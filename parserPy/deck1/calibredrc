// DESIGN_KIT_CALIBRE_DRC_CONTROL_FILE (this line is mandatory for DK Interface)
//////////////////////////////////////////////////////////////////////////////////
//
// $Id: calibredrc 697 2019-03-21 06:26:54Z akononov $
//  ----------------------------------------------------------------------
//     (C) Copyright 2020
//     JSC MERI
//     All Rights Reserved.  
//  ----------------------------------------------------------------------
//
//                        ========================
//                        CALIBRE DRC CONTROL FILE
//                        ========================
//
//
// Input GDS file and cell :
 
// Default required parameter :
DRC MAXIMUM RESULTS 1000

// Default required output :
DRC RESULTS DATABASE drc_results.db
DRC SUMMARY REPORT drc_summary HIER

//DEFINE VARIABLES IFDEF

#IFNDEF INTERACTIVE

// Used wo Interactive: (usually needed for tape out)
#DEFINE DENSITY_CHECK                      

#UNDEFINE DENS_WIN_SIZE 


// Not Used wo Interactive: (usually not needed for tape out)

#UNDEFINE EXCLUDE_SRAMDMY_ONLY
#UNDEFINE OD2_REC_RULES
#UNDEFINE STD_PAD_CHECK
                     

#ENDIF

#DEFINE RVEHIER
// This is your customized deck :
 TITLE "CALIBRE cmos090 DRC RULES FILE, Common technology kit team - Crolles2, dated Date: Wed Jun 21 17:02:52 2006 $ - DRM rev revF - CTK rev 6_1"
 
//////////////////////////////////////////////////////////////////////////////////
//
//                        =============================
//                        CALIBRE cmos090 DRC RULES FILE
//                        =============================
//
//      REFERENCE DOCUMENTS: 
//                Technology: cmos090  
//                Design Rule Manual - Rev: revF
//                RADCS Number: R00125(1-2)
//                CTK - Rev: 6_1
//    Calibre: 
//        Version: v2006.1_19.20
//
//    SOURCE  :        Common technology kit team - Crolles2
//
//    UPDATE  :        Date: Wed Jun 21 17:02:52 2006 $
//    MASTER VERSION : Revision: 1.29 $
//
//        ***************************************************
//         File customized  Mon Jun 26 11:51:26 MEST 2006 
//          with tools :
//           DKSYNCDERIV 5.9.36c2l May-12-2005 ; DKDECK 1.9 Dec-16-2003 ; MIF 1.7.5 Nov-18-2002 ; TCL 8.3 Jan-10-2005 ;
//          with following values :
//           DEL_MY_TECHNO_OPTION  lp
//           PRIVATE_RULES_FILE_NAME  /project/tkitdf61/DEVELOPMENT_DK/CTKdesignKits/cmos090/calibre/c090_derivdir_drc/cgi/cmos090lp_M7_2T.calibredrc_custom
//           SWI_SHRINK  YES
//           SWI_STD_PAD_CHECKS  NO
//           PRIVATE_PILOT  drc.rules
//           SWI_DENS_WIN_SIZES  NO
//           SWI_DENSITY_CHECKS  YES
//           SWI_RVEHIER  YES
//        ***************************************************
//        ***************************************************
//         File customized  Mon Jun 26 11:51:20 MEST 2006 
//          with tools :
//           DKSYNCDERIV 5.9.36c2l May-12-2005 ; DKDECK 1.9 Dec-16-2003 ; MIF 1.7.5 Nov-18-2002 ; TCL 8.3 Jan-10-2005 ;
//          with following values :
//           DEL_MY_TECHNO_OPTION  lp
//        ***************************************************
//        ***************************************************
//         File customized  Mon Jun 26 11:49:58 MEST 2006 
//          with tools :
//           DKSUB 2.13 Jan-22-2004 ; DKSYNCDERIV 5.9.36c2l May-12-2005 ; DKDECK 1.9 Dec-16-2003 ; MIF 1.7.5 Nov-18-2002 ; TCL 8.3 Jan-10-2005 ;
//         with Process Data :
//           missing information for file ../c090_data/ITtecShare_data/ITtechnolyr/TECHNO_CMOS090.lyr
//           RCSfile: CALNUM.lyr.rca $ Revision: 1.75 $ Date: Wed Jan 11 16:24:51 2006 $
//           RCSfile: DUMMY.dr.rca $ Revision: 1.36 $ Date: Mon Sep 12 17:49:17 2005 $
//           RCSfile: CMOS090.dr.rca $ Revision: 1.66 $ Date: Wed Jun 21 17:06:12 2006 $
//           RCSfile: MIM6C090.dr.rca $ Revision: 1.17 $ Date: Thu Aug 25 18:16:29 2005 $
//           RCSfile: FRINGEC090.dr.rca $ Revision: 1.5 $ Date: Thu Sep  8 18:10:12 2005 $
//           RCSfile: STRESS090.dr.rca $ Revision: 1.3 $ Date: Fri Jan 14 17:17:30 2005 $
//           RCSfile: ANTENNA090.dr.rca $ Revision: 1.5 $ Date: Wed Dec  7 16:28:54 2005 $
//           RCSfile: CMOS090.model.rca $ Revision: 1.9 $ Date: Wed Nov 10 11:00:22 2004 $
//          for Process option C090_7ML_2T
//          with following values :
//           DEL_MY_TECHNO_OPTION  lp
//           DEL_METAL_LEVEL  7
//           DEL_MY_TECHNO_NAME  cmos090
//           DEL_MY_SITE_NAME  Crolles2
//           DEL_MY_RADCS_NUMBER  R00125(1-2)
//           DEL_MY_DRM_REVISION  revF
//           DEL_MY_CTK_REVISION  6_1
//           DEL_MGC_CALIBRE_VERSION  v2006.1_19.20
//        ***************************************************
//        ***************************************************
//         File customized  Mon Jun 26 11:49:24 MEST 2006 
//          with tools :
//           DKSYNCDERIV 5.9.36c2l May-12-2005 ; DKDECK 1.9 Dec-16-2003 ; MIF 1.7.5 Nov-18-2002 ; TCL 8.3 Jan-10-2005 ;
//          with following values :
//           DEL_MY_TECHNO_OPTION  lp
//           DEL_METAL_LEVEL  7
//           DEL_MY_TECHNO_NAME  cmos090
//           DEL_MY_SITE_NAME  Crolles2
//           DEL_MY_RADCS_NUMBER  R00125(1-2)
//           DEL_MY_DRM_REVISION  revF
//           DEL_MY_CTK_REVISION  6_1
//           DEL_MGC_CALIBRE_VERSION  v2006.1_19.20
//        ***************************************************
//
//////////////////////////////////////////////////////////////////////////////////
 
//  #################################################################################
//  ######                                    #####
//  ######            REVISION  HISTORY                #####
//  ######                                    #####
//  #################################################################################
//
// 
//HELPS :########################################################################
//HELPS :######                                                             #####
//HELPS :######                   SWITCHES  USAGE                           #####
//HELPS :######                                                             #####
//HELPS :########################################################################
//HELPS :
//HELPS : ##MEMORIES CHECKS MANAGEMENT : Use SRAMDMY only as DRC exclusion layer for non alliance memories
//HELPS : EXCLUDE_SRAMDMY_ONLY
//HELPS :   The default is set to "NO".
//HELPS :   Present in tkit DRC file to "mimic" TSMC DRC on SRAMs:
//HELPS :   Allows to determine which layer(s) should be used to exclude from DRCed database a set of layers in the "3rd party" SRAM memories. 
//HELPS :   Such memories have been designed using TSMC DRC which removes from the DRCed database a set of layers: from DNW to VIA1.
//HELPS :   In TSMC DRC, two layers can be used to remove these layers from the DRCed database:
//HELPS :   - (SRM, drawing)
//HELPS :   - (MKR, sramdmy)
//HELPS :   By default, the OR of (SRM, drawing) and (MKR, sramdmy) is used
//HELPS :   If EXCLUDE_SRAMDMY_ONLY is set to TRUE (for ex. by clikcing on the corresponding button in the calibre interactive customization form), only the layer (MKR. sramdmy) is used.
//HELPS : 
//HELPS : ##DENSITY CHECKS MANAGEMENT : Check Density Rules
//HELPS : DENSITY_CHECKS
//HELPS : Allows to turn OFF minimum density checks.
//HELPS : In the early phases of the layout of a design/cell/block, it may be more user friendly to turn OFF the minimum density checks as it is known that, because the layout is not yet finished, minimum density may not be reached on all layers.
//HELPS : By default, all minimum density checks are performed (they are the ones that perform STAT_ files); this corresponds to the following list of design rules:
//HELPS : OD.R.3,OD.D.1,OD.R.3.1,OD.R.3.2,OD.R.2,OD.R.2.1,PO.R.1,PO.R.2,M1.R.2,M1.R.2.1,
//HELPS : M1.R.4,M2.R.1,M2.R.1.1,M2.R.4,M3.R.1,M3.R.1.1,M3.R.4,M4.R.1,M4.R.1.1,M4.R.4,M5.R.1, 
//HELPS : M5.R.1.1,M5.R.4,M6.R.1,M6.R.1.1,M6.R.4,M7.R.1,M7.R.1.1,M7.R.4,AP.R.2,AP.R.2.1,CTM.DEN.1,CTM.DEN.2,CTM.DEN.3 
//HELPS : These checks can be turned OFF by undefining the DENSITY_CHECK variable.
//HELPS : Note that Maximum density checks are always performed (not possible to turn them OFF through this switch).
//HELPS :
//HELPS : ##DENSITY WINDOW SIZE CHECKS MANAGEMENT : Density window size (/4)
//HELPS : DENS_WIN_SIZES
//HELPS : Allows to turn ON density checks with a window size divided by 4. Impacted rules are:
//HELPS : M1.R.2, Mx.R.1, Mn.R.1.
//HELPS : These checks can be turned ON by modifying the DENS_WIN_SIZE variable value.
//HELPS :
//HELPS : ##SHRINK CHECKS MANAGEMENT : Check rules for shrink compatibility
//HELPS : SHRINK
//HELPS : Allows to turn ON or OFF design rule check S_CO.D.5
//HELPS : By default, S_CO.D.5 is not checked.
//HELPS : This check can be turned ON by defining the SHRINK calibre variable.
//HELPS :
//HELPS : ##STD_PAD_CHECK MANAGEMENT : Check Standard Pad Construction Rules
//HELPS : STD_PAD_CHECK
//HELPS : Allows to turn ON or OFF Standard Pad Construction Rules.
//HELPS :
//HELPS : ##OD2_REC_RULES MANAGEMENT : Check Recommended OD2 Design Rules
//HELPS : OD2_REC_RULES
//HELPS : Allows to turn ON or OFF Recommended OD2 Design Rules
//HELPS :

//  ##############################################################################
//  ######                                                                   #####
//  ######                 SETTING  EXECUTION  CONDITIONS                    #####
//  ######                                                                   #####
//  ##############################################################################
 
//  -------------------------------------------------------------------------
//     EXECUTION  MODE
//  -------------------------------------------------------------------------
 
PRECISION 1000
UNIT LENGTH U
RESOLUTION 5
#IFDEF RVEHIER
DRC CELL NAME YES CELL SPACE XFORM ALL
#ENDIF
 
//  ##############################################################################
//  ######                                                                   #####
//  ######                    INPUT   LAYER   BLOCK                          #####
//  ######                                                                   #####
//  ##############################################################################
//-------------------------------------------------------------------------
//        DRAWN LAYER DEFINITIONS
//-------------------------------------------------------------------------

// DNW
LAYER DNW_dg        3699    LAYER MAP 1    DATATYPE  0    3699        //  DNW -- Deep N-Well
LAYER DNW_msk        3376    LAYER MAP 1    DATATYPE  10    3376
DNWi = DNW_dg OR DNW_msk
LAYER DNW_ng        3701    LAYER MAP 1    DATATYPE  31    3701 
LAYER DNW_fg        3700    LAYER MAP 1    DATATYPE  32    3700
LAYER DNW_gdr        3189 LAYER MAP 1 DATATYPE >=31 <33 3189

// NWEL
LAYER NWEL_dg        3502    LAYER MAP 3    DATATYPE  0    3502           //  NW -- N-Well
LAYER NWEL_hd        3994    LAYER MAP 3    DATATYPE  30    3994
LAYER NWEL_msk        3375    LAYER MAP 3    DATATYPE  10    3375 
NWELi = (NWEL_dg OR NWEL_hd) OR NWEL_msk
LAYER NWEL_ng        3244    LAYER MAP 3    DATATYPE  31    3244 
LAYER NW_gdr        3187 LAYER MAP 3 DATATYPE >=31 <33 3187
LAYER PW_bk        3692    LAYER MAP 222    DATATYPE  20    3692
LAYER PW_gdr        3149 LAYER MAP 222 DATATYPE >=31 <33 3149

// NTN
LAYER NT_N_dg           3732 LAYER MAP 11  DATATYPE 0    3732
LAYER NT_N_ng           3731    LAYER MAP 11     DATATYPE 31       3731
LAYER NT_N_msk         3730    LAYER MAP 11     DATATYPE 10       3730

// VTH
LAYER ADHVTN_dg        3894    LAYER MAP 67    DATATYPE  0    3894
LAYER ADHVTN_hd    3891    LAYER MAP 67    DATATYPE  30    3891
LAYER ADHVTN_msk    3291    LAYER MAP 67    DATATYPE  10    3291 
ADHVTN = (ADHVTN_dg OR ADHVTN_hd) OR ADHVTN_msk
LAYER ADHVTN_ng        3893    LAYER MAP 67    DATATYPE  31    3893 
LAYER VTH_N_gdr        3158 LAYER MAP 67 DATATYPE >=31 <33 3158

LAYER ADHVTP_dg        3890    LAYER MAP 68    DATATYPE  0    3890
LAYER ADHVTP_hd    3887    LAYER MAP 68    DATATYPE  30    3887
LAYER ADHVTP_msk    3290    LAYER MAP 68    DATATYPE  10    3290 
ADHVTP = (ADHVTP_dg OR ADHVTP_hd) OR ADHVTP_msk
LAYER ADHVTP_ng        3889    LAYER MAP 68    DATATYPE  31    3889 
LAYER VTH_P_gdr        3157 LAYER MAP 68 DATATYPE >=31 <33 3157

// VTL
LAYER VTL_N_dg        3681    LAYER MAP 12    DATATYPE  0    3681
LAYER VTL_N_hd    3678    LAYER MAP 12    DATATYPE  30    3678
LAYER VTL_N_msk    3293    LAYER MAP 12    DATATYPE  10    3293 
VTL_Ni = (VTL_N_dg OR VTL_N_hd) OR VTL_N_msk
LAYER VTL_N_ng        3680    LAYER MAP 12    DATATYPE  31    3680 
LAYER VTL_N_gdr        3160 LAYER MAP 12 DATATYPE >=31 <33 3160

LAYER VTL_P_dg        3677    LAYER MAP 13    DATATYPE  0    3677
LAYER VTL_P_hd    3674    LAYER MAP 13    DATATYPE  30    3674
LAYER VTL_P_msk    3292    LAYER MAP 13    DATATYPE  10    3292 
VTL_Pi = (VTL_P_dg OR VTL_P_hd) OR VTL_P_msk
LAYER VTL_P_ng        3676    LAYER MAP 13    DATATYPE  31    3676 
LAYER VTL_P_gdr        3159 LAYER MAP 13 DATATYPE >=31 <33 3159

// OD
LAYER OD_drg        3993    LAYER MAP 6    DATATYPE  0    3993           //  OD -- Thin Oxide
LAYER OD_hd        3987    LAYER MAP 6    DATATYPE  30    3987
LAYER OD_msk        3321    LAYER MAP 6    DATATYPE  10    3321
OD_dg = (OD_drg OR OD_hd) OR OD_msk
LAYER OD_dm        3569    LAYER MAP 6    DATATYPE  40    3569
ODi = OD_dg OR OD_dm
LAYER OD_pin      3990      LAYER MAP 180      DATATYPE  0   3990
LAYER OD_net      3989      LAYER MAP 180      DATATYPE  60   3989
LAYER ACTIVE_dy        3985    LAYER MAP 6      DATATYPE  1    3985    
LAYER ACTIVE_ng        3992    LAYER MAP 6    DATATYPE  31    3992 
LAYER ACTIVE_fg        3991    LAYER MAP 6    DATATYPE  32    3991
LAYER OD_gdr        3188 LAYER MAP 6 DATATYPE >=31 <33 3188

// OD2_33
LAYER OD2_33_drg        3983    LAYER MAP 15    DATATYPE  0    3983           //  OD2-- Thick Oxide
LAYER OD2_33_msk        3320    LAYER MAP 15    DATATYPE  10    3320
OD2_33_dg = OD2_33_drg OR OD2_33_msk
LAYER OD2_33_dm        3554    LAYER MAP 15    DATATYPE  40    3554
LAYER OD2_33_ng        3982    LAYER MAP 15    DATATYPE  31    3982 
LAYER OD2_33_gdr        3186 LAYER MAP 15 DATATYPE >=31 <33 3186

// OD2_25
LAYER OD2_25_drg    3484    LAYER MAP 41    DATATYPE  0    3484           //  OD2-- Thick Oxide
LAYER OD2_25_msk    3319    LAYER MAP 41    DATATYPE  10    3319
OD2_25_dg = OD2_25_drg OR OD2_25_msk
LAYER OD2_25_dm        3483    LAYER MAP 41    DATATYPE  40    3483
LAYER OD2_25_ng        3486    LAYER MAP 41    DATATYPE  31    3486 
LAYER OD2_25_gdr        3185 LAYER MAP 41 DATATYPE >=31 <33 3185

// OD2_18
LAYER OD2_18_drg    3388    LAYER MAP 16    DATATYPE  0    3388 
LAYER OD2_18_msk    3384    LAYER MAP 16    DATATYPE  10    3384
OD2_18_dg = OD2_18_drg OR OD2_18_msk
LAYER OD2_18_dm        3387    LAYER MAP 16    DATATYPE  40    3387
LAYER OD2_18_ng        3386    LAYER MAP 16    DATATYPE  31    3386 
LAYER OD2_18_gdr        3184 LAYER MAP 16 DATATYPE >=31 <33 3184


OD2i = ((OD2_33_dg OR OD2_33_dm) OR OD2_25_dg) OR OD2_25_dm
OD2nodm = OD2_33_dg OR OD2_25_dg

// PO
LAYER POLYG_drg        3975    LAYER MAP 17    DATATYPE  0    3975           //  PO -- Poly Si
LAYER POLYG_hd        3964    LAYER MAP 17    DATATYPE  30    3964 
LAYER POLYG_msk        3318    LAYER MAP 17    DATATYPE  10    3318 
POLYG_dg = (POLYG_drg OR POLYG_hd) OR POLYG_msk
LAYER POLYG_dm        3568    LAYER MAP 17    DATATYPE  40    3568
POLYGi = POLYG_dg OR POLYG_dm

LAYER POLY_dy        3965    LAYER MAP 17    DATATYPE  1    3965
LAYER POLY_ng        3974    LAYER MAP 17    DATATYPE  31    3974
LAYER POLY_fg        3973    LAYER MAP 17    DATATYPE  32    3973
LAYER PO_gdr        3183 LAYER MAP 17 DATATYPE >=31 <33 3183
LAYER PO_pin      3968      LAYER MAP 149      DATATYPE  0   3968
LAYER PO_net      3967      LAYER MAP 149      DATATYPE  60   3967
LAYER POLY_PSPO        3703    LAYER MAP 17    DATATYPE  51    3703

// N1V & N2V
LAYER N1V_bk        3383    LAYER MAP 225    DATATYPE  20    3383
LAYER N1V_mk        3136    LAYER MAP 225    DATATYPE  10    3136
LAYER N1V_gdr        3134    LAYER MAP 225    DATATYPE  >=31 <33 3134
LAYER N2V_bk        3704    LAYER MAP 227    DATATYPE  20    3704
LAYER N2V_mk        3709    LAYER MAP 227    DATATYPE  10    3709
LAYER N2V_gdr1        3145 LAYER MAP 227 DATATYPE >=10 <20 3145
LAYER N2V_gdr2        3706 LAYER MAP 227 DATATYPE >20 <33 3706
N2V_gdr = N2V_gdr1 OR N2V_gdr2

// PP
LAYER PP_dg        3947    LAYER MAP 25    DATATYPE  0    3947           //  PP -- P+ S/D Implantation
LAYER PP_hd        3944    LAYER MAP 25    DATATYPE  30    3944
LAYER PP_msk        3317    LAYER MAP 25    DATATYPE  10    3317 
PPi = (PP_dg OR PP_hd) OR PP_msk
LAYER PP_ng        3949    LAYER MAP 25    DATATYPE  31    3949 
LAYER PP_gdr        3182 LAYER MAP 25 DATATYPE >=31 <33 3182

// NP
LAYER NP_drg        3953    LAYER MAP 26   DATATYPE  0    3953           //  NP -- N+ S/D Implantation
LAYER NP_hd        3950    LAYER MAP 26    DATATYPE  30    3950
LAYER NP_msk        3316    LAYER MAP 26    DATATYPE  10    3316 
LAYER CELLIMP_dm    3315    LAYER MAP 239    DATATYPE  40    3315
LAYER CELLVT_dm        3710    LAYER MAP 238    DATATYPE  40    3710
NP_dg = (NP_drg OR NP_hd) OR NP_msk
LAYER NP_dm        3562    LAYER MAP 26    DATATYPE  40    3562
NPi = NP_dg OR NP_dm
LAYER NP_ng        3952    LAYER MAP 26    DATATYPE  31    3952 
LAYER NP_gdr        3181 LAYER MAP 26 DATATYPE >=31 <33 3181

// RPO
LAYER RPOi_dg        3943    LAYER MAP 29    DATATYPE  0    3943 // Silicided Block Layer
LAYER RPOi_msk        3285    LAYER MAP 29    DATATYPE  10    3285
RPOi = RPOi_dg OR RPOi_msk
LAYER RPOi_ng        3942    LAYER MAP 29    DATATYPE  31    3942 
LAYER RPO_gdr        3180 LAYER MAP 29 DATATYPE >=31 <33 3180

// CO, METALs AND VIAs LAYERS
LAYER COi_dg        3938    LAYER MAP 30    DATATYPE  0    3938           //  CO -- Contact Window
LAYER CO_hd        3933    LAYER MAP 30    DATATYPE  30    3933
LAYER CO_dm        3549    LAYER MAP 30    DATATYPE  40    3549
COi = (COi_dg OR CO_hd) OR CO_dm 
LAYER CONTACT_ng    3937    LAYER MAP 30    DATATYPE  31    3937
LAYER CONTACT_fg    3936    LAYER MAP 30    DATATYPE  32    3936
LAYER CO_gdr        3179 LAYER MAP 30 DATATYPE >=31 <33 3179

LAYER M1_drg        3885    LAYER MAP 31    DATATYPE  0    3885           //  M1 -- Metal-1
LAYER M1_hd        3871    LAYER MAP 31    DATATYPE  30    3871 
M1_dg = M1_drg OR M1_hd
LAYER M1_dm        3548    LAYER MAP 31    DATATYPE  40    3548
M1i =  M1_dm OR M1_dg 
LAYER ME1_dy        3873    LAYER MAP 31    DATATYPE  1    3873
LAYER ME1_ng        3884    LAYER MAP 31    DATATYPE  31    3884
LAYER ME1_fg        3883    LAYER MAP 31    DATATYPE  32    3883
LAYER M1_gdr        3178 LAYER MAP 31 DATATYPE >=31 <33 3178
LAYER M1_pin      3876 LAYER MAP 131      DATATYPE 0    3876        
LAYER M1_net      3875 LAYER MAP 131      DATATYPE 60    3875        
LAYER ME1_sense        3284    LAYER MAP 219    DATATYPE 1    3284
LAYER ME1_fringeC    3270    LAYER MAP 217    DATATYPE 1    3270
LAYER ME1_fringeC_label    3715    LAYER MAP 217    TEXTTYPE 1    3715

LAYER VIA1i_dg        3868    LAYER MAP 51    DATATYPE  0    3868           //  Via1 Hole
LAYER VIA1_hd        3860    LAYER MAP 51    DATATYPE  30    3860
VIA1i = VIA1i_dg OR VIA1_hd
LAYER VI1_ng        3867    LAYER MAP 51    DATATYPE  31    3867 
LAYER VI1_fg        3866    LAYER MAP 51    DATATYPE  32    3866
LAYER VIA1_gdr        3177 LAYER MAP 51 DATATYPE >=31 <33 3177

LAYER M2i_dg        3859    LAYER MAP 32    DATATYPE  0    3859           //  M2 -- Metal-2
LAYER M2_hd        3845    LAYER MAP 32    DATATYPE  30    3845 
M2i = M2i_dg OR M2_hd 
LAYER ME2_dy        3849    LAYER MAP 32    DATATYPE  1    3849
LAYER ME2_ng        3858    LAYER MAP 32    DATATYPE  31    3858
LAYER ME2_fg        3857    LAYER MAP 32    DATATYPE  32    3857
LAYER M2_gdr        3176 LAYER MAP 32 DATATYPE >=31 <33 3176
LAYER M2_pin      3852 LAYER MAP 132      DATATYPE 0    3852        
LAYER M2_net      3851 LAYER MAP 132      DATATYPE 60    3851        
LAYER ME2_sense        3283    LAYER MAP 219    DATATYPE 2    3283
LAYER ME2_fringeC    3269    LAYER MAP 217    DATATYPE 2    3269

LAYER VIA2i_dg        3842    LAYER MAP 52    DATATYPE  0    3842           //  Via2 Hole
LAYER VIA2_hd        3834    LAYER MAP 52    DATATYPE  30    3834
VIA2i = VIA2i_dg OR VIA2_hd
LAYER VI2_ng        3841    LAYER MAP 52    DATATYPE  31    3841 
LAYER VI2_fg        3840    LAYER MAP 52    DATATYPE  32    3840
LAYER VIA2_gdr        3175 LAYER MAP 52 DATATYPE >=31 <33 3175

LAYER M3i_dg        3833    LAYER MAP 33    DATATYPE  0    3833           //  M3 -- Metal-3
LAYER M3_hd        3819    LAYER MAP 33    DATATYPE  30    3819 
M3i = M3i_dg OR M3_hd 
LAYER ME3_dy        3823    LAYER MAP 33    DATATYPE  1    3823
LAYER ME3_ng        3832    LAYER MAP 33    DATATYPE  31    3832
LAYER ME3_fg        3831    LAYER MAP 33    DATATYPE  32    3831
LAYER M3_gdr        3174 LAYER MAP 33 DATATYPE >=31 <33 3174
LAYER M3_pin      3826 LAYER MAP 133      DATATYPE 0    3826        
LAYER M3_net      3825 LAYER MAP 133      DATATYPE 60    3825        
LAYER ME3_sense        3282    LAYER MAP 219    DATATYPE 3    3282
LAYER ME3_fringeC    3268    LAYER MAP 217    DATATYPE 3    3268

LAYER VIA3i_dg        3816    LAYER MAP 53    DATATYPE  0    3816           //  Via3 Hole
LAYER VIA3_hd        3808    LAYER MAP 53    DATATYPE  30    3808
VIA3i = VIA3i_dg OR VIA3_hd
LAYER VI3_ng        3815    LAYER MAP 53    DATATYPE  31    3815 
LAYER VI3_fg        3814    LAYER MAP 53    DATATYPE  32    3814
LAYER VIA3_gdr        3173 LAYER MAP 53 DATATYPE >=31 <33 3173

LAYER M4i_dg        3807    LAYER MAP 34    DATATYPE  0    3807           //  M4 -- Metal-4
LAYER M4_hd        3793    LAYER MAP 34    DATATYPE  30    3793 
M4i = M4i_dg OR M4_hd 
LAYER ME4_dy        3797    LAYER MAP 34    DATATYPE  1    3797
LAYER ME4_ng        3806    LAYER MAP 34    DATATYPE  31    3806
LAYER ME4_fg        3805    LAYER MAP 34    DATATYPE  32    3805
LAYER M4_gdr        3172 LAYER MAP 34 DATATYPE >=31 <33 3172
LAYER M4_pin      3800 LAYER MAP 134      DATATYPE 0    3800        
LAYER M4_net      3799 LAYER MAP 134      DATATYPE 60    3799        
LAYER ME4_sense        3281    LAYER MAP 219    DATATYPE 4    3281
LAYER ME4_fringeC    3267    LAYER MAP 217    DATATYPE 4    3267

LAYER VIA4i_dg        3789    LAYER MAP 54    DATATYPE  0    3789           //  Via4 Hole
LAYER VIA4_hd        3781    LAYER MAP 54    DATATYPE  30    3781
VIA4i = VIA4i_dg OR VIA4_hd
LAYER VI4_ng        3788    LAYER MAP 54    DATATYPE  31    3788 
LAYER VI4_fg        3787    LAYER MAP 54    DATATYPE  32    3787
LAYER VIA4_gdr        3171 LAYER MAP 54 DATATYPE >=31 <33 3171

LAYER M5i_dg        3780    LAYER MAP 35    DATATYPE  0    3780           //  M5 -- Metal-5
LAYER M5_hd        3766    LAYER MAP 35    DATATYPE  30    3766 
M5i = M5i_dg OR M5_hd 
LAYER ME5_dy        3770    LAYER MAP 35    DATATYPE  1    3770
LAYER ME5_ng        3779    LAYER MAP 35    DATATYPE  31    3779
LAYER ME5_fg        3778    LAYER MAP 35    DATATYPE  32    3778
LAYER M5_gdr        3170 LAYER MAP 35 DATATYPE >=31 <33 3170
LAYER M5_pin      3773 LAYER MAP 135      DATATYPE 0    3773        
LAYER M5_net      3772 LAYER MAP 135      DATATYPE 60    3772        
LAYER ME5_sense        3280    LAYER MAP 219    DATATYPE 5    3280
LAYER ME5_fringeC    3266    LAYER MAP 217    DATATYPE 5    3266

LAYER VIA5i_dg        3763    LAYER MAP 55    DATATYPE  0    3763           //  Via5 Hole
LAYER VIA5_hd        3755    LAYER MAP 55    DATATYPE  30    3755
VIA5i = VIA5i_dg OR VIA5_hd
LAYER VI5_ng        3762    LAYER MAP 55    DATATYPE  31    3762 
LAYER VI5_fg        3761    LAYER MAP 55    DATATYPE  32    3761
LAYER VIA5_gdr        3169 LAYER MAP 55 DATATYPE >=31 <33 3169

LAYER M6i_dg        3754    LAYER MAP 36    DATATYPE  0    3754           //  M6 -- Metal-6
LAYER M6_hd        3740    LAYER MAP 36    DATATYPE  30    3740 
M6i = M6i_dg OR M6_hd 
LAYER ME6_dy        3744    LAYER MAP 36    DATATYPE  1    3744
LAYER ME6_ng        3753    LAYER MAP 36    DATATYPE  31    3753
LAYER ME6_fg        3752    LAYER MAP 36    DATATYPE  32    3752
LAYER M6_gdr        3168 LAYER MAP 36 DATATYPE >=31 <33 3168
LAYER M6_pin      3747 LAYER MAP 136      DATATYPE 0    3747        
LAYER M6_net      3746 LAYER MAP 136      DATATYPE 60    3746        
LAYER ME6_sense        3279    LAYER MAP 219    DATATYPE 6    3279
LAYER ME6_fringeC    3444    LAYER MAP 217    DATATYPE 6    3444

LAYER VIA6i_dg        3356    LAYER MAP 56    DATATYPE  0    3356           //  Via6 Hole
LAYER VIA6_hd        3348    LAYER MAP 56    DATATYPE  30    3348
VIA6i = VIA6i_dg OR VIA6_hd
LAYER VI6_ng        3355    LAYER MAP 56    DATATYPE  31    3355 
LAYER VI6_fg        3354    LAYER MAP 56    DATATYPE  32    3354
LAYER VIA6_gdr        3167 LAYER MAP 56 DATATYPE >=31 <33 3167

LAYER M7i_dg        3347    LAYER MAP 37    DATATYPE  0    3347           //  M7 -- Metal-7
LAYER M7_hd        3333    LAYER MAP 37    DATATYPE  30    3333 
M7i = M7i_dg OR M7_hd 
LAYER ME7_dy        3337    LAYER MAP 37    DATATYPE  1    3337
LAYER ME7_ng        3346    LAYER MAP 37    DATATYPE  31    3346
LAYER ME7_fg        3345    LAYER MAP 37    DATATYPE  32    3345
LAYER M7_gdr        3166 LAYER MAP 37 DATATYPE >=31 <33 3166
LAYER M7_pin      3340 LAYER MAP 137      DATATYPE 0    3340        
LAYER M7_net      3339 LAYER MAP 137      DATATYPE 60    3339        
LAYER ME7_sense        3278    LAYER MAP 219    DATATYPE 7    3278
LAYER ME7_fringeC    3445    LAYER MAP 217    DATATYPE 7    3445

LAYER ME1_tO        3080    LAYER MAP 31    DATATYPE  7    3080
M1i_dg_tO = ME1_tO OR M1i
LAYER ME2_tO        3079    LAYER MAP 32    DATATYPE  7    3079
M2i_dg_tO = ME2_tO OR M2i
LAYER ME3_tO        3078    LAYER MAP 33    DATATYPE  7    3078
M3i_dg_tO = ME3_tO OR M3i
LAYER ME4_tO        3077    LAYER MAP 34    DATATYPE  7    3077
M4i_dg_tO = ME4_tO OR M4i
LAYER ME5_tO        3076    LAYER MAP 35    DATATYPE  7    3076
M5i_dg_tO = ME5_tO OR M5i

//-------------------------------------------------------------------------
//        CAPACITORS LAYERS 
//-------------------------------------------------------------------------

LAYER BOTMIMi         3530    LAYER MAP 88     DATATYPE 0 3530
LAYER BOTMIM_dy        3529    LAYER MAP 88    DATATYPE  1 3529
LAYER BOTMIM_ng        3488    LAYER MAP 88    DATATYPE  31 3488
LAYER BOTMIM_gdr    3154 LAYER MAP 88 DATATYPE >=31 <33 3154
LAYER MEXCLUDE_BOT     3485     LAYER MAP 150     DATATYPE  23 3485

LAYER MKTOPMIMi        3481    LAYER MAP 77     DATATYPE  0 3481
LAYER MKTOPMIM_dy    3480    LAYER MAP 77     DATATYPE  1    3480
LAYER MKTOPMIM_ng    3489    LAYER MAP 77     DATATYPE  31    3489
LAYER MKTOPMIM_gdr    3155 LAYER MAP 77 DATATYPE >=31 <33 3155

MKR_MOM = ME1_fringeC AND (ME2_fringeC AND (ME3_fringeC AND (ME4_fringeC AND ME5_fringeC)))

//-------------------------------------------------------------------------
//        ENCAPSULATION LAYERS 
//-------------------------------------------------------------------------

LAYER NITRIDE_dg    3133    LAYER MAP 231    DATATYPE  0    3133 
LAYER NITRIDE_gdr    3142 LAYER MAP 231 DATATYPE >=31 <33 3142
LAYER NIT_bp        3924    LAYER MAP 231    DATATYPE  35    3924 

LAYER CBi        3931    LAYER MAP 43    DATATYPE  0    3931 // Passivation opening for Bond Pad
LAYER CB_ng        3929    LAYER MAP 43    DATATYPE  31    3929 // Passivation opening for Bond Pad
LAYER CB_via        3239    LAYER MAP 43     DATATYPE  33 3239
LAYER CB_gdr        3153 LAYER MAP 43 DATATYPE >=31 <33 3153

LAYER ALUCAP        3583    LAYER MAP 42     DATATYPE  0    3583
LAYER ALUCAP_dy        3575    LAYER MAP 42    DATATYPE  1    3575
LAYER AP_gdr        3161 LAYER MAP 42 DATATYPE >=31 <33 3161
LAYER AP_pin      3736 LAYER MAP 42      DATATYPE 50    3736            
LAYER AP_net      3737 LAYER MAP 42      DATATYPE 60    3737            

//-------------------------------------------------------------------------
//        DRAM LAYERS 
//-------------------------------------------------------------------------

LAYER LIL_dm        3552    LAYER MAP 235    DATATYPE  40    3552
LAYER LIL_gdr        3141 LAYER MAP 235 DATATYPE >=31 <33 3141

LAYER ELEC1_dm        3537    LAYER MAP 236    DATATYPE  40    3537
LAYER ELEC1_msk        3288    LAYER MAP 236    DATATYPE  10    3288 
ELEC1 = ELEC1_dm OR ELEC1_msk
LAYER ELEC1_ng        3487    LAYER MAP 236    DATATYPE  31    3487 
LAYER ELEC1_gdr        3140 LAYER MAP 236 DATATYPE >=31 <33 3140

LAYER ELEC2_dm        3536    LAYER MAP 237    DATATYPE  40    3536
LAYER ELEC2_msk        3287    LAYER MAP 237    DATATYPE  10    3287 
ELEC2 = ELEC2_dm OR ELEC2_msk
LAYER ELEC2_ng        3490    LAYER MAP 237    DATATYPE  31    3490 
LAYER ELEC2_gdr        3139 LAYER MAP 237 DATATYPE >=31 <33 3139

LAYER CTELEC2        3932    LAYER MAP 30    DATATYPE  47    3932
LAYER CTDRAM_gdr    3135 LAYER MAP 233 DATATYPE >=31 <33 3135
LAYER CELLVT_gdr    3138 LAYER MAP 238 DATATYPE >=10 <33 3138
LAYER CELLIMP_gdr    3137 LAYER MAP 239 DATATYPE >=10 <33 3137

//-------------------------------------------------------------------------
//        MISC LAYER
//-------------------------------------------------------------------------

LAYER PRESIST_0_dg    3526    LAYER MAP 70    DATATYPE 0    3526    
LAYER PRESIST_0_ng    3499    LAYER MAP 70    DATATYPE 31    3499    
LAYER HRI_gdr        3156 LAYER MAP 70 DATATYPE >=31 <33 3156
LAYER CB_lr        3926    LAYER MAP 95    DATATYPE  0    3926 
LAYER FUSE_gdr        3152 LAYER MAP 95 DATATYPE >=31 <33 3152
LAYER LMARK        3524    LAYER MAP 109    DATATYPE 0    3524           // Alignment Mark Rule for Laser Repair 
LAYER LMARK_gdr        3151 LAYER MAP 109 DATATYPE >=31 <33 3151
LAYER POFUSE        3448    LAYER MAP 156    DATATYPE  0    3448  

//Layer for General Data Requirement rules: mask layers only
LAYER NW2V_gdr        3150 LAYER MAP 221 DATATYPE >=10 <33 3150
LAYER VTNCELL_gdr    3148 LAYER MAP 224 DATATYPE >=31 <33 3148
LAYER PW2V_gdr        3147 LAYER MAP 223 DATATYPE >=10 <33 3147
LAYER P1V_gdr        3146 LAYER MAP 226 DATATYPE >=10 <33 3146
LAYER P2V_gdr        3144 LAYER MAP 228 DATATYPE >=10 <33 3144
LAYER PP2V_gdr        3143 LAYER MAP 230 DATATYPE >=10 <33 3143

// Historic layers 
LAYER HOTWL        3515    LAYER MAP 112    DATATYPE 0    3515       //  Hot N_well dummy for DRC (SEE README HOT_NWEL NOTES)
LAYER NWDMY        3510    LAYER MAP 114    DATATYPE 0    3510       //  NWEL resistor dummy layer
LAYER RODMY        3496    LAYER MAP 49    DATATYPE  0    3496          //  dummy layer to remove OD
LAYER RPDMY        3518    LAYER MAP 115     DATATYPE 0    3518

//-------------------------------------------------------------------------
//        INPUT LAYER : MARKERS
//-------------------------------------------------------------------------

// tilling
LAYER MEXCLUDE_m1    3650    LAYER MAP 150    DATATYPE 1    3650
LAYER MEXCLUDE_m2    3649    LAYER MAP 150    DATATYPE 2    3649
LAYER MEXCLUDE_m3    3648    LAYER MAP 150    DATATYPE 3    3648
LAYER MEXCLUDE_m4    3647    LAYER MAP 150    DATATYPE 4    3647
LAYER MEXCLUDE_m5    3646    LAYER MAP 150    DATATYPE 5    3646
LAYER MEXCLUDE_m6    3645    LAYER MAP 150    DATATYPE 6    3645
LAYER MEXCLUDE_m7    3509    LAYER MAP 150    DATATYPE 7    3509
LAYER MEXCLUDE_poly    3651    LAYER MAP 150    DATATYPE 21    3651
LAYER MEXCLUDE_ac    3643    LAYER MAP 150    DATATYPE 20    3643
LAYER MEXCLUDE_dg     3652     LAYER MAP 218        DATATYPE 24  3652
LAYER MEXCLUDE_alu    3572      LAYER MAP 150 DATATYPE 22   3572
LAYER MEXCLUDE_rf     3644  LAYER MAP 218     DATATYPE 1       3644

// misc
LAYER RHDMY        3519    LAYER MAP 117    DATATYPE 0    3519          //  dummy layer to form P+OD/POLY resistor & N+OD/POLY resistor with RPO
LAYER BJTDMY        3514    LAYER MAP 110    DATATYPE 0    3514           //  dummy layer to form BJT
LAYER EXCL        3516    LAYER MAP 121    DATATYPE 0    3516        //  exclude all layers for DRC
LAYER OD_res        3210    LAYER MAP 116     DATATYPE 18    3210
LAYER PO_res        3209    LAYER MAP 116     DATATYPE 19    3209
LAYER PMDMY        3520    LAYER MAP 106    DATATYPE 0    3520           //  dummy layer to cover fuse window and protection ring structure
LAYER SEALRINGi        3421    LAYER MAP 162    DATATYPE 0    3421    // SEALRING Layer to cover seal ring area
SEALRING_TC = SEALRINGi NOT INTERACT PMDMY
SEALRING_FPR = SEALRINGi INTERACT PMDMY

LAYER INDDMY        3417    LAYER MAP 144    DATATYPE  0    3417 
LAYER DIODMYi        3495    LAYER MAP 119    DATATYPE  0    3495            //  dummy layer to form diode
LAYER mkr_LP        3195   LAYER MAP 218   DATATYPE  56 3195
LAYER mkr_GP        3196   LAYER MAP 218   DATATYPE  55 3196
LAYER LOGO        3194   LAYER MAP 158   DATATYPE  0 3194
LAYER MKR_GATED        3684    LAYER MAP 218    DATATYPE  111    3684
LAYER MKR_tp        3655    LAYER MAP 218    DATATYPE  121    3655  //MKR;tp for test points
LAYER MKR_wb        3642    LAYER MAP 218    DATATYPE  119    3642  //MKR;wb for bonding areas
LAYER MKR_plateC    3707    LAYER MAP 218    DATATYPE  125    3707
LAYER MKR_fuselink    3708    LAYER MAP 156    DATATYPE  1    3708 //MKR;fuselink for polyfuse body

// MKR for SRAM
LAYER DMSRMi        3479    LAYER MAP 50    DATATYPE  0    3479  // SRAM layer
LAYER SRAMDMY        3211    LAYER MAP 186    DATATYPE  0    3211    
LAYER MKR_srmperi    3705    LAYER MAP 186    DATATYPE  4    3705
LAYER FDRC        3621    LAYER MAP 218    DATATYPE  46    3621    

LAYER SRAMPG        3895    LAYER MAP 186    DATATYPE  1    3895  
LAYER SRAMSP        3401    LAYER MAP 218    DATATYPE  117    3401  
LAYER SRAMDP        3402    LAYER MAP 218    DATATYPE  118    3402  



//-------------------------------------------------------------------------
//        INPUT LAYER FOR BLAZE LVS VERIFICATION
//-------------------------------------------------------------------------
LAYER POBIASP_drawing2 3001 LAYER MAP  245 DATATYPE 4 3001   // Blaze modified
LAYER POBIASP_drawing4 3002 LAYER MAP  245 DATATYPE 6 3002   // Blaze modified
LAYER POBIASP_drawing6 3003 LAYER MAP  245 DATATYPE 8 3003   // Blaze modified
LAYER POBIASM_drawing2 3004 LAYER MAP  245 DATATYPE 5 3004   // Blaze modified
LAYER POBIASM_drawing4 3005 LAYER MAP  245 DATATYPE 7 3005   // Blaze modified
LAYER POBIASM_drawing6 3006 LAYER MAP  245 DATATYPE 9 3006   // Blaze modified

//-------------------------------------------------------------------------
//        INPUT LAYER FOR LVS VERIFICATION
//-------------------------------------------------------------------------
  
LAYER TEXT_0        3662    LAYER MAP 127    DATATYPE  0    3662

#IFDEF ATTACH_LABEL
TEXT LAYER        3208    LAYER MAP 180    TEXTTYPE  0    3208
TEXT LAYER        3971    LAYER MAP 149    TEXTTYPE  0    3971
TEXT LAYER        3881 LAYER MAP 131    TEXTTYPE 0    3881     // metal1 pintext
TEXT LAYER        3855 LAYER MAP 132    TEXTTYPE 0    3855     // metal2 pintext
TEXT LAYER        3829 LAYER MAP 133    TEXTTYPE 0    3829     // metal3 pintext
TEXT LAYER        3803 LAYER MAP 134    TEXTTYPE 0    3803     // metal4 pintext
TEXT LAYER        3776 LAYER MAP 135    TEXTTYPE 0    3776     // metal5 pintext
TEXT LAYER        3750 LAYER MAP 136    TEXTTYPE 0    3750     // metal6 pintext
TEXT LAYER        3343 LAYER MAP 137    TEXTTYPE 0    3343     // metal7 pintext
TEXT LAYER        3369 LAYER MAP 138    TEXTTYPE 0    3369     // metal8 pintext
TEXT LAYER        3229 LAYER MAP 139    TEXTTYPE 0    3229     // metal8 pintext
TEXT LAYER        3574 LAYER MAP 42    TEXTTYPE 50 3574 

ATTACH 3971    IPOLY_FINAL    PORT LAYER TEXT 3971
ATTACH 3971    RES_POLY_TERM_FINAL    PORT LAYER TEXT 3971
ATTACH 3208    SALI_FINAL    PORT LAYER TEXT 3208
ATTACH 3881    ME1_FINAL    PORT LAYER TEXT 3881
ATTACH 3855    ME2_FINAL    PORT LAYER TEXT 3855
ATTACH 3829    ME3_FINAL    PORT LAYER TEXT 3829
ATTACH 3803    ME4_FINAL    PORT LAYER TEXT 3803
ATTACH 3776    ME5_FINAL    PORT LAYER TEXT 3776
ATTACH 3750    ME6_FINAL    PORT LAYER TEXT 3750
ATTACH 3343         ME7_FINAL       PORT LAYER TEXT 3343
ATTACH 3574    ALUCAP_FINAL    PORT LAYER TEXT 3574

TEXT LAYER        3109 LAYER MAP 180    TEXTTYPE  60    3109
TEXT LAYER        3970    LAYER MAP 149    TEXTTYPE  60    3970
TEXT LAYER        3880 LAYER MAP 131    TEXTTYPE  60  3880        
TEXT LAYER        3854 LAYER MAP 132    TEXTTYPE  60  3854        
TEXT LAYER        3828 LAYER MAP 133    TEXTTYPE  60  3828        
TEXT LAYER        3802 LAYER MAP 134    TEXTTYPE  60  3802        
TEXT LAYER        3775 LAYER MAP 135    TEXTTYPE  60  3775        
TEXT LAYER        3749 LAYER MAP 136    TEXTTYPE  60  3749        
TEXT LAYER        3342 LAYER MAP 137    TEXTTYPE  60  3342        
TEXT LAYER        3368 LAYER MAP 138    TEXTTYPE  60  3368        
TEXT LAYER        3228 LAYER MAP 139    TEXTTYPE  60  3228        
TEXT LAYER        3573 LAYER MAP 42    TEXTTYPE  60  3573

ATTACH 3970    IPOLY_FINAL
ATTACH 3970    RES_POLY_TERM_FINAL
ATTACH 3109    SALI_FINAL
ATTACH 3880    ME1_FINAL
ATTACH 3854    ME2_FINAL
ATTACH 3828    ME3_FINAL
ATTACH 3802    ME4_FINAL
ATTACH 3775    ME5_FINAL
ATTACH 3749    ME6_FINAL
ATTACH 3342    ME7_FINAL    
ATTACH 3573    ALUCAP_FINAL

#ENDIF

// markerR
LAYER ME1_17        3879    LAYER MAP 116    DATATYPE  1    3879
LAYER ME3_17        3827    LAYER MAP 116    DATATYPE  3    3827
LAYER ME2_17        3853    LAYER MAP 116    DATATYPE  2    3853
LAYER ME4_17        3801    LAYER MAP 116    DATATYPE  4    3801
LAYER ME5_17        3774    LAYER MAP 116    DATATYPE  5    3774
LAYER ME6_17        3748    LAYER MAP 116    DATATYPE  6    3748
LAYER ME7_17        3341    LAYER MAP 116    DATATYPE  7    3341
LAYER ME8_17        3367    LAYER MAP 116    DATATYPE  8    3367
LAYER ME9_17        3227    LAYER MAP 116    DATATYPE  9    3227
LAYER ALUCAP_17        3576    LAYER MAP 116    DATATYPE  20    3576
// markerC
LAYER ME1_25        3870    LAYER MAP 216    DATATYPE  1    3870
LAYER ME2_25        3844    LAYER MAP 216    DATATYPE  2    3844
LAYER ME3_25        3818    LAYER MAP 216    DATATYPE  3    3818
LAYER ME4_25        3792    LAYER MAP 216    DATATYPE  4    3792
LAYER ME5_25        3765    LAYER MAP 216    DATATYPE  5    3765
LAYER ME6_25        3739    LAYER MAP 216    DATATYPE  6    3739
LAYER ME7_25        3332    LAYER MAP 216    DATATYPE  7    3332
LAYER ME8_25        3358    LAYER MAP 216    DATATYPE  8    3358
LAYER ME9_25        3218    LAYER MAP 216    DATATYPE  9    3218

TEXT LAYER    3870       LAYER MAP 216     DATATYPE  1      3870
TEXT LAYER    3844       LAYER MAP 216     DATATYPE  2      3844
TEXT LAYER    3818       LAYER MAP 216     DATATYPE  3      3818
TEXT LAYER    3792       LAYER MAP 216     DATATYPE  4      3792
TEXT LAYER    3765       LAYER MAP 216     DATATYPE  5      3765
TEXT LAYER    3739       LAYER MAP 216     DATATYPE  6      3739
TEXT LAYER    3332       LAYER MAP 216     DATATYPE  7      3332
TEXT LAYER    3358       LAYER MAP 216     DATATYPE  8      3358
TEXT LAYER    3218       LAYER MAP 216     DATATYPE  9      3218

TEXT LAYER    3110        LAYER MAP 219    TEXTTYPE 1    3110
TEXT LAYER    3111        LAYER MAP 219    TEXTTYPE 2    3111
TEXT LAYER    3112        LAYER MAP 219    TEXTTYPE 3    3112
TEXT LAYER    3113        LAYER MAP 219    TEXTTYPE 4    3113
TEXT LAYER    3114        LAYER MAP 219    TEXTTYPE 5    3114
TEXT LAYER    3115        LAYER MAP 219    TEXTTYPE 6    3115
TEXT LAYER    3116        LAYER MAP 219    TEXTTYPE 7    3116
TEXT LAYER    3117        LAYER MAP 219    TEXTTYPE 8    3117
TEXT LAYER    3118        LAYER MAP 219    TEXTTYPE 9    3118

LAYER MSUB_0        3632    LAYER MAP 111    DATATYPE 0    3632
LAYER FSIZE        3593
LAYER MAP >=0 <243    DATATYPE 32    3593
LAYER MAP >245 <256    DATATYPE 32    3593

LAYER NOSIZE        3594
LAYER MAP >=0 <243    DATATYPE 31    3594
LAYER MAP >245 <256    DATATYPE 31    3594
LAYER ALUCAP_ng        3582    LAYER MAP 42    DATATYPE 31    3582

//-------------------------------------------------------------------------
//        INPUT LAYER TO AVOID FALSE MAPPING CALIBRE
//-------------------------------------------------------------------------


LAYER ALL_MASK        3999
LAYER MAP >=0 <243    DATATYPE 10    3999
LAYER MAP >245 <256    DATATYPE 10    3999

LAYER ALL_GEOM 4000 LAYER MAP >= 0 < 256 DATATYPE >= 0 < 128 4000
LAYER ALL_TEXT 255 LAYER MAP >= 0 < 256 TEXTTYPE >= 0 < 128 255

ALL_PHYSICAL_LAYERS:0 = DNWi OR DNW_gdr
ALL_PHYSICAL_LAYERS:1 = (((ALL_PHYSICAL_LAYERS:0 OR NWELi) OR NW_gdr) OR PW_bk) OR PW_gdr
ALL_PHYSICAL_LAYERS:2 = ((ALL_PHYSICAL_LAYERS:1 OR NT_N_dg) OR NT_N_ng) OR NT_N_msk
ALL_PHYSICAL_LAYERS:3 = (ALL_PHYSICAL_LAYERS:2 OR ADHVTN) OR VTH_N_gdr
ALL_PHYSICAL_LAYERS:4 = (ALL_PHYSICAL_LAYERS:3 OR ADHVTP) OR VTH_P_gdr
ALL_PHYSICAL_LAYERS:5 = (ALL_PHYSICAL_LAYERS:4 OR VTL_Ni) OR VTL_N_gdr
ALL_PHYSICAL_LAYERS:6 = (ALL_PHYSICAL_LAYERS:5 OR VTL_Pi) OR VTL_P_gdr
ALL_PHYSICAL_LAYERS:7 = ((ALL_PHYSICAL_LAYERS:6 OR ODi) OR OD_gdr) OR ACTIVE_dy
ALL_PHYSICAL_LAYERS:8 = ((ALL_PHYSICAL_LAYERS:7 OR OD2i) OR OD2_33_gdr) OR OD2_25_gdr
ALL_PHYSICAL_LAYERS:9 = ((ALL_PHYSICAL_LAYERS:8 OR POLYGi) OR PO_gdr) OR POLY_dy
ALL_PHYSICAL_LAYERS:10 = ((ALL_PHYSICAL_LAYERS:9 OR N1V_bk) OR N1V_mk) OR N1V_gdr
ALL_PHYSICAL_LAYERS:11 = ((ALL_PHYSICAL_LAYERS:10 OR N2V_bk) OR N2V_mk) OR N2V_gdr
ALL_PHYSICAL_LAYERS:12 = (ALL_PHYSICAL_LAYERS:11 OR PPi) OR PP_gdr
ALL_PHYSICAL_LAYERS:13 = (ALL_PHYSICAL_LAYERS:12 OR NPi) OR NP_gdr
ALL_PHYSICAL_LAYERS:14 = (ALL_PHYSICAL_LAYERS:13 OR CELLIMP_dm) OR CELLIMP_gdr
ALL_PHYSICAL_LAYERS:15 = (ALL_PHYSICAL_LAYERS:14 OR RPOi) OR RPO_gdr
ALL_PHYSICAL_LAYERS:16 = (ALL_PHYSICAL_LAYERS:15 OR COi) OR CO_gdr
ALL_PHYSICAL_LAYERS:17 = ((ALL_PHYSICAL_LAYERS:16 OR M1i) OR M1_gdr) OR ME1_dy
ALL_PHYSICAL_LAYERS:18 = (ALL_PHYSICAL_LAYERS:17 OR VIA1i) OR VIA1_gdr
ALL_PHYSICAL_LAYERS:19 = ((ALL_PHYSICAL_LAYERS:18 OR M2i) OR M2_gdr) OR ME2_dy
ALL_PHYSICAL_LAYERS:20 = (ALL_PHYSICAL_LAYERS:19 OR VIA2i) OR VIA2_gdr
ALL_PHYSICAL_LAYERS:21 = ((ALL_PHYSICAL_LAYERS:20 OR M3i) OR M3_gdr) OR ME3_dy
ALL_PHYSICAL_LAYERS:22 = (ALL_PHYSICAL_LAYERS:21 OR VIA3i) OR VIA3_gdr
ALL_PHYSICAL_LAYERS:23 = ((ALL_PHYSICAL_LAYERS:22 OR M4i) OR M4_gdr) OR ME4_dy
ALL_PHYSICAL_LAYERS:24 = (ALL_PHYSICAL_LAYERS:23 OR VIA4i) OR VIA4_gdr
ALL_PHYSICAL_LAYERS:25 = ((ALL_PHYSICAL_LAYERS:24 OR M5i) OR M5_gdr) OR ME5_dy
ALL_PHYSICAL_LAYERS:26 = (ALL_PHYSICAL_LAYERS:25 OR VIA5i) OR VIA5_gdr
ALL_PHYSICAL_LAYERS:27 = ((ALL_PHYSICAL_LAYERS:26 OR M6i) OR M6_gdr) OR ME6_dy
ALL_PHYSICAL_LAYERS:28 = (ALL_PHYSICAL_LAYERS:27 OR VIA6i) OR VIA6_gdr
ALL_PHYSICAL_LAYERS:29 = ((ALL_PHYSICAL_LAYERS:28 OR M7i) OR M7_gdr) OR ME7_dy
ALL_PHYSICAL_LAYERS:30 = ((ALL_PHYSICAL_LAYERS:29 OR BOTMIMi) OR BOTMIM_gdr) OR BOTMIM_dy 
ALL_PHYSICAL_LAYERS:31 = ((ALL_PHYSICAL_LAYERS:30 OR MKTOPMIMi) OR MKTOPMIM_gdr) OR MKTOPMIM_dy
ALL_PHYSICAL_LAYERS:32 = ((ALL_PHYSICAL_LAYERS:31 OR NITRIDE_dg) OR NITRIDE_gdr) OR NIT_bp
ALL_PHYSICAL_LAYERS:33 = ((ALL_PHYSICAL_LAYERS:32 OR CBi) OR CB_gdr) OR CB_via
ALL_PHYSICAL_LAYERS:34 = ((ALL_PHYSICAL_LAYERS:33 OR ALUCAP) OR AP_gdr) OR ALUCAP_dy
ALL_PHYSICAL_LAYERS:35 = (ALL_PHYSICAL_LAYERS:34 OR LIL_dm) OR LIL_gdr
ALL_PHYSICAL_LAYERS:36 = (ALL_PHYSICAL_LAYERS:35 OR ELEC1) OR ELEC1_gdr
ALL_PHYSICAL_LAYERS:37 = (ALL_PHYSICAL_LAYERS:36 OR ELEC2) OR ELEC2_gdr
ALL_PHYSICAL_LAYERS:38 = (ALL_PHYSICAL_LAYERS:37 OR CTELEC2) OR CTDRAM_gdr
ALL_PHYSICAL_LAYERS:39 = ((((((ALL_PHYSICAL_LAYERS:38 OR PRESIST_0_dg) OR HRI_gdr) OR CB_lr) OR FUSE_gdr) OR LMARK) OR LMARK_gdr) OR POFUSE
ALL_PHYSICAL_LAYERS:40 = (((((ALL_PHYSICAL_LAYERS:39 OR NW2V_gdr) OR VTNCELL_gdr) OR PW2V_gdr) OR P1V_gdr) OR P2V_gdr) OR PP2V_gdr
ALL_PHYSICAL_LAYERS:41 = (((ALL_PHYSICAL_LAYERS:40 OR HOTWL) OR NWDMY) OR RODMY) OR RPDMY
ALL_PHYSICAL_LAYERS:42 = ((((((((ALL_PHYSICAL_LAYERS:41 OR RHDMY) OR BJTDMY) OR EXCL) OR OD_res) OR PO_res) OR PMDMY) OR SEALRING_TC) OR INDDMY) OR DIODMYi
ALL_PHYSICAL_LAYERS:43 = (((((((ALL_PHYSICAL_LAYERS:42 OR mkr_LP) OR mkr_GP) OR LOGO) OR MKR_GATED) OR MKR_tp) OR MKR_wb) OR MKR_plateC) OR MKR_fuselink 
ALL_PHYSICAL_LAYERS:44 = ((((((ALL_PHYSICAL_LAYERS:43 OR DMSRMi) OR SRAMDMY) OR MKR_srmperi) OR FDRC) OR SRAMPG) OR SRAMSP) OR SRAMDP 
ALL_PHYSICAL_LAYERS:46 = ((ALL_PHYSICAL_LAYERS:44 OR MSUB_0) OR FSIZE) OR NOSIZE

LAYOUT BASE LAYER DNW_dg DNW_msk DNW_ng DNW_fg                            
LAYOUT BASE LAYER NWEL_dg NWEL_hd NWEL_msk NWEL_ng NW_gdr PW_bk PW_gdr
LAYOUT BASE LAYER NT_N_dg NT_N_ng NT_N_msk
LAYOUT BASE LAYER ADHVTN_dg ADHVTN_hd ADHVTN_msk ADHVTN_ng VTH_N_gdr
LAYOUT BASE LAYER ADHVTP_dg ADHVTP_hd ADHVTP_msk ADHVTP_ng VTH_P_gdr
LAYOUT BASE LAYER VTL_N_dg VTL_N_hd VTL_N_msk VTL_N_ng VTL_N_gdr
LAYOUT BASE LAYER VTL_P_dg VTL_P_hd VTL_P_msk VTL_P_ng VTL_P_gdr
LAYOUT BASE LAYER OD_drg OD_hd OD_msk OD_dm ACTIVE_dy ACTIVE_ng ACTIVE_fg
LAYOUT BASE LAYER OD2_33_drg OD2_33_msk OD2_33_dm OD2_33_ng OD2_33_gdr
LAYOUT BASE LAYER OD2_25_drg OD2_25_msk OD2_25_dm OD2_25_ng OD2_25_gdr
LAYOUT BASE LAYER POLYG_drg POLYG_hd POLYG_msk POLYG_dm POLY_dy POLY_ng POLY_fg    // POLY_PSPO nust not be used
LAYOUT BASE LAYER N1V_bk N1V_mk N1V_gdr N2V_bk N2V_mk N2V_gdr1 N2V_gdr2
LAYOUT BASE LAYER PP_dg PP_hd PP_msk PP_ng PP_gdr
LAYOUT BASE LAYER NP_drg NP_hd NP_msk NP_dm NP_ng NP_gdr
LAYOUT BASE LAYER RPOi_dg RPOi_msk RPOi_ng RPO_gdr
LAYOUT BASE LAYER COi_dg CO_hd CO_dm CONTACT_ng CONTACT_fg CO_gdr
LAYOUT BASE LAYER M1_drg M1_hd M1_dm ME1_dy ME1_tO ME1_ng ME1_fg
LAYOUT BASE LAYER PRESIST_0_dg PRESIST_0_ng HRI_gdr
// RAM:
LAYOUT BASE LAYER ELEC1_dm ELEC1_msk ELEC1_ng ELEC1_gdr ELEC2_dm ELEC2_msk ELEC2_ng ELEC2_gdr
LAYOUT BASE LAYER CELLIMP_dm CELLIMP_gdr CELLVT_dm CELLVT_gdr LIL_dm LIL_gdr CTELEC2 CTDRAM_gdr
// Misc:
LAYOUT BASE LAYER NW2V_gdr VTNCELL_gdr PW2V_gdr P1V_gdr P2V_gdr PP2V_gdr 

CHIP = EXTENT ALL_PHYSICAL_LAYERS:46
BULK  = SIZE CHIP BY 1.0
EMPTY = CHIP NOT BULK

//  ##############################################################################
//  ######                                                                   #####
//  ######                      OPERATION   BLOCK                            #####
//  ######                                                                   #####
//  ##############################################################################
 
// //////////////////////////////////////////////////////////////////////////////
// /                      LAYERS  DERIVATION  SECTION                           /
// //////////////////////////////////////////////////////////////////////////////
 

// Derived layers used for density check:
// Exclusion Areas:
EA2 = (CB OR CB_via) OR LMARK

XALLACT      = ((ODi OR ACTIVE_ng) OR ACTIVE_fg) OR ACTIVE_dy
POLY_DENS = ((POLYGi OR POLY_ng) OR POLY_fg) OR POLY_dy

M1_DENS = (((M1i OR ME1_dy) OR ME1_ng) OR ME1_fg) OR ME1_tO
M1_MIN_DENS = M1_DENS NOT INDDMY
M2_DENS = (((M2i OR ME2_dy) OR ME2_ng) OR ME2_fg) OR ME2_tO
M2_MIN_DENS = M2_DENS NOT INDDMY
M3_DENS = (((M3i OR ME3_dy) OR ME3_ng) OR ME3_fg) OR ME3_tO
M3_MIN_DENS = M3_DENS NOT INDDMY
M4_DENS = (((M4i OR ME4_dy) OR ME4_ng) OR ME4_fg) OR ME4_tO
M4_MIN_DENS = M4_DENS NOT INDDMY
M5_DENS = (((M5i OR ME5_dy) OR ME5_ng) OR ME5_fg) OR ME5_tO
M5_MIN_DENS = M5_DENS NOT INDDMY
M6_DENS = ((M6i OR ME6_dy) OR ME6_ng) OR ME6_fg
M6_MIN_DENS = M6_DENS NOT INDDMY
M7_DENS = ((M7i OR ME7_dy) OR ME7_ng) OR ME7_fg
M7_MIN_DENS = M7_DENS NOT BOT_OR_IND
M7_MAX_DENS = M7_DENS NOT EA2
ALUCAP_DENS = ((ALUCAP OR ALUCAP_dy) OR AP_gdr) OR CB

// NODAL NWEL CONNECTIVITY CHECKS
//-------------------------------

NPODi        = NPi AND ODi                // These derivations are needed to
NONWRi       = NWELi NOT INTERACT NWDMY   // for NW.S.1/NW.S.2/NW.S.3
RPDMYi       = RPDMY NOT INTERACT RPOi
RPO_RPDMY    = RPOi OR RPDMYi
ILP1i        = POLYGi NOT RPO_RPDMY


PPODi        = PPi AND ODi                

DMSRM_NOTA = DMSRMi NOT INTERACT FDRC
SRAMDMY_NOTA = SRAMDMY NOT INTERACT FDRC

#IFDEF EXCLUDE_SRAMDMY_ONLY
SRAM_EXCLUDE = COPY SRAMDMY_NOTA
#ELSE
SRAM_EXCLUDE = DMSRM_NOTA OR SRAMDMY_NOTA
#ENDIF

// GLOBAL DERIVED LAYERS FOR RULE CHECKS
//--------------------------------------

PWELi    = BULK NOT (NWELi OR PW_bk) 
PWEL    = PWELi NOT INSIDE SRAM_EXCLUDE
NWPWBLK_1 = NWEL INTERACT PW_bk
NWPWBLK    = NWPWBLK_1 OR PW_bk
HRI    = COPY PRESIST_0_dg
DMSRM   = COPY DMSRMi
SEALRING_NOT_RP = SEALRING_TC NOT RELIEF_PATTERN



// EXCLUDE UNCHECKED REGIONS
//--------------------------

DNW    = DNWi    NOT INSIDE SRAM_EXCLUDE
NWEL    = NWELi NOT INSIDE SRAM_EXCLUDE
PW_bk_ns= PW_bk NOT INSIDE SRAM_EXCLUDE
NT_N    = (NT_N_dg OR NT_N_msk) NOT SRAM_EXCLUDE    
OD      = ODi    NOT SRAM_EXCLUDE            
OD2     = OD2i    NOT SRAM_EXCLUDE
POLY    = POLYGi NOT SRAM_EXCLUDE            
PP      = PPi    NOT INSIDE SRAM_EXCLUDE    
NP      = NPi    NOT INSIDE SRAM_EXCLUDE    
VTH_N    = ADHVTN    NOT SRAM_EXCLUDE        
VTH_P    = ADHVTP    NOT SRAM_EXCLUDE
VTL_N    = VTL_Ni    NOT SRAM_EXCLUDE
VTL_P    = VTL_Pi    NOT SRAM_EXCLUDE
RPO     = RPOi    NOT SRAM_EXCLUDE            

CO     = (COi NOT SRAM_EXCLUDE) NOT SEALRING_NOT_RP    
M1     = (M1i NOT SRAM_EXCLUDE) NOT SEALRING_NOT_RP    
M1_dg_tO = (M1i_dg_tO NOT SRAM_EXCLUDE) NOT SEALRING_NOT_RP
VIA1     = (VIA1i NOT SRAM_EXCLUDE) NOT SEALRING_NOT_RP    
M2     = M2i NOT SEALRING_NOT_RP
M2_dg_tO = M2i_dg_tO NOT SEALRING_NOT_RP
VIA2 = VIA2i NOT SEALRING_NOT_RP
M3 = M3i NOT SEALRING_NOT_RP
M3_dg_tO = M3i_dg_tO NOT SEALRING_NOT_RP
VIA3 = VIA3i NOT SEALRING_NOT_RP
M4 = M4i NOT SEALRING_NOT_RP
M4_dg_tO = M4i_dg_tO NOT SEALRING_NOT_RP
VIA4 = VIA4i NOT SEALRING_NOT_RP
M5 = M5i NOT SEALRING_NOT_RP
M5_dg_tO = M5i_dg_tO NOT SEALRING_NOT_RP
VIA5 = VIA5i NOT SEALRING_NOT_RP
M6 = M6i NOT SEALRING_NOT_RP
VIA6 = VIA6i NOT SEALRING_NOT_RP
M7 = M7i NOT SEALRING_NOT_RP

CB      = COPY CBi
FW    = COPY CB_lr
BOTMIM    = COPY BOTMIMi
MKTOPMIM = COPY MKTOPMIMi

// DEFINED SRM RELATED DERIVED LAYERS
//-----------------------------------

ODs    = ODi AND SRAM_EXCLUDE
POLYGs    = POLYGi AND SRAM_EXCLUDE
NWELs    = NWELi INSIDE SRAM_EXCLUDE

NPODs    = NPi AND ODs
PPODs    = PPi AND ODs
NSTPs    = NPODs AND NONWRi
PSTPs    = PPODs AND PWELi

NACTs    = NPODs AND PWELi
PACTs    = PPODs AND NWELi
DACTs    = NACTs OR PACTs
GATEs    = POLYGs AND ODs
HV_GATEs = GATEs AND OD2i
NGO2s    = HV_GATEs AND NPi
PGO2s    = HV_GATEs AND PPi
GATE_NPs = GATEs AND NPi
GATE_PPs = GATEs AND PPi
ALLNGATEs = GATE_NPs OR NGO2s
ALLPGATEs = GATE_PPs OR PGO2s
ALLGATEs = ALLPGATEs OR ALLNGATEs
ACTNOSTRAPs = ODs NOT (NSTPs AND PSTPs)
ACTIVSDs = (ACTNOSTRAPs ENCLOSE ALLGATEs) NOT ALLGATEs

// DRM DEFINITION
//-----------------------------------

PPOD_drmi = (PPi AND ODi) NOT POLYGi    // P+OD
NPOD_drmi = (NPi AND ODi) NOT POLYGi    // N+OD
CIOD_drmi = (CELLIMP_dm AND ODi) NOT POLYGi // CELLIMPOD

PW_STRAPi = PPOD_drmi AND PWELi        // PW strap
NW_STRAPi = NPOD_drmi AND NWELi        // NW strap
CI_STRAPi = CIOD_drmi AND NWELi        // CI strap

PPSD_drmi = PPOD_drmi AND NWELi        // P+SD
NPSD_drmi = NPOD_drmi AND PWELi        // N+SD
CISD_drmi = CIOD_drmi AND PWELi        // CI SD

SD_drmi     = PPSD_drmi OR (NPSD_drmi OR CISD_drmi)    // SD (Source/Drain)
BarfromLDD = ((((POFUSE OR RHDMY) OR HRI) OR BJTDMY) OR N1V_bk) OR N2V_bk

// DRM DEFINITION, EXCLUDE UNCHECKED REGIONS
//--------------------------

PPOD_drm = (PP AND OD) NOT POLY    // P+OD
NPOD_drm = (NP AND OD) NOT POLY    // N+OD
CIOD_drm = (CELLIMP_dm AND OD) NOT POLY    // CELLIMPOD

PW_STRAP = PPOD_drm AND PWEL        // PW strap
NW_STRAP = NPOD_drm AND NWEL        // NW strap
CI_STRAP = CIOD_drm AND NWEL        // CI strap

PPSD_drm = PPOD_drm AND NWEL        // P+SD
NPSD_drm = NPOD_drm AND PWEL        // N+SD
CISD_drm = CIOD_drm AND PWEL        // CI SD

SD_drm     = PPSD_drm OR (NPSD_drm OR CISD_drm)    // SD (Source/Dran)


// VARIABLES SETTINGS
//-----------------------------------

// VTH/L_N/P.W/S.1
VARIABLE        track_l        0.280
VARIABLE        edge_l        0.560
// WB.S.2, WB.DEN.1/2/3
VARIABLE    Bond_area    -3.000
VARIABLE    COS45        1.414 
// These variables are for developpers: they allow quick density window (size and step) modification impact analysis:
VARIABLE    Win_dev        1
VARIABLE    Step_dev    1
// STEP fine tuning for corners: 1/sqrt(2)
VARIABLE    Isqrt2        0.7 
// CMIM.ANT.8
VARIABLE    AP_thick    1.000


// DEFINED NON-SRM RELATED DERIVED LAYERS
//-----------------------------------

NW1V    = NWEL NOT OD2
NW1V_NODAL = STAMP NW1V BY NWELi
NW2V    = NWEL AND OD2
NW2V_NODAL = STAMP NW2V BY NWELi


RWi    = DNWi NOT NWELi
RW2V       = RWi INTERACT OD2i
RW2V_NODAL = STAMP RW2V BY PWELi
RW1V       = RWi NOT RW2V
RW1V_NODAL = STAMP RW1V BY PWELi

IMP    = NP OR PP
NPOD    = OD AND NP
PPOD    = OD AND PP

COOD    = CO AND OD // Diffusion contacts 
COPO    = CO NOT OD               // POLY contacts + floating contacts

NSTP    = NPOD AND NONWR          // NWEL tap diffusion
NACT    = NPOD AND PWEL           // NMOS device active diffusion
PACT    = PPOD AND NWEL           // PMOS device active diffusion
PSTP    = PPOD AND PWEL           // Substrate (pwell) tap diffusion

DACT    = NACT OR PACT            // NMOS/PMOS device active diffusion

GATE    = POLY AND OD                                // Gate regions for all NMOS and PMOS (included varactors, drifts, gated diodes)
GATE_Drift_Antifuse = ((((NPOD CUT PWEL) CUT NWEL) INTERACT (OD2_33_dg OR OD2_25_dg)) AND GATE) NOT INTERACT PW_bk   // Gate regions for drifts antifuse
GATE_Var = (((P_CHANNEL INSIDE NP) OR (N_CHANNEL INSIDE PP)) NOT GATE_Drift) NOT GATE_Drift_Antifuse   // Gate regions for varactors
GATE_Drift = POLY AND ODDrift                     // Gate regions for drifts
GATE_GatedDiode = ((GATE CUT NP) AND (GATE CUT PP)) AND OD2 // Gate regions for gated diodes

GATE_Not_Drift_Var = GATE NOT (GATE_Var OR GATE_Drift)        // Gate regions for all NMOS and PMOS, except varactors and drifts

FPO1A    = POLY NOT OD             // Field poly
HV_GATE    = GATE AND OD2

GATE_NP    = GATE AND NP
GATE_PP    = GATE AND PP

GATE_W    = POLY COIN INSIDE EDGE GATE      // Gate width
GATE_W_Not_Drift_Var = POLY COIN INSIDE EDGE GATE_Not_Drift_Var      // Gate width for all NMOS and PMOS, except varactors and drifts
GATE_L    = GATE NOT COIN INSIDE EDGE POLY  // Coincident edge of interconnect POLY
GATE_L_Not_Drift_Var = GATE_Not_Drift_Var NOT COIN INSIDE EDGE POLY  // Coincident edge of interconnect POLY for all NMOS and PMOS, except varactors and drifts

GATEN_W    = GATE_W COIN INSIDE EDGE GATE_NP
GATEP_W    = GATE_W COIN INSIDE EDGE GATE_PP

HV_GATE_W_33 = GATE_W INSIDE EDGE OD2_33_dg
HV_GATE_W_25 = GATE_W INSIDE EDGE OD2_25_dg

HV_GATE_W = GATE_W COIN INSIDE EDGE HV_GATE      //  2.5V MOS gates
LV_GATE_W = GATE_W NOT COIN INSIDE EDGE HV_GATE

HV_NGATE_W = HV_GATE_W COIN INSIDE EDGE GATE_NP   //  NMOS gate edges
HV_PGATE_W = HV_GATE_W COIN INSIDE EDGE GATE_PP   //  PMOS gate edges

PSTP_NACT_BTE = PSTP COIN OUTSIDE EDGE NACT     
NACT_PSTP_BTE = NACT COIN OUTSIDE EDGE PSTP
NSTP_PACT_BTE = NSTP COIN OUTSIDE EDGE PACT
PACT_NSTP_BTE = PACT COIN OUTSIDE EDGE NSTP     

STACK_M1_ng = COPY ME1_ng
STACK_V0_ng = COPY BULK
STACK_M2_ng = STACK_M1_ng AND ME2_ng
STACK_V1_ng = STACK_V0_ng AND VI1_ng
STACK_M3_ng = STACK_M2_ng AND ME3_ng
STACK_V2_ng = STACK_V1_ng AND VI2_ng
STACK_M4_ng = STACK_M3_ng AND ME4_ng
STACK_V3_ng = STACK_V2_ng AND VI3_ng
STACK_M5_ng = STACK_M4_ng AND ME5_ng
STACK_V4_ng = STACK_V3_ng AND VI4_ng
STACK_M6_ng = STACK_M5_ng AND ME6_ng
STACK_V5_ng = STACK_V4_ng AND VI5_ng
STACK_M7_ng = STACK_M6_ng AND ME7_ng
STACK_V6_ng = STACK_V5_ng AND VI6_ng

RNGX_M1    = COPY M1i
RNGX_V0 = COPY BULK
RNGX_M2 = RNGX_M1 AND M2i
RNGX_V1 = RNGX_V0 AND VIA1i
RNGX_M3 = RNGX_M2 AND M3i
RNGX_V2 = RNGX_V1 AND VIA2i
RNGX_M4 = RNGX_M3 AND M4i
RNGX_V3 = RNGX_V2 AND VIA3i
RNGX_M5 = RNGX_M4 AND M5i
RNGX_V4 = RNGX_V3 AND VIA4i
RNGX_M6 = RNGX_M5 AND M6i
RNGX_V5 = RNGX_V4 AND VIA5i
RNGX_M7 = RNGX_M6 AND M7i
RNGX_V6 = RNGX_V5 AND VIA6i

//rings of metals and vias outside sealring:
RNGX_M    = RNGX_M7 NOT INTERACT SEALRING_TC     //all metals, not in SR MKR 
RNGX_V    = RNGX_V6 NOT INTERACT SEALRING_TC     //all vias, not in SR MKR 
RNGX_M_2 = RNGX_M TOUCH ((HOLES (RNGX_M ENCLOSE (INSIDE RNGX_V RNGX_M)) INNER) ENCLOSE FW == 1)        //protection ring made of these layers enclosing one relevant FW shape

RNGX    = (PMDMY NOT FW) AND RNGX_M_2

//rings of metals and vias in sealring:
RNGX_M_SR = INSIDE RNGX_M7 SEALRING_TC     //all metals, in SR MKR 
RNGX_V_SR = INSIDE RNGX_V6 SEALRING_TC     //all vias, in SR MKR 
RNGX_M_2_SR = RNGX_M_SR NOT TOUCH (HOLES (RNGX_M_SR ENCLOSE (INSIDE RNGX_V_SR RNGX_M_SR)) INNER)             //protection ring made of these layers

// Expand edges outward from OD and extended side to side to form a rectangle.
EXGATE_NP = SIZE ((GATE_NP NOT GATE_Var) NOT INTERACT MKR_GATED) BY 0.220    
EXGATE_PP = SIZE ((GATE_PP NOT GATE_Var) NOT INTERACT MKR_GATED) BY 0.220    

// For ESD check
PMOS    = PACT ENCLOSE GATE 
NMOS    = NACT ENCLOSE GATE
PASD    = PMOS NOT GATE
NASD    = NMOS NOT GATE

// For NWEL (within OD) RESISTOR CHECKS
RNWEL    = NWEL INTERACT NWDMY    // NWEL resistor (UNDER OD & STI)
NWRES    = RNWEL INTERACT RPO    // NWEL resistor (UNDER OD)
NONWR    = NWEL NOT INTERACT NWDMY        // NWEL exclude resistor area
ODWR    = OD INTERACT NWRES    // OD area of NW resistor

// For via checks
// FOR isolated single via rule

M1Wide = ((SIZE M1 BY 0.21 UNDEROVER TRUNCATE 0.21) AND M1) NOT M1Big
M2Wide = ((SIZE M2 BY 0.21 UNDEROVER TRUNCATE 0.21) AND M2) NOT M2Big
M3Wide = ((SIZE M3 BY 0.21 UNDEROVER TRUNCATE 0.21) AND M3) NOT M3Big
M4Wide = ((SIZE M4 BY 0.21 UNDEROVER TRUNCATE 0.21) AND M4) NOT M4Big
M5Wide = ((SIZE M5 BY 0.21 UNDEROVER TRUNCATE 0.21) AND M5) NOT M5Big

M1Big = (SIZE M1 BY 0.49 UNDEROVER TRUNCATE 0.49) AND M1
M2Big = (SIZE M2 BY 0.49 UNDEROVER TRUNCATE 0.49) AND M2
M3Big = (SIZE M3 BY 0.49 UNDEROVER TRUNCATE 0.49) AND M3
M4Big = (SIZE M4 BY 0.49 UNDEROVER TRUNCATE 0.49) AND M4
M5Big = (SIZE M5 BY 0.49 UNDEROVER TRUNCATE 0.49) AND M5

M5Huge = (SIZE M5Big BY 0.9 UNDEROVER TRUNCATE 0.9) AND M5Big 
M6Huge = (SIZE M6 BY 0.9 UNDEROVER TRUNCATE 0.9) AND M6
M7Huge = (SIZE M7 BY 0.9 UNDEROVER TRUNCATE 0.9) AND M7


M2OvpM1 = M1 AND M2
M3OvpM2 = M2 AND M3
M4OvpM3 = M3 AND M4
M5OvpM4 = M4 AND M5
M6OvpM5 = M5 AND M6
M7OvpM6 = M6 AND M7

VIA_EXD    = RNGX OR SEALRING_NOT_RP

//---------------------------------------- LAYERS  DERIVATION

NGO2    = HV_GATE AND NP
PGO2    = HV_GATE AND PP
ALLNGATE = GATE_NP OR NGO2
ALLPGATE = GATE_PP OR PGO2
ALLGATE  =  ALLPGATE OR ALLNGATE

NACTIVE = OD AND NP
PACTIVE = OD AND PP
NINPW    = NACTIVE AND PWEL
PINNW    = PACTIVE AND NWEL

GATE_N    = NINPW AND POLY
GATE_P    = PINNW AND POLY

ACTNOSTRAP = OD NOT (NSTP AND PSTP) 
ACTIVSD    = (ACTNOSTRAP ENCLOSE ALLGATE) NOT ALLGATE

POLY_SALI = POLY AND RPO

//--------------------------------------------- actpol layer
ACTPOL:1 = OD AND POLY
 
//--------------------------------------------- trprot layer
SIPA    = RPO AND OD
SIPG1    = SIPA ENCLOSE ACTPOL:1
SIPO    = RPO AND POLY
SIPG2    = SIPO ENCLOSE ACTPOL:1
TRPROT:1 = SIPG1 OR SIPG2

//--------------------------------------------- siprotx layer
SIPROTX = RPO NOT TRPROT:1
 
//--------------------------------------------- pofield layer
POFIELD = POLY NOT OD

//--------------------------------------------- siprpo1 layer
SIPRPO1 = POFIELD AND SIPROTX

//--------------------------------------------- rhipo device
RHBODY    = (HRI AND SIPRPO1) NOT PP
RHPOLY    = POLY ENCLOSE RHBODY
RHTERM    = RHPOLY NOT RHBODY
RHHEAD    = RHTERM AND PP

//--------------------------------------------- CB_via layer
CB_VIA_BOTMIM = (CB_via AND BOTMIM) NOT INTERACT MKTOPMIM
CB_VIA_TOPMIM = CB_via AND MKTOPMIM
CB_VIA_MIM = CB_VIA_TOPMIM OR CB_VIA_BOTMIM
CB_VIA_NOT_MIM = CB_VIA NOT CB_VIA_MIM
CB_VIA_NOT_MIM_NOT_SR = CB_VIA NOT (CB_VIA_MIM OR SEALRING_TC_MZ)
ALUCAP_MIM = ALUCAP INTERACT CB_VIA_MIM
CB_VIA_MIM_AP = CB_VIA_MIM OR (ALUCAP_MIM AND (CB_VIA AND M7)) //CB_VIA on MIM, or on Mtop and linked through AP to CB_VIA on MIM
CB_VIA_METAL:1 = CB_VIA NOT CB_VIA_MIM_AP   //CB_VIA out of MIM
 
// //////////////////////////////////////////////////////////////////////////////
// /                      CONNECTIVITY  DEFINITION                              /
// //////////////////////////////////////////////////////////////////////////////

SALIP    = PPOD_drmi NOT RPO_RPDMY
SALIN    = NPOD_drmi NOT RPO_RPDMY
SALIC    = CIOD_drmi NOT RPO_RPDMY

CONNECT    SALIP PWELi
CONNECT    SALIN NWELi
CONNECT    SALIC CELLIMP_dm
CONNECT    SALIN SALIP SALIC

CONNECT       NWELi DNWi    
CONNECT    M1i ILP1i SALIN BY COi
CONNECT    M1i ILP1i SALIP BY COi
CONNECT    M1i ILP1i SALIC BY COi
CONNECT    M1i M2i BY VIA1i              
CONNECT    M2i M3i BY VIA2i              
CONNECT    M3i M4i BY VIA3i
CONNECT    M4i M5i BY VIA4i
CONNECT       M5i M6i BY VIA5i
CONNECT    M6i M7i BY VIA6i


// Devices specific connectivity
// For PF.D.3 check
CP_POFUSE = COPY POFUSE
CONNECT CP_POFUSE ILP1i BY POLY_FUSE_BODY  

CONNECT ALUCAP MKTOPMIM BOTMIM M7i BY CB_via
//------------------------------------------------------------------------------
//     Derived Layers for SEALRING and Fuse Protection Ring
//------------------------------------------------------------------------------

RELIEF_PATTERN = INSIDE (PP AND ((ENCLOSE (HOLES (DONUT OD >1)INNER) POLY == 1) OR (DONUT OD >1))) SEALRING_TC //relief patterns

OD_STRESS = ODi INSIDE RELIEF_PATTERN
M1_STRESS = M1i INSIDE RELIEF_PATTERN
M2_STRESS = M2i INSIDE RELIEF_PATTERN
M3_STRESS = M3i INSIDE RELIEF_PATTERN
M4_STRESS = M4i INSIDE RELIEF_PATTERN
M5_STRESS = M5i INSIDE RELIEF_PATTERN
M6_STRESS = M6i INSIDE RELIEF_PATTERN
M7_STRESS = M7i INSIDE RELIEF_PATTERN
CO_STRESS = COi INSIDE RELIEF_PATTERN
VIA1_STRESS = VIA1i INSIDE RELIEF_PATTERN
VIA2_STRESS = VIA2i INSIDE RELIEF_PATTERN
VIA3_STRESS = VIA3i INSIDE RELIEF_PATTERN
VIA4_STRESS = VIA4i INSIDE RELIEF_PATTERN
VIA5_STRESS = VIA5i INSIDE RELIEF_PATTERN
VIA6_STRESS = VIA6i INSIDE RELIEF_PATTERN

CB_SEALRING = CBi AND SEALRING_TC
OD_SEALRING = (ODi NOT OD_STRESS) AND SEALRING_TC
M1_SEALRING = (M1i NOT M1_STRESS) AND SEALRING_TC
M2_SEALRING = (M2i NOT M2_STRESS) AND SEALRING_TC
M3_SEALRING = (M3i NOT M3_STRESS) AND SEALRING_TC
M4_SEALRING = (M4i NOT M4_STRESS) AND SEALRING_TC
M5_SEALRING = (M5i NOT M5_STRESS) AND SEALRING_TC
M6_SEALRING = (M6i NOT M6_STRESS) AND SEALRING_TC
M7_SEALRING = (M7i NOT M7_STRESS) AND SEALRING_TC
CO_SR = (COi NOT CO_STRESS) AND SEALRING_TC
VIA1_SR = (VIA1i NOT VIA1_STRESS) AND SEALRING_TC
VIA2_SR = (VIA2i NOT VIA2_STRESS) AND SEALRING_TC
VIA3_SR = (VIA3i NOT VIA3_STRESS) AND SEALRING_TC
VIA4_SR = (VIA4i NOT VIA4_STRESS) AND SEALRING_TC
VIA5_SR = (VIA5i NOT VIA5_STRESS) AND SEALRING_TC
VIA6_SR = (VIA6i NOT VIA6_STRESS) AND SEALRING_TC

M1_CRACK = M1_SEALRING INTERACT VIA1i == 1
M2_CRACK = M2_SEALRING INTERACT VIA1i == 1
M3_CRACK = M3_SEALRING INTERACT VIA2i == 1
M4_CRACK = M4_SEALRING INTERACT VIA3i == 1
M5_CRACK = M5_SEALRING INTERACT VIA4i == 1
M6_CRACK = M6_SEALRING INTERACT VIA5i == 1
M7_CRACK = M7_SEALRING INTERACT VIA6i == 1

M1_MGS = M1_SEALRING INTERACT VIA1i == 2
M2_MGS = M2_SEALRING INTERACT VIA1i == 2
M3_MGS = M3_SEALRING INTERACT VIA2i == 2
M4_MGS = M4_SEALRING INTERACT VIA3i == 2
M5_MGS = M5_SEALRING INTERACT VIA4i == 2
M6_MGS = M6_SEALRING INTERACT VIA5i == 2
M7_MGS = M7_SEALRING INTERACT VIA6i == 2
#IFDEF OLD_SEALRING

SR.R.2 {@ Rule SR.R.2: The die seal ring must be a continuous ring around the entire chip consisting of 2 rings on all metals with 3 rings of CO and all vias (2 on inner, 1 on the outer metal). The outer metal ring is covered by CB. The die seal ring must be covered with MKR;sealring.
    NOT DONUT CO_SR
    NOT DONUT VIA1_SR
    NOT DONUT VIA2_SR
    NOT DONUT VIA3_SR
    NOT DONUT VIA4_SR
    NOT DONUT VIA5_SR
    NOT DONUT VIA6_SR
    NOT DONUT SEALRING_TC
    SEALRING_TC INTERACT OD_SEALRING !=2
    SEALRING_TC INTERACT M1_SEALRING !=2
    SEALRING_TC INTERACT M1_SEALRING !=2
    SEALRING_TC INTERACT M2_SEALRING !=2
    SEALRING_TC INTERACT M3_SEALRING !=2
    SEALRING_TC INTERACT M4_SEALRING !=2
    SEALRING_TC INTERACT M5_SEALRING !=2
    SEALRING_TC INTERACT M6_SEALRING !=2
    SEALRING_TC INTERACT M7_SEALRING !=2
    CRACK_RING = M1i INTERACT CB_SEALRING
    CRACK_RING INTERACT CO_SR !=1
    CRACK_RING INTERACT VIA1_SR !=1
    CRACK_RING INTERACT VIA2_SR !=1
    CRACK_RING INTERACT VIA3_SR !=1
    CRACK_RING INTERACT VIA4_SR !=1
    CRACK_RING INTERACT VIA5_SR !=1
    CRACK_RING INTERACT VIA6_SR !=1
    MGS_RING = M1i NOT INTERACT CB_SEALRING
    MGS_RING INTERACT CO_SR !=2
    MGS_RING INTERACT VIA1_SR !=2
    MGS_RING INTERACT VIA2_SR !=2
    MGS_RING INTERACT VIA3_SR !=2
    MGS_RING INTERACT VIA4_SR !=2
    MGS_RING INTERACT VIA5_SR !=2
    MGS_RING INTERACT VIA6_SR !=2
}

SR.D.1 {@ Rule SR.D.1: Distance of die seal ring Metal to any NW, DNW, unrelated PO, NP or any dummy (these shapes not allowed under MKR;sealring). Metal Space within MKR;sealring. Space of Metal inside MKR;sealring to other metal.: 3.000
    X1 = EXT M1 M1_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X1 NOT SEALRING_TC
    X2 = EXT M2 M2_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X2 NOT SEALRING_TC
    X3 = EXT M3 M3_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X3 NOT SEALRING_TC
    X4 = EXT M4 M4_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X4 NOT SEALRING_TC
    X5 = EXT M5 M5_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X5 NOT SEALRING_TC
    X6 = EXT M6 M6_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X6 NOT SEALRING_TC
    X7 = EXT M7 M7_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    X7 NOT SEALRING_TC
    XOD = EXT OD M1_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    XOD NOT SEALRING_TC
    XNWEL = EXT NWEL M1_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XNWEL NOT SEALRING_TC
    XDNWEL = EXT DNW M1_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XDNWEL NOT SEALRING_TC
    XPOLY = EXT POLY M1_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XPOLY NOT SEALRING_TC
    XNP = EXT NP M1_SEALRING < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XNP NOT SEALRING_TC
}

SR.D.2 {@ Rule SR.D.2: CB Distance to metal of inner metal ring: 2.000
    EXT M1_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    EXT M2_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    EXT M3_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    EXT M4_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    EXT M5_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    EXT M6_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    EXT M7_MGS CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION
}

SR.EN.4 {@ Rule SR.EN.4: MKR;sealring Enclosure of CB: 1.000
    X = HOLES CB_SEALRING
    Y = SEALRING_TC NOT X
    Y WITH WIDTH < 5
    Y WITH WIDTH > 5
}

SR.W.4 {@ Rule SR.W.4: VIAn Width in seal ring (min=max width of continuous VIAn rings): 0.280
    VIA5_SR WITH WIDTH < 0.280
    VIA5_SR WITH WIDTH > 0.2872
    VIA6_SR WITH WIDTH < 0.280
    VIA6_SR WITH WIDTH > 0.2872
}

SR.W.5 {@ Rule SR.W.5: VIAx Width in seal ring (min=max width of continuous VIAx rings): 0.130
    VIA1_SR WITH WIDTH < 0.130
    VIA1_SR WITH WIDTH > 0.1372
    VIA2_SR WITH WIDTH < 0.130
    VIA2_SR WITH WIDTH > 0.1372
    VIA3_SR WITH WIDTH < 0.130
    VIA3_SR WITH WIDTH > 0.1372
    VIA4_SR WITH WIDTH < 0.130
    VIA4_SR WITH WIDTH > 0.1372
}

SR.W.6 {@ Rule SR.W.6: CO Width in seal ring (min=max width of continuous CO rings): 0.120
    CO_SR WITH WIDTH < 0.120
    CO_SR WITH WIDTH > 0.1272
}

SR.W.7 {@ Rule SR.W.7: CB Width in die seal ring (min=max width of continuous CB rings): 4.000
    CB_SEALRING WITH WIDTH < 4.000
    CB_SEALRING WITH WIDTH > 4.0072
}

SR.S.1 {@ Rule SR.S.1: VIAn Space in die seal ring (space between continuous VIAn rings in inner metal ring) : 1.120
    X6 = M6_MGS NOT VIA5_SR
    Y6 = X6 TOUCH  VIA5_SR == 2
    Y6 WITH WIDTH < 1.1092
    Y6 WITH WIDTH > 1.1236
    X7 = M7_MGS NOT VIA6_SR
    Y7 = X7 TOUCH  VIA6_SR == 2
    Y7 WITH WIDTH < 1.1092
    Y7 WITH WIDTH > 1.1236
}

SR.S.4 {@ Rule SR.S.4: Metal Space in die seal ring (space between inner and outer metal ring): 3.000
    EXT M1_CRACK M1_MGS < 3.000 ABUT <90 SINGULAR
    EXT M2_CRACK M2_MGS < 3.000 ABUT <90 SINGULAR
    EXT M3_CRACK M3_MGS < 3.000 ABUT <90 SINGULAR
    EXT M4_CRACK M4_MGS < 3.000 ABUT <90 SINGULAR
    EXT M5_CRACK M5_MGS < 3.000 ABUT <90 SINGULAR
    EXT M6_CRACK M6_MGS < 3.000 ABUT <90 SINGULAR
    EXT M7_CRACK M7_MGS < 3.000 ABUT <90 SINGULAR
}

SR.S.2 {@ Rule SR.S.2: VIAx Space in die seal ring (space between continuous VIAx rings in inner metal ring): 1.270
    X1 = M2_MGS NOT VIA1_SR
    Y1 = X1 TOUCH  VIA1_SR == 2
    Y1 WITH WIDTH < 1.2592
    Y1 WITH WIDTH > 1.2736
    X2 = M3_MGS NOT VIA2_SR
    Y2 = X2 TOUCH  VIA2_SR == 2
    Y2 WITH WIDTH < 1.2592
    Y2 WITH WIDTH > 1.2736
    X3 = M4_MGS NOT VIA3_SR
    Y3 = X3 TOUCH  VIA3_SR == 2
    Y3 WITH WIDTH < 1.2592
    Y3 WITH WIDTH > 1.2736
    X4 = M5_MGS NOT VIA4_SR
    Y4 = X4 TOUCH  VIA4_SR == 2
    Y4 WITH WIDTH < 1.2592
    Y4 WITH WIDTH > 1.2736
}

SR.S.3 {@ Rule SR.S.3: CO Space in die seal ring (space between continuous CO rings in inner metal ring): 1.280
    X = M1_MGS NOT CO_SR
    Y = X TOUCH CO_SR == 2
    Y WITH WIDTH < 1.2692
    Y WITH WIDTH > 1.2836
}

SR.EN.1 {@ Rule SR.EN.1: Metal Enclosure of VIAn (continuous ring): 0.360
    ENC VIA5_SR M5_SEALRING < 0.3564 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA6_SR M6_SEALRING < 0.3564 ABUT <90 SINGULAR OUTSIDE ALSO
}

SR.EN.2 {@ Rule SR.EN.2: Metal Enclosure of VIAx (continuous ring): 0.435
    ENC VIA1_SR M1_SEALRING < 0.435 ABUT <90 ANGLED ==0 REGION SINGULAR OUTSIDE ALSO
    ENC VIA2_SR M2_SEALRING < 0.435 ABUT <90 ANGLED ==0 REGION SINGULAR OUTSIDE ALSO
    ENC VIA3_SR M3_SEALRING < 0.435 ABUT <90 ANGLED ==0 REGION SINGULAR OUTSIDE ALSO
    ENC VIA4_SR M4_SEALRING < 0.435 ABUT <90 ANGLED ==0 REGION SINGULAR OUTSIDE ALSO

    ENC VIA1_SR M1_SEALRING < 0.4313 ABUT <90 SINGULAR ANGLED ==2 REGION OUTSIDE ALSO
    ENC VIA2_SR M2_SEALRING < 0.4313 ABUT <90 SINGULAR ANGLED ==2 REGION OUTSIDE ALSO
    ENC VIA3_SR M3_SEALRING < 0.4313 ABUT <90 SINGULAR ANGLED ==2 REGION OUTSIDE ALSO
    ENC VIA4_SR M4_SEALRING < 0.4313 ABUT <90 SINGULAR ANGLED ==2 REGION OUTSIDE ALSO
}

SR.EN.3 {@ Rule SR.EN.3: M1 Enclosure of CO (continuous ring): 0.440
    ENC CO_SR M5i < 0.4364 ABUT <90 SINGULAR OUTSIDE ALSO
}

SR.L.1 {@ Rule SR.L.1: Die seal ring corner exclusion length (only sealring, corner-L and stress relief pattern are allowed inside the zone defined by MKR;sealring): 70.00
    A = ANGLE SEALRING_TC == 45
    B = EXPAND EDGE  A INSIDE BY 55 EXTEND BY 18.4
    C = B AND ((HOLES SEALRING_TC) OR SEALRING_TC)
    D = ANGLE C !=45
    LENGTH D < 70.00
}

SR.L.2 {@ Rule SR.L.2: Die seal ring metal corner length (corner-L placed in triangle outside the sealring metal): 30.00
    A = ANGLE M7_SEALRING == 45
    B = COINCIDENT EDGE A (RNGX_M_2_SR OR (HOLES RNGX_M_2_SR)) 
    C = EXPAND EDGE B OUTSIDE BY 24 EXTEND BY 4  
        D = ANGLE (C AND SEALRING_TC)!=45
    LENGTH D < 30.00
}

GROUP SR SR.?
#ENDIF
//------------------------------------------------------------------------------
//     Derived Layers for SEALRING and Fuse Protection Ring
//------------------------------------------------------------------------------
// Accuracy for SR angles
VARIABLE    Accuracy  0.0036    
RELIEF_PATTERN_MZ = INSIDE (PP AND ((ENCLOSE (HOLES (DONUT OD >1)INNER) POLY == 1) OR (DONUT OD >1))) SEALRING_TC_MZ  //relief patterns, only for std sealring

OD_STRESS_MZ = ODi INSIDE RELIEF_PATTERN_MZ
M1_STRESS_MZ = M1i INSIDE RELIEF_PATTERN_MZ

M2_STRESS_MZ = M2i INSIDE RELIEF_PATTERN_MZ
M3_STRESS_MZ = M3i INSIDE RELIEF_PATTERN_MZ
M4_STRESS_MZ = M4i INSIDE RELIEF_PATTERN_MZ
M5_STRESS_MZ = M5i INSIDE RELIEF_PATTERN_MZ
M6_STRESS_MZ = M6i INSIDE RELIEF_PATTERN_MZ
M7_STRESS_MZ = M7i INSIDE RELIEF_PATTERN_MZ

CO_STRESS_MZ = COi INSIDE RELIEF_PATTERN_MZ

VIA1_STRESS_MZ = VIA1i INSIDE RELIEF_PATTERN_MZ
VIA2_STRESS_MZ = VIA2i INSIDE RELIEF_PATTERN_MZ
VIA3_STRESS_MZ = VIA3i INSIDE RELIEF_PATTERN_MZ
VIA4_STRESS_MZ = VIA4i INSIDE RELIEF_PATTERN_MZ
VIA5_STRESS_MZ = VIA5i INSIDE RELIEF_PATTERN_MZ
VIA6_STRESS_MZ = VIA6i INSIDE RELIEF_PATTERN_MZ
CB_via_SEALRING_MZ = CB_via AND SEALRING_TC_MZ
SEALRING_TC_MZ = SEALRING_TC INTERACT M7i
CB_SEALRING_MZ = CB AND SEALRING_TC_MZ
NITRIDE_SEALRING_MZ = NITRIDE_dg AND SEALRING_TC_MZ
CB_Not_SEALRING = CBi NOT SEALRING_TC
AP_SEALRING_MZ = ALUCAP AND SEALRING_TC_MZ
OD_SEALRING_MZ = (ODi NOT OD_STRESS_MZ) AND SEALRING_TC_MZ
M1_SEALRING_MZ = (M1i NOT M1_STRESS_MZ) AND SEALRING_TC_MZ

M2_SEALRING_MZ = (M2i NOT M2_STRESS_MZ) AND SEALRING_TC_MZ
M3_SEALRING_MZ = (M3i NOT M3_STRESS_MZ) AND SEALRING_TC_MZ
M4_SEALRING_MZ = (M4i NOT M4_STRESS_MZ) AND SEALRING_TC_MZ
M5_SEALRING_MZ = (M5i NOT M5_STRESS_MZ) AND SEALRING_TC_MZ
M6_SEALRING_MZ = (M6i NOT M6_STRESS_MZ) AND SEALRING_TC_MZ
M7_SEALRING_MZ = (M7i NOT M7_STRESS_MZ) AND SEALRING_TC_MZ

CO_SR_MZ = (COi NOT CO_STRESS_MZ)  AND SEALRING_TC_MZ

VIA1_SR_MZ = (VIA1i NOT VIA1_STRESS_MZ) AND SEALRING_TC_MZ
VIA2_SR_MZ = (VIA2i NOT VIA2_STRESS_MZ) AND SEALRING_TC_MZ
VIA3_SR_MZ = (VIA3i NOT VIA3_STRESS_MZ) AND SEALRING_TC_MZ
VIA4_SR_MZ = (VIA4i NOT VIA4_STRESS_MZ) AND SEALRING_TC_MZ
VIA5_SR_MZ = (VIA5i NOT VIA5_STRESS_MZ) AND SEALRING_TC_MZ
VIA6_SR_MZ = (VIA6i NOT VIA6_STRESS_MZ) AND SEALRING_TC_MZ

OD_CRACK_MZ = OD_SEALRING_MZ INTERACT CO_SR_MZ == 1
M1_CRACK_MZ = M1_SEALRING_MZ INTERACT VIA1i == 1

M2_CRACK_MZ = M2_SEALRING_MZ INTERACT VIA1i == 1
M3_CRACK_MZ = M3_SEALRING_MZ INTERACT VIA2i == 1
M4_CRACK_MZ = M4_SEALRING_MZ INTERACT VIA3i == 1
M5_CRACK_MZ = M5_SEALRING_MZ INTERACT VIA4i == 1
M6_CRACK_MZ = M6_SEALRING_MZ INTERACT VIA5i == 1


M7_CRACK_MZ = M7_SEALRING_MZ INTERACT VIA6i == 1


OD_MGS_MZ = OD_SEALRING_MZ INTERACT CO_SR_MZ == 2
M1_MGS_MZ = M1_SEALRING_MZ INTERACT VIA1i == 2

M2_MGS_MZ = M2_SEALRING_MZ INTERACT VIA1i == 2
M3_MGS_MZ = M3_SEALRING_MZ INTERACT VIA2i == 2
M4_MGS_MZ = M4_SEALRING_MZ INTERACT VIA3i == 2
M5_MGS_MZ = M5_SEALRING_MZ INTERACT VIA4i == 2
M6_MGS_MZ = M6_SEALRING_MZ INTERACT VIA5i == 2
M7_MGS_MZ = M7_SEALRING_MZ INTERACT VIA6i == 2

RSR.R.2 {@ Rule RSR.R.2: The die seal ring must be a continuous ring around the entire chip consisting of 2 rings on all metals with 3 rings of CO and all vias (2 on inner, 1 on the outer metal). The outer metal ring is covered by CB;via, AP and NITRIDE. The die seal ring must be covered with MKR;sealring.
    @ This DRC error is flagging because the old-sealring structure is used here.
    @ Please replace it by generating back the latest sealring generator part of this DK so that DRC and sealring will be thus fully in-line.
    NOT DONUT CO_SR_MZ
    NOT DONUT VIA1_SR_MZ
    NOT DONUT VIA2_SR_MZ
    NOT DONUT VIA3_SR_MZ
    NOT DONUT VIA4_SR_MZ
    NOT DONUT VIA5_SR_MZ
    NOT DONUT VIA6_SR_MZ
    NOT DONUT SEALRING_TC_MZ
    SEALRING_TC_MZ INTERACT OD_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M1_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M2_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M3_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M4_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M5_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M6_SEALRING_MZ !=2
    SEALRING_TC_MZ INTERACT M7_SEALRING_MZ !=2
    CRACK_RING = M1i INTERACT CB_via_SEALRING_MZ
    CRACK_RING INTERACT CO_SR_MZ !=1
    CRACK_RING INTERACT VIA1_SR_MZ !=1
    CRACK_RING INTERACT VIA2_SR_MZ !=1
    CRACK_RING INTERACT VIA3_SR_MZ !=1
    CRACK_RING INTERACT VIA4_SR_MZ !=1
    CRACK_RING INTERACT VIA5_SR_MZ !=1
    CRACK_RING INTERACT VIA6_SR_MZ !=1
    MGS_RING = M1i NOT INTERACT CB_via_SEALRING_MZ
    MGS_RING INTERACT CO_SR_MZ !=2
    MGS_RING INTERACT VIA1_SR_MZ !=2
    MGS_RING INTERACT VIA2_SR_MZ !=2
    MGS_RING INTERACT VIA3_SR_MZ !=2
    MGS_RING INTERACT VIA4_SR_MZ !=2
    MGS_RING INTERACT VIA5_SR_MZ !=2
    MGS_RING INTERACT VIA6_SR_MZ !=2
}

RSR.R.3 {@ Rule RSR.R.3: NITRIDE is drawn line-on-line with CB;via
    A = NITRIDE_SEALRING_MZ AND CB_via_SEALRING_MZ
    (CB_via_SEALRING_MZ INTERACT NITRIDE_SEALRING_MZ) NOT A
    NITRIDE_SEALRING_MZ NOT A
}



RSR.W.4 {@ Rule RSR.W.4: VIAn Width in seal ring (min=max width of continuous VIAn rings): 0.280
    VIA5_SR_MZ WITH WIDTH < 0.280
    VIA5_SR_MZ WITH WIDTH > 0.280+2*Accuracy
    VIA6_SR_MZ WITH WIDTH < 0.280
    VIA6_SR_MZ WITH WIDTH > 0.280+2*Accuracy
}


RSR.W.5 {@ Rule RSR.W.5: VIAx Width in seal ring (min=max width of continuous VIAx rings): 0.130
    VIA1_SR_MZ WITH WIDTH < 0.130
    VIA1_SR_MZ WITH WIDTH > 0.130+2*Accuracy    
    VIA2_SR_MZ WITH WIDTH < 0.130
    VIA2_SR_MZ WITH WIDTH > 0.130+2*Accuracy    
    VIA3_SR_MZ WITH WIDTH < 0.130
    VIA3_SR_MZ WITH WIDTH > 0.130+2*Accuracy    
    VIA4_SR_MZ WITH WIDTH < 0.130
    VIA4_SR_MZ WITH WIDTH > 0.130+2*Accuracy    
}

RSR.W.6 {@ Rule RSR.W.6: CO Width in seal ring (min=max width of continuous CO rings): 0.120
    CO_SR_MZ WITH WIDTH < 0.120
    CO_SR_MZ WITH WIDTH > 0.120+2*Accuracy    
}

RSR.W.7 {@ Rule RSR.W.7: CB;via and NITRIDE Width in die seal ring (min=max width of continuous CB;via and NITRIDE rings, except at corners): 3.000
    (CB_via_SEALRING_MZ AND NITRIDE_SEALRING_MZ) WITH WIDTH < 3.000
    CORNERS_SR_CB = HOLES CB_via_SEALRING_MZ INNER <= 6000 
    CB_more_width = (CB_via_SEALRING_MZ AND NITRIDE_SEALRING_MZ) WITH WIDTH > 3.000+2*Accuracy
    CB_more_width NOT INTERACT CORNERS_SR_CB
    (CB_via_SEALRING_MZ AND NITRIDE_SEALRING_MZ) INTERACT CB_more_width !=8 
}

RSR.W.8 {@ Rule RSR.W.8: AP Width in die seal ring (min=max width of continuous AP rings, except at corners): 5.000
    AP_SEALRING_MZ WITH WIDTH < 5.000
    CORNERS_SR_AP = HOLES AP_SEALRING_MZ INNER <= 6000 
    AP_more_width = AP_SEALRING_MZ WITH WIDTH > 5.000+2*Accuracy
    AP_more_width NOT INTERACT CORNERS_SR_AP
    AP_SEALRING_MZ INTERACT AP_more_width !=8 
}

RSR.S.1 {@ Rule RSR.S.1: VIAn Space in die seal ring (space between continuous VIAn rings in inner metal ring): 1.120
    EXT VIA5_SR_MZ < 1.115 ABUT < 90 SINGULAR
    EXT VIA6_SR_MZ < 1.115 ABUT < 90 SINGULAR
}


RSR.S.2 {@ Rule RSR.S.2: VIAx Space in die seal ring (space between continuous VIAx rings in inner metal ring): 1.270
    EXT VIA1_SR_MZ < 1.265 ABUT < 90 SINGULAR
    EXT VIA2_SR_MZ < 1.265 ABUT < 90 SINGULAR
    EXT VIA3_SR_MZ < 1.265 ABUT < 90 SINGULAR
    EXT VIA4_SR_MZ < 1.265 ABUT < 90 SINGULAR
}

RSR.S.3 {@ Rule RSR.S.3: CO Space in die seal ring (space between continuous CO rings in inner metal ring): 1.280
    EXT CO_SR_MZ < 1.275 ABUT < 90 SINGULAR
}

RSR.S.4 {@ Rule RSR.S.4: Metal Space in die seal ring (space between inner and outer metal ring): 3.000
    EXT M1_CRACK_MZ M1_MGS_MZ < 3.000 ABUT < 90 SINGULAR
    EXT M2_CRACK_MZ M2_MGS_MZ < 3.000 ABUT < 90 SINGULAR
    EXT M3_CRACK_MZ M3_MGS_MZ < 3.000 ABUT < 90 SINGULAR
    EXT M4_CRACK_MZ M4_MGS_MZ < 3.000 ABUT < 90 SINGULAR
    EXT M5_CRACK_MZ M5_MGS_MZ < 3.000 ABUT < 90 SINGULAR
    EXT M6_CRACK_MZ M6_MGS_MZ < 3.000 ABUT < 90 SINGULAR
    EXT M7_CRACK_MZ M7_MGS_MZ < 3.000 ABUT < 90 SINGULAR
}

RSR.D.1 {@ Rule RSR.D.1: Distance of die seal ring Metal to any NW, DNW, unrelated PO, NP or any dummy (these shapes not allowed under MKR;sealring). Metal Space within MKR;sealring. Space of Metal inside MKR;sealring to other metal.: 3.000
    //space to unrelated metal:
    EXT (M1 NOT SEALRING_TC_MZ) M1_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (M2 NOT SEALRING_TC_MZ) M2_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (M3 NOT SEALRING_TC_MZ) M3_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (M4 NOT SEALRING_TC_MZ) M4_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (M5 NOT SEALRING_TC_MZ) M5_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (M6 NOT SEALRING_TC_MZ) M6_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (M7 NOT SEALRING_TC_MZ) M7_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    EXT (ALUCAP NOT SEALRING_TC_MZ) AP_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR
    //space to unrelated metal inside MKR,sealring : detected as not donut, as opposite to the ring.
    STRESS_RP = INSIDE (PP AND ((ENCLOSE (HOLES (DONUT OD >1)INNER) POLY == 1) OR (DONUT OD >1))) SEALRING_TC_MZ 

    OD_SEALRING_MZ NOT ((DONUT OD_SEALRING_MZ) OR STRESS_RP) 
    M1_SEALRING_MZ NOT ((DONUT M1_SEALRING_MZ) OR STRESS_RP)
    M2_SEALRING_MZ NOT ((DONUT M2_SEALRING_MZ) OR STRESS_RP)
    M3_SEALRING_MZ NOT ((DONUT M3_SEALRING_MZ) OR STRESS_RP)
    M4_SEALRING_MZ NOT ((DONUT M4_SEALRING_MZ) OR STRESS_RP)
    M5_SEALRING_MZ NOT ((DONUT M5_SEALRING_MZ) OR STRESS_RP)
    M6_SEALRING_MZ NOT ((DONUT M6_SEALRING_MZ) OR STRESS_RP)
    M7_SEALRING_MZ NOT ((DONUT M7_SEALRING_MZ) OR STRESS_RP)
    AP_SEALRING_MZ NOT ((DONUT AP_SEALRING_MZ) OR STRESS_RP)
    //Distance of seal ring metal to unrelated OD, PO:
    XOD = EXT OD M1_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    XOD NOT SEALRING_TC_MZ
    XPO = EXT POLY M1_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR OPPOSITE REGION
    XPO NOT SEALRING_TC_MZ    
    
    
    //distance of seal ring metal to any NW, DNW, NP:
    XNWEL = EXT NWEL M1_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XNWEL NOT SEALRING_TC_MZ
    XDNWEL = EXT DNW M1_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XDNWEL NOT SEALRING_TC_MZ
    XNP = EXT NP M1_SEALRING_MZ < 3.000 ABUT >0<90 SINGULAR OPPOSITE INSIDE ALSO REGION
    XNP NOT SEALRING_TC_MZ
    
    //NW, DNW, PO, NP not allowed under MKR, sealring
    NWEL AND SEALRING_TC_MZ
    DNW AND SEALRING_TC_MZ
    NP AND SEALRING_TC_MZ
}

RSR.D.2 {@ Rule RSR.D.2: CB;via Distance to metal of inner metal ring, except at corners: 2.000
    EXT M1_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
    EXT M2_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
    EXT M3_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
    EXT M4_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
    EXT M5_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
    EXT M6_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
    EXT M7_MGS_MZ CB < 2.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==0
}

RSR.D.3 {@ Rule RSR.D.3: CB;via Distance to metal of inner metal ring at corners: 1.000
    EXT M1_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
    EXT M2_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
    EXT M3_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
    EXT M4_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
    EXT M5_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
    EXT M6_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
    EXT M7_MGS_MZ CB < 1.000 ABUT >0<90 SINGULAR OPPOSITE REGION ANGLED ==2
}

RSR.EN.1 {@ Rule RSR.EN.1: Metal Enclosure of VIAn (continuous ring): 0.360
    ENC VIA5_SR_MZ M6_SEALRING_MZ < 0.355 ABUT < 90 SINGULAR OUTSIDE ALSO
    ENC VIA6_SR_MZ M7_SEALRING_MZ < 0.355 ABUT < 90 SINGULAR OUTSIDE ALSO
}


RSR.EN.2 {@ Rule RSR.EN.2: Metal Enclosure of VIAx (continuous ring): 0.435
    ENC VIA1_SR_MZ M2_SEALRING_MZ < 0.43 ABUT < 90 SINGULAR OUTSIDE ALSO
    ENC VIA2_SR_MZ M3_SEALRING_MZ < 0.43 ABUT < 90 SINGULAR OUTSIDE ALSO
    ENC VIA3_SR_MZ M4_SEALRING_MZ < 0.43 ABUT < 90 SINGULAR OUTSIDE ALSO
    ENC VIA4_SR_MZ M5_SEALRING_MZ < 0.43 ABUT < 90 SINGULAR OUTSIDE ALSO
}

RSR.EN.3 {@ Rule RSR.EN.3: M1 Enclosure of CO (continuous ring): 0.440
    ENC CO_SR_MZ M1i < 0.435 ABUT < 90 SINGULAR OUTSIDE ALSO
}


RSR.EN.4 {@ Rule RSR.EN.4: MKR;sealring Enclosure of CB;via: 1.000
    ENC CB_via_SEALRING_MZ SEALRING_TC_MZ < 1.000 ABUT < 90 SINGULAR OUTSIDE ALSO
}

RSR.EN.5 {@ Rule RSR.EN.5: AP enclosure of CB;via: 1.000
    ENC CB_via_SEALRING_MZ AP_SEALRING_MZ < 1.000 ABUT < 90 SINGULAR OUTSIDE ALSO
}

RSR.L.1 {@ Rule RSR.L.1: Die seal ring corner exclusion length (only sealring, corner-L and stress relief pattern are allowed inside the zone defined by MKR;sealring): 70.00
    A = ANGLE SEALRING_TC_MZ == 45
    B = EXPAND EDGE  A INSIDE BY 55 EXTEND BY 18.4
    C = B AND ((HOLES SEALRING_TC_MZ) OR SEALRING_TC_MZ)
    D = ANGLE C !=45
    LENGTH D < 70.00
}

GROUP RSR RSR.?


// //////////////////////////////////////////////////////////////////////////////
// /                            DRC  SECTION                                    /
// //////////////////////////////////////////////////////////////////////////////

GEN.MRC.1 {@ Rule GEN.MRC.1: Layers with purpose mask (dt 10) not to be drawn
    COPY ALL_MASK
}

GEN.MRC.3 {@ Rule GEN.MRC.1: Layers with purpose cd (dt 32) not to be drawn
    COPY FSIZE
}

GEN.MRC.2.1 {@ Rule GEN.MRC.2.1: Layers with purpose noprocessing (dt 31) must be covered by marker logo and marker sealring.
    (NOSIZE NOT SEALRING_TC) NOT LOGO
}
    
GEN.MRC.2.2 {@ Rule GEN.MRC.2.2: noprocessing shape distance to any drawing shape (noprocessing shape are not allowed under drawing shape): 3.000
    EXT ACTIVE_ng OD_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT DNW_ng DNW_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT NWEL_ng NWEL_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ADHVTN_ng ADHVTN_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ADHVTP_ng ADHVTP_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT OD2_33_ng OD2_33_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT OD2_25_ng OD2_25_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VTL_N_ng VTL_N_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VTL_P_ng VTL_P_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT NP_ng NP_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT PP_ng PP_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT RPOi_ng RPOi_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT PRESIST_0_ng PRESIST_0_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT POLY_ng POLY < 3.000 ABUT <90 SINGULAR INSIDE ALSO 
    EXT CONTACT_ng COi_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME1_ng M1_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VI1_ng VIA1i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME2_ng M2i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VI2_ng VIA2i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME3_ng M3i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VI3_ng VIA3i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME4_ng M4i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VI4_ng VIA4i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME5_ng M5i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VI5_ng VIA5i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME6_ng M6i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT VI6_ng VIA6i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ME7_ng M7i_dg < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT CB_ng CBi < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    (EXT ALUCAP_ng ALUCAP < 3.000 ABUT <90 SINGULAR INSIDE ALSO REGION ) NOT  SEALRING_TC_MZ
    EXT ELEC1_ng ELEC1_dm < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ELEC2_ng ELEC2_dm < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT BOTMIM_ng BOTMIM < 3.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT MKTOPMIM_ng MKTOPMIM < 3.000 ABUT <90 SINGULAR INSIDE ALSO    
}

GEN.MRC.4 {@ Rule GEN.MRC.4: Not supported layers: OD18, PSPO, CELLVT.
    (((OD2_18_drg OR OD2_18_msk) OR OD2_18_dm) OR OD2_18_ng) OR OD2_18_gdr
    COPY POLY_PSPO
    CELLVT_dm OR CELLVT_gdr
}

CAD.DM.1 {@ Rule CAD.DM1.1: CO_dm layer interacting with OD_drawing layer.
    CO_dm INTERACT OD_drg SINGULAR ALSO
}

CAD.DM.2 {@ Rule CAD.DM1.2: OD_dm layer interacting with CO_drawing layer.
    OD_dm INTERACT COi_dg SINGULAR ALSO
}

CAD.DM.3 {@ Rule CAD.DM1.1: PO_dm layer interacting with OD_drawing layer.
    POLYG_dm INTERACT OD_drg SINGULAR ALSO
}

CAD.DM.4 {@ Rule CAD.DM1.2: OD_dm layer interacting with PO_drawing layer.
    OD_dm INTERACT POLYG_drg SINGULAR ALSO
}

GROUP MRC ?.MRC.?
GROUP CAD ?CAD.?

// ---------------------------------------------------
// DENSITY CHECKS
// ---------------------------------------------------

//  ACTIVE
ODc = SD_drmi NOT OD2  // critical OD

OD.D.1 {@ Rule OD.D.1: Max space without OD or OD;dummy: 40.000
    ACTSIZED = SIZE XALLACT BY 20
    CHIP NOT ACTSIZED
}

OD.R.3 {@ Rule OD.R.3: Minimum OD + OD;dummy density over local 150um x 150um areas stepped in 75um increments: 0.2
    DENSITY XALLACT < 0.2 WINDOW 150/Win_dev STEP 75/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT OD.R.3.density
    DENSITY XALLACT < 1 WINDOW 150/Win_dev STEP 75/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_OD.R.3.density
}

OD.R.3.1 {@ Rule OD.R.3.1: Maximum OD + OD;dummy density over local 150um x 150um areas stepped in 75um increments. Rule applies if window contains any active OD (Source/Drain) that is not covered with OD2.: 0.8
    DENSITY XALLACT ODc > 0.8 WINDOW 150/Win_dev STEP 75/Step_dev [AREA(XALLACT)/(AREA()*!!AREA(ODc))] INSIDE OF LAYER CHIP BACKUP PRINT OD.R.3.1.density
}

OD.R.3.2 {@ Rule OD.R.3.2: Maximum OD + OD;dummy density over local 150um x 150um areas stepped in 75um increments within OD2. Rule applies if all active OD (Source/Drain) within the window is covered with OD2.: 0.9
    DENSITY XALLACT ODc > 0.9 WINDOW 150/Win_dev STEP 75/Step_dev [AREA(XALLACT)/(AREA()*!AREA(ODc))] INSIDE OF LAYER CHIP BACKUP PRINT OD.R.3.2.density
}

OD.R.2 {@ Rule OD.R.2: Minimum OD + OD;dummy density across full chip: 0.25
    DENSITY XALLACT < 0.25 INSIDE OF LAYER CHIP PRINT OD.R.2.density
}
    
OD.R.2.1 {@ Rule OD.R.2.1: Maximum OD + OD;dummy density across full chip: 0.75
    DENSITY XALLACT > 0.75 INSIDE OF LAYER CHIP PRINT OD.R.2.1.density
}
    
//  POLY    
PO.R.1 {@ Rule PO.R.1: Min PO density across full chip after dummies insertion: 0.14
    DENSITY POLY_DENS < 0.14 INSIDE OF LAYER CHIP PRINT PO.R.1.density
    DENSITY POLY_DENS < 1 INSIDE OF LAYER CHIP PRINT ONLY STAT_PO.R.1.density
}

PO.R.2 {@ Rule PO.R.2: Max PO density across full chip after dummies insertion: 0.5
    DENSITY POLY_DENS > 0.5 INSIDE OF LAYER CHIP PRINT PO.R.2.density
}


//  METAL1
INDDMYSIZE = SIZE INDDMY BY 7

M1.R.2 {@ Rule M1.R.2: M1 density over local 100 um x 100 um areas stepped in 50um increments . Dummy patterns (M1;dummy and M1;dummy_O) are required to keep density > 15%. Exclusions from minimum density check: M1 under MKR;inddmy.: 0.15
    EA_S = (SIZE INDDMYSIZE BY 100) AND CHIP  
    A = DENSITY M1_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M1_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER CHIP BACKUP PRINT M1.R.2.density 
    (A NOT INDDMYSIZE) NOT INSIDE EA_S    
    B = DENSITY M1_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M1_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER EA_S BACKUP PRINT M1.R.2.ea.density 
    (B NOT INDDMYSIZE) WITH WIDTH > 100/4
    DENSITY M1_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M1.R.2.density 
}

M1.R.2.1 {@ Rule M1.R.2.1: Maximum M1 density over local 100 um x 100 um areas stepped in 50um increments.:0.7
    DENSITY M1_DENS  > 0.7 WINDOW 100/Win_dev STEP 50/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M1.R.2.1.density 
}

M1.R.4 {@ Rule M1.R.4: M1 widths and spaces have to be chosen such that Maximum M1 density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value: 0.9
    DENSITY M1_DENS > 0.9 WINDOW 20/Win_dev STEP 10/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M1.R.4.density 
}

//  METAL2

M2.R.1 {@ Rule M2.R.1: Metal density over local 100 um x 100 um areas stepped in 50um increments. Dummy patterns (Mi;dummy and Mi;dummy_O) are required to keep density > 15%. Exclusions from minimum density check: Mx under MKR;inddmy.:0.15
    EA_S = (SIZE INDDMYSIZE BY 100) AND CHIP 
    A = DENSITY M2_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M2_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER CHIP BACKUP PRINT M2.R.1.density 
    (A NOT INDDMYSIZE) NOT INSIDE EA_S    
    B = DENSITY M2_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M2_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER EA_S BACKUP PRINT M2.R.1.ea.density 
    (B NOT INDDMYSIZE) WITH WIDTH > 100/4
    DENSITY M2_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M2.R.1.density
}

M2.R.1.1 {@ Rule M2.R.1.1: Maximum Metal density over local 100 um x 100 um areas stepped in 50um increments.: 0.7
    DENSITY M2_DENS  > 0.7 WINDOW 100/Win_dev STEP 50/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M2.R.1.1.density 
}

M2.R.4 {@ Rule M2.R.4: Mi widths and spaces have to be chosen such that Maximum Mi density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value: 0.9
    DENSITY M2_DENS > 0.9  WINDOW 20/Win_dev STEP 10/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M2.R.4.density 
}
//  METAL3

M3.R.1 {@ Rule M3.R.1: Metal density over local 100 um x 100 um areas stepped in 50um increments. Dummy patterns (Mi;dummy and Mi;dummy_O) are required to keep density > 15%. Exclusions from minimum density check: Mx under MKR;inddmy.:0.15
    EA_S = (SIZE INDDMYSIZE BY 100) AND CHIP 
    A = DENSITY M3_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M3_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER CHIP BACKUP PRINT M3.R.1.density 
    (A NOT INDDMYSIZE) NOT INSIDE EA_S    
    B = DENSITY M3_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M3_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER EA_S BACKUP PRINT M3.R.1.ea.density 
    (B NOT INDDMYSIZE) WITH WIDTH > 100/4
    DENSITY M3_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M3.R.1.density
}

M3.R.1.1 {@ Rule M3.R.1.1: Maximum Metal density over local 100 um x 100 um areas stepped in 50um increments.: 0.7
    DENSITY M3_DENS  > 0.7 WINDOW 100/Win_dev STEP 50/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M3.R.1.1.density 
}

M3.R.4 {@ Rule M3.R.4: Mi widths and spaces have to be chosen such that Maximum Mi density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value: 0.9
    DENSITY M3_DENS > 0.9  WINDOW 20/Win_dev STEP 10/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M3.R.4.density 
}
//  METAL4

M4.R.1 {@ Rule M4.R.1: Metal density over local 100 um x 100 um areas stepped in 50um increments. Dummy patterns (Mi;dummy and Mi;dummy_O) are required to keep density > 15%. Exclusions from minimum density check: Mx under MKR;inddmy.:0.15
    EA_S = (SIZE INDDMYSIZE BY 100) AND CHIP 
    A = DENSITY M4_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M4_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER CHIP BACKUP PRINT M4.R.1.density 
    (A NOT INDDMYSIZE) NOT INSIDE EA_S    
    B = DENSITY M4_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M4_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER EA_S BACKUP PRINT M4.R.1.ea.density 
    (B NOT INDDMYSIZE) WITH WIDTH > 100/4
    DENSITY M4_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M4.R.1.density
}

M4.R.1.1 {@ Rule M4.R.1.1: Maximum Metal density over local 100 um x 100 um areas stepped in 50um increments.: 0.7
    DENSITY M4_DENS  > 0.7 WINDOW 100/Win_dev STEP 50/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M4.R.1.1.density 
}

M4.R.4 {@ Rule M4.R.4: Mi widths and spaces have to be chosen such that Maximum Mi density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value: 0.9
    DENSITY M4_DENS > 0.9  WINDOW 20/Win_dev STEP 10/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M4.R.4.density 
}
//  METAL5

M5.R.1 {@ Rule M5.R.1: Metal density over local 100 um x 100 um areas stepped in 50um increments. Dummy patterns (Mi;dummy and Mi;dummy_O) are required to keep density > 15%. Exclusions from minimum density check: Mx under MKR;inddmy.:0.15
    EA_S = (SIZE INDDMYSIZE BY 100) AND CHIP 
    A = DENSITY M5_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M5_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER CHIP BACKUP PRINT M5.R.1.density 
    (A NOT INDDMYSIZE) NOT INSIDE EA_S    
    B = DENSITY M5_MIN_DENS INDDMYSIZE < 0.15 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M5_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER EA_S BACKUP PRINT M5.R.1.ea.density 
    (B NOT INDDMYSIZE) WITH WIDTH > 100/4
    DENSITY M5_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M5.R.1.density
}

M5.R.1.1 {@ Rule M5.R.1.1: Maximum Metal density over local 100 um x 100 um areas stepped in 50um increments.: 0.7
    DENSITY M5_DENS  > 0.7 WINDOW 100/Win_dev STEP 50/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M5.R.1.1.density 
}

M5.R.4 {@ Rule M5.R.4: Mi widths and spaces have to be chosen such that Maximum Mi density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value: 0.9
    DENSITY M5_DENS > 0.9  WINDOW 20/Win_dev STEP 10/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M5.R.4.density 
}

//  METAL6

// For thick metals (Mn) other than Mtop, no exclusion from maximum density check and the only exclusion from minimum density check is M6 under MKR;inddmy.
M6.R.1 {@ Rule M6.R.1: Metal density over local 100 um x 100 um areas stepped in 50 um increments. Dummy patterns (Mi;dummy and Mi;dummy_O) are required to keep density > 20%. Exclusions from minimum density check: Mtop under BOTMIM, Mn under MKR;inddmy.: 0.2
    EA_S = (SIZE INDDMYSIZE BY 100) AND CHIP 
    A = DENSITY M6_MIN_DENS INDDMYSIZE < 0.2 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M6_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER CHIP BACKUP PRINT M6.R.1.density 
    (A NOT INDDMYSIZE) NOT INSIDE EA_S    
    B = DENSITY M6_MIN_DENS INDDMYSIZE < 0.2 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M6_MIN_DENS)/(AREA()-AREA(INDDMYSIZE))] INSIDE OF LAYER EA_S BACKUP PRINT M6.R.1.ea.density 
    (B NOT INDDMYSIZE) WITH WIDTH > 100/4
    DENSITY M6_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M6.R.1.density
}

M6.R.1.1 {@ Rule M6.R.1.1: Maximum Metal density over local 100 um x 100 um areas stepped in 50um increments. Exclusions from maximum density check: Mtop under CB, CB;via or LMARK. : 0.8
    DENSITY M6_DENS > 0.8 WINDOW 100/Win_dev STEP 50/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M6.R.1.1.density 
}

M6.R.4 {@ Rule M6.R.4: Mi widths and spaces have to be chosen such that Maximum Mi density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value (Exclusions: Mtop under CB, CB;via or LMARK): 0.9
    DENSITY M6_DENS > 0.9 WINDOW 20/Win_dev STEP 10/Step_dev INSIDE OF LAYER CHIP BACKUP PRINT M6.R.4.density 
}

M6.W.2 {@ Rule M6.W.2: Maximum width (Exclusion: Mtop under CB, CB;via or LMARK): 12.00 
    (SIZE M6 BY 6 UNDEROVER TRUNCATE 6) AND M6
}

//  METAL7 : Mtop

BOT_OR_IND = BOTMIM OR INDDMYSIZE
M7.R.1 {@ Rule M7.R.1: Metal density over local 100 um x 100 um areas stepped in 50 um increments. Dummy patterns (Mi;dummy and Mi;dummy_O) are required to keep density > 20%. Exclusions from minimum density check: Mtop under BOTMIM, Mn under MKR;inddmy.: 0.2
    EA_S = (SIZE BOT_OR_IND BY 100) AND CHIP 
    A = DENSITY M7_MIN_DENS BOT_OR_IND < 0.2 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M7_MIN_DENS)/(AREA()-AREA(BOT_OR_IND))] INSIDE OF LAYER CHIP BACKUP PRINT M7.R.1.density 
    (A NOT BOT_OR_IND) NOT INSIDE EA_S    
    B = DENSITY M7_MIN_DENS BOT_OR_IND < 0.2 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) [AREA(M7_MIN_DENS)/(AREA()-AREA(BOT_OR_IND))] INSIDE OF LAYER EA_S BACKUP PRINT M7.R.1.ea.density 
    (B NOT BOT_OR_IND) WITH WIDTH > 100/4
    DENSITY M7_DENS < 1 WINDOW 100/(Win_edge*Win_dev) STEP 50/(Win_edge*Step_dev) INSIDE OF LAYER CHIP BACKUP PRINT ONLY STAT_M7.R.1.density
}

M7.R.1.1 {@ Rule M7.R.1.1: Maximum Metal density over local 100 um x 100 um areas stepped in 50um increments. Exclusions from maximum density check: Mtop under CB, CB;via or LMARK. : 0.8
    EA_S = (SIZE EA2 BY 100) AND CHIP 
    A = DENSITY M7_MAX_DENS EA2 > 0.8 WINDOW 100/Win_dev STEP 50/Step_dev [AREA(M7_MAX_DENS)/(AREA()-AREA(EA2))] INSIDE OF LAYER CHIP BACKUP PRINT M7.R.1.1.density 
    (A NOT EA2) NOT INSIDE EA_S    
    B = DENSITY M7_MAX_DENS EA2 > 0.8 WINDOW 100/Win_dev STEP 50/Step_dev [AREA(M7_MAX_DENS)/(AREA()-AREA(EA2))] INSIDE OF LAYER EA_S BACKUP PRINT M7.R.1.1.ea.density 
    (B NOT EA2) WITH WIDTH > 100/4
}

M7.R.4 {@ Rule M7.R.4: Mi widths and spaces have to be chosen such that Maximum Mi density over local 20 um x 20 um areas stepped in 10 um increments cannot exceed this value (Exclusions: Mtop under CB, CB;via or LMARK): 0.9
    EA_S = (SIZE EA2 BY 20) AND CHIP 
    A = DENSITY M7_MAX_DENS EA2 > 0.9 WINDOW 20/Win_dev STEP 10/Step_dev [AREA(M7_MAX_DENS)/(AREA()-AREA(EA2))] INSIDE OF LAYER CHIP BACKUP PRINT M7.R.4.density 
    (A NOT EA2) NOT INSIDE EA_S    
    B = DENSITY M7_MAX_DENS EA2 > 0.9 WINDOW 20/Win_dev STEP 10/Step_dev [AREA(M7_MAX_DENS)/(AREA()-AREA(EA2))] INSIDE OF LAYER EA_S BACKUP PRINT M7.R.4.ea.density 
    (B NOT EA2) WITH WIDTH > 20/4
}

M7.W.2 {@ Rule M7.W.2: Maximum width (Exclusion: Mtop under CB, CB;via or LMARK): 12.00 
    (SIZE (M7 NOT EA2) BY 6 UNDEROVER TRUNCATE 6) AND (M7 NOT EA2)
}

// ALUCAP

AP.R.2 {@ Rule AP.R.2: Minimum AP density after dummy insertion across full chip : 0.1
    DENSITY ALUCAP_DENS < 0.1 INSIDE OF LAYER CHIP PRINT AP.R.2.density
}

AP.R.2.1 {@ Rule AP.R.2.1: Maximum AP density across full chip: 0.6
    DENSITY ALUCAP_DENS > 0.6 INSIDE OF LAYER CHIP PRINT AP.R.2.1.density
}

GROUP DENSITY_CHECK OD.R.3 
OD.D.1
OD.R.3.1 
OD.R.3.2 
OD.R.2 
OD.R.2.1 
PO.R.1 
PO.R.2 
M1.R.2 
M1.R.2.1 
M1.R.4 
M2.R.1 
M2.R.1.1 
M2.R.4 
M3.R.1 
M3.R.1.1 
M3.R.4 
M4.R.1 
M4.R.1.1 
M4.R.4 
M5.R.1 
M5.R.1.1 
M5.R.4 
M6.R.1 
M6.R.1.1 
M6.R.4 
M7.R.1 
M7.R.1.1 
M7.R.4 
AP.R.2 
AP.R.2.1 
CTM.DEN.1
CTM.DEN.2
CTM.DEN.3

// //////////////////////////////////////////////////////////////////////////////
// /                            DUMMIES  SECTION                                /
// //////////////////////////////////////////////////////////////////////////////
HOLE_LMARK = HOLES (M7i AND LMARK)

// ------------------------------------------------------------------------------
//        ACTIVE/DUMMY  [CAD layer]
// ------------------------------------------------------------------------------


DOD.W.1 {@ Rule DOD.W.1: Minimum OD;dummy Width: 0.500
    INT (ACTIVE_dy NOT INTERACT LMARK) < 0.500 ABUT <90 SINGULAR REGION
}

DOD.W.2 {@ Rule DOD.W.2: Maximum OD;dummy Width: 5.000
    WITH WIDTH (ACTIVE_dy NOT INTERACT LMARK) > 5.000
}

DOD.S.1 {@ Rule DOD.S.1: Minimum OD;dummy Space: 0.400
    EXT ACTIVE_dy < 0.400 ABUT >0<90 SINGULAR
}
    
DOD.D.1 {@ Rule DOD.D.1: OD;dummy Distance to OD (not allowed to interact with OD): 0.600
    EXT ACTIVE_dy OD < 0.600 ABUT <90 SINGULAR INSIDE ALSO
}

DOD.D.2 {@ Rule DOD.D.2: OD;dummy Distance to PO (not allowed to interact with PO): 0.600
    EXT ACTIVE_dy POLY < 0.600 ABUT <90 SINGULAR INSIDE ALSO
}

DOD.D.3 {@ Rule DOD.D.3: OD;dummy Distance to NW/PW boundary (OD;dummy must not cross the NW/PW boundary): 0.600
    ACTIVE_dy CUT NWEL
    EXT ACTIVE_dy NWEL < 0.600 ABUT <90 SINGULAR
    ENC ACTIVE_dy NWEL < 0.600 ABUT <90 SINGULAR
}

DOD.D.5 {@ Rule DOD.D.5: OD;dummy Distance to MKR;sealring (OD;dummy not allowed in sealring): 0.000
    ACTIVE_dy AND SEALRING_TC
}
       
DOD.D.6 {@ Rule DOD.D.6: OD;dummy Distance to FW, POFUSE, and laser fuse alignment target (L-shape Mtop opening under LMARK) (OD;dummy not allowed under these shapes): 1.200 
    EXT ACTIVE_dy FW < 1.200 ABUT <90 SINGULAR INSIDE ALSO
    EXT ACTIVE_dy HOLE_LMARK < 1.200 ABUT <90 SINGULAR INSIDE ALSO 
    EXT ACTIVE_dy POFUSE < 1.200 ABUT <90 SINGULAR INSIDE ALSO
}
                                                         
DOD.D.7 {@ Rule DOD.D.7: OD;dummy Distance to PO;dummy (not allowed to interact with each other): 0.300
    EXT POLY_dy ACTIVE_dy < 0.300 ABUT <90 SINGULAR INSIDE ALSO
}
                                                 
GROUP DOD DOD.?

// ;------------------------------------------------------------------------------
// ;       POLY/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------
 
NWELFT = (NWEL INTERACT CB) OUTSIDE OD 
DPO.W.1 {@ Rule DPO.W.1: Minimum PO;dummy Width: 0.400
    INT (POLY_dy NOT NWELFT) < 0.400 ABUT <90 SINGULAR REGION
}

DPO.W.2 {@ Rule DPO.W.2: Maximum PO;dummy Width: 5.000
    WITH WIDTH (POLY_dy NOT NWELFT) > 5.000
}

DPO.S.1 {@ Rule DPO.S.1: Minimum PO;dummy Space: 0.300
    EXT (POLY_dy NOT NWELFT) < 0.300 ABUT >0<90 SINGULAR REGION
}

DPO.D.1 {@ Rule DPO.D.1: PO;dummy Distance to OD (not allowed to interact with OD): 0.200
    EXT POLY_dy OD < 0.200 ABUT <90 SINGULAR INSIDE ALSO
}
 
DPO.D.2 {@ Rule DPO.D.2: PO;dummy Distance to PO (not allowed to interact with PO): 0.500
    EXT POLY_dy POLY < 0.500 ABUT <90 SINGULAR INSIDE ALSO
}

DPO.D.5 {@ Rule DPO.D.5: PO;dummy Distance to MKR;sealring (PO;dummy not allowed in sealring): 0.000
    POLY_dy AND SEALRING_TC
}

DPO.D.6 {@ Rule DPO.D.6: PO;dummy Distance to FW, POFUSE, and laser fuse alignment target (L-shape Mtop opening under LMARK) (PO;dummy not allowed under these shapes): 1.200
    EXT POLY_dy FW < 1.200 ABUT <90 SINGULAR INSIDE ALSO
    EXT POLY_dy POFUSE < 1.200 ABUT <90 SINGULAR INSIDE ALSO
    EXT POLY_dy HOLE_LMARK < 1.200 ABUT <90 SINGULAR INSIDE ALSO 
}

GROUP DPO DPO.?

// ;------------------------------------------------------------------------------
// ;       METAL1/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM1.W.1 {@ Rule DM1.W.1: Minimum M1;dummy Width: 0.320
    INT ME1_dy < 0.320 ABUT >0<90 SINGULAR REGION
}
 
DM1.W.3 {@ Rule DM1.W.3: Maximum M1;dummy Width: 3.000
    WITH WIDTH ME1_dy > 3.000
}
 
DM1.S.1 {@ Rule DM1.S.1: Minimum M1;dummy Space: 0.400
    EXT ME1_dy < 0.400 ABUT >0<90 SINGULAR REGION
}

DM1.A.1 {@ Rule DM1.A.1: Minimum M1;dummy Area: 0.320
    AREA ME1_dy < 0.320
}

DM1.D.1 {@ Rule DM1.D.1: Minimum M1;dummy Distance to M1 (exclusion zone). Any dummy structure that exceeds length of 4.5, must use an exclusion zone >= 1.5. M1;dummy is not allowed to interact with the corresponding metal drawing layer M1: 0.600
    LME1_dy = LENGTH ME1_dy > 4.500
    ME1_dy_notwithL = ME1_dy NOT WITH EDGE LME1_dy  
    ME1_dy_withL = ME1_dy WITH EDGE LME1_dy
    EXT ME1_dy_notwithL M1i_dg_tO < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME1_dy_withL M1i_dg_tO < 1.500 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM1.D.3 {@ Rule DM1.D.3 Minimum M1;dummy Distance to FW, POFUSE, and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME1_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME1_dy POFUSE < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO 
    EXT ME1_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO 
}

DM1.D.4 {@ Rule DM1.D.4: Minimum M1;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME1_dy AND SEALRING_TC
}

DM1.R.2 {@ Rule DM1.R.2: M1;dummy must be rectangles or squares orthogonal to grid
    ME1_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM1 DM1.?

// ;------------------------------------------------------------------------------
// ;       METAL1/DUMMY_0  [CAD layer]
// ;------------------------------------------------------------------------------

DOM1.A.1 {@ Rule DOM1.A.1: Minimum M1;dummy_O Area: 0.070
    AREA ME1_tO < 0.070
}

DOM1.R.1 {@ Rule DOM1.R.1: M1;dummy_O are not allowed to interact with M1 or M1;dummy shapes
    ME1_tO INTERACT ((M1i OR M1_gdr) OR ME1_dy) SINGULAR ALSO
}

DOM1.R.2 {@ Rule DOM1.R.2: M1;dummy_O must be rectangle or square orthogonal to grid, with a maximum allowed length of 6.0 um and maximum width of 0.21 um
    NOT RECTANGLE ME1_tO <= 6.000 BY <= 0.210 ORTHOGONAL ONLY
}

GROUP DOM1 DOM1.?

// ;------------------------------------------------------------------------------
// ;       METAL2/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM2.W.1 {@ Rule DM2.W.1: Minimum Mx;dummy Width: 0.320
    INT ME2_dy < 0.320 ABUT >0<90 SINGULAR REGION
}
 
DM2.W.3 {@ Rule DM2.W.3: Maximum Mx;dummy Width: 3.000
    WITH WIDTH ME2_dy > 3.000
}
 
DM2.S.1 {@ Rule DM2.S.1: Minimum Mx;dummy Space: 0.400
    EXT ME2_dy < 0.400 ABUT >0<90 SINGULAR REGION
}

DM2.A.1 {@ Rule DM2.A.1: Minimum Mx;dummy Area: 0.320
    AREA ME2_dy < 0.320
}

DM2.D.1 {@ Rule DM2.D.1: Minimum Mx;dummy Distance to Mx (exclusion zone). Any dummy structure that exceeds length of 4.5, must use an exclusion zone >= 1.5. Mx;dummy is not allowed to interact with the corresponding metal drawing layer Mx: 0.600
    LME2_dy = LENGTH ME2_dy > 4.500
    ME2_dy_notwithL = ME2_dy NOT WITH EDGE LME2_dy  
    ME2_dy_withL = ME2_dy WITH EDGE LME2_dy
    EXT ME2_dy_notwithL M2i_dg_tO < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME2_dy_withL M2i_dg_tO < 1.500 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM2.D.3 {@ Rule DM2.D.3: Minimum Mx;dummy Distance to FW and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME2_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME2_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM2.D.4 {@ Rule DM2.D.4: Minimum Mx;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME2_dy AND SEALRING_TC
}

DM2.R.2 {@ Rule DM2.R.2: Mx;dummy must be rectangles or squares orthogonal to grid
    ME2_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM2 DM2.?

// ;------------------------------------------------------------------------------
// ;       METAL2/DUMMY_0  [CAD layer]
// ;------------------------------------------------------------------------------

DOM2.A.1 {@ Rule DOM2.A.1: Minimum Mx;dummy_O Area: 0.070
    AREA ME2_tO < 0.070
}

DOM2.R.1 {@ Rule DOM2.R.1: Mx;dummy_O are not allowed to interact with Mx or Mx;dummy shapes
    ME2_tO INTERACT ((M2i OR M2_gdr) OR ME2_dy) SINGULAR ALSO
}

DOM2.R.2 {@ Rule DOM2.R.2: Mx;dummy_O must be rectangle or square orthogonal to grid, with a maximum allowed length of 6.0 um and maximum width of 0.21 um
    NOT RECTANGLE ME2_tO <= 6.000 BY <= 0.210 ORTHOGONAL ONLY
}

GROUP DOM2 DOM2.?

// ;------------------------------------------------------------------------------
// ;       METAL3/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM3.W.1 {@ Rule DM3.W.1: Minimum Mx;dummy Width: 0.320
    INT ME3_dy < 0.320 ABUT >0<90 SINGULAR REGION
}
 
DM3.W.3 {@ Rule DM3.W.3: Maximum Mx;dummy Width: 3.000
    WITH WIDTH ME3_dy > 3.000
}
 
DM3.S.1 {@ Rule DM3.S.1: Minimum Mx;dummy Space: 0.400
    EXT ME3_dy < 0.400 ABUT >0<90 SINGULAR REGION
}

DM3.A.1 {@ Rule DM3.A.1: Minimum Mx;dummy Area: 0.320
    AREA ME3_dy < 0.320
}

DM3.D.1 {@ Rule DM3.D.1: Minimum Mx;dummy Distance to Mx (exclusion zone). Any dummy structure that exceeds length of 4.5, must use an exclusion zone >= 1.5. Mx;dummy is not allowed to interact with the corresponding metal drawing layer Mx: 0.600
    LME3_dy = LENGTH ME3_dy > 4.500
    ME3_dy_notwithL = ME3_dy NOT WITH EDGE LME3_dy  
    ME3_dy_withL = ME3_dy WITH EDGE LME3_dy
    EXT ME3_dy_notwithL M3i_dg_tO < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME3_dy_withL M3i_dg_tO < 1.500 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM3.D.3 {@ Rule DM3.D.3: Minimum Mx;dummy Distance to FW and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME3_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME3_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM3.D.4 {@ Rule DM3.D.4: Minimum Mx;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME3_dy AND SEALRING_TC
}

DM3.R.2 {@ Rule DM3.R.2: Mx;dummy must be rectangles or squares orthogonal to grid
    ME3_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM3 DM3.?

// ;------------------------------------------------------------------------------
// ;       METAL3/DUMMY_0  [CAD layer]
// ;------------------------------------------------------------------------------

DOM3.A.1 {@ Rule DOM3.A.1: Minimum Mx;dummy_O Area: 0.070
    AREA ME3_tO < 0.070
}

DOM3.R.1 {@ Rule DOM3.R.1: Mx;dummy_O are not allowed to interact with Mx or Mx;dummy shapes
    ME3_tO INTERACT ((M3i OR M3_gdr) OR ME3_dy) SINGULAR ALSO
}

DOM3.R.2 {@ Rule DOM3.R.2: Mx;dummy_O must be rectangle or square orthogonal to grid, with a maximum allowed length of 6.0 um and maximum width of 0.21 um
    NOT RECTANGLE ME3_tO <= 6.000 BY <= 0.210 ORTHOGONAL ONLY
}

GROUP DOM3 DOM3.?

// ;------------------------------------------------------------------------------
// ;       METAL4/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM4.W.1 {@ Rule DM4.W.1: Minimum Mx;dummy Width: 0.320
    INT ME4_dy < 0.320 ABUT >0<90 SINGULAR REGION
}
 
DM4.W.3 {@ Rule DM4.W.3: Maximum Mx;dummy Width: 3.000
    WITH WIDTH ME4_dy > 3.000
}
 
DM4.S.1 {@ Rule DM4.S.1: Minimum Mx;dummy Space: 0.400
    EXT ME4_dy < 0.400 ABUT >0<90 SINGULAR REGION
}

DM4.A.1 {@ Rule DM4.A.1: Minimum Mx;dummy Area: 0.320
    AREA ME4_dy < 0.320
}

DM4.D.1 {@ Rule DM4.D.1: Minimum Mx;dummy Distance to Mx (exclusion zone). Any dummy structure that exceeds length of 4.5, must use an exclusion zone >= 1.5. Mx;dummy is not allowed to interact with the corresponding metal drawing layer Mx: 0.600
    LME4_dy = LENGTH ME4_dy > 4.500
    ME4_dy_notwithL = ME4_dy NOT WITH EDGE LME4_dy  
    ME4_dy_withL = ME4_dy WITH EDGE LME4_dy
    EXT ME4_dy_notwithL M4i_dg_tO < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME4_dy_withL M4i_dg_tO < 1.500 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM4.D.3 {@ Rule DM4.D.3: Minimum Mx;dummy Distance to FW and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME4_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME4_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM4.D.4 {@ Rule DM4.D.4: Minimum Mx;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME4_dy AND SEALRING_TC
}

DM4.R.2 {@ Rule DM4.R.2: Mx;dummy must be rectangles or squares orthogonal to grid
    ME4_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM4 DM4.?

// ;------------------------------------------------------------------------------
// ;       METAL4/DUMMY_0  [CAD layer]
// ;------------------------------------------------------------------------------

DOM4.A.1 {@ Rule DOM4.A.1: Minimum Mx;dummy_O Area: 0.070
    AREA ME4_tO < 0.070
}

DOM4.R.1 {@ Rule DOM4.R.1: Mx;dummy_O are not allowed to interact with Mx or Mx;dummy shapes
    ME4_tO INTERACT ((M4i OR M4_gdr) OR ME4_dy) SINGULAR ALSO
}

DOM4.R.2 {@ Rule DOM4.R.2: Mx;dummy_O must be rectangle or square orthogonal to grid, with a maximum allowed length of 6.0 um and maximum width of 0.21 um
    NOT RECTANGLE ME4_tO <= 6.000 BY <= 0.210 ORTHOGONAL ONLY
}

GROUP DOM4 DOM4.?

// ;------------------------------------------------------------------------------
// ;       METAL5/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM5.W.1 {@ Rule DM5.W.1: Minimum Mx;dummy Width: 0.320
    INT ME5_dy < 0.320 ABUT >0<90 SINGULAR REGION
}
 
DM5.W.3 {@ Rule DM5.W.3: Maximum Mx;dummy Width: 3.000
    WITH WIDTH ME5_dy > 3.000
}
 
DM5.S.1 {@ Rule DM5.S.1: Minimum Mx;dummy Space: 0.400
    EXT ME5_dy < 0.400 ABUT >0<90 SINGULAR REGION
}

DM5.A.1 {@ Rule DM5.A.1: Minimum Mx;dummy Area: 0.320
    AREA ME5_dy < 0.320
}

DM5.D.1 {@ Rule DM5.D.1: Minimum Mx;dummy Distance to Mx (exclusion zone). Any dummy structure that exceeds length of 4.5, must use an exclusion zone >= 1.5. Mx;dummy is not allowed to interact with the corresponding metal drawing layer Mx: 0.600
    LME5_dy = LENGTH ME5_dy > 4.500
    ME5_dy_notwithL = ME5_dy NOT WITH EDGE LME5_dy  
    ME5_dy_withL = ME5_dy WITH EDGE LME5_dy
    EXT ME5_dy_notwithL M5i_dg_tO < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME5_dy_withL M5i_dg_tO < 1.500 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM5.D.3 {@ Rule DM5.D.3: Minimum Mx;dummy Distance to FW and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME5_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME5_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM5.D.4 {@ Rule DM5.D.4: Minimum Mx;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME5_dy AND SEALRING_TC
}

DM5.R.2 {@ Rule DM5.R.2: Mx;dummy must be rectangles or squares orthogonal to grid
    ME5_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM5 DM5.?

// ;------------------------------------------------------------------------------
// ;       METAL5/DUMMY_0  [CAD layer]
// ;------------------------------------------------------------------------------

DOM5.A.1 {@ Rule DOM5.A.1: Minimum Mx;dummy_O Area: 0.070
    AREA ME5_tO < 0.070
}

DOM5.R.1 {@ Rule DOM5.R.1: Mx;dummy_O are not allowed to interact with Mx or Mx;dummy shapes
    ME5_tO INTERACT ((M5i OR M5_gdr) OR ME5_dy) SINGULAR ALSO
}

DOM5.R.2 {@ Rule DOM5.R.2: Mx;dummy_O must be rectangle or square orthogonal to grid, with a maximum allowed length of 6.0 um and maximum width of 0.21 um
    NOT RECTANGLE ME5_tO <= 6.000 BY <= 0.210 ORTHOGONAL ONLY
}

GROUP DOM5 DOM5.?

// ;------------------------------------------------------------------------------
// ;       METAL6/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM6.W.2 {@ Rule DM6.W.2: Minimum Mn;dummy Width: 0.600
    INT ME6_dy < 0.600 ABUT >0<90 SINGULAR REGION
}
 
DM6.W.3 {@ Rule DM6.W.3: Maximum Mn;dummy Width: 3.000
    WITH WIDTH ME6_dy > 3.000
}
 
DM6.S.2 {@ Rule DM6.S.2: Minimum Mn;dummy Space: 0.800
    EXT ME6_dy < 0.800 ABUT >0<90 SINGULAR REGION
}

DM6.A.2 {@ Rule DM6.A.2: Minimum Mn;dummy Area: 0.600
    AREA ME6_dy < 0.600
}

DM6.D.2 {@ Rule DM6.D.2: Minimum Mn;dummy Distance to Mn (exclusion zone). Mn;dummy is not allowed to interact with the corresponding metal drawing layer Mn: 0.600
    EXT ME6_dy M6i < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM6.D.3 {@ Rule DM6.D.3: Minimum Mn;dummy Distance to FW and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME6_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME6_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM6.D.4 {@ Rule DM6.D.4: Minimum Mn;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME6_dy AND SEALRING_TC
}

DM6.R.2 {@ Rule DM6.R.2: Mn;dummy must be rectangles or squares orthogonal to grid
    ME6_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM6 DM6.?

// ;------------------------------------------------------------------------------
// ;       METAL7/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

DM7.W.2 {@ Rule DM7.W.2: Minimum Mn;dummy Width: 0.600
    INT ME7_dy < 0.600 ABUT >0<90 SINGULAR REGION
}
 
DM7.W.3 {@ Rule DM7.W.3: Maximum Mn;dummy Width: 3.000
    WITH WIDTH ME7_dy > 3.000
}
 
DM7.S.2 {@ Rule DM7.S.2: Minimum Mn;dummy Space: 0.800
    EXT ME7_dy < 0.800 ABUT >0<90 SINGULAR REGION
}

DM7.A.2 {@ Rule DM7.A.2: Minimum Mn;dummy Area: 0.600
    AREA ME7_dy < 0.600
}

DM7.D.2 {@ Rule DM7.D.2: Minimum Mn;dummy Distance to Mn (exclusion zone). Mn;dummy is not allowed to interact with the corresponding metal drawing layer Mn: 0.600
    EXT ME7_dy M7i < 0.600 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM7.D.3 {@ Rule DM7.D.3: Minimum Mn;dummy Distance to FW and laser fuse alignment target (L-shape Mtop opening under LMARK). Dummies are not allowed to interact with these shapes.: 5.000
    EXT ME7_dy FW < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT ME7_dy HOLE_LMARK < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

DM7.D.4 {@ Rule DM7.D.4: Minimum Mn;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ME7_dy AND SEALRING_TC
}

DM7.R.2 {@ Rule DM7.R.2: Mn;dummy must be rectangles or squares orthogonal to grid
    ME7_dy NOT RECTANGLE ORTHOGONAL ONLY
}

GROUP DM7 DM7.?

// ;------------------------------------------------------------------------------ 
// ;       ALUCAP/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

DAP.W.1 {@ Rule DAP.W.1: AP;dummy Width: 2.500
    INT ALUCAP_dy < 2.500 ABUT >0<90 SINGULAR
} 
  
DAP.S.1 {@ Rule DAP.S.1: AP;dummy Space: 2.000
    EXT ALUCAP_dy < 2.000 ABUT >0<90 SINGULAR
}

DAP.D.1 {@ Rule DAP.D.1: AP;dummy Distance to AP. Dummies are not allowed to interact with these shapes.: 5.000
    EXT ALUCAP_dy ALUCAP < 5.000 ABUT <90 SINGULAR INSIDE ALSO
}

DAP.D.2 {@ Rule DAP.D.2: AP;dummy Distance to CB, CB;via, NITRIDE, NITRIDE;bump. Dummies are not allowed to interact with these shapes.: 5.000
    EXT ALUCAP_dy (((CBi OR CB_via) OR NITRIDE_dg) OR NIT_bp) < 5.000 ABUT <90 SINGULAR INSIDE ALSO
}

DAP.D.3 {@ Rule DAP.D.3: AP;dummy Distance to FW (laser fuse window), LMARK (laser fuse alignment key), MKR;inddmy, BOTMIM, and MKR;logo. Dummies are not allowed to interact with these shapes.: 5.000
    EXT ALUCAP_dy FW < 5.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ALUCAP_dy LMARK < 5.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ALUCAP_dy INDDMY < 5.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ALUCAP_dy LOGO < 5.000 ABUT <90 SINGULAR INSIDE ALSO
    EXT ALUCAP_dy BOTMIM < 5.000 ABUT <90 SINGULAR INSIDE ALSO
}

DAP.D.4 {@ Rule DAP.D.4: AP;dummy Distance to MKR;sealring (dummies not allowed in sealring): 0.000
    ALUCAP_dy AND SEALRING_TC 
}
    
GROUP DAP DAP.?

////do not delete. Used for modularity !!!

// ;------------------------------------------------------------------------------ 
// ;       TOPMIM/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

DCTM.MRC.1 {@ Rule DCTM.MRC.1: dummy topmim is not allowed on topmim. Distance to topmim: 3.5
    EXT MKTOPMIM_dy MKTOPMIM < 3.5 ABUT<90 SINGULAR INSIDE ALSO
}

// ;------------------------------------------------------------------------------ 
// ;       BOTMIM/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

DCBM.MRC.1 {@ Rule DCBM.MRC.1: dummy botmim is not allowed on botmim. Distance to botmim: 2.5
    EXT BOTMIM_dy BOTMIM < 2.5 ABUT<90 SINGULAR INSIDE ALSO
}
    
DCBM.W.1 {@ Rule DCBM.W.1: BOTMIM;dummy Width: 4.500
    INT BOTMIM_dy < 4.500 ABUT >0<90 SINGULAR
} 
  
DCBM.S.1 {@ Rule DCBM.S.1: BOTMIM;dummy Space: 2.500
    EXT BOTMIM_dy < 2.500 ABUT >0<90 SINGULAR
}

DCBM.R.2 {@ Rule DCBM.R.2: BOTMIM;dummy must not intersect Mtop (drawn metal) 
    BOTMIM_dy AND M7i
}
      
DCBM.MRC.2 {@ Rule DCBM.MRC.1: BOTMIM dummy exclusion distance to FW: 5.000
    BOTMIM_dy AND (SIZE CB_lr BY 5.000)
}
    
DCBM.MRC.3 {@ Rule DCBM.MRC.2: BOTMIM dummy exclusion distance to target (LMARK): 0.000
    BOTMIM_dy AND LMARK
}

DCBM.R.1 {@ Rule DCBM.R.1: BOTMIM;dummy must completely cover MKTOPMIM;dummy 
    MKTOPMIM_dy NOT BOTMIM_dy
}

GROUP DCBM DCBM.?

// //////////////////////////////////////////////////////////////////////////////
// /              General Data Requirements                                              /
// //////////////////////////////////////////////////////////////////////////////

GEN.1 {@ Rule GEN.1: Standard layout design grid is 0.005 micron for all the levels. Off-grid design data is not allowed.
// From substrat to PO:
    OFFGRID DNW_dg 5
    OFFGRID DNW_msk 5
    OFFGRID DNW_ng 5
    OFFGRID DNW_fg 5
    OFFGRID NWEL_dg 5
    OFFGRID NWEL_hd 5
    OFFGRID NWEL_msk 5
    OFFGRID NWEL_ng 5
    OFFGRID NW_gdr 5
    OFFGRID NT_N_dg 5
    OFFGRID NT_N_ng 5
    OFFGRID NT_N_msk 5
    OFFGRID OD_drg 5
    OFFGRID OD_hd 5
    OFFGRID OD_msk 5
    OFFGRID ACTIVE_dy 5
    OFFGRID ACTIVE_ng 5
    OFFGRID ACTIVE_fg 5
    OFFGRID OD2_33_drg 5
    OFFGRID OD2_33_msk 5
    OFFGRID OD2_33_ng 5
    OFFGRID OD2_33_gdr 5
    OFFGRID OD2_25_drg 5
    OFFGRID OD2_25_msk 5
    OFFGRID OD2_25_ng 5
    OFFGRID OD2_25_gdr 5
// From PO to CO:
    OFFGRID POLYG_drg 5
    OFFGRID POLYG_hd 5
    OFFGRID POLYG_msk 5
    OFFGRID POLY_dy 5
    OFFGRID POLY_ng 5
    OFFGRID POLY_fg 5
    OFFGRID PP_dg 5
    OFFGRID PP_hd 5
    OFFGRID PP_msk 5
    OFFGRID PP_ng 5
    OFFGRID PP_gdr 5
    OFFGRID NP_drg 5
    OFFGRID NP_hd 5
    OFFGRID NP_msk 5
    OFFGRID NP_ng 5
    OFFGRID NP_gdr 5
    OFFGRID RPOi_dg 5
    OFFGRID RPOi_msk 5
    OFFGRID RPOi_ng 5
    OFFGRID RPO_gdr 5
    OFFGRID ADHVTN_dg 5
    OFFGRID ADHVTN_hd 5
    OFFGRID ADHVTN_msk 5
    OFFGRID ADHVTN_ng 5
    OFFGRID VTH_N_gdr 5
    OFFGRID ADHVTP_dg 5
    OFFGRID ADHVTP_hd 5
    OFFGRID ADHVTP_msk 5
    OFFGRID ADHVTP_ng 5
    OFFGRID VTH_P_gdr 5
    OFFGRID VTL_N_dg 5
    OFFGRID VTL_N_hd 5
    OFFGRID VTL_N_msk 5
    OFFGRID VTL_N_ng 5
    OFFGRID VTL_N_gdr 5
    OFFGRID VTL_P_dg 5
    OFFGRID VTL_P_hd 5
    OFFGRID VTL_P_msk 5
    OFFGRID VTL_P_ng 5
    OFFGRID VTL_P_gdr 5
// From CO to Mtop:
    OFFGRID COi_dg 5
    OFFGRID CO_hd 5
    OFFGRID CONTACT_ng 5
    OFFGRID CONTACT_fg 5
    OFFGRID M1_drg 5
    OFFGRID M1_hd 5
    OFFGRID ME1_dy 5
    OFFGRID ME1_tO 5
    OFFGRID ME1_ng 5
    OFFGRID ME1_fg 5
    OFFGRID VIA1i_dg 5
    OFFGRID VIA1_hd 5
    OFFGRID VI1_ng 5
    OFFGRID VI1_fg 5
    OFFGRID M2i_dg 5
    OFFGRID M2_hd 5
    OFFGRID ME2_dy 5
    OFFGRID ME2_tO 5
    OFFGRID ME2_ng 5
    OFFGRID ME2_fg 5
    OFFGRID VIA2i_dg 5
    OFFGRID VIA2_hd 5
    OFFGRID VI2_ng 5
    OFFGRID VI2_fg 5
    OFFGRID M3i_dg 5
    OFFGRID M3_hd 5
    OFFGRID ME3_dy 5
    OFFGRID ME3_tO 5
    OFFGRID ME3_ng 5
    OFFGRID ME3_fg 5
    OFFGRID VIA3i_dg 5
    OFFGRID VIA3_hd 5
    OFFGRID VI3_ng 5
    OFFGRID VI3_fg 5
    OFFGRID M4i_dg 5
    OFFGRID M4_hd 5
    OFFGRID ME4_dy 5
    OFFGRID ME4_tO 5
    OFFGRID ME4_ng 5
    OFFGRID ME4_fg 5
    OFFGRID VIA4i_dg 5
    OFFGRID VIA4_hd 5
    OFFGRID VI4_ng 5
    OFFGRID VI4_fg 5
    OFFGRID M5i_dg 5
    OFFGRID M5_hd 5
    OFFGRID ME5_dy 5
    OFFGRID ME5_tO 5
    OFFGRID ME5_ng 5
    OFFGRID ME5_fg 5
    OFFGRID VIA5i_dg 5
    OFFGRID VIA5_hd 5
    OFFGRID VI5_ng 5
    OFFGRID VI5_fg 5
    OFFGRID M6i_dg 5
    OFFGRID M6_hd 5
    OFFGRID ME6_dy 5
    OFFGRID ME6_ng 5
    OFFGRID ME6_fg 5
    OFFGRID VIA6i_dg 5
    OFFGRID VIA6_hd 5
    OFFGRID VI6_ng 5
    OFFGRID VI6_fg 5
    OFFGRID M7i_dg 5
    OFFGRID M7_hd 5
    OFFGRID ME7_dy 5
    OFFGRID ME7_ng 5
    OFFGRID ME7_fg 5
// Add:
    OFFGRID BOTMIMi 5
    OFFGRID BOTMIM_dy 5
    OFFGRID BOTMIM_ng 5
    OFFGRID BOTMIM_gdr 5
    OFFGRID MKTOPMIMi 5
    OFFGRID MKTOPMIM_dy 5
    OFFGRID MKTOPMIM_ng 5
    OFFGRID MKTOPMIM_gdr 5
    OFFGRID ALUCAP 5
    OFFGRID ALUCAP_dy 5
    OFFGRID ALUCAP_ng 5
    OFFGRID AP_gdr 5
// Misc: 
    OFFGRID CBi 5
    OFFGRID CB_ng 5
    OFFGRID CB_gdr 5
    OFFGRID CB_via 5
    OFFGRID CB_lr 5
    OFFGRID FUSE_gdr 5
    OFFGRID DMSRMi 5
    OFFGRID NITRIDE_dg 5
    OFFGRID NITRIDE_gdr 5
    OFFGRID NIT_bp 5
    OFFGRID PRESIST_0_dg 5
    OFFGRID PRESIST_0_ng 5
    OFFGRID HRI_gdr 5
// DRAM: 
    OFFGRID CELLIMP_dm 5
    OFFGRID CELLIMP_gdr 5
    OFFGRID NP_dm 5
    OFFGRID OD_dm 5
    OFFGRID OD2_33_dm 5
    OFFGRID OD2_25_dm 5
    OFFGRID POLYG_dm 5
    OFFGRID CO_dm 5
    OFFGRID M1_dm 5
    OFFGRID LIL_dm 5
    OFFGRID LIL_gdr 5
    OFFGRID ELEC1_dm 5
    OFFGRID ELEC1_msk 5
    OFFGRID ELEC1_ng 5
    OFFGRID ELEC1_gdr 5
    OFFGRID ELEC2_dm 5
    OFFGRID ELEC2_msk 5
    OFFGRID ELEC2_ng 5
    OFFGRID ELEC2_gdr 5
    OFFGRID CTELEC2 5
    OFFGRID CTDRAM_gdr 5
// MKR used for CAD2MASK 
    OFFGRID LMARK 5
    OFFGRID LMARK_gdr 5
    OFFGRID BJTDMY 5
    OFFGRID POFUSE 5
    OFFGRID mkr_GP 5
    OFFGRID mkr_LP 5
    OFFGRID MKR_GATED 5
    OFFGRID RHDMY 5
// Historic layers 
    OFFGRID NWDMY 5
    OFFGRID RODMY 5
    OFFGRID RPDMY 5
    OFFGRID SRAMDP 5
    OFFGRID SRAMPG 5
    OFFGRID SRAMSP 5
// Mask layers 
    OFFGRID NW2V_gdr 5
    OFFGRID PW_bk 5
    OFFGRID PW_gdr 5
    OFFGRID PW2V_gdr 5
    OFFGRID VTNCELL_gdr 5
    OFFGRID N2V_mk 5
    OFFGRID N2V_gdr1 5
    OFFGRID N2V_gdr2 5
    OFFGRID P2V_gdr 5
    OFFGRID N1V_bk 5
    OFFGRID N1V_mk 5
    OFFGRID N1V_gdr 5
    OFFGRID P1V_gdr 5
    OFFGRID PP2V_gdr 5
}
    
GEN.2 {@ Rule GEN.2: Only vertical or horizontal geometries are allowed. Any angle different from 0 or 90 is forbidden except where 45 or other angles are explicitly allowed. Non-acute shapes with 45 angles are allowed for:- OD, PO, M1, Mx, Mn, CB, AP, NITRIDE- CB;via (unless when covered by NITRIDE;bump)- features in approved bitcells- features in the corners of the sealring (must be marked with MKR;sealring)Non-acute shapes with any angle are allowed for:- CB;via when covered by NITRIDE;bump, NITRIDE;bump- special features metal on datatype 31 for logo artwork (must be marked with MKR;logo).
// From substrat to PO:
    ANGLE DNW_dg >0<90
    ANGLE DNW_msk >0<90
    ANGLE DNW_ng >0<90
    ANGLE DNW_fg >0<90
    ANGLE NWEL_dg >0<90
    ANGLE NWEL_hd >0<90
    ANGLE NWEL_msk >0<90
    ANGLE NWEL_ng >0<90
    ANGLE NW_gdr >0<90
    ANGLE NT_N_dg >0<90
    ANGLE NT_N_ng >0<90
    ANGLE NT_N_msk >0<90
    ANGLE OD2_33_drg >0<90
    ANGLE OD2_33_msk >0<90
    ANGLE OD2_33_ng >0<90
    ANGLE OD2_33_gdr >0<90
    ANGLE OD2_25_drg >0<90
    ANGLE OD2_25_msk >0<90
    ANGLE OD2_25_ng >0<90
    ANGLE OD2_25_gdr >0<90
// From PO to CO:
    ANGLE (NP_drg NOT FILTER_GEN.2) >0<90
    ANGLE NP_hd >0<90
    ANGLE NP_msk >0<90
    ANGLE NP_ng >0<90
    ANGLE NP_gdr >0<90
    ANGLE (RPOi_dg NOT FILTER_GEN.2) >0<90
    ANGLE RPOi_msk >0<90
    ANGLE RPOi_ng >0<90
    ANGLE RPO_gdr >0<90
    ANGLE ADHVTN_dg >0<90
    ANGLE ADHVTN_hd >0<90
    ANGLE ADHVTN_msk >0<90
    ANGLE ADHVTN_ng >0<90
    ANGLE VTH_N_gdr >0<90
    ANGLE ADHVTP_dg >0<90
    ANGLE ADHVTP_hd >0<90
    ANGLE ADHVTP_msk >0<90
    ANGLE ADHVTP_ng >0<90
    ANGLE VTH_P_gdr >0<90
    ANGLE VTL_N_dg >0<90
    ANGLE VTL_N_hd >0<90
    ANGLE VTL_N_msk >0<90
    ANGLE VTL_N_ng >0<90
    ANGLE VTL_N_gdr >0<90
    ANGLE VTL_P_dg >0<90
    ANGLE VTL_P_hd >0<90
    ANGLE VTL_P_msk >0<90
    ANGLE VTL_P_ng >0<90
    ANGLE VTL_P_gdr >0<90
// Non-acute shapes with 45 angles are allowed for:
// 1/ Features in the corners of the sealring
// PP is allowed in SR at 45d
    OUTSIDE EDGE (ANGLE  (PP_dg NOT FILTER_GEN.2) >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_dg >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE PP_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_hd >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE PP_msk >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_msk >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_msk >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE PP_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_ng >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE PP_gdr >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_gdr >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE PP_gdr >45<90) SEALRING_TC
// vias are allowed in SR at 45d
    OUTSIDE EDGE (ANGLE COi_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE COi_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE COi_dg >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE CO_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE CO_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE CO_hd >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE CONTACT_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE CONTACT_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE CONTACT_ng >45<90) SEALRING_TC
    OUTSIDE EDGE (ANGLE CONTACT_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE CONTACT_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE CONTACT_fg >45<90) SEALRING_TC
    
    OUTSIDE EDGE (ANGLE VIA1i_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA1i_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA1i_dg >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VIA1_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA1_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA1_hd >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VI1_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI1_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI1_ng >45<90) SEALRING_TC        
    OUTSIDE EDGE (ANGLE VI1_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI1_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI1_fg >45<90) SEALRING_TC    
    
    OUTSIDE EDGE (ANGLE VIA2i_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA2i_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA2i_dg >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VIA2_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA2_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA2_hd >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VI2_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI2_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI2_ng >45<90) SEALRING_TC        
    OUTSIDE EDGE (ANGLE VI2_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI2_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI2_fg >45<90) SEALRING_TC    
    
    OUTSIDE EDGE (ANGLE VIA3i_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA3i_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA3i_dg >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VIA3_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA3_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA3_hd >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VI3_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI3_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI3_ng >45<90) SEALRING_TC        
    OUTSIDE EDGE (ANGLE VI3_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI3_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI3_fg >45<90) SEALRING_TC    
    
    OUTSIDE EDGE (ANGLE VIA4i_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA4i_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA4i_dg >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VIA4_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA4_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA4_hd >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VI4_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI4_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI4_ng >45<90) SEALRING_TC        
    OUTSIDE EDGE (ANGLE VI4_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI4_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI4_fg >45<90) SEALRING_TC    
    
    OUTSIDE EDGE (ANGLE VIA5i_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA5i_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA5i_dg >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VIA5_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA5_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA5_hd >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VI5_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI5_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI5_ng >45<90) SEALRING_TC        
    OUTSIDE EDGE (ANGLE VI5_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI5_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI5_fg >45<90) SEALRING_TC    
    
    OUTSIDE EDGE (ANGLE VIA6i_dg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA6i_dg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA6i_dg >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VIA6_hd >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA6_hd >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VIA6_hd >45<90) SEALRING_TC    
    OUTSIDE EDGE (ANGLE VI6_ng >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI6_ng >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI6_ng >45<90) SEALRING_TC        
    OUTSIDE EDGE (ANGLE VI6_fg >0<90) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI6_fg >0<45) SEALRING_TC
    NOT OUTSIDE EDGE (ANGLE VI6_fg >45<90) SEALRING_TC    
// 2/ OD, PO, AP, NITRIDE, CB, "CB;via NOT NITRIDE;bump", metals
 
    ANGLE OD_drg >0<45
    ANGLE OD_drg >45<90
 
    ANGLE OD_hd >0<45
    ANGLE OD_hd >45<90
 
    ANGLE OD_msk >0<45
    ANGLE OD_msk >45<90
 
    ANGLE ACTIVE_dy >0<45
    ANGLE ACTIVE_dy >45<90
 
    ANGLE ACTIVE_fg >0<45
    ANGLE ACTIVE_fg >45<90
 
    ANGLE POLYG_drg >0<45
    ANGLE POLYG_drg >45<90
 
    ANGLE POLYG_hd >0<45
    ANGLE POLYG_hd >45<90
 
    ANGLE POLYG_dm >0<45
    ANGLE POLYG_dm >45<90
 
    ANGLE POLYG_msk >0<45
    ANGLE POLYG_msk >45<90
 
    ANGLE POLY_dy >0<45
    ANGLE POLY_dy >45<90
 
    ANGLE POLY_fg >0<45
    ANGLE POLY_fg >45<90
 
    ANGLE ALUCAP >0<45
    ANGLE ALUCAP >45<90
 
    ANGLE ALUCAP_dy >0<45
    ANGLE ALUCAP_dy >45<90
 
    ANGLE ALUCAP_ng >0<45
    ANGLE ALUCAP_ng >45<90
 
    ANGLE AP_gdr >0<45
    ANGLE AP_gdr >45<90
 
    ANGLE NITRIDE_dg >0<45
    ANGLE NITRIDE_dg >45<90
 
    ANGLE NITRIDE_gdr >0<45
    ANGLE NITRIDE_gdr >45<90
 
    ANGLE CBi >0<45
    ANGLE CBi >45<90
 
    ANGLE CB_ng >0<45
    ANGLE CB_ng >45<90
 
    ANGLE CB_gdr >0<45
    ANGLE CB_gdr >45<90

    ANGLE (CB_via NOT NIT_bp) >0<45
    ANGLE (CB_via NOT NIT_bp) >45<90
    ANGLE (ACTIVE_ng NOT LOGO) >0<45
    ANGLE (ACTIVE_ng NOT LOGO) >45<90
    ANGLE (POLY_ng NOT LOGO) >0<45
    ANGLE (POLY_ng NOT LOGO) >45<90

    ANGLE M1_drg >0<45
    ANGLE M1_drg >45<90
    ANGLE M1_hd  >0<45 
    ANGLE M1_hd  >45<90
    ANGLE M1_dm >0<45
    ANGLE M1_dm >45<90    
    ANGLE ME1_dy >0<45
    ANGLE ME1_dy >45<90
    ANGLE ME1_tO >0<45    
    ANGLE ME1_tO >45<90
    ANGLE (ME1_ng NOT LOGO) >0<45
    ANGLE (ME1_ng NOT LOGO) >45<90
    ANGLE ME1_fg >0<45
    ANGLE ME1_fg >45<90
    
    ANGLE M2i_dg >0<45
    ANGLE M2i_dg >45<90
    ANGLE M2_hd  >0<45
    ANGLE M2_hd  >45<90
    ANGLE ME2_dy >0<45
    ANGLE ME2_dy >45<90
    ANGLE ME2_tO >0<45    
    ANGLE ME2_tO >45<90
    ANGLE (ME2_ng NOT LOGO) >0<45
    ANGLE (ME2_ng NOT LOGO) >45<90
    ANGLE ME2_fg >0<45
    ANGLE ME2_fg >45<90
    
    ANGLE M3i_dg >0<45
    ANGLE M3i_dg >45<90
    ANGLE M3_hd  >0<45
    ANGLE M3_hd  >45<90
    ANGLE ME3_dy >0<45
    ANGLE ME3_dy >45<90
    ANGLE ME3_tO >0<45    
    ANGLE ME3_tO >45<90
    ANGLE (ME3_ng NOT LOGO) >0<45
    ANGLE (ME3_ng NOT LOGO) >45<90
    ANGLE ME3_fg >0<45
    ANGLE ME3_fg >45<90
    
    ANGLE M4i_dg >0<45
    ANGLE M4i_dg >45<90
    ANGLE M4_hd  >0<45
    ANGLE M4_hd  >45<90
    ANGLE ME4_dy >0<45
    ANGLE ME4_dy >45<90
    ANGLE ME4_tO >0<45    
    ANGLE ME4_tO >45<90
    ANGLE (ME4_ng NOT LOGO) >0<45
    ANGLE (ME4_ng NOT LOGO) >45<90
    ANGLE ME4_fg >0<45
    ANGLE ME4_fg >45<90
    
    ANGLE M5i_dg >0<45
    ANGLE M5i_dg >45<90
    ANGLE M5_hd  >0<45
    ANGLE M5_hd  >45<90
    ANGLE ME5_dy >0<45
    ANGLE ME5_dy >45<90
    ANGLE ME5_tO >0<45    
    ANGLE ME5_tO >45<90
    ANGLE (ME5_ng NOT LOGO) >0<45
    ANGLE (ME5_ng NOT LOGO) >45<90
    ANGLE ME5_fg >0<45
    ANGLE ME5_fg >45<90
    
    ANGLE M6i_dg >0<45
    ANGLE M6i_dg >45<90
    ANGLE M6_hd  >0<45
    ANGLE M6_hd  >45<90
    ANGLE ME6_dy >0<45
    ANGLE ME6_dy >45<90
    ANGLE (ME6_ng NOT LOGO) >0<45
    ANGLE (ME6_ng NOT LOGO) >45<90
    ANGLE ME6_fg >0<45
    ANGLE ME6_fg >45<90
    
    ANGLE M7i_dg >0<45
    ANGLE M7i_dg >45<90
    ANGLE M7_hd  >0<45
    ANGLE M7_hd  >45<90
    ANGLE ME7_dy >0<45
    ANGLE ME7_dy >45<90
    ANGLE (ME7_ng NOT LOGO) >0<45
    ANGLE (ME7_ng NOT LOGO) >45<90
    ANGLE ME7_fg >0<45
    ANGLE ME7_fg >45<90
// Add:
    ANGLE BOTMIMi >0<90
    ANGLE BOTMIM_dy >0<90
    ANGLE BOTMIM_ng >0<90
    ANGLE BOTMIM_gdr >0<90
    ANGLE MKTOPMIMi >0<90
    ANGLE MKTOPMIM_dy >0<90
    ANGLE MKTOPMIM_ng >0<90
    ANGLE MKTOPMIM_gdr >0<90
// Misc: 
    ANGLE CB_lr >0<90
    ANGLE FUSE_gdr >0<90
    ANGLE DMSRMi >0<90
    ANGLE PRESIST_0_dg >0<90
    ANGLE PRESIST_0_ng >0<90
    ANGLE HRI_gdr >0<90
// DRAM: 
    ANGLE CELLIMP_dm >0<90
    ANGLE CELLIMP_gdr >0<90
    ANGLE NP_dm >0<90
    ANGLE OD_dm >0<90
    ANGLE OD2_33_dm >0<90
    ANGLE OD2_25_dm >0<90
    ANGLE CO_dm >0<90
    ANGLE M1_dm >0<90
    ANGLE LIL_dm >0<90
    ANGLE LIL_gdr >0<90
    ANGLE ELEC1_dm >0<90
    ANGLE ELEC1_msk >0<90
    ANGLE ELEC1_ng >0<90
    ANGLE ELEC1_gdr >0<90
    ANGLE ELEC2_dm >0<90
    ANGLE ELEC2_msk >0<90
    ANGLE ELEC2_ng >0<90
    ANGLE ELEC2_gdr >0<90
    ANGLE CTELEC2 >0<90
    ANGLE CTDRAM_gdr >0<90
// MKR used for CAD2MASK 
    ANGLE LMARK >0<90
    ANGLE LMARK_gdr >0<90
    ANGLE BJTDMY >0<90
    ANGLE POFUSE >0<90
    ANGLE mkr_GP >0<90
    ANGLE mkr_LP >0<90
    ANGLE MKR_GATED >0<90
    ANGLE RHDMY >0<90
// Historic layers 
    ANGLE NWDMY >0<90
    ANGLE RODMY >0<90
    ANGLE RPDMY >0<90
    ANGLE SRAMDP >0<90
    ANGLE SRAMPG >0<90
    ANGLE SRAMSP >0<90
// Mask layers 
    ANGLE NW2V_gdr >0<90
    ANGLE (PW_bk NOT FILTER_GEN.2) >0<90
    ANGLE PW_gdr >0<90
    ANGLE PW2V_gdr >0<90
    ANGLE VTNCELL_gdr >0<90
    ANGLE N2V_mk >0<90
    ANGLE N2V_gdr1 >0<90
    ANGLE N2V_gdr2 >0<90
    ANGLE P2V_gdr >0<90
    ANGLE N1V_bk >0<90
    ANGLE N1V_mk >0<90
    ANGLE N1V_gdr >0<90
    ANGLE P1V_gdr >0<90
    ANGLE PP2V_gdr >0<90
}

GEN.4 {@ Rule GEN.4: Minimum width and minimum space rules must be followed for any layer;datatype that results in a physical feature. Specifically, shapes with acute angles do not fulfill these requirements and are forbidden in any layer;datatype that results in a physical feature.
    INT NW_gdr < 0.620 ABUT <90
    EXT NW_gdr < 0.620 ABUT >0<90 SINGULAR
    INT OD_gdr < 0.110 ABUT <90
    EXT OD_gdr < 0.140 ABUT >0<90 SINGULAR
    INT OD2_33_gdr < 0.620 ABUT <90
    EXT OD2_33_gdr < 0.620 ABUT >0<90 SINGULAR
    INT OD2_25_gdr < 0.620 ABUT <90
    EXT OD2_25_gdr < 0.620 ABUT >0<90 SINGULAR
    INT PO_gdr < 0.100 ABUT <90
    EXT PO_gdr < 0.140 ABUT >0<90 SINGULAR
    INT PP_gdr < 0.240 ABUT <90
    EXT PP_gdr < 0.240 ABUT >0<90 SINGULAR
    INT NP_gdr < 0.240 ABUT <90
    EXT NP_gdr < 0.240 ABUT >0<90 SINGULAR
    INT RPO_gdr < 0.430 ABUT <90
    EXT RPO_gdr < 0.430 ABUT >0<90 SINGULAR
    INT VTL_N_gdr < 0.400 ABUT <90
    EXT VTL_N_gdr < 0.240 ABUT >0<90 SINGULAR
    INT VTL_P_gdr < 0.400 ABUT <90
    EXT VTL_P_gdr < 0.240 ABUT >0<90 SINGULAR
    INT VTH_N_gdr < 0.400 ABUT <90
    EXT VTH_N_gdr < 0.240 ABUT >0<90 SINGULAR
    INT VTH_P_gdr < 0.400 ABUT <90
    EXT VTH_P_gdr < 0.240 ABUT >0<90 SINGULAR
    INT HRI_gdr < 0.720 ABUT <90
    EXT HRI_gdr < 0.310 ABUT >0<90 SINGULAR
    INT FUSE_gdr < 0.800 ABUT <90
    EXT FUSE_gdr < 4.000 ABUT >0<90 SINGULAR
    INT NW2V_gdr < 0.620 ABUT <90
    EXT NW2V_gdr < 0.620 ABUT >0<90 SINGULAR
    INT PW_gdr < 0.620 ABUT <90
    EXT PW_gdr < 0.620 ABUT >0<90 SINGULAR
    INT VTNCELL_gdr < 0.240 ABUT <90
    EXT VTNCELL_gdr < 0.240 ABUT >0<90 SINGULAR
    INT N1V_gdr < 0.240 ABUT <90
    EXT N1V_gdr < 0.240 ABUT >0<90 SINGULAR
    INT N2V_gdr < 0.240 ABUT <90
    EXT N2V_gdr < 0.240 ABUT >0<90 SINGULAR
    INT PW2V_gdr < 0.620 ABUT <90
    EXT PW2V_gdr < 0.620 ABUT >0<90 SINGULAR
    INT P1V_gdr < 0.240 ABUT <90
    EXT P1V_gdr < 0.240 ABUT >0<90 SINGULAR
    INT P2V_gdr < 0.240 ABUT <90
    EXT P2V_gdr < 0.240 ABUT >0<90 SINGULAR
    INT PP2V_gdr < 0.240 ABUT <90
    EXT PP2V_gdr < 0.240 ABUT >0<90 SINGULAR
    INT NITRIDE_gdr < 2.000 ABUT <90
    EXT NITRIDE_gdr < 2.000 ABUT >0<90 SINGULAR
    INT CTDRAM_gdr < 0.120 ABUT <90
    EXT CTDRAM_gdr < 0.140 ABUT >0<90 SINGULAR
    INT LIL_gdr < 0.120 ABUT <90
    EXT LIL_gdr < 0.140 ABUT >0<90 SINGULAR
    INT ELEC1_gdr < 0.180 ABUT <90
    EXT ELEC1_gdr < 0.100 ABUT >0<90 SINGULAR
    INT ELEC2_gdr < 0.220 ABUT <90
    EXT ELEC2_gdr < 0.300 ABUT >0<90 SINGULAR
    INT CELLIMP_gdr < 0.400 ABUT <90
    EXT CELLIMP_gdr < 0.400 ABUT >0<90 SINGULAR

    INT CO_gdr < 0.400 ABUT <90
    EXT CO_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M1_gdr < 0.400 ABUT <90
    EXT M1_gdr < 0.400 ABUT >0<90 SINGULAR
    INT VIA1_gdr < 0.400 ABUT <90
    EXT VIA1_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M2_gdr < 0.400 ABUT <90
    EXT M2_gdr < 0.400 ABUT >0<90 SINGULAR
    INT VIA2_gdr < 0.400 ABUT <90
    EXT VIA2_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M3_gdr < 0.400 ABUT <90
    EXT M3_gdr < 0.400 ABUT >0<90 SINGULAR
    INT VIA3_gdr < 0.400 ABUT <90
    EXT VIA3_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M4_gdr < 0.400 ABUT <90
    EXT M4_gdr < 0.400 ABUT >0<90 SINGULAR
    INT VIA4_gdr < 0.400 ABUT <90
    EXT VIA4_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M5_gdr < 0.400 ABUT <90
    EXT M5_gdr < 0.400 ABUT >0<90 SINGULAR
    INT VIA5_gdr < 0.400 ABUT <90
    EXT VIA5_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M6_gdr < 0.400 ABUT <90
    EXT M6_gdr < 0.400 ABUT >0<90 SINGULAR
    INT VIA6_gdr < 0.400 ABUT <90
    EXT VIA6_gdr < 0.400 ABUT >0<90 SINGULAR
    INT M7_gdr < 0.400 ABUT <90
    EXT M7_gdr < 0.400 ABUT >0<90 SINGULAR

    INT LMARK_gdr < 6.000 ABUT <90    

    INT AP_gdr < 1.000 ABUT <90        // C_AP.W.1 (min=1) has a less restrictive value than AP.W.1 (min=3)
    EXT AP_gdr < 2.000 ABUT >0<90 SINGULAR
    
    INT NT_N_ng < 0.400 ABUT <90
    EXT NT_N_ng < 0.400 ABUT >0<90 SINGULAR
    INT NT_N_msk < 0.400 ABUT <90
    EXT NT_N_msk < 0.400 ABUT >0<90 SINGULAR
    
// Modification due to CORNER L:
    INT (DNW_gdr NOT CORL_SR) < 3.000 ABUT <90
    INT (DNW_gdr AND CORL_SR) < 1.500 ABUT <90    
    EXT DNW_gdr < 4.800 ABUT >0<90 SINGULAR

    INT (CB_gdr NOT CORL_SR) < 3.000 ABUT <90
    INT (CB_gdr AND CORL_SR) < 1.500 ABUT <90    
    EXT CB_gdr < 6.000 ABUT >0<90 SINGULAR

    INT (BOTMIM_gdr NOT CORL_SR) < 4.5 ABUT <90
    INT (BOTMIM_gdr AND CORL_SR) < 1.500 ABUT <90    
    EXT BOTMIM_gdr < 2.5 ABUT >0<90 SINGULAR

    INT (MKTOPMIM_gdr NOT CORL_SR) < 3.500 ABUT <90
    INT (MKTOPMIM_gdr AND CORL_SR) < 1.500 ABUT <90    
    EXT MKTOPMIM_gdr < 3.500 ABUT >0<90 SINGULAR

}

SIZE.MRC.1  {@ Rule SIZE.MRC.1: Chip size (Data extent of tape-out design block) must be multiple of 2um in x- and y-dimension.
    SEALRING_FULL = EXTENTS SEALRING_TC
    A = RECTANGLES 2 2 2 INSIDE OF LAYER SEALRING_FULL
    B = SIZE A BY 1 OVERUNDER                  
    C = XOR B SEALRING_FULL
    D = C WITH WIDTH != 2
    SEALRING_TC INTERACT D
}

GROUP GEN GEN.?

// //////////////////////////////////////////////////////////////////////////////
// /              CMOS  DESIGN  RULES                                           /
// //////////////////////////////////////////////////////////////////////////////
 
  //  -------------------------------------------------------------------------
//          e-Beam test-point    
  //  -------------------------------------------------------------------------

TP.R.1 {@ Rule TP.R.1: MKR;tp must cover CB opening of e-Beam test-point (a e-Beam test-point is a CB covered by MKR;tp that does not interact with NITRIDE) 
    ( (CBi INTERACT  MKR_TP) NOT INTERACT NITRIDE_dg ) NOT MKR_TP
}
  
  
//  -------------------------------------------------------------------------
//      OD  
//  -------------------------------------------------------------------------

OD.W.2 {@ Rule OD.W.2: Width of transistor : 0.120 
   R1 =     INT GATE_L < 0.120 ABUT >0<90 REGION
   M = FDRC INSIDE CELL '*FR_ODXWX2_*' '*FR_2X1Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

OD.W.1 {@ Rule OD.W.1: Width: 0.110 
   R1 =       INT OD < 0.110 ABUT <90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_ODXWX1_*' '*FR_2X2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }
    
OD.W.2.2 {@ Rule OD.W.2.2: Width of 3.3 V transistors: 0.400 
      INT (GATE_L INSIDE EDGE OD2_33_dg) < 0.400 ABUT >0<90
}
    
OD.W.2.1 {@ Rule OD.W.2.1: Width of 2.5 V transistors: 0.400 
      INT (GATE_L INSIDE EDGE OD2_25_dg) < 0.400 ABUT >0<90
}
        
OD.S.1 {@ Rule OD.S.1: Space: 0.140 
    EXT OD < 0.140 ABUT <90 SINGULAR 
}

OD.A.1 {@ Rule OD.A.1: Area: 0.060 
    AREA OD < 0.060
}
    
OD.A.2 {@ Rule OD.A.2: Enclosed area: 0.085
    HOLES OD < 0.085
}

OD.S.4 {@ Rule OD.S.4: Space (within OD2): 0.180 
    EXT ((OD NOT OD_dm) AND OD2) < 0.180 ABUT <90 SINGULAR REGION
}
    
OD.W.3 {@ Rule OD.W.3: Width of 45 OD lines: 0.180 
    INT OD < 0.180 ABUT <90 ANGLED REGION
}
  
OD.S.2 {@ Rule OD.S.2: Space of 45 OD lines: 0.180
    EXT OD < 0.180 ABUT <90 ANGLED 
}

ACTINCOR:1 = EXT OD < 0.005 ABUT ==90 INTERSECTING ONLY REGION
OD.S.3 {@ Rule OD.S.3: Space between 2 OD segments of U-shaped OD or OD enclosed area (notch): 0.200 
    A = CONVEX EDGE OD == 0 WITH LENGTH < 0.200
   R1 =     EXPAND EDGE A BY 0.005
   M = FDRC INSIDE CELL '*FR_ODXSX3_*' '*FR_2X14_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

OD.R.1 {@ Rule OD.R.1: OD must be fully covered by the {combination of NP + PP} (except N-Well resistor) 
       A = ((OD_dg NOT SRAM_EXCLUDE) NOT IMP) NOT FILTER_OD.R.1
       A NOT INTERACT NWDMY
}

OD.S.5 {@ Rule OD.S.5: Space between two OD with a parallel length >= 0.3um (L) if at least one of the corresponding OD regions has width > 0.23 um (W) and at least one of the OD is crossed by PO. Rule only applies for distances < 0.16um from the gate edge where the PO crosses the OD edge.: 0.160
    SZ_OD = (SIZE OD BY 0.115 UNDEROVER TRUNCATE 0.115) AND OD
    
    GATE_W23 = LENGTH GATE_W > 0.230
    GATE23 = GATE WITH EDGE GATE_W23
    OD_GATE23 = SZ_OD INTERACT GATE23
    
    X = EXPAND EDGE GATE_L INSIDE BY 0.005 EXTEND BY 0.160
    Y = (LENGTH X > 0.005) COIN INSIDE EDGE OD
    Z = EXT [Y] OD < 0.160 OPPOSITE
    E = OD TOUCH INSIDE EDGE Z
    T = EXT E OD < 0.160 OPPOSITE REGION PROJ >= 0.300
    T TOUCH OD_GATE23
}

OD.L.1 {@ Rule OD.L.1: Maximum length of OD connected to butted OD (strap) when width of this OD is < 0.15um: 0.500
      SD = DACT NOT GATE
      PSD = SD AND PP
    NSD = SD AND NP
    BUTTED_PSTRAP = PSD TOUCH NSTP
    BUTTED_NSTRAP = NSD TOUCH PSTP
    BUTTED_STRAP = BUTTED_PSTRAP OR BUTTED_NSTRAP
    Y = BUTTED_STRAP COINCIDENT EDGE OD
    Z = INT Y  < 0.150 PROJ > 0.500 REGION
    Z NOT INTERACT GATE
}

OD.L.2 {@ Rule OD.L.2: Maximum OD length between 2 CO as well as between 1 CO and the OD line end when the OD width is < 0.15um: 25.00
    LONG_OD_1 = AREA (OD NOT ME1_fringeC) > 2.75
     LONG_OD_2 = INT LONG_OD_1 < 0.150 OPPOSITE REGION
    LONG_OD = (OD NOT ME1_fringeC) INTERACT LONG_OD_2 
    ODCHECK = LONG_OD INTERACT CO
      CHECK_CO = CO INTERACT ODCHECK
      CO_A = SIZE CHECK_CO BY 12.5 INSIDE OF ODCHECK STEP 0.14
      OD_A = ODCHECK INTERACT CO_A == 1
      OD_B = ODCHECK INTERACT CO_A > 1
      CO_B = CO_A INTERACT OD_A
      CO_C = SIZE CO_B BY 12.5 INSIDE OF OD_A STEP 0.14
      BAD = (OD_A NOT CO_C) OR (OD_B NOT CO_A)
      BAD_EDGE = BAD COIN INSIDE EDGE OD
    ODCHECK WITH EDGE BAD_EDGE
}

OD.PIN.CAD.1 {@ Rule OD.PIN.CAD.1: OD purpose PIN without DRAWING
    OD_pin NOT ODi
}

GROUP OD OD.?

 
//  -------------------------------------------------------------------------
//      NWELL  
//  -------------------------------------------------------------------------

NW.W.1 {@ Rule NW.W.1: Width : 0.620 
   R1 =     (INT NWEL < 0.620 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
   M = FDRC INSIDE CELL '*FR_NWXWX1_*' '*FR_1X1Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NW.S.2 {@ Rule NW.S.2: Space of two NW1V at different potential : 1.000 
    EXT NW1V_NODAL < 1.000 ABUT <90 NOT CONNECTED SINGULAR REGION
} 

NW.S.1 {@ Rule NW.S.1: Space: 0.620 
    (EXT NWEL < 0.620 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

NW.S.3 {@ Rule NW.S.3: NW1V Space to NW2V (align if less): 1.200 
    EXT NW1V_NODAL NW2V_NODAL < 1.200 ABUT <90 NOT CONNECTED SINGULAR REGION
}

NW.S.4 {@ Rule NW.S.4: Space of two NW2V at different potential: 1.200
    EXT NW2V_NODAL < 1.200 ABUT <90 NOT CONNECTED SINGULAR REGION
}

NW.A.1 {@ Rule NW.A.1: Area : 1.550 
   R1 =     AREA NWEL < 1.550
   M = FDRC INSIDE CELL '*FR_NWXAX1_*' '*FR_1X10_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NW.A.2 {@ Rule NW.A.2: Enclosed area: 1.550 
    (HOLES NWEL < 1.550) NOT INSIDE SRAM_EXCLUDE
}

NPOD2 = NPOD AND OD2
PPOD2 = PPOD AND OD2

NW.EN.2 {@ Rule NW.EN.2: Enclosure of P+ OD : 0.220
    X = ENC PPOD NWEL < 0.220 ABUT <90 SINGULAR OVERLAP REGION 
   R1 =     X NOT INTERACT PW_bk
   M = FDRC INSIDE CELL '*FR_NWXENX2_*' '*FR_1X4Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NW.EN.3 {@ Rule NW.EN.3: Enclosure of P+ OD in OD2: 0.310
    ENC PPOD2 NWEL < 0.310 ABUT <90 REGION SINGULAR
}

NW.D.2 {@ Rule NW.D.2: Distance to N+ OD: 0.220
    X = EXT NPOD NONWR < 0.220 ABUT <90 SINGULAR OVERLAP REGION
   R1 =     X NOT INTERACT PW_bk
   M = FDRC INSIDE CELL '*FR_NWXDX2_*' '*FR_1X6Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NW.D.3 {@ Rule NW.D.3: Distance to N+ OD in OD2: 0.310
    EXT NPOD2 NWEL < 0.310 ABUT <90 SINGULAR REGION
}

NW.EN.1 {@ Rule NW.EN.1: Enclosure of NWELL strap : 0.170
    X = ENC NPOD NONWR < 0.170 ABUT <90 SINGULAR OVERLAP REGION
   R1 =     X NOT INTERACT PW_bk
   M = FDRC INSIDE CELL '*FR_NWXENX1_*' '*FR_NWXENX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NW.D.1 {@ Rule NW.D.1: Distance to PWELL strap: 0.170 
      X = EXT PPOD NWELi < 0.170 ABUT <90 OVERLAP SINGULAR REGION
   R1 =     X NOT INTERACT PW_bk
   M = FDRC INSIDE CELL '*FR_NWXDX1_*' '*FR_NWXDX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

GROUP NW NW.?

//  -------------------------------------------------------------------------
//     PW;blk Design Rules (P-Well block)
//  -------------------------------------------------------------------------

#IFDEF ALLIANCE
FILTER_PWB.R.1 = COPY EMPTY
FILTER_PWB.R.2 = COPY EMPTY
FILTER_RPO.R.2 = COPY EMPTY
FILTER_RPO.D.3 = COPY EMPTY
FILTER_NP.EX.2 = COPY EMPTY
FILTER_OD.R.1 = COPY EMPTY
FILTER_RPO.A.2 = COPY EMPTY
FILTER_PO.W.4 = COPY EMPTY
FILTER_PO.W.6 = COPY EMPTY
FILTER_GD.EX.1  = COPY EMPTY
FILTER_GD.R.1  = COPY EMPTY
FILTER_RPO.EX.5 = COPY EMPTY
FILTER_RPO.EX.4 = COPY EMPTY
FILTER_RPO.EX.3 = COPY EMPTY
FILTER_RPO.D.6 = COPY EMPTY
FILTER_GEN.2  = COPY EMPTY
FILTER_I.AP.W.1 = COPY EMPTY
#ENDIF

PWB.W.1 {@ Rule PWB.W.1: {NW or PW;blk} Width: 0.620
    INT NWPWBLK < 0.620 ABUT >0<90 SINGULAR
}

PWB.S.1 {@ Rule PWB.S.1: PW;blk Space to {NW or PW;blk}: 0.620
    EXT PW_bk (NWEL OR PW_bk) < 0.620 ABUT >0<90 SINGULAR REGION
}

PWB.A.1 {@ Rule PWB.A.1: PW;blk Area, except when abutted with NW: 1.550
       PW_abut_NW = PW_bk_ns TOUCH NWEL
       PW_nabut_NW = PW_bk_ns NOT PW_abut_NW
       AREA PW_nabut_NW < 1.550
}

PWB.A.2 {@ Rule PWB.A.2: {NW or PW;blk} Enclosed Area: 1.550
    HOLES (NWEL OR PW_bk_ns) < 1.550
}

PWB.R.1 {@ Rule PWB.R.1: PW;blk must not intersect NW
    (PW_bk_ns AND NWEL) NOT FILTER_PWB.R.1
}

GROUP PWB PWB.?

// -------------------------------------------------------------------------
//     Drift-MOS Transistor Design Rules
// -------------------------------------------------------------------------

// ODDrif is OD that is crossed by PW_bk
ODDrift = OD CUT PW_bk
ODDrift_PW_bk = ODDrift AND PW_bk
SourceNDrift = (PWEL AND ODDrift) NOT POLY
SourcePDrift = (NWEL AND ODDrift) NOT POLY

PW_bk_Hole_In = HOLES (PW_bk CUT OD) INNER        // the smaller PW_bk hole involved in drift
PW_bk_Ring = PW_bk TOUCH PW_bk_Hole_In            // its ring
PW_bk_DrPMOS = (EXTENTS PW_bk_Ring) ENCLOSE PWEL == 1    // its ring filled: DrPMOS
PW_bk_DrNMOS = (EXTENTS PW_bk_Ring) ENCLOSE NWEL == 1    // its ring filled: DrNMOS

DR.OL.1 {@ Rule DR.OL.1: Transistor Length: PW Overlap of NMOS-GATE, NW overlap of PMOS-GATE (NW boundary in Drift-MOS OD must be covered by PO): 0.500
    EXT SourceNDrift ODDrift_PW_bk < 0.500 ABUT <90 SINGULAR REGION
    EXT SourcePDrift ODDrift_PW_bk < 0.500 ABUT <90 SINGULAR REGION
}

DR.OL.2 {@ Rule DR.OL.2: NW Overlap of NMOS-GATE, PW Overlap of PMOS-GATE: 0.150
    INT GATE_Drift (PWEL NOT PW_bk) < 0.150 SINGULAR REGION PARALLEL ONLY
    INT GATE_Drift NWEL < 0.150 SINGULAR REGION PARALLEL ONLY
}

DR.EX.1 {@ Rule DR.EX.1: NW Extension on Drift-MOS OD : 0.220
    ENC ODDrift (NWEL AND PW_bk_DrNMOS) < 0.220 ABUT <90 SINGULAR REGION  // check done on drift-NMOS (A)
}

DR.D.1 {@ Rule DR.D.1: NW Distance to Drift-MOS OD: 0.220
    ENC ODDrift PW_bk_DrPMOS < 0.220 ABUT <90 SINGULAR REGION  // check done on drift-PMOS (B)
}

DR.R.1 {@ Rule DR.R.1: OD2 must cover all Drift-MOS OD
    ODDrift NOT OD2
}

DR.R.2 {@ Rule DR.R.2: No 90 corner of OD under PO
    EXPAND EDGE (CONVEX EDGE ((ODDrift AND POLY) NOT TOUCH INSIDE EDGE POLY) ANGLE1 == 90 ANGLE2 <180) INSIDE BY 0.001
}

GROUP DR DR.?

//------------------------------------------------------------------------------
// Gated Diodes
//------------------------------------------------------------------------------

GD.OL.1 {@ Rule GD.OL.1: NP Overlap of Gate of gated diode: 0.150
    INT GATE_GatedDiode NP < 0.150 ABUT <90 SINGULAR REGION
} 

GD.OL.2 {@ Rule GD.OL.2: PP Overlap of Gate of gated diode: 0.150
    INT GATE_GatedDiode PP < 0.150 ABUT <90 SINGULAR REGION
} 

GD.EX.1 {@ Rule GD.EX.1: NP Extension on Gate: 0.220
    X = NP NOT FILTER_GD.EX.1
    ENC GATE_GatedDiode X < 0.220 ABUT <90 OPPOSITE
    
} 

GD.EX.2 {@ Rule GD.EX.2: PP Extension on Gate: 0.220
    ENC GATE_GatedDiode PP < 0.220 ABUT <90 OPPOSITE
} 

GD.R.1 {@ Rule GD.R.1: MKR;GATED must be drawn line-on-line with Gate of gated diode 
    (GATE_GatedDiode NOT MKR_GATED) NOT FILTER_GD.R.1
    (MKR_GATED NOT GATE_GatedDiode) NOT FILTER_GD.R.1
} 

GD.R.2 {@ Rule GD.R.2: Gated diode not allowed outside OD2 (MKR;GATED outside OD2 not allowed) 
    MKR_GATED NOT OD2
} 

GROUP GD GD.?

//  -------------------------------------------------------------------------
//      NPLUS  /  NP  
//  -------------------------------------------------------------------------

NP.W.1 {@ Rule NP.W.1: Width: 0.240 
    (INT NP < 0.240 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

NP.S.1 {@ Rule NP.S.1: Space: 0.240 
    (EXT NP < 0.240 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

NP.D.1 {@ Rule NP.D.1: Distance to a P+ OD (not along PO) other than PW strap: 0.130 
   R1 =     EXT NP PACT < 0.130 ABUT >0<90 INSIDE ALSO SINGULAR REGION
    X = EXT NP [PACT] < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
   R2 =     Y NOT INTERACT NPOD
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_NPXDX1_*' '*FR_16X3_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

NP.D.2 {@ Rule NP.D.2: Distance (in PW) to a non butted PW strap: 0.020 
    EXT NP PSTP < 0.020 ABUT >0<90 INSIDE ALSO SINGULAR REGION
    X = EXT NP [PSTP] < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
    Y NOT INTERACT NPOD
}

NP.D.3 {@ Rule NP.D.3: Distance (including NW strap) to P+ Gate on OD: 0.320 
    EXT GATEP_W NSTP_PACT_BTE < 0.320 ABUT <90 OPPOSITE
}

NP.EN.2 {@ Rule NP.EN.2: Enclosure of Gate on OD: 0.320 
   R1 =     ENC GATEN_W NACT_PSTP_BTE < 0.320 ABUT <90 OPPOSITE REGION
   M = FDRC INSIDE CELL '*FR_NPXENX2_*' '*FR_NPXENX2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NP.OL.1 {@ Rule NP.OL.1: Overlap of N+ OD: 0.130 
   R1 =     INT OD NP < 0.130 ABUT >0<90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_NPXOLX1_*' '*FR_NPXOLX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NP.EX.1 {@ Rule NP.EX.1: Extension on OD (other than NW strap): 0.130 
    A = NACT NOT ODWR
   R1 =     ENC A NP < 0.130 ABUT >0<90 SINGULAR REGION
    X = ENC [A] NP < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
   R2 =     Y NOT INTERACT (OD NOT NPOD)
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_NPXEXX1_*' '*FR_16X8_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

NP.EX.2 {@ Rule NP.EX.2: Extension on OD (NW strap): 0.020 
    ENC NSTP NP < 0.020 ABUT >0<90 SINGULAR REGION
    X = ENC [NSTP] NP < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
    (Y NOT INTERACT PPOD) NOT FILTER_NP.EX.2 
}

NP.D.4 {@ Rule NP.D.4: Distance from a butted N+ OD to the related PO edge if butting P+ OD is extending < 0.22 in NW: 0.320
    A1 = EXPAND EDGE PACT_NSTP_BTE INSIDE by 0.005
    A2 = COIN EDGE OD A1
    W = TOUCH EDGE PACT A2
    A = LENGTH W < 0.220
    B = PACT WITH EDGE A
    C = NSTP TOUCH B
    Y = EXPAND EDGE (GATE_PP COINCIDENT EDGE B) OUTSIDE BY 0.220
    Z = Y COINCIDENT EDGE POLY
    (EXT Z C < 0.320 ABUT >0<90 OPPOSITE REGION) INTERACT ((EXPAND EDGE Z OUTSIDE BY 0.320) INTERACT (EXPAND EDGE (COIN EDGE NSTP PACT) BY 0.001))
}
    
NP.A.1 {@ Rule NP.A.1: Area: 0.122 
    AREA NP < 0.122
}

NP.A.2 {@ Rule NP.A.2: Enclosed area: 0.122 
    (HOLES NP < 0.122) NOT INSIDE SRAM_EXCLUDE
}

NP.EN.1 {@ Rule NP.EN.1: Enclosure of Gate (square corner) (except varactors): 0.220
   R1 =     EXGATE_NP NOT NP
   M = FDRC INSIDE CELL '*FR_NPXENX1_*' '*FR_16X13_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

NP.B.1 {@ Rule NP.B.1: Unremovable Width or Space of {NP .not. NW .and. OD2 .not. BarfromLDD} (NLDDGO2 mask): 0.240
    X = ((NP NOT NWEL) AND OD2) NOT BarfromLDD
    Y = SIZE (SIZE (SIZE X BY 0.115) BY -0.23) BY 0.115
    INT Y < 0.240 ABUT <90 SINGULAR REGION
    EXT Y < 0.240 ABUT <90 SINGULAR REGION
}
    
NP.B.2 {@ Rule NP.B.2: Unremovable Width or Space of {NP .not. NW .not. OD2 .not. BarfromLDD} (NLDD mask): 0.240
    X = ((NP NOT NWEL) NOT OD2) NOT BarfromLDD
    Y = SIZE (SIZE (SIZE X BY 0.115) BY -0.23) BY 0.115
    INT Y < 0.240 ABUT <90 SINGULAR REGION
    EXT Y < 0.240 ABUT <90 SINGULAR REGION
}

NP.A.3 {@ Rule NP.A.3: Area of N+ OD butted to a P+OD: 0.040 
    Y = NSTP WITH EDGE NSTP_PACT_BTE
    AREA Y < 0.040 
}

NP.D.5_PP.D.5 {@ Rule NP.D.5: Distance to OD for an NP edge forming a butted N+ OD/P+ OD (allowed for up to 0.13um distance from butted N+ OD/P+ OD): 0.000
                          @ Rule PP.D.5: Distance to OD for an PP edge forming a butted N+ OD/P+ OD (allowed for up to 0.13um distance from butted N+ OD/P+ OD): 0.000
     PP_EDGE = PP COIN EDGE OD
    NP_EDGE = NP COIN EDGE OD
   
    PSTP_GEOM = EXPAND EDGE PSTP_NACT_BTE OUTSIDE BY 0.001 INSIDE BY 0.001 EXTEND BY 0.130
    PSTP_GEOM_HALF = PSTP_GEOM AND IMP 
    BAD_PSTP_GEOM = PSTP_GEOM NOT PSTP_GEOM_HALF
    BAD_PSTP_GEOM COIN EDGE OD
    NSTP_GEOM = EXPAND EDGE NSTP_PACT_BTE OUTSIDE BY 0.001 INSIDE BY 0.001 EXTEND BY 0.130
    NSTP_GEOM_HALF = NSTP_GEOM AND IMP 
    BAD_NSTP_GEOM = NSTP_GEOM NOT NSTP_GEOM_HALF
    BAD_NSTP_GEOM COIN EDGE OD

    C = EXPAND EDGE PP_EDGE OUTSIDE BY 0.001 INSIDE BY 0.001
    D = EXPAND EDGE NP_EDGE OUTSIDE BY 0.001 INSIDE BY 0.001
    BAD_IMP = D OR C
    BAD_IMP NOT (PSTP_GEOM OR NSTP_GEOM)
}

GROUP NP NP.?


//  -------------------------------------------------------------------------
//      PPLUS  /  PP  
//  -------------------------------------------------------------------------

PP.W.1 {@ Rule PP.W.1: Width: 0.240 
    (INT PP < 0.240 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

PP.S.1 {@ Rule PP.S.1: Space: 0.240 
    (EXT PP < 0.240 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

PP.D.1 {@ Rule PP.D.1: Distance to N+ OD (not along PO) other than NW strap: 0.130 
   R1 =     EXT PP NACT < 0.130 ABUT >0<90 INSIDE ALSO SINGULAR REGION
    X = EXT PP [NACT] < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
   R2 =     Y NOT INTERACT PPOD
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_PPXDX1_*' '*FR_17X3_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

PP.D.2 {@ Rule PP.D.2: Distance (in NW) to non butted NW strap: 0.020 
    EXT PP NSTP < 0.020 ABUT >0<90 INSIDE ALSO SINGULAR REGION
    X = EXT PP [NSTP] < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
    Y NOT INTERACT PPOD
}

PP.D.3 {@ Rule PP.D.3: Distance (including PW strap) to N+ Gate on OD: 0.320 
   R1 =     EXT GATEN_W PSTP_NACT_BTE < 0.320 ABUT <90 OPPOSITE REGION
   M = FDRC INSIDE CELL '*FR_PPXDX3_*' '*FR_PPXDX3_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PP.EN.2 {@ Rule PP.EN.2: Enclosure of Gate on OD: 0.320 
    ENC GATEP_W PACT_NSTP_BTE < 0.320 ABUT <90 OPPOSITE
}

PP.OL.1 {@ Rule PP.OL.1: Overlap of P+ OD: 0.130 
   R1 =     INT OD PP < 0.130  ABUT >0<90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_PPXOLX1_*' '*FR_PPXOLX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PP.EX.1 {@ Rule PP.EX.1: Extension on OD (other than PW strap): 0.130 
   R1 =     ENC PACT PP < 0.130 ABUT >0<90 SINGULAR REGION
    X = ENC [PACT] PP < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
   R2 =     Y NOT INTERACT (OD NOT PPOD)
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_PPXEXX1_*' '*FR_17X8_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

PP.EX.2 {@ Rule PP.EX.2 Extension on OD (PW strap): 0.020 
    ENC PSTP PP < 0.020 ABUT >0<90 SINGULAR REGION
    X = ENC [PSTP] PP < 0.001 ABUT == 0
    Y = EXPAND EDGE X OUTSIDE BY 0.001
    Y NOT INTERACT NPOD
}

PP.D.4 {@ Rule PP.D.4: Distance from a butted P+ OD to the related PO edge if butting N+ OD is extending < 0.22 in PW: 0.320
    A1 = EXPAND EDGE NACT_PSTP_BTE INSIDE by 0.005
    A2 = COIN EDGE OD A1
    W = TOUCH EDGE NACT A2
    A = LENGTH W < 0.220
    B = NACT WITH EDGE A    
    C = PSTP TOUCH B
    Y = EXPAND EDGE (GATE_NP COINCIDENT EDGE B) OUTSIDE BY 0.220
    Z = Y COINCIDENT EDGE POLY
   R1 =      (EXT Z C < 0.320 ABUT >0<90 OPPOSITE REGION) INTERACT ((EXPAND EDGE Z OUTSIDE BY 0.320) INTERACT (EXPAND EDGE (COIN EDGE PSTP NACT) BY 0.001))
   M = FDRC INSIDE CELL '*FR_PPXDX4_*' '*FR_PPXDX4_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }
    
PP.A.1 {@ Rule PP.A.1: Area: 0.122 
    AREA PP < 0.122
}

PP.A.2 {@ Rule PP.A.2: Enclosed area: 0.122 
    (HOLES PP < 0.122) NOT INSIDE SRAM_EXCLUDE
}

PP.EN.1 {@ Rule PP.EN.1: Enclosure of Gate (square corner) (except varactors): 0.220
   R1 =     EXGATE_PP NOT PP
   M = FDRC INSIDE CELL '*FR_PPXENX1_*' '*FR_17X13_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PP.EX.3_NP.EX.3 {@ Rule PP.EX.3: {Combination of NP + PP} Enclosure of PO : 0.200
                        @ Rule NP.EX.3: {Combination of NP + PP} Extension on PO : 0.200
   R1 =     ENC (POLYG_dg NOT SRAM_EXCLUDE) IMP < 0.200 ABUT <90 SINGULAR  REGION
   M = FDRC INSIDE CELL '*FR_PPXEXX3_NPXEXX3_*' '*FR_PPXENX3_NPXENX3_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PP.R.1_NP.R.1 {@ Rule PP.R.1_NP.R.1: Intersection with NP is not allowed 
    PP AND NP
}

PP.B.1 {@ Rule PP.B.1: Unremovable Width or Space of {PP .and. NW .and. OD2 .not. BarfromLDD} (PLDDGO2 mask): 0.240
    X = ((PP AND NWEL) AND OD2) NOT BarfromLDD
    Y = SIZE (SIZE (SIZE X BY 0.115) BY -0.23) BY 0.115
    INT Y < 0.240 ABUT <90 SINGULAR REGION
    EXT Y < 0.240 ABUT <90 SINGULAR REGION
}
    
PP.B.2 {@ Rule PP.B.2: Unremovable Width or Space of {PP .and. NW .not. OD2 .not. BarfromLDD} (PLDD mask): 0.240
    X = ((PP AND NWEL) NOT OD2) NOT BarfromLDD
    Y = SIZE (SIZE (SIZE X BY 0.115) BY -0.23) BY 0.115
    INT Y < 0.240 ABUT <90 SINGULAR REGION
    EXT Y < 0.240 ABUT <90 SINGULAR REGION
}

PP.B.4 {@ Rule PP.B.4: Unremovable Width or Space of {PP .and. OD2} (PPLUSGO2): 0.240
    X = PP AND OD2
    Y = SIZE (SIZE (SIZE X BY 0.115) BY -0.23) BY 0.115
    INT Y < 0.240 ABUT <90 SINGULAR REGION
    EXT Y < 0.240 ABUT <90 SINGULAR REGION
}

PP.B.5 {@ Rule PP.B.5: Unremovable Width or Space of {PP .not. OD2} (PPLUS): 0.240
    X = PP NOT OD2
    Y = SIZE (SIZE (SIZE X BY 0.115) BY -0.23) BY 0.115
    INT Y < 0.240 ABUT <90 SINGULAR REGION
    EXT Y < 0.240 ABUT <90 SINGULAR REGION
}


PP.A.3 {@ Rule PP.A.3: Area of P+ OD butted to an N+ OD: 0.040 
    y = PSTP WITH EDGE PSTP_NACT_BTE
    AREA Y < 0.040 
}

GROUP PP PP.?

//------------------------------------------------------------------------------  
//       SRM Design Rules     
//------------------------------------------------------------------------------  

SRM.W.1 {@ Rule SRM.W.1: Width (if error shape intersects OD): 0.280  
    (INT DMSRM < 0.280 ABUT <90 SINGULAR REGION) AND ODi
}

SRM.S.1 {@ Rule SRM.S.1: Space (if error shape intersects OD): 0.280  
    (EXT DMSRM < 0.280 ABUT <90 SINGULAR REGION) AND ODi
}

SRM.EN.1 {@ Rule SRM.EN.1: Enclosure of OD of MOS: 0.070 
    ENC (DACT INTERACT POLY) DMSRM < 0.070 ABUT <90 SINGULAR INSIDE ALSO  
}

SRM.EN.2 {@ Rule SRM.EN.2: Enclosure of Gate: 0.220 
    ENC GATE DMSRM < 0.220 ABUT <90 SINGULAR
}

SRM.D.1 {@ Rule SRM.D.1: Distance to OD of MOS not using SRM: 0.070
         EXT DMSRM (ACTIVSD NOT INTERACT DMSRM) < 0.070 ABUT <90 SINGULAR
}

SRM.D.2 {@ Rule SRM.D.2: Distance to Gate not using SRM: 0.170
      EXT DMSRM (ALLGATE OUTSIDE DMSRM) < 0.170 ABUT <90 SINGULAR
}
    
SRM.EX.1 {@ Rule SRM.EX.1: SRM Extension on NW (if error shape intersects OD. Align if less): 0.280
   R1 =     (ENC NWELi DMSRM < 0.280 ABUT >0<90 SINGULAR REGION) AND ODi
   M = FDRC INSIDE CELL '*FR_SMXEXX1_*' '*FR_SMXEXX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

GROUP SRM SRM.?

//------------------------------------------------------------------------------  
//       SRAM Marker Restrictions  
//------------------------------------------------------------------------------  

MSRM.R.1 {@ Rule MSRM.R.1: MKR;sramdmy must intersect {Gate within SRM} (cannot use marker on non-SRAM circuit)
    SRAMDMY NOT INTERACT (SRAMDMY AND (ACTPOL AND DMSRM))
}

MSRM.R.2 {@ Rule MSRM.R.2: MKR;srmperi must be a rectangle
    NOT RECTANGLE MKR_srmperi
}

MSRM.R.4 {@ Rule MSRM.R.4: MKR;srmperi must be completely covered by {SRM upsized 200.00}
    MKR_srmperi NOT (SIZE DMSRMi BY 200.000)
}

MSRM.D.1 {@ Rule MSRM.D.1: CO Distance to Gate within MKR;srmperi (CO completely within marker): 0.055
    EXT (CO INSIDE MKR_srmperi) (GATE INSIDE MKR_srmperi) < 0.055 ABUT <90 SINGULAR INSIDE ALSO
}

GROUP MSRM MSRM.?

//  -------------------------------------------------------------------------
//      10% Shrink Compatibility
//  -------------------------------------------------------------------------

S_CO.D.5 {@ Rule S_CO.D.5: Distance of CO on OD to Gate on OD2: 0.130
    EXT COOD_GP HV_GATE < 0.130 ABUT <90 INSIDE ALSO SINGULAR
}

GROUP SHRINK_CHECK S_CO.D.5

//------------------------------------------------------------------------------  
//       VTH_N  
//------------------------------------------------------------------------------  

VTH_N.W.1 {@ Rule VTH_N.W.1: Width (with exception of touching standard cell library cells) : 0.400
    A = INT VTH_N < 0.400 ABUT >0<90 REGION
    B = INT VTH_N == track_l OPPOSITE EXTENDED 0.001 REGION
    C = AREA B == track_l*0.001 
    A NOT INTERACT C         
    
    D= EXTENTS C        
    E= SIZE D BY 0.001    
    F = INSIDE EDGE VTH_N E    
    G = TOUCH EDGE VTH_N F    
        LENGTH G < edge_l    
}    

VTH_N.S.1 {@ Rule VTH_N.S.1: Space (with exception of touching standard cell library cells): 0.240
    EXT VTH_N < 0.240 ABUT >0<90 REGION
    
    A = EXT VTH_N < 0.001 SINGULAR REGION    
    B = TOUCH EDGE VTH_N A            
    LENGTH B < edge_l            
}

VTH_N.EN.1 {@ Rule VTH_N.EN.1: Enclosure of Gate: 0.220 
   R1 =     ENC GATE_NP VTH_N < 0.220 ABUT <90 SINGULAR INSIDE ALSO REGION
   M = FDRC INSIDE CELL '*FR_VTH_NXENX1_*' '*FR_82X4Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

GATENOADHN = GATE OUTSIDE VTH_N
VTH_N.D.1 {@ Rule VTH_N.D.1: Distance to Gate not using VTH_N: 0.220
   R1 =     EXT VTH_N GATENOADHN < 0.220 ABUT <90 REGION
   M = FDRC INSIDE CELL '*FR_VTH_NXDX1_*' '*FR_82X6Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

VTH_N.A.1 {@ Rule VTH_N.A.1: Area: 0.400
    AREA VTH_N < 0.400
}

ADHVTNH = HOLES VTH_N INNER EMPTY    
VTH_N.A.2 {@ Rule VTH_N.A.2: Enclosed area: 0.400
    AREA ADHVTNH < 0.400
}

N_CHANNEL = GATE NOT NWEL
P_CHANNEL = GATE AND NWEL

VTH_N.R.1 {@ Rule VTH_N.R.1: VTH_N must not intersect P-Channel (transistor and varactor), P+ SD, OD2
    VTH_N AND P_CHANNEL                                          // P-Channel transistor and varactor (layer)
    VTH_N AND PACT                                  // P+ SD (layer)
    VTH_N AND OD2                                  // if OD2 overlap VTH_N
}

GROUP VTH_N VTH_N.?

//------------------------------------------------------------------------------  
//       VTH_P    
//------------------------------------------------------------------------------  

VTH_P.W.1 {@ Rule VTH_P.W.1: Width (with exception of touching standard cell library cells) : 0.400
    A = INT VTH_P < 0.400 ABUT >0<90 REGION
    B = INT VTH_P == track_l OPPOSITE EXTENDED 0.001 REGION
    C = AREA B == track_l*0.001 
    A NOT INTERACT C         
    
    D= EXTENTS C        
    E= SIZE D BY 0.001    
    F = INSIDE EDGE VTH_P E    
    G = TOUCH EDGE VTH_P F    
        LENGTH G < edge_l    
}

VTH_P.S.1 {@ Rule VTH_P.S.1: Space (with exception of touching standard cell library cells): 0.240
    EXT VTH_P < 0.240 ABUT >0<90 REGION

    A = EXT VTH_P < 0.001 SINGULAR REGION    
    B = TOUCH EDGE VTH_P A            
    LENGTH B < edge_l            
}

VTH_P.EN.1 {@ Rule VTH_P.EN.1: Enclosure of Gate: 0.220 
   R1 =     ENC GATE_PP VTH_P < 0.220 ABUT <90 SINGULAR INSIDE ALSO REGION
   M = FDRC INSIDE CELL '*FR_VTH_PXENX1_*' '*FR_83X4Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }
        
GATENOADHP = GATE OUTSIDE VTH_P
VTH_P.D.1 {@ Rule VTH_P.D.1: Distance to Gate not using VTH_P: 0.220
   R1 =     EXT VTH_P GATENOADHP < 0.220 ABUT <90 REGION
   M = FDRC INSIDE CELL '*FR_VTH_PXDX1_*' '*FR_83X6Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }
    
VTH_P.A.1 {@ Rule VTH_P.A.1: Area: 0.400
    AREA VTH_P < 0.400
}

ADHVTPH = HOLES VTH_P INNER EMPTY
VTH_P.A.2 {@ Rule VTH_P.A.2: Enclosed area: 0.400
    AREA ADHVTPH < 0.400
}    
      
VTH_P.R.1 {@ Rule VTH_P.R.1: VTH_P must not intersect N-Channel (transistor and varactor), N+ SD, OD2
    VTH_P AND N_CHANNEL            // N-Channel transistor and varactor (layer)
    VTH_P AND NACT                // N+ SD (layer)
    VTH_P AND OD2                // if OD2 overlap VTH_P
}

GROUP VTH_P VTH_P.?

LP.MRC.1 {@ Rule LP.MRC.1: VTL_N and VTL_P layers not allowed in LP process option
    COPY VTL_N
    COPY VTL_P
}


//  -------------------------------------------------------------------------
//      POLY  /  PO  
//  -------------------------------------------------------------------------

//PO.W.2 is checked by PO.W.1   

PO.W.4 {@ Rule PO.W.4: Transistor length for 2.5V NMOS and PMOS: 0.280 
    (INT HV_GATE_W_25 < 0.280 ABUT <90 REGION) NOT FILTER_PO.W.4

}


PO.W.1 {@ Rule PO.W.1: Width: 0.100 
    INT POLY < 0.100 ABUT <90 SINGULAR REGION
}

PO.S.2 {@ Rule PO.S.2: PO space on OD for thin oxide NMOS and PMOS: 0.150 
    EXT LV_GATE_W < 0.150
}

PO.S.3 {@ Rule PO.S.3: PO space on OD for 2.5V NMOS and PMOS: 0.250 
   R1 =     EXT HV_NGATE_W < 0.250 REGION
   R2 =     EXT HV_PGATE_W < 0.250 REGION
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_POXSX3_*' '*FR_POXSX3_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

PO.S.1 {@ Rule PO.S.1: Space on field oxide: 0.140 
   R1 =     EXT POLY < 0.140 ABUT <90 SINGULAR  REGION
   M = FDRC INSIDE CELL '*FR_POXSX1_*' '*FR_13X4Xc_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.D.1 {@ Rule PO.D.1: Distance of a PO on field to an OD: 0.050 
   R1 =     EXT (POLY NOT POLYG_dm) OD < 0.050 ABUT <89.5 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_POXDX1_*' '*FR_13X5Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

SMALL_GATE_W2 = LENGTH GATE_W < 0.2
EXPAND_GATE = EXPAND EDGE SMALL_GATE_W2 INSIDE BY 0.005 EXTEND BY 0.1

PO.D.2 {@ Rule PO.D.2: Distance to OD corner when PO and OD are in the same MOS transistor, if W<0.2 um: 0.100
    X = EXT OD EXPAND_GATE < 0.100 ABUT <90 OPPOSITE REGION
   R1 =     X OUTSIDE POLY
   M = FDRC INSIDE CELL '*FR_POXDX2_*' '*FR_13X5Xb_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.D.3 {@ Rule PO.D.3: Distance between PO corner on field and Gate when PO and Gate are in the same MOS transistor, and W<0.2 um: 0.100
      GATE_W_CONV_EDGE = CONVEX EDGE GATE_W <= 1 
      SMALL_GATE_W3 = LENGTH GATE_W_CONV_EDGE < 0.200
     SMALL_GATE3 = GATE WITH EDGE SMALL_GATE_W3
   R1 =     EXT SMALL_GATE3 POLY < 0.100 PERP ONLY REGION
   M = FDRC INSIDE CELL '*FR_POXDX3_*' '*FR_13X5Xc_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.EX.1 {@ Rule PO.EX.1: OD Extension on PO (width of source and drain): 0.150 
   R1 =     ENC POLY OD < 0.150 ABUT <89.5 OPPOSITE SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_POXEXX1_*' '*FR_13X6_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.EX.2 {@ Rule PO.EX.2: PO Gate extension on OD (endcap): 0.160 
   R1 =     ENC OD POLY < 0.160 ABUT <89.5 SINGULAR OPPOSITE REGION
   M = FDRC INSIDE CELL '*FR_POXEXX2_*' '*FR_13X7_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.EX.3 {@ Rule PO.EX.3: PO Gate extension on OD (endcap) when L-shaped OD to PO distance is < 0.1: 0.180
    X = ENC OD POLY < 0.180 ABUT <90 OPPOSITE REGION
    Y = EXT (CONVEX EDGE (NOT TOUCH EDGE X GATE_L) ==1) OD < 0.100 ABUT >0<90 OPPOSITE REGION 
    Z = EXPAND EDGE GATE_W OUTSIDE BY 0.005 
   R1 =     Y TOUCH Z
   M = FDRC INSIDE CELL '*FR_POXEXX3_*' '*FR_13X7Xb_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.R.3_PO.R.4 {@ Rule PO.R.3: Gate must be a rectangle orthogonal to grid (except varactors and drift-MOS). For varactor and drift-MOS: no 90 corner of OD under PO
                        @ Rule PO.R.4: PO intersecting OD must completely straddle OD (except varactors and drift-MOS)
    X = NOT RECTANGLE GATE_Not_Drift_Var ORTHOGONAL ONLY
   R1 =     X NOT INTERACT PW_bk
    X1 = CONVEX EDGE GATE_W_Not_Drift_Var == 2
   R2 =     EXPAND EDGE X1 BY 0.005
   R3 = R1 OR R2
    Y1 = CONVEX EDGE GATE_L_Not_Drift_Var == 2
   R4 =     EXPAND EDGE Y1 BY 0.005
   R5 = R3 OR R4
   M = FDRC INSIDE CELL '*FR_POXX3_POXRX4_*' '*FR_POXX3_POXRX4_*'
   R5 NOT INTERACT M
   R6 = R5 INTERACT M
   R6 INTERACT (SIZE (R6 XOR M) BY -0.001)
     }

PO.W.6 {@ Rule PO.W.6: Width of 45 PO lines on field oxide: 0.190 
       (INT (POLY NOT POLYG_dm) < 0.190 ABUT <90 ANGLED REGION) NOT FILTER_PO.W.6
}

PO.S.5 {@ Rule PO.S.5: Space of 45 PO lines on field oxide: 0.190 
   R1 =     EXT (POLY NOT POLYG_dm) < 0.190 ABUT <90 ANGLED  REGION
   M = FDRC INSIDE CELL '*FR_POXSX5_*' '*FR_POXSX5_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.A.1 {@ Rule PO.A.1: Area: 0.060
    AREA POLY < 0.060
}

PO.A.2 {@ Rule PO.A.2: Enclosed area: 0.110
    HOLES POLY < 0.110
}
    
POLY_23S = (POLY SIZE BY 0.115 UNDEROVER TRUNCATE 0.115) AND POLY    
PO.S.4 {@ Rule PO.S.4: Space if at least one PO width is > 0.23 um (W) and if the parallel PO run length (between both PO) is > 0.3 um (L): 0.180 
    X = EXT POLY_23S POLY < 0.180 OPPOSITE REGION MEASURE ALL
    ENCLOSE RECTANGLE X 0.095 0.305
}    

PO.L.1 {@ Rule PO.L.1: Maximum PO length between 2 CO as well as between 1 CO and the PO line end when the PO width <0.13 um: 25.00
    LONG_PO_1 = AREA (POLY NOT POLYG_dm)> 2.5
    LONG_PO_2 = INT LONG_PO_1 < 0.130 OPPOSITE REGION
    LONG_PO = POLY INTERACT LONG_PO_2 
      CHECK_PO = LONG_PO INTERACT CO
      CHECK_CO = CO INTERACT CHECK_PO
      CO_A = SIZE CHECK_CO BY 12.5 INSIDE OF CHECK_PO STEP 0.14
      PO_A = CHECK_PO INTERACT CO_A == 1
      PO_B = CHECK_PO INTERACT CO_A > 1
      CO_B = CO_A INTERACT PO_A
      CO_C = SIZE CO_B BY 12.5 INSIDE OF PO_A STEP 0.14
      BAD = (PO_A NOT CO_C) OR (PO_B NOT CO_A)
      BAD_EDGE = BAD COIN INSIDE EDGE POLY
      CHECK_PO WITH EDGE BAD_EDGE    
}

RHIPO = ((((POLYG_dg NOT SRAM_EXCLUDE) AND RPO) AND HRI) NOT IMP) NOT RHDMY    
POLY_NOT_HIPO_POFUSE = ((POLYG_dg NOT SRAM_EXCLUDE) NOT RHIPO) NOT POFUSE     

PO.R.5 {@ Rule PO.R.5: PO must be fully covered by the combination NP + PP (except for HIPO resistor and PO fuse) 
   R1 =     POLY_NOT_HIPO_POFUSE NOT IMP
   M = FDRC INSIDE CELL '*FR_POXX5_*' '*FR_POXX5_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

PO.PIN.CAD.1 {@ Rule PO.PIN.CAD.1: POLY purpose PIN without DRAWING
    PO_pin NOT POLYGi
}

GROUP PO PO.?

//  -------------------------------------------------------------------------
//      RPO  
//  -------------------------------------------------------------------------

RPO.W.1 {@ Rule RPO.W.1: Width: 0.430 
    INT RPO < 0.430 ABUT <90 SINGULAR REGION
}

RPO.S.1 {@ Rule RPO.S.1: Space: 0.430 
    EXT RPO < 0.430 ABUT <90 SINGULAR REGION
}

RPO.D.1 {@ Rule RPO.D.1: Distance to OD on field: 0.220 
    EXT RPO OD < 0.220 ABUT <90 SINGULAR REGION
}

RPO.D.2 {@ Rule RPO.D.2: Distance to CO (on OD or on PO. RPO overlap with CO not allowed): 0.220 
    EXT RPO CO < 0.220 ABUT <90 INSIDE ALSO SINGULAR
}

RPO.D.3 {@ Rule RPO.D.3: Distance to PO Gate, on OD: 0.380 
    (EXT RPO GATE < 0.380 ABUT <90 SINGULAR REGION) NOT FILTER_RPO.D.3
}

RPO.EX.1 {@ Rule RPO.EX.1: Extension on related OD for unsilicided OD (S/D or OD resistor): 0.220 
    ENC OD RPO < 0.220 ABUT <90 SINGULAR REGION
}

RPO.EX.2 {@ Rule RPO.EX.2: OD extension on RPO: 0.220 
    ENC RPO OD < 0.220 ABUT <90 SINGULAR REGION
}

RPO.EX.4 {@ Rule RPO.EX.4: Extension on PO on field (RPO must overlap PO on both sides): 0.220 
    ENC FPO1A (RPO NOT FILTER_RPO.EX.4) < 0.220 ABUT <90 SINGULAR
    A = (RPO NOT FILTER_RPO.EX.4) INSIDE EDGE FPO1A
    CONVEX EDGE A > 0
}

RPO.EX.5 {@ Rule RPO.EX.5: Extension on unsilicided OD or PO (if RPO width > 10.0um): 0.300
       RPO_10 = (RPO WITH WIDTH > 10.000)  NOT FILTER_RPO.EX.5
    ENC POLY RPO_10 < 0.300 ABUT <90
    ENC OD RPO_10 < 0.300 ABUT <90    
}

RPO.A.1 {@ Rule RPO.A.1: Area: 1.000
    AREA RPO < 1.000
}

RPO.D.4 {@ Rule RPO.D.4: Distance to PO on field: 0.300 
    EXT RPO FPO1A < 0.300 ABUT <90 SINGULAR
}

RPO.R.2 {@ Rule RPO.R.2: Unsilicided PO or OD can only be either NP or PP (butted NP/PP not allowed within RPO)
    Y = (ODPO_RPO INTERACT NP) INTERACT PP
    (Y OUTSIDE HRI) NOT FILTER_RPO.R.2
    (PP NOT FILTER_RPO.R.2) INSIDE EDGE (POLY_SALI OUTSIDE HRI) 
    (NP NOT FILTER_RPO.R.2) INSIDE EDGE (POLY_SALI OUTSIDE HRI) 
}

RPO.A.2 {@ Rule RPO.A.2: Enclosed area: 1.000
    HOLES (RPO NOT FILTER_RPO.A.2)< 1.000
}

RPO.S.2 {@ Rule RPO.S.2: PO space to PO within RPO: 0.250 
    EXT POLY_SALI < 0.250 ABUT <90 SINGULAR REGION
}


RPO.D.5 {@ Rule RPO.D.5: {Unsilicided PO or OD} Distance to NP: 0.200
    EXT ODPO_RPO NP < 0.200 ABUT <90 SINGULAR REGION
}

RPO.D.6 {@ Rule RPO.D.6: {Unsilicided PO or OD} Distance to PP: 0.200
    (EXT ODPO_RPO PP < 0.200 ABUT <90 SINGULAR REGION ) NOT FILTER_RPO.D.6 
}

PO_RPO = POLY AND RPO
ODPO_RPO = ODPO AND RPO
VTH_N_UG = VTH_N INTERACT (GATE AND RPO)  // VTH_N on a unsilicided gate
VTH_N_NUG = VTH_N NOT VTH_N_UG          // other VTH_N 
VTH_P_UG = VTH_P INTERACT (GATE AND RPO)  
VTH_P_NUG = VTH_P NOT VTH_P_UG 
RPO.D.7 {@ Rule RPO.D.7: {Unsilicided PO or OD} Distance to VTH_N, VTH_P, VTL_N, VTL_P (overlap not allowed except for unsilicided transistors): 0.220 
    EXT VTH_N_UG ODPO_RPO < 0.220 ABUT <90 SINGULAR REGION               
    EXT VTH_N_NUG ODPO_RPO < 0.220 ABUT <90 SINGULAR REGION INSIDE ALSO  
    EXT VTH_P_UG ODPO_RPO < 0.220 ABUT <90 SINGULAR REGION
    EXT VTH_P_NUG ODPO_RPO < 0.220 ABUT <90 SINGULAR REGION INSIDE ALSO
}

ACTSIP = (RPO AND OD) NOT FILTER_RPO.EX.3
SIPAC = RPO COINCIDENT INSIDE EDGE ACTSIP
RPO.EX.3 {@ Rule RPO.EX.3: Extension on PO, on OD: 0.300
    ENC GATEN_W SIPAC < 0.300 ABUT <90
    ENC GATEP_W SIPAC < 0.300 ABUT <90
}
 
GROUP RPO RPO.?

//------------------------------------------------------------------------------
//      DNW 
//------------------------------------------------------------------------------

DNW.R.1 {@ Rule DNW.R.1: DNW edge must be fully enclosed by NW
    DNW OUTSIDE EDGE NWEL
}

DNW.W.1 {@ Rule DNW.W.1: Width: 3.000 
    (INT DNW < 3.000 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

DNW.S.1 {@ Rule DNW.S.1: Space: 4.800 
    (EXT DNW < 4.800 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

DNW.S.2 {@ Rule DNW.S.2: RW Space (Width of NW between two RW) if one RW is at different potential <= 1.2V : 1.000 
    (EXT RW1V_NODAL < 1.000 ABUT <90 NOT CONNECTED SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

DNW.S.3 {@ Rule DNW.S.3: RW Space (Width of NW between two RW) if one RW is at different potential > 1.2V : 1.200 
    (EXT RW2V_NODAL < 1.200 ABUT <90 NOT CONNECTED SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
    (EXT RW1V_NODAL RW2V_NODAL < 1.200 ABUT <90 NOT CONNECTED SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

DNW.EN.1 {@ Rule DNW.EN.1: Enclosure by NW: 1.500 
    ENC DNW NWEL < 1.500 ABUT <90 SINGULAR REGION
}

DNW.OL.1 {@ Rule DNW.OL.1: Overlap of NW : 0.400 
    (INT DNW NWEL < 0.400 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
}

//Rule DNW.R.2  check by LVS

DNW.D.1 {@ Rule DNW.D.1: Distance to NW on different net: 3.300
    EXT DNW NWEL < 3.300 ABUT <90 SINGULAR REGION MEASURE ALL NOT CONNECTED
} 

DNW.D.2 {@ Rule DNW.D.2: Distance to N+ SD: 1.820
    EXT DNW NACT < 1.820 ABUT <90 SINGULAR REGION
}
    
DNW.D.3 {@ Rule DNW.D.3: Distance to PFET Gate (P-Channel) : 1.000
    EXT DNW GATE_P < 1.000 ABUT <90 SINGULAR REGION OVERLAP
}
  
DNW.EN.2 {@ Rule DNW.EN.2: Enclosure of PFET Gate (P-Channel): 0.500
    ENC GATE_P DNW < 0.500 ABUT <90 REGION SINGULAR
}

DNW.R.3 {@ Rule DNW.R.3: DNW must not intersect OD of {Native VT (NT_N), Drift-NMOS, PNP (MKR;BJT)}
    DNW AND (OD AND NT_N)
    DNW AND (OD INTERACT PW_bk_DrNMOS)
    DNW AND (OD AND (BJTDMY ENCLOSE NWEL >=1))
}

GROUP DNW DNW.?

//------------------------------------------------------------------------------
//      NT_N
//------------------------------------------------------------------------------

NT_N.W.1 {@ Rule NT_N.W.1: Width: 0.620
    INT NT_N < 0.620 ABUT <90 SINGULAR REGION
}

NT_N.S.1 {@ Rule NT_N.S.1: Space: 0.620
    EXT NT_N < 0.620 ABUT <90 SINGULAR REGION
}

NT_N.A.1 {@ Rule NT_N.A.1: Area: 1.550
    AREA NT_N < 1.550
}

NT_N.A.2 {@ Rule NT_N.A.2: Enclosed area: 1.550
    HOLES NT_N < 1.550
}

NT_N.W.2 {@ Rule NT_N.W.2: Transistor Length of native device: 1.200
       INT (HV_GATE_W_25 INSIDE EDGE NT_N) < 1.200 ABUT <90 REGION
       INT (HV_GATE_W_33 INSIDE EDGE NT_N) < 1.200 ABUT <90 REGION    
}

NT_N.W.3 {@ Rule NT_N.W.3: Transistor Width of native device: 0.500
    INT (GATE_L INSIDE EDGE NT_N) < 0.500 ABUT <90 REGION
}

NT_N.EN.1 {@ Rule NT_N.EN.1: Enclosure of OD (min=max): 0.260
    OD_NT = OD AND NT_N
    A = SIZE OD_NT BY 0.260
    (NT_N INTERACT A) NOT A
    A NOT (NT_N INTERACT A)
    NT_N INTERACT OD_NT >1
}

NT_N.EX.1 {@ Rule NT_N.EX.1: PO Extension on OD of native device (endcap): 0.350
    ENC (OD INTERACT NT_N) POLY < 0.350 ABUT <89.5 SINGULAR OPPOSITE REGION
}

NT_N.D.1 {@ Rule NT_N.D.1: Distance to {Source/Drain outside NT_N}: 0.380
    EXT NT_N (OD OUTSIDE NT_N) < 0.380 ABUT <90 SINGULAR REGION
}

NT_N.D.2 {@ Rule NT_N.D.2: Distance to NW: 1.200
    EXT NT_N NWEL < 1.200 ABUT <90 SINGULAR REGION
}

NT_N.R.1 {@ Rule NT_N.R.1: NT_N must not intersect NW, DNW, VTH_N Gate, VTL_N Gate, or P+ OD
    NT_N AND NWEL
    NT_N AND DNW
    NT_N AND (GATE_N AND VTH_N)
    NT_N AND (GATE_N AND VTL_N)
    NT_N AND PPOD
}

NT_N.R.3 {@ Rule NT_N.R.3: OD within NT_N must be covered by OD2 (only thick oxide native device is allowed)
    (OD AND NT_N) NOT OD2
}

GROUP NT_N NT_N.?

//------------------------------------------------------------------------------
//         OD2  
//------------------------------------------------------------------------------

OD2.EX.1 {@ Rule OD2.EX.1: Extension on {Source/Drain or Gate} (well straps excluded): 0.270 
    ENC ((SD_drm OR GATE) NOT (NW_STRAP OR PW_STRAP)) OD2 < 0.270 ABUT <90 SINGULAR REGION
    OD2 INSIDE ((SD_drm OR GATE) NOT (NW_STRAP OR PW_STRAP))
}

OD2.EX.2 {@ Rule OD2.EX.2: P+ SD Extension on OD2: 0.130
    ENC OD2 PACT < 0.130 ABUT <90 SINGULAR REGION     
}

OD2.S.1 {@ Rule OD2.S.1: Space. Merge if less: 0.620 
    EXT OD2 < 0.620 ABUT <90 SINGULAR REGION
}

//OD2.D.3 CHECKED BY OD2.S.1

OD2.D.1 {@ Rule OD2.D.1: Distance to Source/Drain OD (well straps excluded): 0.270 
    EXT OD2 DACT < 0.270 ABUT <90 SINGULAR REGION
}

OD2.D.2 {@ Rule OD2.D.2: Distance to Gate of thin oxide MOS: 0.340 
    EXT OD2 GATE < 0.340 ABUT <90 SINGULAR
}

OD2.EN.1 {@ Rule OD2.EN.1: Enclosure of Gate of 2.5V or 3.3 V MOS in S/D direction: 0.340 
    ENC GATE_W OD2 < 0.340 ABUT <90 REGION
    GATE CUT OD2
}

OD2.B.1 {@ Rule OD2.B.1: Unremovable Width or Space of {OD2 .and. NW} (NWELLGO2 mask): 0.550
    X = OD2 AND NWEL
    Y = SIZE (SIZE (SIZE X BY 0.27) BY -0.54) BY 0.27
    INT Y < 0.550 ABUT <90 SINGULAR REGION
    EXT Y < 0.550 ABUT <90 SINGULAR REGION
}

OD2.B.2 {@ Rule OD2.B.2: Unremovable Width or Space of {OD2 .not. (NW .or. NT_N.or. PW;blk)} (PWELLGO2 mask): 0.550
    X = OD2 NOT ((NWEL OR NT_N) OR PW_bk)
    Y = SIZE (SIZE (SIZE X BY 0.27) BY -0.54) BY 0.27
    INT Y < 0.550 ABUT <90 SINGULAR REGION
    EXT Y < 0.550 ABUT <90 SINGULAR REGION
}

OD2.B.3 {@ Rule OD2.B.3: Unremovable Width or Space of {NW .not. OD2} (NWELL mask): 0.550
    X = NWEL NOT OD2
    Y = SIZE (SIZE (SIZE X BY 0.27) BY -0.54) BY 0.27
    INT Y < 0.550 ABUT <90 SINGULAR REGION
    EXT Y < 0.550 ABUT <90 SINGULAR REGION
}

OD2.B.4 {@ Rule OD2.B.4: Unremovable Width or Space of {(.not. OD2) .not. (NW .or. NT_N .or. PW;blk)} (PWELL mask): 0.550
    X = (CHIP NOT OD2) NOT ((NWEL OR NT_N) OR PW_bk)
    Y = SIZE (SIZE (SIZE X BY 0.27) BY -0.54) BY 0.27
    INT Y < 0.550 ABUT <90 SINGULAR REGION
    EXT Y < 0.550 ABUT <90 SINGULAR REGION
}
    
OD2.W.1 {@ Rule OD2.W.1: Width: 0.620
    INT OD2 < 0.620
}    

OD2.MRC.1 {@ Rule OD2.MRC.1: OD_33 and OD_25 are mutually exclusive process options: cannot be used on the same die. 
    OD2 = OD2_33_dg OR OD2_33_dm
    OD2_25 = OD2_25_dg OR OD2_25_dm
    (BULK INTERACT OD2) AND OD2_25
}
        
OD2.OL.1 {@ Rule OD2.OL.1: Overlap of P+ SD: 0.130
      INT PACT OD2 < 0.130 ABUT >0<90 SINGULAR REGION
}

GROUP OD2 OD2.?

//------------------------------------------------------------------------------
//         Recommanded OD2 Design Rules
//------------------------------------------------------------------------------

R_OD2.B.1 {@ Rule R_OD2.B.1: OD2 Overlap of NW (align if less) (NWELLGO2 mask): 0.620
      INT NWEL OD2 < 0.620 ABUT >0<90 SINGULAR REGION
}

R_OD2.B.2 {@ Rule R_OD2.B.2: OD2 Extension on {NW or PW;blk} (align if less) (PWELLGO2 mask): 0.620
      ENC (NWEL OR PW_bk) OD2 < 0.620 ABUT >0<90 SINGULAR REGION
}

R_OD2.B.3 {@ Rule R_OD2.B.3: NW Extension on OD2 (align if less) (NWELL mask): 0.620
      ENC OD2 NWEL < 0.620 ABUT >0<90 SINGULAR REGION
}

R_OD2.B.4 {@ Rule R_OD2.B.4: OD2 Distance to {NW or PW;blk} (align if less) (PWELL mask): 0.620
      EXT OD2 (NWEL OR PW_bk) < 0.620 ABUT >0<90 SINGULAR REGION
}

R_OD2.B.5 {@ Rule R_OD2.B.5: Width of {OD2 or NW or PW;blk} (PWELL mask): 0.620
    R1 = (INT ((OD2 OR NWEL) OR PW_bk_ns) < 0.620 ABUT <90 SINGULAR REGION) NOT INSIDE SRAM_EXCLUDE
    M = FDRC INSIDE CELL '*FR__OD2XBX5_*' '*FR_NWXWX1_*' '*FR_1X1Xa_*'
    R1 NOT INTERACT M
    R2 = R1 INTERACT M
    R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
}

GROUP R_OD2 R_OD2.?

//  -------------------------------------------------------------------------
//      CO  
//  -------------------------------------------------------------------------

CO.W.1 {@ Rule CO.W.1: Width (width = length, min = max): 0.120
    A = NOT RECTANGLE CO == 0.120 BY == 0.120
   R1 =     A NOT VIA_EXD
   M = FDRC INSIDE CELL '*FR_COXWX1_*' '*FR_19X1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

CO.S.1 {@ Rule CO.S.1: Space: 0.140
   R1 =     EXT CO < 0.140 ABUT <90 SINGULAR  REGION
   M = FDRC INSIDE CELL '*FR_COXSX1_*' '*FR_19X2Xa_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

CO.S.2 {@ Rule CO.S.2: Space to CO in an array (CO with 3 or more CO within < 0.18 um distance): 0.160
    CO_CK = COi_dg NOT DMSRM
    COA = CO_CK WITH NEIGHBOR >= 3 Space < 0.18 
   R1 =     EXT COA CO_CK < 0.16  REGION
    X = EXT CO < 0.180 REGION PROJ
    Y = EXT CO < 0.180 REGION NOT PROJ
    BAD_CONTACT1 = CO INTERACT X > 2
    BAD_CONTACT2 = CO INTERACT Y > 2
    W = CO INTERACT X == 2
    BAD_CONTACT3 = W INTERACT Y >= 1
    Z = CO INTERACT X == 1
    BAD_CONTACT4 = Z INTERACT Y >= 2
    BAD_CONTACT = ((BAD_CONTACT1 OR BAD_CONTACT2) OR BAD_CONTACT3) OR BAD_CONTACT4
   R2 =     EXT BAD_CONTACT CO < 0.160 REGION
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_COXSX2_*' '*FR_COXSX2_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

CO.D.4 {@ Rule CO.D.4: Distance of {CO on OD} to Gate (CO on Gate is not allowed): 0.070 
   R1 =     EXT (COOD_GP NOT INTERACT MKR_srmperi) GATE < 0.070 ABUT <90 INSIDE ALSO SINGULAR REGION
   R2 =     EXT (COOD_GP INTERACT MKR_srmperi) GATE < 0.055 ABUT <90 INSIDE ALSO SINGULAR REGION
   R3 = R1 OR R2
   M = FDRC INSIDE CELL '*FR_COXDX4_*' '*FR_19X6Xa_*'
   R3 NOT INTERACT M
   R4 = R3 INTERACT M
   R4 INTERACT (SIZE (R4 XOR M) BY -0.001)
     }

CO.D.3 {@ Rule CO.D.3: Distance of {CO on PO} to OD: 0.100
   R1 =     EXT COPO OD < 0.100 ABUT <90 INSIDE ALSO SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_COXDX3_*' '*FR_19X5_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

CO.EN.1_CO.EX.1 {@ Rule CO.EN.1: Enclosure by PO: 0.020 
         @ Rule CO.EX.1: PO Extension on CO on at least 2 opposite sides: 0.050
         @ Rule CO.R.6: CO must be fully covered by M1 and by {PO or OD}
   R1 =     RECTANGLE ENCLOSURE COPO POLY ABUT <90 OUTSIDE ALSO SINGULAR GOOD 0.020 0.050 OPPOSITE 0.020 0.050 OPPOSITE
   M = FDRC INSIDE CELL '*FR_COXENX1_COXEXX1_*' '*FR_19X3Xa_R19X3Xb_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

CO.EN.2_CO.EX.2 {@ Rule CO.EN.2: Enclosure by OD: 0.040 
         @ Rule CO.R.6: CO must be fully covered by M1 and by {PO or OD}
    R1 = RECTANGLE ENCLOSURE COOD_GP OD ABUT <90 SINGULAR GOOD 0.040 0.040 0.040 0.040
    M = FDRC INSIDE CELL '*FR_COXENX2_COXDX2_*' '*FR_19X4Xa_R19X4Xb_*'
    R1 NOT INTERACT M
    R2 = R1 INTERACT M
    R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
}

CO.D.2 {@ Rule CO.D.2: Distance to butted N+ OD: 0.060 
   R1 =     EXT NACT_PSTP_BTE COOD < 0.060 ABUT <90 INSIDE ALSO REGION
   R2 =     EXT NSTP_PACT_BTE COOD < 0.060 ABUT <90 INSIDE ALSO  REGION
   R3 = R1 OR R2
   R4 =     EXT COOD NP < 0.001 ABUT <90 SINGULAR REGION
   R5 = R3 OR R4
   M = FDRC INSIDE CELL '*FR_COXDX2_*' '*FR_COXDX2_*'
   R5 NOT INTERACT M
   R6 = R5 INTERACT M
   R6 INTERACT (SIZE (R6 XOR M) BY -0.001)
     }

CO.D.1 {@ Rule CO.D.1: Distance to butted P+ OD: 0.060 
   R1 =     EXT PACT_NSTP_BTE COOD < 0.060 ABUT <90 INSIDE ALSO REGION
   R2 =     EXT PSTP_NACT_BTE COOD < 0.060 ABUT <90 INSIDE ALSO REGION
   R3 = R1 OR R2
   R4 =     EXT COOD PP < 0.001 ABUT <90 SINGULAR REGION
   R5 = R3 OR R4
   M = FDRC INSIDE CELL '*FR_COXDX1_*' '*FR_COXDX1_*'
   R5 NOT INTERACT M
   R6 = R5 INTERACT M
   R6 INTERACT (SIZE (R6 XOR M) BY -0.001)
     }

CO.R.4 {@ Rule CO.R.4: 45 rotated CO not allowed
    ANGLE CO == 45
}

COOD_GP = (CO NOT CO_dm) AND OD
CO.D.5 {@ Rule CO.D.5: Distance of {CO on OD} to Gate on OD2 : 0.110
    EXT COOD_GP HV_GATE < 0.110 ABUT <90 INSIDE ALSO SINGULAR
}

CO.CAD.1 {@ Rule CO.CAD.1: Contact on OD or PO resistor body not allowed.
    (OD AND (RPDMY OR OD_res)) AND CO
    (POLY AND (RPDMY OR PO_res)) AND CO    
}

GROUP CO CO.?

//  -------------------------------------------------------------------------
//      METAL1  /  M1
//  -------------------------------------------------------------------------
 
M1.W.1 {@ Rule M1.W.1: Width : 0.120 
    INT M1_dg_tO < 0.120 ABUT <90 SINGULAR
}

M1.W.2 {@ Rule M1.W.2: Maximum width: 12.00 
    (SIZE M1 BY 6 UNDEROVER TRUNCATE 6) AND M1
}
    
M1.S.1 {@ Rule M1.S.1: Space: 0.120            
    A = EXT M1i_dg_tO ME1_tO < 0.120 ABUT <90 SINGULAR REGION    
    B = EXT M1i_dg_tO M1i    < 0.120 ABUT <90 SINGULAR REGION    
    C = B NOT INSIDE SRAM_EXCLUDE                        
    D = B WITH EDGE (B COIN INSIDE EDGE SRAM_EXCLUDE)            
    A OR (C OR D)
}

ME1_3_1 = (SIZE M1i_dg_tO UNDEROVER BY 0.15 TRUNCATE 0.15) AND M1_dg_tO
ME1_3_2 = (SIZE ME1_3_1 UNDEROVER BY 0.75 TRUNCATE 0.75) AND ME1_3_1
ME1_3_4 = (SIZE ME1_3_2 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME1_3_2

M1.S.3.1 {@ Rule M1.S.3.1: Space if at least one metal line width is > 0.3 um (W1) and if the parallel metal run length (between both metals) > 0.52 um (L1): 0.170    
    A = EXT ME1_3_1 ME1_tO < 0.170 OPPOSITE MEASURE ALL REGION        
    B = EXT ME1_3_1 M1i    < 0.170 OPPOSITE MEASURE ALL REGION        
    C = B NOT INSIDE SRAM_EXCLUDE                            
    D = B WITH EDGE (B COIN INSIDE EDGE SRAM_EXCLUDE)                
    E = A OR (C OR D)
    ENCLOSE RECTANGLE E 0.120 0.521
}

M1.S.3.2 {@ Rule M1.S.3.2: Space if at least one metal line width is > 1.50 um (W2) and if the parallel metal run length (between both metals) > 1.50 um (L2): 0.500     
    A = EXT ME1_3_2 ME1_tO < 0.500 OPPOSITE MEASURE ALL REGION        
    B = EXT ME1_3_2 M1i    < 0.500 OPPOSITE MEASURE ALL REGION        
    C = B NOT INSIDE SRAM_EXCLUDE                            
    D = B WITH EDGE (B COIN INSIDE EDGE SRAM_EXCLUDE)                
    E = A OR (C OR D)
    ENCLOSE RECTANGLE E 0.005 1.501
}

M1.S.3.4 {@ Rule M1.S.3.4: Space if at least one metal line width is > 4.50 um (W4) and if the parallel metal run length (between both metals) > 4.50 um (L4): 1.500    
    A = EXT ME1_3_4 ME1_tO < 1.500 OPPOSITE MEASURE ALL REGION     
    B = EXT ME1_3_4 M1i    < 1.500 OPPOSITE MEASURE ALL REGION     
    C = B NOT INSIDE SRAM_EXCLUDE                            
    D = B WITH EDGE (B COIN INSIDE EDGE SRAM_EXCLUDE)                
    E = A OR (C OR D)
    ENCLOSE RECTANGLE E 0.005 4.501
}
    
M1.EN.1_M1.EX.1_M1.EN.2 {@ Rule M1.EN.1: Enclosure of CO: 0.000
             @ Rule M1.EX.1: Extension on CO on at least 2 opposite sides, unless M1.EN.2 is fulfilled: 0.050
             @ Rule M1.EN.2: Enclosure of CO, unless M1.EX.1 is fulfilled: 0.025
             @ Rule CO.R.6: CO must be fully covered by M1 and by {PO or OD}
    X = ENC [CO] M1 < 0.050 ABUT <90 OPPOSITE
      Y = CO TOUCH EDGE X
     Z =  INT Y < 0.120 ABUT == 90 INTERSECTING ONLY REGION
     W = CO INTERACT Z
    BAD_1 = ENC W M1 < 0.025 ABUT <90 REGION
     BAD_2 = CO NOT M1 
   R1 =      CO INTERACT (BAD_1 OR BAD_2)
   M = FDRC INSIDE CELL '*FR_M1XENX1_M1XEXX1_M1XENX2_*' '*FR_23X4Xa_R23X4Xb_R23X4Xc_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

M1.A.1 {@ Rule M1.A.1: Area: 0.058 
   R1 =     AREA M1 < 0.058
   M = FDRC INSIDE CELL '*FR_M1XAX1_*' '*FR_23X5_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

M1.A.2 {@ Rule M1.A.2: Enclosed area: 0.200
    HOLES M1 < 0.200
}
    
M1.W.3 {@ Rule M1.W.3: Width for 45 metal lines : 0.190 
    INT M1 < 0.190 ABUT <90 ANGLED  REGION
}

M1.S.2 {@ Rule M1.S.2: Space for 45 metal lines: 0.190    
    A = EXT M1i_dg_tO ME1_tO < 0.190 ABUT <90 ANGLED REGION        
    B = EXT M1i_dg_tO M1i    < 0.190 ABUT <90 ANGLED REGION        
    C = B NOT INSIDE SRAM_EXCLUDE                            
    D = B WITH EDGE (B COIN INSIDE EDGE SRAM_EXCLUDE)                
    A OR (C OR D)
}    

M1.PIN.CAD.1 {@ Rule M1.PIN.CAD.1: Metal1 purpose PIN without DRAWING
    M1_pin NOT M1i
}

GROUP M1 M1.?

//  -------------------------------------------------------------------------
//      VIA1  
//  -------------------------------------------------------------------------

VIA1.W.1 {@ Rule VIA1.W.1: Width (width = length, min = max): 0.130
    A = NOT RECTANGLE VIA1 == 0.130 BY == 0.130
    A NOT VIA_EXD
}

VIA1.S.1 {@ Rule VIA1.S.1: Space: 0.150
    EXT VIA1 < 0.150 ABUT <90 SINGULAR REGION
}

VIA1.S.2 {@ Rule VIA1.S.2: VIAi Space to VIAi in an array (VIAi with 3 or more VIAi within < 0.19 um distance): 0.170
    VIA1_array = VIA1 WITH NEIGHBOR >= 3 Space < 0.190
    EXT VIA1_array VIA1 < 0.170 SINGULAR REGION
}

VIA1.EN.1_VIA1.EX.1 {@ Rule VIA1.EN.1: Enclosure of VIAi by Mi : 0.005
                            @ Rule VIA1.EX.1: Mi Extension on VIAi on at least 2 opposite sides: 0.050 
   R1 =     RECTANGLE ENCLOSURE (VIA1 NOT RNGX) M1i OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
   M = FDRC INSIDE CELL '*FR_VIA1XENX1_VIA1XEXX1_*' '*FR_VIA1XENX1_VIA1XEXX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

VIA1.R.1 {@ Rule VIA1.R.1: 45 rotated VIAi not allowed
    ANGLE VIA1 == 45
}

V1_RX = ((VIA1 NOT VIA_EXD) NOT F_V1) NOT R_V1

VIA1.R.5 {@ Rule VIA1.R.5: At least 2 VIAi at space <= 0.29 um (S1), or at least 4 VIAi with space <= 0.57 um (S1') are required to connect Mi and Mi+1 when one of these 2 metals has width 0.42 um (W1) < w <= 0.98 um (W2)
    M1M2_V1R5  =  (M2 AND M1Wide) OR (M1 AND M2Wide)
    v1_R5b     = V1_RX AND M1M2_V1R5
    M1M2_V1R5_C1 = M1M2_V1R5 INTERACT V1_R5b
    M1M2_V1R5_C2 = M2OvpM1 INTERACT M1M2_V1R5_C1
    v1_R5c = V1_RX AND M1M2_V1R5_C2
    
    M1M2_V1R5_A = M1M2_V1R5_C2 INTERACT V1_R5c >=4
    v1_R5c_A = V1_R5c AND M1M2_V1R5_A
    M1M2_V1R5_B = M1M2_V1R5_C2 INTERACT V1_R5c < 4
    v1_R5c_B = V1_R5c AND M1M2_V1R5_B

    good_4v1 = ((SIZE V1_R5c_A BY 0.285 INSIDE OF M1M2_V1R5_C2 STEP 0.1) AND M1M2_V1R5_A) INTERACT V1_R5c_A >=4
    good_2v1 = ((SIZE V1_R5c_B BY 0.145 INSIDE OF M1M2_V1R5_C2 STEP 0.1) AND M1M2_V1R5_B) INTERACT V1_R5c_B >=2
    good_4v1_2 = ((SIZE V1_R5c_A BY 0.145 INSIDE OF M1M2_V1R5_C2 STEP 0.1) AND M1M2_V1R5_A) INTERACT V1_R5c_A >=2

    CHECKED_AREA = M1M2_V1R5_C2 INTERACT ((good_2v1 OR good_4v1) OR good_4v1_2)

    X=(V1_R5c_A OR V1_R5c_B) NOT INTERACT CHECKED_AREA
    X NOT INTERACT (M1Big OR M2Big)
}

VIA1.R.6 {@ Rule VIA1.R.6: At least 4 VIAi at space <= 0.29 um (S2), or at least 9 VIAi with space <= 0.77 um (S2') are required to connect Mi and Mi+1 when one of these 2 metals has width > 0.98 um (W2)
    M1M2_V1R5  =  (M2 AND M1Big) OR (M1 AND M2Big)
    v1_R5b     = V1_RX AND M1M2_V1R5
    M1M2_V1R5_C1 = M1M2_V1R5 INTERACT V1_R5b
    M1M2_V1R5_C2 = M2OvpM1 INTERACT M1M2_V1R5_C1
    v1_R5c = V1_RX AND M1M2_V1R5_C2
    
    M1M2_V1R5_A = M1M2_V1R5_C2 INTERACT V1_R5c >=9
    v1_R5c_A = V1_R5c AND M1M2_V1R5_A
    M1M2_V1R5_B = M1M2_V1R5_C2 INTERACT V1_R5c < 9
    v1_R5c_B = V1_R5c AND M1M2_V1R5_B
    
    good_4v1 = ((SIZE V1_R5c_A BY 0.385 INSIDE OF M1M2_V1R5_C2 STEP 0.1) AND M1M2_V1R5_A) INTERACT V1_R5c_A >=9
    good_2v1 = ((SIZE V1_R5c_B BY 0.145 INSIDE OF M1M2_V1R5_C2 STEP 0.1) AND M1M2_V1R5_B) INTERACT V1_R5c_B >=4 < 9
    good_4v1_2 = ((SIZE V1_R5c_A BY 0.145 INSIDE OF M1M2_V1R5_C2 STEP 0.1) AND M1M2_V1R5_A) INTERACT V1_R5c_A >=4 < 9
    
    CHECKED_AREA = M1M2_V1R5_C2 INTERACT ((good_2v1 OR good_4v1) OR good_4v1_2)

    (V1_R5c_A OR V1_R5c_B)  NOT INTERACT CHECKED_AREA
}

M1Wide_0.700_VIA1 = (SIZE M1 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M1 
M1Wide_2.000_VIA1 = (SIZE M1Wide_0.700_VIA1 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M1Wide_0.700_VIA1 
M1Wide_3.000_VIA1 = (SIZE M1Wide_2.000_VIA1 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M1Wide_2.000_VIA1 
M2Wide_0.700_VIA1 = (SIZE M2 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M2 
M2Wide_2.000_VIA1 = (SIZE M2Wide_0.700_VIA1 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M2Wide_0.700_VIA1 
M2Wide_3.000_VIA1 = (SIZE M2Wide_2.000_VIA1 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M2Wide_2.000_VIA1 

M1Big_3.000_VIA1 = ENCLOSE RECTANGLE M1Wide_3.000_VIA1 3.000 10.005
M2Big_3.000_VIA1 = ENCLOSE RECTANGLE M2Wide_3.000_VIA1 3.000 10.005

VIA1.R.7.1 {@ Rule VIA1.R.7.1: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 1 um (L1) away from a metal plate with height > 0.7 um (H1) and width > 0.7 um (W1)
    BRANCH_M1 = ((SIZE M1Wide_0.700_VIA1 BY 1.000 INSIDE OF M1 STEP 0.08) NOT M1Wide_0.700_VIA1) AND M2
    BAD_BRANCH_M1 = BRANCH_M1 INTERACT VIA1 == 1
    BAD_REGION_M1 = (M2OvpM1 INTERACT BAD_BRANCH_M1) INTERACT VIA1 == 1
    (VIA1 INTERACT BAD_REGION_M1) NOT VIA_EXD

    BRANCH_M2 = ((SIZE M2Wide_0.700_VIA1 BY 1.000 INSIDE OF M2 STEP 0.08) NOT M2Wide_0.700_VIA1) AND M1
    BAD_BRANCH_M2 = BRANCH_M2 INTERACT VIA1 == 1
    BAD_REGION_M2 = (M2OvpM1 INTERACT BAD_BRANCH_M2) INTERACT VIA1 == 1
    (VIA1 INTERACT BAD_REGION_M2) NOT VIA_EXD
}

VIA1.R.7.2 {@ Rule VIA1.R.7.2: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 2 um (L2) away from a metal plate with height > 2 um (H2) and width > 2 um (W2)
    BRANCH_M1 = ((SIZE M1Wide_2.000_VIA1 BY 2.000 INSIDE OF M1 STEP 0.08) NOT M1Wide_2.000_VIA1) AND M2
    BAD_BRANCH_M1 = BRANCH_M1 INTERACT VIA1 == 1
    BAD_REGION_M1 = (M2OvpM1 INTERACT BAD_BRANCH_M1) INTERACT VIA1 == 1
    (VIA1 INTERACT BAD_REGION_M1) NOT VIA_EXD

    BRANCH_M2 = ((SIZE M2Wide_2.000_VIA1 BY 2.000 INSIDE OF M2 STEP 0.08) NOT M2Wide_2.000_VIA1) AND M1
    BAD_BRANCH_M2 = BRANCH_M2 INTERACT VIA1 == 1
    BAD_REGION_M2 = (M2OvpM1 INTERACT BAD_BRANCH_M2) INTERACT VIA1 == 1
    (VIA1 INTERACT BAD_REGION_M2) NOT VIA_EXD
}  

VIA1.R.7.3 {@ Rule VIA1.R.7.3: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 5 um (L3) away from a metal plate with height > 10 um (H3) and width > 3 um (W3)
    BRANCH_M1 = ((SIZE M1Big_3.000_VIA1 BY 5.000 INSIDE OF M1 STEP 0.08) NOT M1Wide_3.000_VIA1) AND M2
    BAD_BRANCH_M1 = BRANCH_M1 INTERACT VIA1 == 1
    BAD_REGION_M1 = (M2OvpM1 INTERACT BAD_BRANCH_M1) INTERACT VIA1 == 1
    (VIA1 INTERACT BAD_REGION_M1) NOT VIA_EXD

    BRANCH_M2 = ((SIZE M2Big_3.000_VIA1 BY 5.000 INSIDE OF M2 STEP 0.08) NOT M2Wide_3.000_VIA1) AND M1
    BAD_BRANCH_M2 = BRANCH_M2 INTERACT VIA1 == 1
    BAD_REGION_M2 = (M2OvpM1 INTERACT BAD_BRANCH_M2) INTERACT VIA1 == 1
    (VIA1 INTERACT BAD_REGION_M2) NOT VIA_EXD
}  

GROUP VIA1 VIA1.?

//  -------------------------------------------------------------------------
//      METAL2  /  M2 
//  -------------------------------------------------------------------------
 
M2.W.1 {@ Rule M2.W.1: Width: 0.140 
    INT M2_dg_tO < 0.140 ABUT <90 SINGULAR 
}

M2.W.2 {@ Rule M2.W.2: Maximum Width: 12.00 
    (SIZE M2 BY 6 UNDEROVER TRUNCATE 6) AND M2
}
    
M2.S.1 {@ Rule M2.S.1: Space: 0.140 
    EXT M2_dg_tO < 0.140 ABUT <90 SINGULAR 
}

ME2_3_1 = (SIZE M2_dg_tO UNDEROVER BY 0.105 TRUNCATE 0.105) AND M2_dg_tO
ME2_3_2 = (SIZE ME2_3_1 UNDEROVER BY 0.75 TRUNCATE 0.75) AND ME2_3_1
ME2_3_4 = (SIZE ME2_3_2 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME2_3_2

M2.S.3.1 {@ Rule M2.S.3.1: Space if at least one metal line width is > 0.21 um (W1) and if the parallel metal run length (between both metals) > 0.52 um (L1): 0.190 
        X = EXT ME2_3_1 M2_dg_tO < 0.190 OPPOSITE MEASURE ALL REGION 
   R1 =     ENCLOSE RECTANGLE X 0.005 0.521
   M = FDRC INSIDE CELL '*FR_M2XSX3X1_*' '*FR_27X2Xb_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

M2.S.3.2 {@ Rule M2.S.3.2: Space if at least one metal line width is > 1.50 um (W2) and if the parallel metal run length (between both metals) > 1.50 um (L2): 0.500 
        X=EXT ME2_3_2 M2_dg_tO < 0.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 1.501
}

M2.S.3.4 {@ Rule M2.S.3.4: Space if at least one metal line width is > 4.50 um (W4) and if the parallel metal run length (between both metals) > 4.50 um (L4): 1.500 
        X=EXT ME2_3_4 M2_dg_tO < 1.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 4.501
}
    
M2.EN.1_M2.EX.1 {@ Rule M2.EN.1: Enclosure of VIAi-1 by Mi: 0.005 
          @ Rule M2.EX.1: Extension on VIAi-1 by Mi on at least 2 opposite sides: 0.050
    RECTANGLE ENCLOSURE (VIA1 NOT RNGX) M2 OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

M2.A.1 {@ Rule M2.A.1: Area: 0.070
    AREA M2 < 0.070
}

M2.A.2 {@ Rule M2.A.2: Enclosed area: 0.200 
    HOLES M2 < 0.200
}
    
M2.W.3 {@ Rule M2.W.3: Width for 45 metal lines: 0.190 
    INT M2 < 0.190 ABUT <90 ANGLED REGION
}

M2.S.2 {@ Rule M2.S.2: Space for 45 metal lines: 0.190 
    EXT M2_dg_tO < 0.190 ABUT <90 ANGLED
}    

M2.PIN.CAD.1 {@ Rule M2.PIN.CAD.1: Metal2 purpose PIN without DRAWING
    M2_pin NOT M2i
}

GROUP M2 M2.?
//  -------------------------------------------------------------------------
//      VIA2  
//  -------------------------------------------------------------------------

VIA2.W.1 {@ Rule VIA2.W.1: Width (width = length, min = max): 0.130
    A = NOT RECTANGLE VIA2 == 0.130 BY == 0.130
    A NOT VIA_EXD
}

VIA2.S.1 {@ Rule VIA2.S.1: Space: 0.150
    EXT VIA2 < 0.150 ABUT <90 SINGULAR REGION
}

VIA2.S.2 {@ Rule VIA2.S.2: VIAi Space to VIAi in an array (VIAi with 3 or more VIAi within < 0.19 um distance): 0.170
    VIA2_array = VIA2 WITH NEIGHBOR >= 3 Space < 0.190
    EXT VIA2_array VIA2 < 0.170 SINGULAR REGION
}

VIA2.EN.1_VIA2.EX.1 {@ Rule VIA2.EN.1: Enclosure of VIAi by Mi : 0.005
                            @ Rule VIA2.EX.1: Mi Extension on VIAi on at least 2 opposite sides: 0.050 
    RECTANGLE ENCLOSURE (VIA2 NOT RNGX) M2i OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

VIA2.R.1 {@ Rule VIA2.R.1: 45 rotated VIAi not allowed
    ANGLE VIA2 == 45
}

V2_RX = ((VIA2 NOT VIA_EXD) NOT F_V2) NOT R_V2

VIA2.R.5 {@ Rule VIA2.R.5: At least 2 VIAi at space <= 0.29 um (S1), or at least 4 VIAi with space <= 0.57 um (S1') are required to connect Mi and Mi+1 when one of these 2 metals has width 0.42 um (W1) < w <= 0.98 um (W2)
    M2M3_V2R5  =  (M3 AND M2Wide) OR (M2 AND M3Wide)
    v2_R5b     = V2_RX AND M2M3_V2R5
    M2M3_V2R5_C2 = M2M3_V2R5 INTERACT V2_R5b
    M2M3_V2R5_C3 = M3OvpM2 INTERACT M2M3_V2R5_C2
    v2_R5c = V2_RX AND M2M3_V2R5_C3
    
    M2M3_V2R5_A = M2M3_V2R5_C3 INTERACT V2_R5c >=4
    v2_R5c_A = V2_R5c AND M2M3_V2R5_A
    M2M3_V2R5_B = M2M3_V2R5_C3 INTERACT V2_R5c < 4
    v2_R5c_B = V2_R5c AND M2M3_V2R5_B

    good_4v2 = ((SIZE V2_R5c_A BY 0.285 INSIDE OF M2M3_V2R5_C3 STEP 0.1) AND M2M3_V2R5_A) INTERACT V2_R5c_A >=4
    good_2v2 = ((SIZE V2_R5c_B BY 0.145 INSIDE OF M2M3_V2R5_C3 STEP 0.1) AND M2M3_V2R5_B) INTERACT V2_R5c_B >=2
    good_4v2_2 = ((SIZE V2_R5c_A BY 0.145 INSIDE OF M2M3_V2R5_C3 STEP 0.1) AND M2M3_V2R5_A) INTERACT V2_R5c_A >=2

    CHECKED_AREA = M2M3_V2R5_C3 INTERACT ((good_2v2 OR good_4v2) OR good_4v2_2)

    X=(V2_R5c_A OR V2_R5c_B) NOT INTERACT CHECKED_AREA
    X NOT INTERACT (M2Big OR M3Big)
}

VIA2.R.6 {@ Rule VIA2.R.6: At least 4 VIAi at space <= 0.29 um (S2), or at least 9 VIAi with space <= 0.77 um (S2') are required to connect Mi and Mi+1 when one of these 2 metals has width > 0.98 um (W2)
    M2M3_V2R5  =  (M3 AND M2Big) OR (M2 AND M3Big)
    v2_R5b     = V2_RX AND M2M3_V2R5
    M2M3_V2R5_C2 = M2M3_V2R5 INTERACT V2_R5b
    M2M3_V2R5_C3 = M3OvpM2 INTERACT M2M3_V2R5_C2
    v2_R5c = V2_RX AND M2M3_V2R5_C3
    
    M2M3_V2R5_A = M2M3_V2R5_C3 INTERACT V2_R5c >=9
    v2_R5c_A = V2_R5c AND M2M3_V2R5_A
    M2M3_V2R5_B = M2M3_V2R5_C3 INTERACT V2_R5c < 9
    v2_R5c_B = V2_R5c AND M2M3_V2R5_B
    
    good_4v2 = ((SIZE V2_R5c_A BY 0.385 INSIDE OF M2M3_V2R5_C3 STEP 0.1) AND M2M3_V2R5_A) INTERACT V2_R5c_A >=9
    good_2v2 = ((SIZE V2_R5c_B BY 0.145 INSIDE OF M2M3_V2R5_C3 STEP 0.1) AND M2M3_V2R5_B) INTERACT V2_R5c_B >=4 < 9
    good_4v2_2 = ((SIZE V2_R5c_A BY 0.145 INSIDE OF M2M3_V2R5_C3 STEP 0.1) AND M2M3_V2R5_A) INTERACT V2_R5c_A >=4 < 9
    
    CHECKED_AREA = M2M3_V2R5_C3 INTERACT ((good_2v2 OR good_4v2) OR good_4v2_2)

    (V2_R5c_A OR V2_R5c_B)  NOT INTERACT CHECKED_AREA
}

M2Wide_0.700_VIA2 = (SIZE M2 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M2 
M2Wide_2.000_VIA2 = (SIZE M2Wide_0.700_VIA2 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M2Wide_0.700_VIA2 
M2Wide_3.000_VIA2 = (SIZE M2Wide_2.000_VIA2 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M2Wide_2.000_VIA2 
M3Wide_0.700_VIA2 = (SIZE M3 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M3 
M3Wide_2.000_VIA2 = (SIZE M3Wide_0.700_VIA2 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M3Wide_0.700_VIA2 
M3Wide_3.000_VIA2 = (SIZE M3Wide_2.000_VIA2 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M3Wide_2.000_VIA2 

M2Big_3.000_VIA2 = ENCLOSE RECTANGLE M2Wide_3.000_VIA2 3.000 10.005
M3Big_3.000_VIA2 = ENCLOSE RECTANGLE M3Wide_3.000_VIA2 3.000 10.005

VIA2.R.7.1 {@ Rule VIA2.R.7.1: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 1 um (L1) away from a metal plate with height > 0.7 um (H1) and width > 0.7 um (W1)
    BRANCH_M2 = ((SIZE M2Wide_0.700_VIA2 BY 1.000 INSIDE OF M2 STEP 0.08) NOT M2Wide_0.700_VIA2) AND M3
    BAD_BRANCH_M2 = BRANCH_M2 INTERACT VIA2 == 1
    BAD_REGION_M2 = (M3OvpM2 INTERACT BAD_BRANCH_M2) INTERACT VIA2 == 1
    (VIA2 INTERACT BAD_REGION_M2) NOT VIA_EXD

    BRANCH_M3 = ((SIZE M3Wide_0.700_VIA2 BY 1.000 INSIDE OF M3 STEP 0.08) NOT M3Wide_0.700_VIA2) AND M2
    BAD_BRANCH_M3 = BRANCH_M3 INTERACT VIA2 == 1
    BAD_REGION_M3 = (M3OvpM2 INTERACT BAD_BRANCH_M3) INTERACT VIA2 == 1
    (VIA2 INTERACT BAD_REGION_M3) NOT VIA_EXD
}

VIA2.R.7.2 {@ Rule VIA2.R.7.2: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 2 um (L2) away from a metal plate with height > 2 um (H2) and width > 2 um (W2)
    BRANCH_M2 = ((SIZE M2Wide_2.000_VIA2 BY 2.000 INSIDE OF M2 STEP 0.08) NOT M2Wide_2.000_VIA2) AND M3
    BAD_BRANCH_M2 = BRANCH_M2 INTERACT VIA2 == 1
    BAD_REGION_M2 = (M3OvpM2 INTERACT BAD_BRANCH_M2) INTERACT VIA2 == 1
    (VIA2 INTERACT BAD_REGION_M2) NOT VIA_EXD

    BRANCH_M3 = ((SIZE M3Wide_2.000_VIA2 BY 2.000 INSIDE OF M3 STEP 0.08) NOT M3Wide_2.000_VIA2) AND M2
    BAD_BRANCH_M3 = BRANCH_M3 INTERACT VIA2 == 1
    BAD_REGION_M3 = (M3OvpM2 INTERACT BAD_BRANCH_M3) INTERACT VIA2 == 1
    (VIA2 INTERACT BAD_REGION_M3) NOT VIA_EXD
}  

VIA2.R.7.3 {@ Rule VIA2.R.7.3: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 5 um (L3) away from a metal plate with height > 10 um (H3) and width > 3 um (W3)
    BRANCH_M2 = ((SIZE M2Big_3.000_VIA2 BY 5.000 INSIDE OF M2 STEP 0.08) NOT M2Wide_3.000_VIA2) AND M3
    BAD_BRANCH_M2 = BRANCH_M2 INTERACT VIA2 == 1
    BAD_REGION_M2 = (M3OvpM2 INTERACT BAD_BRANCH_M2) INTERACT VIA2 == 1
    (VIA2 INTERACT BAD_REGION_M2) NOT VIA_EXD

    BRANCH_M3 = ((SIZE M3Big_3.000_VIA2 BY 5.000 INSIDE OF M3 STEP 0.08) NOT M3Wide_3.000_VIA2) AND M2
    BAD_BRANCH_M3 = BRANCH_M3 INTERACT VIA2 == 1
    BAD_REGION_M3 = (M3OvpM2 INTERACT BAD_BRANCH_M3) INTERACT VIA2 == 1
    (VIA2 INTERACT BAD_REGION_M3) NOT VIA_EXD
}  

GROUP VIA2 VIA2.?

//  -------------------------------------------------------------------------
//      METAL3  /  M3 
//  -------------------------------------------------------------------------
 
M3.W.1 {@ Rule M3.W.1: Width: 0.140 
    INT M3_dg_tO < 0.140 ABUT <90 SINGULAR 
}

M3.W.2 {@ Rule M3.W.2: Maximum Width: 12.00 
    (SIZE M3 BY 6 UNDEROVER TRUNCATE 6) AND M3
}
    
M3.S.1 {@ Rule M3.S.1: Space: 0.140 
    EXT M3_dg_tO < 0.140 ABUT <90 SINGULAR 
}

ME3_3_1 = (SIZE M3_dg_tO UNDEROVER BY 0.105 TRUNCATE 0.105) AND M3_dg_tO
ME3_3_2 = (SIZE ME3_3_1 UNDEROVER BY 0.75 TRUNCATE 0.75) AND ME3_3_1
ME3_3_4 = (SIZE ME3_3_2 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME3_3_2

M3.S.3.1 {@ Rule M3.S.3.1: Space if at least one metal line width is > 0.21 um (W1) and if the parallel metal run length (between both metals) > 0.52 um (L1): 0.190 
        X = EXT ME3_3_1 M3_dg_tO < 0.190 OPPOSITE MEASURE ALL REGION 
    ENCLOSE RECTANGLE X 0.005 0.521
}

M3.S.3.2 {@ Rule M3.S.3.2: Space if at least one metal line width is > 1.50 um (W2) and if the parallel metal run length (between both metals) > 1.50 um (L2): 0.500 
        X=EXT ME3_3_2 M3_dg_tO < 0.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 1.501
}

M3.S.3.4 {@ Rule M3.S.3.4: Space if at least one metal line width is > 4.50 um (W4) and if the parallel metal run length (between both metals) > 4.50 um (L4): 1.500 
        X=EXT ME3_3_4 M3_dg_tO < 1.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 4.501
}
    
M3.EN.1_M3.EX.1 {@ Rule M3.EN.1: Enclosure of VIAi-1 by Mi: 0.005 
          @ Rule M3.EX.1: Extension on VIAi-1 by Mi on at least 2 opposite sides: 0.050
    RECTANGLE ENCLOSURE (VIA2 NOT RNGX) M3 OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

M3.A.1 {@ Rule M3.A.1: Area: 0.070
    AREA M3 < 0.070
}

M3.A.2 {@ Rule M3.A.2: Enclosed area: 0.200 
    HOLES M3 < 0.200
}
    
M3.W.3 {@ Rule M3.W.3: Width for 45 metal lines: 0.190 
    INT M3 < 0.190 ABUT <90 ANGLED REGION
}

M3.S.2 {@ Rule M3.S.2: Space for 45 metal lines: 0.190 
    EXT M3_dg_tO < 0.190 ABUT <90 ANGLED
}    

M3.PIN.CAD.1 {@ Rule M3.PIN.CAD.1: Metal3 purpose PIN without DRAWING
    M3_pin NOT M3i
}

GROUP M3 M3.?
//  -------------------------------------------------------------------------
//      VIA3  
//  -------------------------------------------------------------------------

VIA3.W.1 {@ Rule VIA3.W.1: Width (width = length, min = max): 0.130
    A = NOT RECTANGLE VIA3 == 0.130 BY == 0.130
    A NOT VIA_EXD
}

VIA3.S.1 {@ Rule VIA3.S.1: Space: 0.150
    EXT VIA3 < 0.150 ABUT <90 SINGULAR REGION
}

VIA3.S.2 {@ Rule VIA3.S.2: VIAi Space to VIAi in an array (VIAi with 3 or more VIAi within < 0.19 um distance): 0.170
    VIA3_array = VIA3 WITH NEIGHBOR >= 3 Space < 0.190
    EXT VIA3_array VIA3 < 0.170 SINGULAR REGION
}

VIA3.EN.1_VIA3.EX.1 {@ Rule VIA3.EN.1: Enclosure of VIAi by Mi : 0.005
                            @ Rule VIA3.EX.1: Mi Extension on VIAi on at least 2 opposite sides: 0.050 
    RECTANGLE ENCLOSURE (VIA3 NOT RNGX) M3i OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

VIA3.R.1 {@ Rule VIA3.R.1: 45 rotated VIAi not allowed
    ANGLE VIA3 == 45
}

V3_RX = ((VIA3 NOT VIA_EXD) NOT F_V3) NOT R_V3

VIA3.R.5 {@ Rule VIA3.R.5: At least 2 VIAi at space <= 0.29 um (S1), or at least 4 VIAi with space <= 0.57 um (S1') are required to connect Mi and Mi+1 when one of these 2 metals has width 0.42 um (W1) < w <= 0.98 um (W2)
    M3M4_V3R5  =  (M4 AND M3Wide) OR (M3 AND M4Wide)
    v3_R5b     = V3_RX AND M3M4_V3R5
    M3M4_V3R5_C3 = M3M4_V3R5 INTERACT V3_R5b
    M3M4_V3R5_C4 = M4OvpM3 INTERACT M3M4_V3R5_C3
    v3_R5c = V3_RX AND M3M4_V3R5_C4
    
    M3M4_V3R5_A = M3M4_V3R5_C4 INTERACT V3_R5c >=4
    v3_R5c_A = V3_R5c AND M3M4_V3R5_A
    M3M4_V3R5_B = M3M4_V3R5_C4 INTERACT V3_R5c < 4
    v3_R5c_B = V3_R5c AND M3M4_V3R5_B

    good_4v3 = ((SIZE V3_R5c_A BY 0.285 INSIDE OF M3M4_V3R5_C4 STEP 0.1) AND M3M4_V3R5_A) INTERACT V3_R5c_A >=4
    good_2v3 = ((SIZE V3_R5c_B BY 0.145 INSIDE OF M3M4_V3R5_C4 STEP 0.1) AND M3M4_V3R5_B) INTERACT V3_R5c_B >=2
    good_4v3_2 = ((SIZE V3_R5c_A BY 0.145 INSIDE OF M3M4_V3R5_C4 STEP 0.1) AND M3M4_V3R5_A) INTERACT V3_R5c_A >=2

    CHECKED_AREA = M3M4_V3R5_C4 INTERACT ((good_2v3 OR good_4v3) OR good_4v3_2)

    X=(V3_R5c_A OR V3_R5c_B) NOT INTERACT CHECKED_AREA
    X NOT INTERACT (M3Big OR M4Big)
}

VIA3.R.6 {@ Rule VIA3.R.6: At least 4 VIAi at space <= 0.29 um (S2), or at least 9 VIAi with space <= 0.77 um (S2') are required to connect Mi and Mi+1 when one of these 2 metals has width > 0.98 um (W2)
    M3M4_V3R5  =  (M4 AND M3Big) OR (M3 AND M4Big)
    v3_R5b     = V3_RX AND M3M4_V3R5
    M3M4_V3R5_C3 = M3M4_V3R5 INTERACT V3_R5b
    M3M4_V3R5_C4 = M4OvpM3 INTERACT M3M4_V3R5_C3
    v3_R5c = V3_RX AND M3M4_V3R5_C4
    
    M3M4_V3R5_A = M3M4_V3R5_C4 INTERACT V3_R5c >=9
    v3_R5c_A = V3_R5c AND M3M4_V3R5_A
    M3M4_V3R5_B = M3M4_V3R5_C4 INTERACT V3_R5c < 9
    v3_R5c_B = V3_R5c AND M3M4_V3R5_B
    
    good_4v3 = ((SIZE V3_R5c_A BY 0.385 INSIDE OF M3M4_V3R5_C4 STEP 0.1) AND M3M4_V3R5_A) INTERACT V3_R5c_A >=9
    good_2v3 = ((SIZE V3_R5c_B BY 0.145 INSIDE OF M3M4_V3R5_C4 STEP 0.1) AND M3M4_V3R5_B) INTERACT V3_R5c_B >=4 < 9
    good_4v3_2 = ((SIZE V3_R5c_A BY 0.145 INSIDE OF M3M4_V3R5_C4 STEP 0.1) AND M3M4_V3R5_A) INTERACT V3_R5c_A >=4 < 9
    
    CHECKED_AREA = M3M4_V3R5_C4 INTERACT ((good_2v3 OR good_4v3) OR good_4v3_2)

    (V3_R5c_A OR V3_R5c_B)  NOT INTERACT CHECKED_AREA
}

M3Wide_0.700_VIA3 = (SIZE M3 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M3 
M3Wide_2.000_VIA3 = (SIZE M3Wide_0.700_VIA3 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M3Wide_0.700_VIA3 
M3Wide_3.000_VIA3 = (SIZE M3Wide_2.000_VIA3 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M3Wide_2.000_VIA3 
M4Wide_0.700_VIA3 = (SIZE M4 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M4 
M4Wide_2.000_VIA3 = (SIZE M4Wide_0.700_VIA3 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M4Wide_0.700_VIA3 
M4Wide_3.000_VIA3 = (SIZE M4Wide_2.000_VIA3 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M4Wide_2.000_VIA3 

M3Big_3.000_VIA3 = ENCLOSE RECTANGLE M3Wide_3.000_VIA3 3.000 10.005
M4Big_3.000_VIA3 = ENCLOSE RECTANGLE M4Wide_3.000_VIA3 3.000 10.005

VIA3.R.7.1 {@ Rule VIA3.R.7.1: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 1 um (L1) away from a metal plate with height > 0.7 um (H1) and width > 0.7 um (W1)
    BRANCH_M3 = ((SIZE M3Wide_0.700_VIA3 BY 1.000 INSIDE OF M3 STEP 0.08) NOT M3Wide_0.700_VIA3) AND M4
    BAD_BRANCH_M3 = BRANCH_M3 INTERACT VIA3 == 1
    BAD_REGION_M3 = (M4OvpM3 INTERACT BAD_BRANCH_M3) INTERACT VIA3 == 1
    (VIA3 INTERACT BAD_REGION_M3) NOT VIA_EXD

    BRANCH_M4 = ((SIZE M4Wide_0.700_VIA3 BY 1.000 INSIDE OF M4 STEP 0.08) NOT M4Wide_0.700_VIA3) AND M3
    BAD_BRANCH_M4 = BRANCH_M4 INTERACT VIA3 == 1
    BAD_REGION_M4 = (M4OvpM3 INTERACT BAD_BRANCH_M4) INTERACT VIA3 == 1
    (VIA3 INTERACT BAD_REGION_M4) NOT VIA_EXD
}

VIA3.R.7.2 {@ Rule VIA3.R.7.2: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 2 um (L2) away from a metal plate with height > 2 um (H2) and width > 2 um (W2)
    BRANCH_M3 = ((SIZE M3Wide_2.000_VIA3 BY 2.000 INSIDE OF M3 STEP 0.08) NOT M3Wide_2.000_VIA3) AND M4
    BAD_BRANCH_M3 = BRANCH_M3 INTERACT VIA3 == 1
    BAD_REGION_M3 = (M4OvpM3 INTERACT BAD_BRANCH_M3) INTERACT VIA3 == 1
    (VIA3 INTERACT BAD_REGION_M3) NOT VIA_EXD

    BRANCH_M4 = ((SIZE M4Wide_2.000_VIA3 BY 2.000 INSIDE OF M4 STEP 0.08) NOT M4Wide_2.000_VIA3) AND M3
    BAD_BRANCH_M4 = BRANCH_M4 INTERACT VIA3 == 1
    BAD_REGION_M4 = (M4OvpM3 INTERACT BAD_BRANCH_M4) INTERACT VIA3 == 1
    (VIA3 INTERACT BAD_REGION_M4) NOT VIA_EXD
}  

VIA3.R.7.3 {@ Rule VIA3.R.7.3: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 5 um (L3) away from a metal plate with height > 10 um (H3) and width > 3 um (W3)
    BRANCH_M3 = ((SIZE M3Big_3.000_VIA3 BY 5.000 INSIDE OF M3 STEP 0.08) NOT M3Wide_3.000_VIA3) AND M4
    BAD_BRANCH_M3 = BRANCH_M3 INTERACT VIA3 == 1
    BAD_REGION_M3 = (M4OvpM3 INTERACT BAD_BRANCH_M3) INTERACT VIA3 == 1
    (VIA3 INTERACT BAD_REGION_M3) NOT VIA_EXD

    BRANCH_M4 = ((SIZE M4Big_3.000_VIA3 BY 5.000 INSIDE OF M4 STEP 0.08) NOT M4Wide_3.000_VIA3) AND M3
    BAD_BRANCH_M4 = BRANCH_M4 INTERACT VIA3 == 1
    BAD_REGION_M4 = (M4OvpM3 INTERACT BAD_BRANCH_M4) INTERACT VIA3 == 1
    (VIA3 INTERACT BAD_REGION_M4) NOT VIA_EXD
}  

GROUP VIA3 VIA3.?

//  -------------------------------------------------------------------------
//      METAL4  /  M4 
//  -------------------------------------------------------------------------
 
M4.W.1 {@ Rule M4.W.1: Width: 0.140 
    INT M4_dg_tO < 0.140 ABUT <90 SINGULAR 
}

M4.W.2 {@ Rule M4.W.2: Maximum Width: 12.00 
    (SIZE M4 BY 6 UNDEROVER TRUNCATE 6) AND M4
}
    
M4.S.1 {@ Rule M4.S.1: Space: 0.140 
    EXT M4_dg_tO < 0.140 ABUT <90 SINGULAR 
}

ME4_3_1 = (SIZE M4_dg_tO UNDEROVER BY 0.105 TRUNCATE 0.105) AND M4_dg_tO
ME4_3_2 = (SIZE ME4_3_1 UNDEROVER BY 0.75 TRUNCATE 0.75) AND ME4_3_1
ME4_3_4 = (SIZE ME4_3_2 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME4_3_2

M4.S.3.1 {@ Rule M4.S.3.1: Space if at least one metal line width is > 0.21 um (W1) and if the parallel metal run length (between both metals) > 0.52 um (L1): 0.190 
        X = EXT ME4_3_1 M4_dg_tO < 0.190 OPPOSITE MEASURE ALL REGION 
    ENCLOSE RECTANGLE X 0.005 0.521
}

M4.S.3.2 {@ Rule M4.S.3.2: Space if at least one metal line width is > 1.50 um (W2) and if the parallel metal run length (between both metals) > 1.50 um (L2): 0.500 
        X=EXT ME4_3_2 M4_dg_tO < 0.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 1.501
}

M4.S.3.4 {@ Rule M4.S.3.4: Space if at least one metal line width is > 4.50 um (W4) and if the parallel metal run length (between both metals) > 4.50 um (L4): 1.500 
        X=EXT ME4_3_4 M4_dg_tO < 1.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 4.501
}
    
M4.EN.1_M4.EX.1 {@ Rule M4.EN.1: Enclosure of VIAi-1 by Mi: 0.005 
          @ Rule M4.EX.1: Extension on VIAi-1 by Mi on at least 2 opposite sides: 0.050
    RECTANGLE ENCLOSURE (VIA3 NOT RNGX) M4 OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

M4.A.1 {@ Rule M4.A.1: Area: 0.070
    AREA M4 < 0.070
}

M4.A.2 {@ Rule M4.A.2: Enclosed area: 0.200 
    HOLES M4 < 0.200
}
    
M4.W.3 {@ Rule M4.W.3: Width for 45 metal lines: 0.190 
    INT M4 < 0.190 ABUT <90 ANGLED REGION
}

M4.S.2 {@ Rule M4.S.2: Space for 45 metal lines: 0.190 
    EXT M4_dg_tO < 0.190 ABUT <90 ANGLED
}    

M4.PIN.CAD.1 {@ Rule M4.PIN.CAD.1: Metal4 purpose PIN without DRAWING
    M4_pin NOT M4i
}

GROUP M4 M4.?
//  -------------------------------------------------------------------------
//      VIA4  
//  -------------------------------------------------------------------------

VIA4.W.1 {@ Rule VIA4.W.1: Width (width = length, min = max): 0.130
    A = NOT RECTANGLE VIA4 == 0.130 BY == 0.130
    A NOT VIA_EXD
}

VIA4.S.1 {@ Rule VIA4.S.1: Space: 0.150
    EXT VIA4 < 0.150 ABUT <90 SINGULAR REGION
}

VIA4.S.2 {@ Rule VIA4.S.2: VIAi Space to VIAi in an array (VIAi with 3 or more VIAi within < 0.19 um distance): 0.170
    VIA4_array = VIA4 WITH NEIGHBOR >= 3 Space < 0.190
    EXT VIA4_array VIA4 < 0.170 SINGULAR REGION
}

VIA4.EN.1_VIA4.EX.1 {@ Rule VIA4.EN.1: Enclosure of VIAi by Mi : 0.005
                            @ Rule VIA4.EX.1: Mi Extension on VIAi on at least 2 opposite sides: 0.050 
    RECTANGLE ENCLOSURE (VIA4 NOT RNGX) M4i OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

VIA4.R.1 {@ Rule VIA4.R.1: 45 rotated VIAi not allowed
    ANGLE VIA4 == 45
}

V4_RX = ((VIA4 NOT VIA_EXD) NOT F_V4) NOT R_V4

VIA4.R.5 {@ Rule VIA4.R.5: At least 2 VIAi at space <= 0.29 um (S1), or at least 4 VIAi with space <= 0.57 um (S1') are required to connect Mi and Mi+1 when one of these 2 metals has width 0.42 um (W1) < w <= 0.98 um (W2)
    M4M5_V4R5  =  (M5 AND M4Wide) OR (M4 AND M5Wide)
    v4_R5b     = V4_RX AND M4M5_V4R5
    M4M5_V4R5_C4 = M4M5_V4R5 INTERACT V4_R5b
    M4M5_V4R5_C5 = M5OvpM4 INTERACT M4M5_V4R5_C4
    v4_R5c = V4_RX AND M4M5_V4R5_C5
    
    M4M5_V4R5_A = M4M5_V4R5_C5 INTERACT V4_R5c >=4
    v4_R5c_A = V4_R5c AND M4M5_V4R5_A
    M4M5_V4R5_B = M4M5_V4R5_C5 INTERACT V4_R5c < 4
    v4_R5c_B = V4_R5c AND M4M5_V4R5_B

    good_4v4 = ((SIZE V4_R5c_A BY 0.285 INSIDE OF M4M5_V4R5_C5 STEP 0.1) AND M4M5_V4R5_A) INTERACT V4_R5c_A >=4
    good_2v4 = ((SIZE V4_R5c_B BY 0.145 INSIDE OF M4M5_V4R5_C5 STEP 0.1) AND M4M5_V4R5_B) INTERACT V4_R5c_B >=2
    good_4v4_2 = ((SIZE V4_R5c_A BY 0.145 INSIDE OF M4M5_V4R5_C5 STEP 0.1) AND M4M5_V4R5_A) INTERACT V4_R5c_A >=2

    CHECKED_AREA = M4M5_V4R5_C5 INTERACT ((good_2v4 OR good_4v4) OR good_4v4_2)

    X=(V4_R5c_A OR V4_R5c_B) NOT INTERACT CHECKED_AREA
    X NOT INTERACT (M4Big OR M5Big)
}

VIA4.R.6 {@ Rule VIA4.R.6: At least 4 VIAi at space <= 0.29 um (S2), or at least 9 VIAi with space <= 0.77 um (S2') are required to connect Mi and Mi+1 when one of these 2 metals has width > 0.98 um (W2)
    M4M5_V4R5  =  (M5 AND M4Big) OR (M4 AND M5Big)
    v4_R5b     = V4_RX AND M4M5_V4R5
    M4M5_V4R5_C4 = M4M5_V4R5 INTERACT V4_R5b
    M4M5_V4R5_C5 = M5OvpM4 INTERACT M4M5_V4R5_C4
    v4_R5c = V4_RX AND M4M5_V4R5_C5
    
    M4M5_V4R5_A = M4M5_V4R5_C5 INTERACT V4_R5c >=9
    v4_R5c_A = V4_R5c AND M4M5_V4R5_A
    M4M5_V4R5_B = M4M5_V4R5_C5 INTERACT V4_R5c < 9
    v4_R5c_B = V4_R5c AND M4M5_V4R5_B
    
    good_4v4 = ((SIZE V4_R5c_A BY 0.385 INSIDE OF M4M5_V4R5_C5 STEP 0.1) AND M4M5_V4R5_A) INTERACT V4_R5c_A >=9
    good_2v4 = ((SIZE V4_R5c_B BY 0.145 INSIDE OF M4M5_V4R5_C5 STEP 0.1) AND M4M5_V4R5_B) INTERACT V4_R5c_B >=4 < 9
    good_4v4_2 = ((SIZE V4_R5c_A BY 0.145 INSIDE OF M4M5_V4R5_C5 STEP 0.1) AND M4M5_V4R5_A) INTERACT V4_R5c_A >=4 < 9
    
    CHECKED_AREA = M4M5_V4R5_C5 INTERACT ((good_2v4 OR good_4v4) OR good_4v4_2)

    (V4_R5c_A OR V4_R5c_B)  NOT INTERACT CHECKED_AREA
}

M4Wide_0.700_VIA4 = (SIZE M4 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M4 
M4Wide_2.000_VIA4 = (SIZE M4Wide_0.700_VIA4 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M4Wide_0.700_VIA4 
M4Wide_3.000_VIA4 = (SIZE M4Wide_2.000_VIA4 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M4Wide_2.000_VIA4 
M5Wide_0.700_VIA4 = (SIZE M5 BY 0.700/2 UNDEROVER TRUNCATE 0.700/2) AND M5 
M5Wide_2.000_VIA4 = (SIZE M5Wide_0.700_VIA4 BY 2.000/2 UNDEROVER TRUNCATE 2.000/2) AND M5Wide_0.700_VIA4 
M5Wide_3.000_VIA4 = (SIZE M5Wide_2.000_VIA4 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M5Wide_2.000_VIA4 

M4Big_3.000_VIA4 = ENCLOSE RECTANGLE M4Wide_3.000_VIA4 3.000 10.005
M5Big_3.000_VIA4 = ENCLOSE RECTANGLE M5Wide_3.000_VIA4 3.000 10.005

VIA4.R.7.1 {@ Rule VIA4.R.7.1: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 1 um (L1) away from a metal plate with height > 0.7 um (H1) and width > 0.7 um (W1)
    BRANCH_M4 = ((SIZE M4Wide_0.700_VIA4 BY 1.000 INSIDE OF M4 STEP 0.08) NOT M4Wide_0.700_VIA4) AND M5
    BAD_BRANCH_M4 = BRANCH_M4 INTERACT VIA4 == 1
    BAD_REGION_M4 = (M5OvpM4 INTERACT BAD_BRANCH_M4) INTERACT VIA4 == 1
    (VIA4 INTERACT BAD_REGION_M4) NOT VIA_EXD

    BRANCH_M5 = ((SIZE M5Wide_0.700_VIA4 BY 1.000 INSIDE OF M5 STEP 0.08) NOT M5Wide_0.700_VIA4) AND M4
    BAD_BRANCH_M5 = BRANCH_M5 INTERACT VIA4 == 1
    BAD_REGION_M5 = (M5OvpM4 INTERACT BAD_BRANCH_M5) INTERACT VIA4 == 1
    (VIA4 INTERACT BAD_REGION_M5) NOT VIA_EXD
}

VIA4.R.7.2 {@ Rule VIA4.R.7.2: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 2 um (L2) away from a metal plate with height > 2 um (H2) and width > 2 um (W2)
    BRANCH_M4 = ((SIZE M4Wide_2.000_VIA4 BY 2.000 INSIDE OF M4 STEP 0.08) NOT M4Wide_2.000_VIA4) AND M5
    BAD_BRANCH_M4 = BRANCH_M4 INTERACT VIA4 == 1
    BAD_REGION_M4 = (M5OvpM4 INTERACT BAD_BRANCH_M4) INTERACT VIA4 == 1
    (VIA4 INTERACT BAD_REGION_M4) NOT VIA_EXD

    BRANCH_M5 = ((SIZE M5Wide_2.000_VIA4 BY 2.000 INSIDE OF M5 STEP 0.08) NOT M5Wide_2.000_VIA4) AND M4
    BAD_BRANCH_M5 = BRANCH_M5 INTERACT VIA4 == 1
    BAD_REGION_M5 = (M5OvpM4 INTERACT BAD_BRANCH_M5) INTERACT VIA4 == 1
    (VIA4 INTERACT BAD_REGION_M5) NOT VIA_EXD
}  

VIA4.R.7.3 {@ Rule VIA4.R.7.3: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 5 um (L3) away from a metal plate with height > 10 um (H3) and width > 3 um (W3)
    BRANCH_M4 = ((SIZE M4Big_3.000_VIA4 BY 5.000 INSIDE OF M4 STEP 0.08) NOT M4Wide_3.000_VIA4) AND M5
    BAD_BRANCH_M4 = BRANCH_M4 INTERACT VIA4 == 1
    BAD_REGION_M4 = (M5OvpM4 INTERACT BAD_BRANCH_M4) INTERACT VIA4 == 1
    (VIA4 INTERACT BAD_REGION_M4) NOT VIA_EXD

    BRANCH_M5 = ((SIZE M5Big_3.000_VIA4 BY 5.000 INSIDE OF M5 STEP 0.08) NOT M5Wide_3.000_VIA4) AND M4
    BAD_BRANCH_M5 = BRANCH_M5 INTERACT VIA4 == 1
    BAD_REGION_M5 = (M5OvpM4 INTERACT BAD_BRANCH_M5) INTERACT VIA4 == 1
    (VIA4 INTERACT BAD_REGION_M5) NOT VIA_EXD
}  

GROUP VIA4 VIA4.?
#IFDEF ISOLATED_VIAS_RULES
//------------------------------------------------------------------------------
// Lonely via detection (temporary implementation)
//------------------------------------------------------------------------------

// Nr of Viax <= 9 in a 30um sized Viax area

VIA1_ISLAND_30 = SIZE VIA1 BY 30
VIA2_ISLAND_30 = SIZE VIA2 BY 30
VIA3_ISLAND_30 = SIZE VIA3 BY 30
VIA4_ISLAND_30 = SIZE VIA4 BY 30        

VIA1_30 {@ LON-VIA1_30: Minimum number of VIA1 inside {VIA1 upsized by 30um} : 10
    (ENCLOSE VIA1_ISLAND_30 VIA1 <= 9) AND VIA1 }

VIA2_30 {@ LON-VIA2_30: Minimum number of VIA2 inside {VIA2 upsized by 30um} : 10
    (ENCLOSE VIA2_ISLAND_30 VIA2 <= 9) AND VIA2 }

VIA3_30 {@ LON-VIA3_30: Minimum number of VIA3 inside {VIA3 upsized by 30um} : 10
    (ENCLOSE VIA3_ISLAND_30 VIA3 <= 9) AND VIA3 }

VIA4_30 {@ LON-VIA4_30: Minimum number of VIA4 inside {VIA4 upsized by 30um} : 10
    (ENCLOSE VIA4_ISLAND_30 VIA4 <= 9) AND VIA4 }

// lonely via detection end
#ENDIF

//  -------------------------------------------------------------------------
//      METAL5  /  M5 
//  -------------------------------------------------------------------------
 
M5.W.1 {@ Rule M5.W.1: Width: 0.140 
    INT M5_dg_tO < 0.140 ABUT <90 SINGULAR 
}

M5.W.2 {@ Rule M5.W.2: Maximum Width: 12.00 
    (SIZE M5 BY 6 UNDEROVER TRUNCATE 6) AND M5
}
    
M5.S.1 {@ Rule M5.S.1: Space: 0.140 
    EXT M5_dg_tO < 0.140 ABUT <90 SINGULAR 
}

ME5_3_1 = (SIZE M5_dg_tO UNDEROVER BY 0.105 TRUNCATE 0.105) AND M5_dg_tO
ME5_3_2 = (SIZE ME5_3_1 UNDEROVER BY 0.75 TRUNCATE 0.75) AND ME5_3_1
ME5_3_4 = (SIZE ME5_3_2 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME5_3_2

M5.S.3.1 {@ Rule M5.S.3.1: Space if at least one metal line width is > 0.21 um (W1) and if the parallel metal run length (between both metals) > 0.52 um (L1): 0.190 
        X = EXT ME5_3_1 M5_dg_tO < 0.190 OPPOSITE MEASURE ALL REGION 
    ENCLOSE RECTANGLE X 0.005 0.521
}

M5.S.3.2 {@ Rule M5.S.3.2: Space if at least one metal line width is > 1.50 um (W2) and if the parallel metal run length (between both metals) > 1.50 um (L2): 0.500 
        X=EXT ME5_3_2 M5_dg_tO < 0.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 1.501
}

M5.S.3.4 {@ Rule M5.S.3.4: Space if at least one metal line width is > 4.50 um (W4) and if the parallel metal run length (between both metals) > 4.50 um (L4): 1.500 
        X=EXT ME5_3_4 M5_dg_tO < 1.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 4.501
}
    
M5.EN.1_M5.EX.1 {@ Rule M5.EN.1: Enclosure of VIAi-1 by Mi: 0.005 
          @ Rule M5.EX.1: Extension on VIAi-1 by Mi on at least 2 opposite sides: 0.050
    RECTANGLE ENCLOSURE (VIA4 NOT RNGX) M5 OUTSIDE ALSO SINGULAR GOOD 0.005 0.050 OPPOSITE 0.005 0.050 OPPOSITE
}

M5.A.1 {@ Rule M5.A.1: Area: 0.070
    AREA M5 < 0.070
}

M5.A.2 {@ Rule M5.A.2: Enclosed area: 0.200 
    HOLES M5 < 0.200
}
    
M5.W.3 {@ Rule M5.W.3: Width for 45 metal lines: 0.190 
    INT M5 < 0.190 ABUT <90 ANGLED REGION
}

M5.S.2 {@ Rule M5.S.2: Space for 45 metal lines: 0.190 
    EXT M5_dg_tO < 0.190 ABUT <90 ANGLED
}    

M5.PIN.CAD.1 {@ Rule M5.PIN.CAD.1: Metal5 purpose PIN without DRAWING
    M5_pin NOT M5i
}

GROUP M5 M5.?



//  -------------------------------------------------------------------------
//      VIA5
//  -------------------------------------------------------------------------

VIA5.W.1 {@ Rule VIA5.W.1: Width (width = length, min = max): 0.360
    A = NOT RECTANGLE VIA5 == 0.360 BY == 0.360
    A NOT VIA_EXD
}

VIA5.S.1 {@ Rule VIA5.S.1: Space : 0.340 
    EXT VIA5 < 0.340 ABUT <90 SINGULAR REGION
}

VIA5.S.2 {@ Rule VIA5.S.2: Space to VIAi in an array (VIAi with 3 or more VIAi within < 0.56 um distance): 0.540
    VIA5_array = VIA5 WITH NEIGHBOR >= 3 Space < 0.560
    EXT VIA5_array VIA5 < 0.540 SINGULAR REGION
}

VIA5.EN.1_VIA5.EX.1 {@ Rule VIA5.EN.1: Enclosure of VIAi by Mi (Metal under VIAi) : 0.030  
             @ Rule VIA5.EX.1: Mi (Metal under VIAi) Extension on VIAi on at least 2 opposite sides: 0.080
    RECTANGLE ENCLOSURE (VIA5 NOT RNGX ) M5 OUTSIDE ALSO SINGULAR GOOD 0.030 0.080 OPPOSITE 0.030 0.080 OPPOSITE
}

VIA5.R.1 {@ Rule VIA5.R.1: 45 rotated VIAi not allowed
    ANGLE VIA5 == 45
}

VIA5.R.4 {@ Rule VIA5.R.4: At least 2 VIAi with space <= 1.7 um (S1) are required to connect Mi and Mi+1 when one of these 2 metals has width > 1.8 um (W1)
       M6OvpM5W = M6 AND M5Huge
       Checked_VIA5 = (((VIA5 NOT VIA_EXD) NOT F_V5) NOT R_V5) NOT OUTSIDE M6OvpM5W
       V5Merged = (SIZE (((VIA5 NOT VIA_EXD) NOT F_V5) NOT R_V5) BY 0.85) AND M6OvpM5
       GM6OvpM5W_B = V5Merged ENCLOSE (((VIA5 NOT VIA_EXD) NOT F_V5) NOT R_V5) > 1
       Checked_VIA5 OUTSIDE GM6OvpM5W_B

       M5OvpM6W = M5 AND M6Huge
       Checked_VIA5_2 = (((VIA5 NOT VIA_EXD) NOT F_V5) NOT R_V5) NOT OUTSIDE M5OvpM6W
       GM5OvpM6W_B = V5Merged ENCLOSE (((VIA5 NOT VIA_EXD) NOT F_V5) NOT R_V5) > 1
       Checked_VIA5_2 OUTSIDE GM5OvpM6W_B
}

M5Wide_3.000_VIA5 = (SIZE M5 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M5
M6Wide_3.000_VIA5 = (SIZE M6 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M6

M5Big_3.000_VIA5 = ENCLOSE RECTANGLE M5Wide_3.000_VIA5 3.000 10.005
M6Big_3.000_VIA5 = ENCLOSE RECTANGLE M6Wide_3.000_VIA5 3.000 10.005

VIA5.R.5 {@ Rule VIA5.R.5: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 5 um (L2) away from a metal plate with height > 10 um (H2) and width > 3 um (W2)
    BRANCH_M5 = ((SIZE M5Big_3.000_VIA5 BY 5.000 INSIDE OF M5 STEP 0.08) NOT M5Wide_3.000_VIA5) AND M6
    BAD_BRANCH_M5 = BRANCH_M5 INTERACT VIA5 == 1
    BAD_REGION_M5 = (M6OvpM5 INTERACT BAD_BRANCH_M5) INTERACT VIA5 == 1
    (VIA5 INTERACT BAD_REGION_M5) NOT VIA_EXD

    BRANCH_M6 = ((SIZE M6Big_3.000_VIA5 BY 5.000 INSIDE OF M6 STEP 0.08) NOT M6Wide_3.000_VIA5) AND M5
    BAD_BRANCH_M6 = BRANCH_M6 INTERACT VIA5 == 1
    BAD_REGION_M6 = (M6OvpM5 INTERACT BAD_BRANCH_M6) INTERACT VIA5 == 1
    (VIA5 INTERACT BAD_REGION_M6) NOT VIA_EXD
}

GROUP VIA5 VIA5.?

//  -------------------------------------------------------------------------
//      METAL6  
//  -------------------------------------------------------------------------

M6.W.1 {@ Rule M6.W.1: Width: 0.420 
    INT M6 < 0.420 ABUT <90 SINGULAR REGION
}

M6.S.1 {@ Rule M6.S.1: Space : 0.420 
    EXT M6 < 0.420 ABUT <90 SINGULAR REGION
}

ME6_3_1 = (SIZE M6 UNDEROVER BY 0.75 TRUNCATE 0.75) AND M6
ME6_3_3 = (SIZE ME6_3_1 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME6_3_1

M6.S.3.1 {@ Rule M6.S.3.1: Space if at least one metal line width is > 1.50 um (W1) and if the parallel metal run length (between both metals) > 1.50 um (L1): 0.500
    X=EXT ME6_3_1 M6 < 0.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 1.501
}

M6.S.3.3 {@ Rule M6.S.3.3: Space if at least one metal line width is > 4.50 um (W3) and if the parallel metal run length (between both metals) > 4.50 um (L3): 1.500
        X=EXT ME6_3_3 M6 < 1.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 4.501
}

M6.EN.1_M6.EX.1 {@ Rule M6.EN.1: Enclosure of VIAi-1 by Mi: 0.030
         @ Rule M6.EX.1: Enclosure of VIAi-1 by Mi: 0.080
    RECTANGLE ENCLOSURE (VIA5 NOT RNGX) M6 OUTSIDE ALSO SINGULAR GOOD 0.030 0.080 OPPOSITE 0.030 0.080 OPPOSITE
}

M6.A.1 {@ Rule M6.A.1: Area : 0.565
    AREA M6 < 0.565
}

M6.A.2 {@ Rule M6.A.2: Enclosed area: 0.565 
    HOLES M6 < 0.565
}

M6.PIN.CAD.1 {@ Rule M6.PIN.CAD.1: Metal6 purpose PIN without DRAWING
    M6_pin NOT M6i
}

GROUP M6 M6.?

//  -------------------------------------------------------------------------
//      VIA6
//  -------------------------------------------------------------------------

VIA6.W.1 {@ Rule VIA6.W.1: Width (width = length, min = max): 0.360
    A = NOT RECTANGLE VIA6 == 0.360 BY == 0.360
    A NOT VIA_EXD
}

VIA6.S.1 {@ Rule VIA6.S.1: Space : 0.340 
    EXT VIA6 < 0.340 ABUT <90 SINGULAR REGION
}

VIA6.S.2 {@ Rule VIA6.S.2: Space to VIAi in an array (VIAi with 3 or more VIAi within < 0.56 um distance): 0.540
    VIA6_array = VIA6 WITH NEIGHBOR >= 3 Space < 0.560
    EXT VIA6_array VIA6 < 0.540 SINGULAR REGION
}

VIA6.EN.1_VIA6.EX.1 {@ Rule VIA6.EN.1: Enclosure of VIAi by Mi (Metal under VIAi) : 0.030  
             @ Rule VIA6.EX.1: Mi (Metal under VIAi) Extension on VIAi on at least 2 opposite sides: 0.080
    RECTANGLE ENCLOSURE (VIA6 NOT RNGX ) M6 OUTSIDE ALSO SINGULAR GOOD 0.030 0.080 OPPOSITE 0.030 0.080 OPPOSITE
}

VIA6.R.1 {@ Rule VIA6.R.1: 45 rotated VIAi not allowed
    ANGLE VIA6 == 45
}

VIA6.R.4 {@ Rule VIA6.R.4: At least 2 VIAi with space <= 1.7 um (S1) are required to connect Mi and Mi+1 when one of these 2 metals has width > 1.8 um (W1)
       M7OvpM6W = M7 AND M6Huge
       Checked_VIA6 = (((VIA6 NOT VIA_EXD) NOT F_V6) NOT R_V6) NOT OUTSIDE M7OvpM6W
       V6Merged = (SIZE (((VIA6 NOT VIA_EXD) NOT F_V6) NOT R_V6) BY 0.85) AND M7OvpM6
       GM7OvpM6W_B = V6Merged ENCLOSE (((VIA6 NOT VIA_EXD) NOT F_V6) NOT R_V6) > 1
       Checked_VIA6 OUTSIDE GM7OvpM6W_B

       M6OvpM7W = M6 AND M7Huge
       Checked_VIA6_2 = (((VIA6 NOT VIA_EXD) NOT F_V6) NOT R_V6) NOT OUTSIDE M6OvpM7W
       GM6OvpM7W_B = V6Merged ENCLOSE (((VIA6 NOT VIA_EXD) NOT F_V6) NOT R_V6) > 1
       Checked_VIA6_2 OUTSIDE GM6OvpM7W_B
}

M6Wide_3.000_VIA6 = (SIZE M6 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M6
M7Wide_3.000_VIA6 = (SIZE M7 BY 3.000/2 UNDEROVER TRUNCATE 3.000/2) AND M7

M6Big_3.000_VIA6 = ENCLOSE RECTANGLE M6Wide_3.000_VIA6 3.000 10.005
M7Big_3.000_VIA6 = ENCLOSE RECTANGLE M7Wide_3.000_VIA6 3.000 10.005

VIA6.R.5 {@ Rule VIA6.R.5: At least 2 VIAi within the same Mi/Mi+1 intersection must be used for a connection that has a VIAi <= 5 um (L2) away from a metal plate with height > 10 um (H2) and width > 3 um (W2)
    BRANCH_M6 = ((SIZE M6Big_3.000_VIA6 BY 5.000 INSIDE OF M6 STEP 0.08) NOT M6Wide_3.000_VIA6) AND M7
    BAD_BRANCH_M6 = BRANCH_M6 INTERACT VIA6 == 1
    BAD_REGION_M6 = (M7OvpM6 INTERACT BAD_BRANCH_M6) INTERACT VIA6 == 1
    (VIA6 INTERACT BAD_REGION_M6) NOT VIA_EXD

    BRANCH_M7 = ((SIZE M7Big_3.000_VIA6 BY 5.000 INSIDE OF M7 STEP 0.08) NOT M7Wide_3.000_VIA6) AND M6
    BAD_BRANCH_M7 = BRANCH_M7 INTERACT VIA6 == 1
    BAD_REGION_M7 = (M7OvpM6 INTERACT BAD_BRANCH_M7) INTERACT VIA6 == 1
    (VIA6 INTERACT BAD_REGION_M7) NOT VIA_EXD
}

GROUP VIA6 VIA6.?

//  -------------------------------------------------------------------------
//      METAL7  
//  -------------------------------------------------------------------------

M7.W.1 {@ Rule M7.W.1: Width: 0.420 
    INT M7 < 0.420 ABUT <90 SINGULAR REGION
}

M7.S.1 {@ Rule M7.S.1: Space : 0.420 
    EXT M7 < 0.420 ABUT <90 SINGULAR REGION
}

ME7_3_1 = (SIZE M7 UNDEROVER BY 0.75 TRUNCATE 0.75) AND M7
ME7_3_3 = (SIZE ME7_3_1 UNDEROVER BY 2.25 TRUNCATE 2.25) AND ME7_3_1

M7.S.3.1 {@ Rule M7.S.3.1: Space if at least one metal line width is > 1.50 um (W1) and if the parallel metal run length (between both metals) > 1.50 um (L1): 0.500
    X=EXT ME7_3_1 M7 < 0.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 1.501
}

M7.S.3.3 {@ Rule M7.S.3.3: Space if at least one metal line width is > 4.50 um (W3) and if the parallel metal run length (between both metals) > 4.50 um (L3): 1.500
        X=EXT ME7_3_3 M7 < 1.500 OPPOSITE MEASURE ALL REGION  
    ENCLOSE RECTANGLE X 0.005 4.501
}

M7.EN.1_M7.EX.1 {@ Rule M7.EN.1: Enclosure of VIAi-1 by Mi: 0.030
         @ Rule M7.EX.1: Enclosure of VIAi-1 by Mi: 0.080
    RECTANGLE ENCLOSURE (VIA6 NOT RNGX) M7 OUTSIDE ALSO SINGULAR GOOD 0.030 0.080 OPPOSITE 0.030 0.080 OPPOSITE
}

M7.A.1 {@ Rule M7.A.1: Area : 0.565
    AREA M7 < 0.565
}

M7.A.2 {@ Rule M7.A.2: Enclosed area: 0.565 
    HOLES M7 < 0.565
}

M7.PIN.CAD.1 {@ Rule M7.PIN.CAD.1: Metal7 purpose PIN without DRAWING
    M7_pin NOT M7i
}

GROUP M7 M7.?

//  -------------------------------------------------------------------------
//        MSUB
//  -------------------------------------------------------------------------

MSUB.CAD.EN.1 {@ Rule MSUB.CAD.EN.1: Enclosure of NW: 0.000
    (MSUB_0 INSIDE EDGE NWEL) NOT COINCIDENT EDGE NWEL
} 

MSUB.CAD.D.1 {@ Rule MSUB.CAD.D.1: Distance to NW: 0.005
    EXT MSUB_0 NWEL < 0.005 ABUT <90 SINGULAR
}

MSUB.CAD.R.1 {@ Rule MSUB.CAD.R.1: (MKR, msub) cannot cut NW
    CUT NWEL MSUB_0
}

MSUB.CAD.EN.2 {@ Rule MSUB.CAD.EN.2: Enclosure of (PW, blk): 0.000
    (MSUB_0 INSIDE EDGE PW_bk) NOT COINCIDENT EDGE PW_bk
} 

MSUB.CAD.D.2 {@ Rule MSUB.CAD.D.2: Distance to (PW, blk): 0.005
    EXT MSUB_0 PW_bk < 0.005 ABUT <90 SINGULAR
}

MSUB.CAD.R.2 {@ Rule MSUB.CAD.R.2: (MKR, msub) cannot cut (PW, blk)
    CUT PW_bk MSUB_0
}

MSUB.CAD.EN.3 {@ Rule MSUB.CAD.EN.3: Enclosure of OD: 0.000
    (MSUB_0 INSIDE EDGE OD) NOT COINCIDENT EDGE OD
}

MSUB.CAD.D.3 {@ Rule MSUB.CAD.D.3: Distance to OD: 0.005
    EXT MSUB_0 OD < 0.005 ABUT <90 SINGULAR REGION
}

MSUB.CAD.R.3 {@ Rule MSUB.CAD.R.3: (MKR, msub) cannot cut OD
    CUT OD MSUB_0
}

MSUB.CAD.R.4 {@ Rule MSUB.CAD.R.4: (MKR, msub) cannot be enclosed by OD
    (MSUB_0 INSIDE OD) NOT (MSUB_0 WITH EDGE ( MSUB_0 COIN INSIDE EDGE OD) == 4 )
}

GROUP MSUB MSUB.?


// //////////////////////////////////////////////////////////////////////////////
// /              HIPO  RESISTOR  OPTION  SPECIFIC  DESIGN  RULES               /
// //////////////////////////////////////////////////////////////////////////////

HRI.W.2 {@ Rule HRI.W.2: PO width within HRI (minimum resistor width): 1.000
    INT (POLY AND HRI) < 1.000 ABUT >0<90 SINGULAR
    (POLY AND HRI) NOT RECTANGLE
}

HRI.EN.1 {@ Rule HRI.EN.1: Enclosure of PO: 0.260
    ENC POLY HRI < 0.260 ABUT <90 SINGULAR REGION INSIDE ALSO
}
 
HRI.W.1 {@ Rule HRI.W.1: Width: 0.720
    INT HRI < 0.720 ABUT >0<90 SINGULAR
}
 
HRI.S.1 {@ Rule HRI.S.1: Space: 0.310
    EXT HRI < 0.310 ABUT >0<90 SINGULAR
}
 
HRI.D.1 {@ Rule HRI.D.1: Distance to OD (HRI must not interact with OD): 0.260
    EXT HRI OD < 0.260 ABUT ==0 SINGULAR REGION INSIDE ALSO
}
 
HRI.D.2 {@ Rule HRI.D.2: Distance to PO: 0.260
    EXT HRI POLY < 0.260 ABUT <90 SINGULAR
    HRI AND (POLY NOT RHPOLY)
}
 
HRI.OL.1 {@ Rule HRI.OL.1: Overlap of PP (min = max): 0.300
    X = RPO AND POLY
    Y = X AND PP
    Z = Y AND HRI
      C = INT PPHEAD RPO == 0.300 ABUT <90 OPPOSITE MEASURE COINCIDENT REGION
    Z XOR C
}

PPHEAD = RHHEAD COINCIDENT INSIDE EDGE PP

HRI.L.1 {@ Rule HRI.L.1: Resistor length (defined by PP space to PP): 3.000
    X = RHBODY COINCIDENT INSIDE EDGE POLY
    PATH LENGTH X < 3.000
}

GROUP HRI HRI.?

//  -------------------------------------------------------------------------
//      N+ and P+ OD and PO resistors
//  -------------------------------------------------------------------------

ODPO = (OD AND (OD_res OR RPO)) OR (POLY AND (PO_res OR RPO))
RESODPO = ODPO INTERACT RHDMY
RESODPO_N = RESODPO INSIDE NP
RESODPO_P = RESODPO INSIDE PP

RES.W.1 {@ Rule RES.W.1: PO or OD width of a PO/OD resistor (minimum resistor width) : 0.240
    INT RESODPO < 0.240
}

RES.EN.1 {@ Rule RES.EN.1: NP Enclosure of PO/OD of an N+ resistor (N+ resistor must be completely covered by NP): 0.200
    ENC RESODPO_N NP < 0.200 ABUT <90 SINGULAR REGION OUTSIDE ALSO
}

RES.D.1 {@ Rule RES.D.1: NP Distance to PO/OD of a P+ resistor (P+ resistor must not interact with NP): 0.200
    EXT RESODPO_P NP < 0.200 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

RES.EN.2 {@ Rule RES.EN.2: PP Enclosure of PO/OD of a P+ resistor (P+ resistor must be completely covered by PP): 0.200
    ENC RESODPO_P PP < 0.200 ABUT <90 SINGULAR REGION OUTSIDE ALSO
}

RES.D.2 {@ Rule RES.D.2: PP Distance to PO/OD of an N+ resistor (N+ resistor must not interact with PP): 0.200
    EXT RESODPO_N PP < 0.200 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

RES.R.1 {@ Rule RES.R.1: N+ or P+ poly resistor is not allowed on OD (PO of poly resistor must not intersect OD)
    (RHDMY AND POLY) AND OD
}

RES.MRC.1 {@ Rule RES.MRC.1: RH layer must be used for resistors only
       RHDMY NOT INTERACT ((PO_res OR OD_res) OR RPO)
}

GROUP RES RES.?

// //////////////////////////////////////////////////////////////////////////////
// /             CAPA MIM  SPECIFIC  DESIGN  RULES                            /
// //////////////////////////////////////////////////////////////////////////////

// DEV.GEN.1 {@ Rule DEV.GEN.1: The MIM capacitor cmimmk are not authorized for design
//         MKCAPMIM = ( BOTMIM INTERACT ( BOTMIM XOR MKTOPMIM ) ) AND MKTOPMIM
//     COPY MKCAPMIM
// }

// CAD.GEN.1 {@ Rule CAD.GEN.1: The CAD layers BOTMIM, BOTMIM;dummy, MKTOPMIM and MKTOPMIM;dummy are not authorized for design
//         COPY BOTMIM
//     COPY BOTMIM_dy
//     COPY MKTOPMIM
//     COPY MKTOPMIM_dy
// }

//------------------------------------------------------------------------------
//       TOPMIM  
//------------------------------------------------------------------------------

CTM.W.1 {@ Rule CTM.W.1: MKTOPMIM Width: 3.500
    INT MKTOPMIM < 3.500 ABUT >0<90 SINGULAR
}

CTM.S.1 {@ Rule CTM.S.1: MKTOPMIM Space: 3.500
    EXT MKTOPMIM < 3.500 ABUT >0<90 SINGULAR
}
 
CTM.A.1 {@ Rule CTM.A.1: Maximum MKTOPMIM Area: 20000.
    AREA MKTOPMIM > 20000.
}

DENSTOPMIM = BULK AND MKTOPMIM
WINDOWHKTOPMIM = SIZE DENSTOPMIM BY 500.000 INSIDE OF BULK
CP_WINDOWHKTOPMIM = COPY WINDOWHKTOPMIM
BOTMIN_25 = SIZE BOTMIM BY 25.000
CP_BOTMIN_25 = COPY BOTMIN_25
BOTMIN_25_ring = (SIZE BOTMIM BY 25.000) NOT BOTMIM
CP_BOTMIN_25_ring = COPY BOTMIN_25_ring
M7_MIN2_DENS = M7_DENS NOT BOTMIM

CTM.DEN.1 {@ Rule CTM.DEN.1: Minimum MKTOPMIM density within a window that is 500um larger than the MIM capacitor (MKTOPMIM): 0.1
    DENSITY DENSTOPMIM MKTOPMIM_dy WINDOWHKTOPMIM [(AREA(DENSTOPMIM)+ AREA(MKTOPMIM_dy)) / AREA(WINDOWHKTOPMIM)] < 0.1 INSIDE OF LAYER CP_WINDOWHKTOPMIM PRINT CTM.DEN.1.density
}

CTM.DEN.2 {@ Rule CTM.DEN.2: Minimum Mtop density under {BOTMIM upsize 25.00} : 0.1
    DENSITY M7_DENS BOTMIN_25 [AREA(M7_DENS) / AREA(BOTMIN_25)] < 0.1 INSIDE OF LAYER CP_BOTMIN_25 PRINT CTM.DEN.2.density
}

CTM.DEN.3 {@ Rule CTM.DEN.3: Minimum Mtop density in the region defined by {(BOTMIM upsize 25.00) .not. BOTMIM}: 0.2
    DENSITY M7_MIN2_DENS BOTMIN_25_ring [AREA(M7_MIN2_DENS) / AREA(BOTMIN_25_ring)] < 0.2 INSIDE OF LAYER CP_BOTMIN_25_ring PRINT CTM.DEN.3.density
}

CTM.EN.1_CTM.R.1 {@ Rule CTM.EN.1: MKTOPMIM Enclosure by BOTMIM: 0.500
                           @ Rule CTM.R.1: MKTOPMIM must be completely covered by BOTMIM
    ENC MKTOPMIM BOTMIM < 0.500 ABUT <90 SINGULAR OUTSIDE ALSO
}    

CTM.EN.2 {@ Rule CTM.EN.2: MKTOPMIM Enclosure of CB;via: 0.500
    ENC CB_VIA_TOPMIM MKTOPMIM < 0.500 ABUT <90 SINGULAR OUTSIDE ALSO
}

CTM.D.1 {@ Rule CTM.D.1: MKTOPMIM Distance to CB;via: 0.700
    EXT CB_via MKTOPMIM < 0.700 ABUT <90 SINGULAR OVERLAP
}
       
CTM.D.2 {@ Rule CTM.D.2: MKTOPMIM Distance to AP on different net (AP must not intersect MKTOPMIM on different net): 0.600
    EXT ALUCAP MKTOPMIM < 0.600 ABUT <90 SINGULAR REGION NOT CONNECTED INSIDE ALSO
}

GROUP CTM CTM.?

//------------------------------------------------------------------------------
//       BOTMIM  
//------------------------------------------------------------------------------

CBM.W.1 {@ Rule CBM.W.1: BOTMIM Width: 4.500
    INT BOTMIM < 4.500 ABUT >0<90 SINGULAR
}

CBM.S.1 {@ Rule CBM.S.1: BOTMIM Space: 2.500
    EXT BOTMIM < 2.500 ABUT >0<90 SINGULAR
}

CBM.EN.1 {@ Rule CBM.EN.1: BOTMIM Enclosure of CB;via: 0.300
    ENC CB_VIA_BOTMIM BOTMIM < 0.300 ABUT <90 SINGULAR OUTSIDE ALSO
}

CBM.D.1 {@ Rule CBM.D.1: BOTMIM Distance to CB;via: 2.000
    EXT BOTMIM CB_VIA < 2.000 ABUT >0<90 SINGULAR REGION MEASURE ALL
}

CBM.D.2 {@ Rule CBM.D.2: BOTMIM Distance to Mtop on a different net (not allowed to interact) : 2.000
    EXT M7i BOTMIM < 2.000 ABUT >0<90 SINGULAR REGION NOT CONNECTED INSIDE ALSO
}

CBM.W.2 {@ Rule CBM.W.2: Maximum Mtop width (including Mtop;dummy and Mtop;dummy_O) under BOTMIM: 0.900
    SIZE ((M7i OR ME7_dy) AND BOTMIM) UNDEROVER BY 0.45 TRUNCATE 0.45
}

GROUP CBM CBM.?

//------------------------------------------------------------------------------
//       CB;via Rules for MIM
//------------------------------------------------------------------------------

    
C_CBV.W.1 {@ Rule C_CBV.W.1: CB;via Width (CB;via that connect AP to BOTMIM or MKTOPMIM, and for any CB;via on an AP shape that also has CB;via connecting to BOTMIM or MKTOPMIM) (width=length,min=max): 1.000
    NOT RECTANGLE CB_VIA_MIM_AP == 1.000 BY == 1.000
}    
    
C_CBV.S.1 {@ Rule C_CBV.S.1: CB;via Space (CB;via that connect AP to BOTMIM or MKTOPMIM, and for any CB;via on an AP shape that also has CB;via connecting to BOTMIM or MKTOPMIM): 1.000
    EXT CB_VIA_MIM_AP < 1.000 ABUT >0<90 SINGULAR REGION
}

GROUP C_CBV C_CBV.?


//------------------------------------------------------------------------------
//       AP Rules for MIM
//------------------------------------------------------------------------------

C_AP.W.1 {@ Rule C_AP.W.1: AP Width (any AP shape that has CB;via connecting it to BOTMIM or MKTOPMIM): 1.000 
    INT ALUCAP_MIM < 1.000 ABUT >0<90 SINGULAR REGION
}


//------------------------------------------------------------------------------
//       ANTENNA RULES
//------------------------------------------------------------------------------

TOPMIMAREA_S = AREA MKTOPMIM < 200.000
TOPMIMAREA_M = AREA (MKTOPMIM NOT TOPMIMAREA_S) < 500.000
TOPMIMAREA_L = (MKTOPMIM NOT TOPMIMAREA_S) NOT TOPMIMAREA_M 

BOTMIMAREA_S = AREA BOTMIM < 200.000
BOTMIMAREA_M = AREA (BOTMIM NOT BOTMIMAREA_S) < 500.000
BOTMIMAREA_L = (BOTMIM NOT BOTMIMAREA_S) NOT BOTMIMAREA_M 

CMIM.ANT.5a {@ Rule CMIM.ANT.5a: Maximum number of CB;via connected to each MIM capacitor plate if area < 200 um2: 4
          TOPMIMAREA_S ENCLOSE CB_via > 4
          (BOTMIMAREA_S NOT MKTOPMIM) ENCLOSE CB_via > 4
}

CMIM.ANT.5b {@ Rule CMIM.ANT.5b: Maximum number of CB;via connected to each MIM capacitor plate if 200 um2 <= area < 500 um2: 10
          TOPMIMAREA_M ENCLOSE CB_via > 10
          (BOTMIMAREA_M NOT MKTOPMIM) ENCLOSE CB_via > 10
} 

CMIM.ANT.6 {@ Rule CMIM.ANT.6: Maximum number of CB;via connected to each MIM capacitor plate if area >= 500 um2: 30
          TOPMIMAREA_L ENCLOSE CB_via > 30
          (BOTMIMAREA_L NOT MKTOPMIM) ENCLOSE CB_via > 30
}
    
CMIM.ANT.8 {@ Rule CMIM.ANT.8: Maximum drawn ratio of AP sidewall area to the MIM capacitor area connected directly to it .: 5000
       NET AREA RATIO ALUCAP MKTOPMIM > 5000
       [PERIMETER(ALUCAP) * AP_thick / AREA(MKTOPMIM)]
    NET AREA RATIO ALUCAP BOT_AND_TOP > 5000 
       [PERIMETER(ALUCAP) * AP_thick / AREA(BOT_AND_TOP)]
}
    
BOT_AND_TOP = BOTMIM AND MKTOPMIM
SD = (ODi NOT POLYGi) OR EMPTY    
CONNECT M1i SD BY COi    
           
ALUCAP_DIO    = NET AREA RATIO SD ALUCAP > 0  // diode of an ALUCAP
ALUCAP_MIN_DIO    = NET AREA ALUCAP_DIO >= 0.06   // minimum effective diode 0.06um^2

ALUCAP_MKTOPMIM        = NET AREA RATIO MKTOPMIM ALUCAP > 0                 // MKTOPMIM connected to an ALUCAP
ALUCAP_MKTOPMIM_NO_DIO    = NET AREA RATIO ALUCAP_MKTOPMIM ALUCAP_MIN_DIO == 0 // MKTOPMIM not protected by effective diode through ALUCAP

ALUCAP_BOT_AND_TOP    = NET AREA RATIO BOT_AND_TOP ALUCAP > 0              // BOTMIM (UNDER MKTOPMIM) connected to an ALUCAP
ALUCAP_BOT_AND_TOP_NO_DIO = NET AREA RATIO ALUCAP_BOT_AND_TOP ALUCAP_MIN_DIO == 0 // BOTMIM (UNDER MKTOPMIM) not protected by effective diode through ALUCAP

CMIM.ANT.9 {@ Rule CMIM.ANT.9: Maximum AP Antenna ratio : 400
    NET AREA RATIO ALUCAP ALUCAP_MKTOPMIM_NO_DIO > 400 [ AREA(ALUCAP)/AREA(ALUCAP_MKTOPMIM_NO_DIO)]
    NET AREA RATIO ALUCAP ALUCAP_BOT_AND_TOP_NO_DIO > 400 [ AREA(ALUCAP)/AREA(ALUCAP_BOT_AND_TOP_NO_DIO)]
}
  
PADOPENMIM    = CB_via AND (BOTMIM NOT MKTOPMIM)
PADOPENTOPMIM    = CB_via AND  MKTOPMIM

CONNECT PADOPENMIM BOTMIM
CONNECT PADOPENTOPMIM BOTMIM

CMIM.ANT.2 {@ Rule CMIM.ANT.2: In case of shared BOTMIM plate, the number of CB;via connected to the common BOTMIM plate must be the sum of the number of CB;via connected to MKTOPMIM plate.
    NET AREA RATIO PADOPENMIM PADOPENTOPMIM != 1
}

ACTPOL        = ODi AND POLYGi
CNWPO_ACT    = ( ODi AND NWELi ) INSIDE NPi    
CNWPO_BOT    = CNWPO_ACT ENCLOSE ACTPOL    
CNWPO_CORE:0    = CNWPO_BOT AND ACTPOL        

CPWPO_ACT    = (ODi NOT NWELi) INSIDE PPi    
CPWPO_BOT    = CPWPO_ACT ENCLOSE ACTPOL    
CPWPO_CORE:0    = CPWPO_BOT AND ACTPOL        
    
ACT1    = ODi NOT POLY
ACT    = ACT1 NOT INTERACT (CNWPO_CORE:0 OR CPWPO_CORE:0)
CTACT    = CO AND ACT
CONNECT M1i ACT BY CTACT

POLYNORES    = POLY INTERACT ODi                    
POLYNOCAPANORES    = POLYNORES NOT INTERACT (CNWPO_CORE:0 OR CPWPO_CORE:0)    
CTPOLYNORES    = POLYNOCAPANORES AND CO
CONNECT POLYNOCAPANORES M1i BY CTPOLYNORES
CONNECT POLYGi M1i BY COi
FLOATBMIM = NET AREA RATIO BOTMIM ACT == 0
FLOATBOTMIM1 = NET AREA RATIO  FLOATBMIM POLYNOCAPANORES == 0
FLOATTMIM = NET AREA RATIO MKTOPMIM ACT  == 0
FLOATTMIM1 = NET AREA RATIO FLOATTMIM POLYNOCAPANORES == 0

NFLOATBMIM = BOTMIM NOT FLOATBOTMIM1
NFLOATTMIM = MKTOPMIM NOT FLOATTMIM1

CMIM.ANT.3 {@ Rule CMIM.ANT.3: The two plates must be simultaneously either floating (it must be the case at BOTMIM and MKTOPMIM levels) or non floating (it is the general case at AP level) 
    FLOATBOTMIM1 INTERACT NFLOATTMIM
    FLOATTMIM1 INTERACT NFLOATBMIM
}

GROUP CMIM_ANT CMIM.ANT.?

// //////////////////////////////////////////////////////////////////////////////
// /             INDUCTOR  DESIGN  RULES                                      /
// /////////////////////////////////////////////////////////////////////////////

//------------------------------------------------------------------------------
//       Metal Design Rules
//------------------------------------------------------------------------------

M1_INDDMY = M1i AND INDDMY
M2_INDDMY = M2i AND INDDMY
M3_INDDMY = M3i AND INDDMY
M4_INDDMY = M4i AND INDDMY
M5_INDDMY = M5i AND INDDMY
M6_INDDMY = M6i AND INDDMY
M7_INDDMY = M7i AND INDDMY

I_Mn.W.1 {@ Rule I_Mn.W.1: Minimum Metal Width (applicable to all Mn, Mx drawing levels within MKR;inddmy: coil, connectors and center tab, but not to the dummies, and not to M1): 1.500

    INT M2_INDDMY < 1.500 ABUT <90 SINGULAR
    INT M3_INDDMY < 1.500 ABUT <90 SINGULAR
    INT M4_INDDMY < 1.500 ABUT <90 SINGULAR
    INT M5_INDDMY < 1.500 ABUT <90 SINGULAR
    INT M6_INDDMY < 1.500 ABUT <90 SINGULAR
    INT M7_INDDMY < 1.500 ABUT <90 SINGULAR
}

I_Mn.S.1 {@ Rule I_Mn.S.1: Minimum Metal Space (applicable to all Mn, Mx drawing levels within MKR;inddmy: coil, connectors and center tab, but not to the dummies, and not to M1): 1.500
    EXT M3_INDDMY < 1.500 ABUT <90 SINGULAR
    EXT M4_INDDMY < 1.500 ABUT <90 SINGULAR
    EXT M5_INDDMY < 1.500 ABUT <90 SINGULAR
    EXT M6_INDDMY < 1.500 ABUT <90 SINGULAR
    EXT M7_INDDMY < 1.500 ABUT <90 SINGULAR
}

//------------------------------------------------------------------------------
//       Surrounding Area Design Rules
//------------------------------------------------------------------------------

M1DUM_INDDMY = ME1_dy AND INDDMY
M1DENS_INDDMY = M1_DENS AND INDDMY
M1DENS_INDDMY_RING = M1DENS_INDDMY AND INDDMY_RING
M2DUM_INDDMY = ME2_dy AND INDDMY
M2DENS_INDDMY = M2_DENS AND INDDMY
M2DENS_INDDMY_RING = M2DENS_INDDMY AND INDDMY_RING
M3DUM_INDDMY = ME3_dy AND INDDMY
M3DENS_INDDMY = M3_DENS AND INDDMY
M3DENS_INDDMY_RING = M3DENS_INDDMY AND INDDMY_RING
M4DUM_INDDMY = ME4_dy AND INDDMY
M4DENS_INDDMY = M4_DENS AND INDDMY
M4DENS_INDDMY_RING = M4DENS_INDDMY AND INDDMY_RING
M5DUM_INDDMY = ME5_dy AND INDDMY
M5DENS_INDDMY = M5_DENS AND INDDMY
M5DENS_INDDMY_RING = M5DENS_INDDMY AND INDDMY_RING
M6DUM_INDDMY = ME6_dy AND INDDMY
M6DENS_INDDMY = M6_DENS AND INDDMY
M6DENS_INDDMY_RING = M6DENS_INDDMY AND INDDMY_RING
M7DUM_INDDMY = ME7_dy AND INDDMY
M7DENS_INDDMY = M7_DENS AND INDDMY
M7DENS_INDDMY_RING = M7DENS_INDDMY AND INDDMY_RING

I_DUM.D.1 {@ Rule I_DUM.D.1: Minimum Metal;dummy Distance to Metal : 5.000
    EXT M1_INDDMY M1DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M1_INDDMY M1DUM_INDDMY < 5.000 CORNER MEASURE ALL
    EXT M2_INDDMY M2DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M2_INDDMY M2DUM_INDDMY < 5.000 CORNER MEASURE ALL
    EXT M3_INDDMY M3DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M3_INDDMY M3DUM_INDDMY < 5.000 CORNER MEASURE ALL
    EXT M4_INDDMY M4DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M4_INDDMY M4DUM_INDDMY < 5.000 CORNER MEASURE ALL
    EXT M5_INDDMY M5DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M5_INDDMY M5DUM_INDDMY < 5.000 CORNER MEASURE ALL
    EXT M6_INDDMY M6DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M6_INDDMY M6DUM_INDDMY < 5.000 CORNER MEASURE ALL
    EXT M7_INDDMY M7DUM_INDDMY < 5.000 ABUT <90 OPPOSITE  INSIDE ALSO MEASURE ALL
    EXT M7_INDDMY M7DUM_INDDMY < 5.000 CORNER MEASURE ALL
}

INDDMY_SZ = SIZE INDDMY BY -18
INDDMY_RING = INDDMY NOT INDDMY_SZ
CP_INDDMY_RING = COPY INDDMY_RING
    
//I_DUM.DEN.1 {@ Rule I_DUM.DEN.1: Density-Transition Ring minimum density (the ring must contain dummies, and also may contain metal to connect the inductors). The density transition ring is defined as the 18um (W) wide ring inside coincident with MKR;inddmy. : 0.2
//    X_M1 = DENSITY M1DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M1DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M1.density
//    X_M1 AND INDDMY_RING
//    X_M2 = DENSITY M2DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M2DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M2.density
//    X_M2 AND INDDMY_RING
//    X_M3 = DENSITY M3DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M3DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M3.density
//    X_M3 AND INDDMY_RING
//    X_M4 = DENSITY M4DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M4DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M4.density
//    X_M4 AND INDDMY_RING
//    X_M5 = DENSITY M5DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M5DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M5.density
//    X_M5 AND INDDMY_RING
//    X_M6 = DENSITY M6DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M6DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M6.density
//    X_M6 AND INDDMY_RING
//    X_M7 = DENSITY M7DENS_INDDMY_RING INDDMY_RING < 0.2 INSIDE OF LAYER CP_INDDMY_RING [AREA(M7DENS_INDDMY_RING)/AREA(INDDMY_RING)] PRINT I_DUM.DEN.1_M7.density
//    X_M7 AND INDDMY_RING
//}

//I_DUM.DEN.2 {@ Rule I_DUM.DEN.2: Minimum Metal Density within MKR;inddmy: 0.05
//    CP_INDDMY = COPY INDDMY
//    X_M1 = DENSITY M1DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M1DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M1.density
//    X_M1 AND INDDMY
//     X_M2 = DENSITY M2DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M2DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M2.density
//    X_M2 AND INDDMY
//    X_M3 = DENSITY M3DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M3DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M3.density
//    X_M3 AND INDDMY
//     X_M4 = DENSITY M4DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M4DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M4.density
//    X_M4 AND INDDMY
//     X_M5 = DENSITY M5DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M5DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M5.density
//    X_M5 AND INDDMY
//     X_M6 = DENSITY M6DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M6DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M6.density
//    X_M6 AND INDDMY
//     X_M7 = DENSITY M7DENS_INDDMY INDDMY < 0.05 INSIDE OF LAYER CP_INDDMY [AREA(M7DENS_INDDMY)/AREA(INDDMY)] PRINT I_DUM.DEN.2_M7.density
//    X_M7 AND INDDMY
//}

GROUP INDUCTOR I_Mn.? I_DUM.?
    
//  -------------------------------------------------------------------------
//      FRINGE  
//  -------------------------------------------------------------------------


PO_FRINGE = (POLYGi INTERACT MKR_MOM) INSIDE NWELi
OD_FRINGE = (OD INTERACT MKR_MOM) INSIDE NWELi

NACTALL    = OD AND NPi
PACTALL = OD AND (PPi OUTSIDE SEALRING_TC)
CELLACT = OD_dm AND CELLIMP_dm
CELLDIFF = CELLACT NOT POLYG_dm
CELLDIFSI = CELLDIFF NOT RPOi
PDIFF0:1 = PACTALL NOT POLYGi
NDIFF0:1 = NACTALL NOT POLYGi
PDIFSI:1 = PDIFF0:1 NOT SIPROTX
NDIFSI:1 = NDIFF0:1 NOT SIPROTX
SALI:1 = PDIFSI:1 OR NDIFSI:1
SALI:2 = SALI:1 OR CELLDIFSI
CONTACT:1 = COi OR CTELEC2
CONTACT:2 = CONTACT:1 OUTSIDE ELEC2_dm
CTA:1 = CONTACT:2 AND SALI:2
CTA:2 = CTA:1 NOT ( CONTACT:2 INTERACT LIL_dm )
CTP:1 = (CONTACT:2 AND POLYGi) NOT RPOi
CTP:2 = CTP:1 NOT ( CONTACT:2 INTERACT LIL_dm )
SHOD_CT = CONTACT:2 INSIDE OD_FRINGE
SHPO_CT = CONTACT:2 INSIDE PO_FRINGE

//--------------------------------------------- metal1 short device
SHME1 = (M1i AND ME1_17) OUTSIDE ((CTA:2 OR CTP:2) OR VIA1i)
ME1:1 = M1i NOT SHME1


//--------------------------------------------- metal2 short device
SHME2 = (M2i AND ME2_17) OUTSIDE (VIA1i OR VIA2i)
ME2:1 = M2i NOT SHME2
//--------------------------------------------- metal3 short device
SHME3 = (M3i AND ME3_17) OUTSIDE (VIA2i OR VIA3i)
ME3:1 = M3i NOT SHME3
//--------------------------------------------- metal4 short device
SHME4 = (M4i AND ME4_17) OUTSIDE (VIA3i OR VIA4i)
ME4:1 = M4i NOT SHME4
//--------------------------------------------- metal5 short device
SHME5 = (M5i AND ME5_17) OUTSIDE (VIA4i OR VIA5i)
ME5:1 = M5i NOT SHME5
//--------------------------------------------- metal6 short device
SHME6 = (M6i AND ME6_17) OUTSIDE (VIA5i OR VIA6i)
ME6:1 = M6i NOT SHME6

SHOD = ((ME1:1 NOT PO_FRINGE) ENCLOSE SHOD_CT) AND OD_FRINGE
SHPO = ((ME1:1 NOT OD_FRINGE) ENCLOSE SHPO_CT) AND PO_FRINGE
FRINGE_0 = EXTENTS (PO_FRINGE OR OD_FRINGE)
FRINGE_1 = FRINGE_0 NOT SHOD
FRINGE     = FRINGE_1 NOT SHPO

M1_FINGER = (MKR_MOM AND ME1:1) AND FRINGE
M2_FINGER = (MKR_MOM AND ME2:1) AND FRINGE
M3_FINGER = (MKR_MOM AND ME3:1) AND FRINGE
M4_FINGER = (MKR_MOM AND ME4:1) AND FRINGE
M5_FINGER = (MKR_MOM AND ME5:1) AND FRINGE

FMOM.W.1 {@ Rule FMOM.W.1: Metal Width of capacitor finger (min = max): 0.18
    X_M1 = INT M1_FINGER == 0.18 REGION
    Y_M1 = INT M1_FINGER < 0.5 REGION
    Y_M1 NOT X_M1
    X_M2 = INT M2_FINGER == 0.18 REGION
    Y_M2 = INT M2_FINGER < 0.5 REGION
    Y_M2 NOT X_M2
    X_M3 = INT M3_FINGER == 0.18 REGION
    Y_M3 = INT M3_FINGER < 0.5 REGION
    Y_M3 NOT X_M3
    X_M4 = INT M4_FINGER == 0.18 REGION
    Y_M4 = INT M4_FINGER < 0.5 REGION
    Y_M4 NOT X_M4
    X_M5 = INT M5_FINGER == 0.18 REGION
    Y_M5 = INT M5_FINGER < 0.5 REGION
    Y_M5 NOT X_M5
}

FMOM.S.1 {@ Rule FMOM.S.1: Metal Space between capacitor finger (min = max): 0.18
    X_M1 = SIZE M1_FINGER BY 0.09
    Y_M1 = SIZE M1_FINGER BY 0.09 OVERLAP ONLY
    Y_M1 OR (ME1_fringeC INTERACT X_M1 > 1)
    X_M2 = SIZE M2_FINGER BY 0.09
    Y_M2 = SIZE M2_FINGER BY 0.09 OVERLAP ONLY
    Y_M2 OR (ME2_fringeC INTERACT X_M2 > 1)
    X_M3 = SIZE M3_FINGER BY 0.09
    Y_M3 = SIZE M3_FINGER BY 0.09 OVERLAP ONLY
    Y_M3 OR (ME3_fringeC INTERACT X_M3 > 1)
    X_M4 = SIZE M4_FINGER BY 0.09
    Y_M4 = SIZE M4_FINGER BY 0.09 OVERLAP ONLY
    Y_M4 OR (ME4_fringeC INTERACT X_M4 > 1)
    X_M5 = SIZE M5_FINGER BY 0.09
    Y_M5 = SIZE M5_FINGER BY 0.09 OVERLAP ONLY
    Y_M5 OR (ME5_fringeC INTERACT X_M5 > 1)
}

M1_BUS_1 = (M1 NOT ME1_fringeC) TOUCH ME1_fringeC
M1_BUS_2 = COINCIDENT EDGE M1_BUS_1 ME1_fringeC
M1_BUS_3 = M1_BUS_2 TOUCH EDGE ((ENC M1_FINGER ME1_fringeC == 1.0 REGION ) COINCIDENT EDGE ME1_fringeC) 
M1_BUS_3_2 = M1_BUS_2 TOUCH EDGE ((ENC M1_FINGER ME1_fringeC < 2 REGION ) COINCIDENT EDGE ME1_fringeC) 
M1_BUS_4 = EXPAND EDGE M1_BUS_3 INSIDE BY 0.6
M1_BUS_4_2 = EXPAND EDGE M1_BUS_3_2 INSIDE BY 0.6

M2_BUS_1 = (M2 NOT ME2_fringeC) TOUCH ME2_fringeC
M2_BUS_2 = COINCIDENT EDGE M2_BUS_1 ME2_fringeC
M2_BUS_3 = M2_BUS_2 TOUCH EDGE ((ENC M2_FINGER ME2_fringeC == 1.0 REGION ) COINCIDENT EDGE ME2_fringeC) 
M2_BUS_3_2 = M2_BUS_2 TOUCH EDGE ((ENC M2_FINGER ME2_fringeC < 2 REGION ) COINCIDENT EDGE ME2_fringeC) 
M2_BUS_4 = EXPAND EDGE M2_BUS_3 INSIDE BY 0.6
M2_BUS_4_2 = EXPAND EDGE M2_BUS_3_2 INSIDE BY 0.6

M3_BUS_1 = (M3 NOT ME3_fringeC) TOUCH ME3_fringeC
M3_BUS_2 = COINCIDENT EDGE M3_BUS_1 ME3_fringeC
M3_BUS_3 = M3_BUS_2 TOUCH EDGE ((ENC M3_FINGER ME3_fringeC == 1.0 REGION ) COINCIDENT EDGE ME3_fringeC) 
M3_BUS_3_2 = M3_BUS_2 TOUCH EDGE ((ENC M3_FINGER ME3_fringeC < 2 REGION ) COINCIDENT EDGE ME3_fringeC) 
M3_BUS_4 = EXPAND EDGE M3_BUS_3 INSIDE BY 0.6
M3_BUS_4_2 = EXPAND EDGE M3_BUS_3_2 INSIDE BY 0.6

M4_BUS_1 = (M4 NOT ME4_fringeC) TOUCH ME4_fringeC
M4_BUS_2 = COINCIDENT EDGE M4_BUS_1 ME4_fringeC
M4_BUS_3 = M4_BUS_2 TOUCH EDGE ((ENC M4_FINGER ME4_fringeC == 1.0 REGION ) COINCIDENT EDGE ME4_fringeC) 
M4_BUS_3_2 = M4_BUS_2 TOUCH EDGE ((ENC M4_FINGER ME4_fringeC < 2 REGION ) COINCIDENT EDGE ME4_fringeC) 
M4_BUS_4 = EXPAND EDGE M4_BUS_3 INSIDE BY 0.6
M4_BUS_4_2 = EXPAND EDGE M4_BUS_3_2 INSIDE BY 0.6

M5_BUS_1 = (M5 NOT ME5_fringeC) TOUCH ME5_fringeC
M5_BUS_2 = COINCIDENT EDGE M5_BUS_1 ME5_fringeC
M5_BUS_3 = M5_BUS_2 TOUCH EDGE ((ENC M5_FINGER ME5_fringeC == 1.0 REGION ) COINCIDENT EDGE ME5_fringeC) 
M5_BUS_3_2 = M5_BUS_2 TOUCH EDGE ((ENC M5_FINGER ME5_fringeC < 2 REGION ) COINCIDENT EDGE ME5_fringeC) 
M5_BUS_4 = EXPAND EDGE M5_BUS_3 INSIDE BY 0.6
M5_BUS_4_2 = EXPAND EDGE M5_BUS_3_2 INSIDE BY 0.6


FMOM.S.2 {@ Rule FMOM.S.2: Metal Space between metal bus and metal finger: 1.0
    EXT M1_BUS_4_2 M1_FINGER < 1.0 ABUT >0<90 OPPOSITE
    EXT M2_BUS_4_2 M2_FINGER < 1.0 ABUT >0<90 OPPOSITE
    EXT M3_BUS_4_2 M3_FINGER < 1.0 ABUT >0<90 OPPOSITE
    EXT M4_BUS_4_2 M4_FINGER < 1.0 ABUT >0<90 OPPOSITE
    EXT M5_BUS_4_2 M5_FINGER < 1.0 ABUT >0<90 OPPOSITE
}

FMOM.L.1 {@ Rule FMOM.L.1: Minimum finger length: 10
    INT M1_FINGER == 0.18 OPPOSITE PARALLEL PROJ < 11
    INT M2_FINGER == 0.18 OPPOSITE PARALLEL PROJ < 11
    INT M3_FINGER == 0.18 OPPOSITE PARALLEL PROJ < 11
    INT M4_FINGER == 0.18 OPPOSITE PARALLEL PROJ < 11
    INT M5_FINGER == 0.18 OPPOSITE PARALLEL PROJ < 11
}

FMOM.L.2 {@ Rule FMOM.L.2: Maximum finger length : 200
    INT M1_FINGER == 0.18 OPPOSITE PARALLEL PROJ > 201
    INT M2_FINGER == 0.18 OPPOSITE PARALLEL PROJ > 201
    INT M3_FINGER == 0.18 OPPOSITE PARALLEL PROJ > 201
    INT M4_FINGER == 0.18 OPPOSITE PARALLEL PROJ > 201
    INT M5_FINGER == 0.18 OPPOSITE PARALLEL PROJ > 201
}

FMOM.R.1 {@ Rule FMOM.R.1: Minimum finger number: 11
    ME1_fringeC INTERACT M1_FINGER < 11
    ME2_fringeC INTERACT M2_FINGER < 11
    ME3_fringeC INTERACT M3_FINGER < 11
    ME4_fringeC INTERACT M4_FINGER < 11
    ME5_fringeC INTERACT M5_FINGER < 11
}


PO_SHIELD = POLY AND (SIZE MKR_MOM BY 0.22) 
FMOM.W.11 {@ Rule FMOM.W.11: PO Width of poly stripes (min = max): 0.34
    X_PO = INT PO_SHIELD == 0.34 REGION
    Y_PO = INT PO_SHIELD < 0.8 REGION
    Y_PO NOT X_PO
}

OD_SHIELD = (OD AND MKR_MOM) AND FRINGE
SZ_OD_SHIELD = SIZE OD_SHIELD BY 0.4
SZ_OD_SHIELD1 = OD AND SZ_OD_SHIELD
FMOM.W.12 {@ Rule FMOM.W.12: OD Width of N+ OD stripes (min = max): 0.18
    X_OD = INT SZ_OD_SHIELD1 == 0.18 REGION
    Y_OD = INT SZ_OD_SHIELD1 < 0.5 REGION
    Y_OD NOT X_OD
}

FMOM.D.11 {@ Rule FMOM.D.11: PO Distance to OD for shield stripes: 0.10
    SHIELD = OD_SHIELD OR PO_SHIELD
    X_SHIELD = SIZE SHIELD BY 0.05
    Y_SHIELD = SIZE SHIELD BY 0.05 OVERLAP ONLY
    Y_SHIELD OR ((MKR_MOM AND FRINGE) INTERACT X_SHIELD > 1)
    
}

FMOM.S.12 {@ Rule FMOM.S.12: M1-M6 shield bus Space to FMOM Metal: 0.54.
    X = (M2_FINGER COINCIDENT EDGE (MKR_MOM AND FRINGE)) NOT COINCIDENT EDGE M1_BUS_4
    Y = EXPAND EDGE X OUTSIDE BY 0.54
    Y AND M1
    Y AND M2
    Y AND M3
    Y AND M4
    Y AND M5
}

M6_SHIELD = M6 INTERACT (MKR_MOM AND FRINGE)
FMOM.MRC.1 {@ Rule FMOM.MRC.1: At least one via mandatory on each metal level shield.
    Y = M6_SHIELD NOT (MKR_MOM AND FRINGE)
    Z = (HOLES M6_SHIELD) INTERACT (MKR_MOM AND FRINGE)
    Z1 = Y AND (M1 TOUCH Z)
    Z1 NOT INTERACT VIA1
    
    Z2 = Y AND (M2 TOUCH Z)
    Z2 NOT INTERACT VIA2
    
    Z3 = Y AND (M3 TOUCH Z)
    Z3 NOT INTERACT VIA3
    
    Z4 = Y AND (M4 TOUCH Z)
    Z4 NOT INTERACT VIA4
    
}    

GROUP FMOM FMOM.?

//  -------------------------------------------------------------------------
//      BIPOLAR
//  -------------------------------------------------------------------------
    
BIP.R.2 {@ Rule BIP.R.2: OD (Emitter) of bipolar transistor must be covered by BJTDMY
    (NPOD INTERACT BJTDMY) CUT BJTDMY 
    (PPOD INTERACT BJTDMY) CUT BJTDMY
}


//  -------------------------------------------------------------------------
//      LASER FUSE 
//  -------------------------------------------------------------------------

F_PO    = FW AND POLY
F_CO    = FW AND CO
F_M1    = FW AND M1
F_V1    = FW AND VIA1
F_M2    = FW AND M2
F_V2    = FW AND VIA2
F_M3    = FW AND M3
F_V3    = FW AND VIA3
F_M4    = FW AND M4
F_V4    = FW AND VIA4
F_M5    = FW AND M5
F_V5    = FW AND VIA5
F_M6    = FW AND M6
F_V6    = FW AND VIA6
F_M7 = FW AND M7

R_M1    = RNGX AND M1
R_V1    = RNGX AND VIA1
R_M2    = RNGX AND M2
R_V2    = RNGX AND VIA2
R_M3    = RNGX AND M3
R_V3    = RNGX AND VIA3
R_M4    = RNGX AND M4
R_V4    = RNGX AND VIA4
R_M5    = RNGX AND M5
R_V5    = RNGX AND VIA5
R_M6    = RNGX AND M6
R_V6    = RNGX AND VIA6
R_VT    = RNGX AND VIA6
R_MT    = RNGX AND M7

FUSE_BODY = F_M7 NOT POLY
FUSE_BODY_LENGTH = FUSE_BODY NOT COINCIDENT EDGE POLY

FW.W.1 {@ Rule FW.W.1: Width of Mtop fuse metal body (min = max, head excepted): 0.800
    X = INT FUSE_BODY_LENGTH == 0.800 REGION OPPOSITE
    FUSE_BODY NOT X
}

FW.S.1 {@ Rule FW.S.1: Space of Mtop fuse metal body (for fuse heads of a dog-bone fuse a space of 3.5 is allowed): 4.000
    EXT F_M7 < 4.000 REGION
}

F_M1_1 = LENGTH F_M1 < 0.800 
F_M2_1 = LENGTH F_M2 < 0.800 
F_M3_1 = LENGTH F_M3 < 0.800 
F_M4_1 = LENGTH F_M4 < 0.800 
F_M5_1 = LENGTH F_M5 < 0.800 
F_M6_1 = LENGTH F_M6 < 0.800 

FW.S.2 {@ Rule FW.S.2: Space between two PO and metals in the connection stack on the opposite ends of the fuse: 10.000
    X = EXT F_PO < 10.000 REGION
    Y = X INSIDE FW
    Y INSIDE F_M7
    X1 = EXT F_M1_1 < 10.000 REGION
    Y1 = X1 INSIDE FW
    Y1 INSIDE F_M7
    X2 = EXT F_M2_1 < 10.000 REGION
    Y2 = X2 INSIDE FW
    Y2 INSIDE F_M7
    X3 = EXT F_M3_1 < 10.000 REGION
    Y3 = X3 INSIDE FW
    Y3 INSIDE F_M7
    X4 = EXT F_M4_1 < 10.000 REGION
    Y4 = X4 INSIDE FW
    Y4 INSIDE F_M7
    X5 = EXT F_M5_1 < 10.000 REGION
    Y5 = X5 INSIDE FW
    Y5 INSIDE F_M7
    X6 = EXT F_M6_1 < 10.000 REGION
    Y6 = X6 INSIDE FW
    Y6 INSIDE F_M7
}

FW.W.2 {@ Rule FW.W.2: FW (laser fuse window) Width: 13.000
    INT FW < 13.000 
}

FW.S.3 {@ Rule FW.S.3: FW (laser fuse window) Space: 8.000
    EXT FW < 8.000 ABUT <90 SINGULAR
}

FW.D.1 {@ Rule FW.D.1: FW (laser fuse window) Distance to NW (FW must not interact with NW): 5.000
    EXT FW NWEL < 5.000 ABUT <90 SINGULAR REGION INSIDE ALSO
}

FW.D.2 {@ Rule FW.D.2: FW (laser fuse window) Distance to die seal ring {MKR;sealring .not. PMDMY} (FW must not intersect with MKR;sealring): 27.000
    EXT FW SEALRING_TC < 27.000 ABUT <90 SINGULAR REGION INSIDE ALSO
}

FW.D.3 {@ Rule FW.D.3: FW Distance to CB, CB;via, AP (FW must not interact with these shapes): 5.000
    EXT FW CBi < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT FW CB_via < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT FW ALUCAP < 5.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

FW.EN.1 {@ Rule FW.EN.1: FW (laser fuse window) Enclosure of metal (applies to metal fuse length direction, and to metal islands in the connecting stack in all directions): 0.500
    X = FW INSIDE EDGE POLY
    ENC F_M1 X < 0.500 ABUT <90 OPPOSITE
    ENC F_M2 X < 0.500 ABUT <90 OPPOSITE
    ENC F_M3 X < 0.500 ABUT <90 OPPOSITE
    ENC F_M4 X < 0.500 ABUT <90 OPPOSITE
    ENC F_M5 X < 0.500 ABUT <90 OPPOSITE
    ENC F_M6 X < 0.500 ABUT <90 OPPOSITE
    ENC F_M7 X < 0.500 ABUT <90 OPPOSITE
}

FW.EX.1 {@ Rule FW.EX.1: FW (laser fuse window) Extension on fuse metal measured orthogonal to metal fuse direction : 8.000
    ENC (LENGTH FUSE_BODY_LENGTH > 10.000 ) FW < 8.000 ABUT <90 
}

FW.EN.2 {@ Rule FW.EN.2: PO enclosure of CO, M1 enclosure of CO, Metal enclosure of VIA in fuse connection stack: 0.120
    ENC F_CO F_PO < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_CO F_M1 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V1 F_M1 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V1 F_M2 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V2 F_M2 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V2 F_M3 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V3 F_M3 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V3 F_M4 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V4 F_M4 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V4 F_M5 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V5 F_M5 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V5 F_M6 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V6 F_M6 < 0.120 ABUT <90 OVERLAP SINGULAR
    ENC F_V6 F_M7 < 0.120 ABUT <90 OVERLAP SINGULAR
}

FW.R.1 {@ Rule FW.R.1: Use minimum 2 CO, VIAx, VIAn to connect the fuse
    F_M7 INTERACT CO <4
    F_M7 INTERACT VIA1 <4
    F_M7 INTERACT VIA2 <4
    F_M7 INTERACT VIA3 <4
    F_M7 INTERACT VIA4 <4
  
    F_M7 INTERACT VIA5 <4
    F_M7 INTERACT VIA6 <4
  
}

LM.MRC.1 {@ Rule LM.MRC.1: Laser fuse alignment targets must be drawn at the same metal level as metal fuses.
      @ Rule LM.MRC.1: There must be at least 3 alignment targets per die.
      @ Rule LM.MRC.1: The rectangle delimited by the targets must enclose all fuse boxes of the die.
    BULK_FUSE_CHECKED = (BULK INTERACT FW) INTERACT (LMARK OR SEALRING_TC)     // the rule is checked only if fuse exists AND (LMARK or SR)           
    X = BULK_FUSE_CHECKED INTERACT (M7 AND FW)           // targets must be at the same metal level as the laser fuses
    Y = BULK_FUSE_CHECKED INTERACT (M7 AND LMARK) > 2      // minimum of 3 alignement targets per die
    X NOT Y 
    FW NOT (EXTENT ((HOLES M7) INSIDE LMARK)) // the rectangle delimited by the targets must enclose all fuse boxes of the die           
}

GROUP FW FW.?

//  -------------------------------------------------------------------------
//      LASER FUSE PROTECTION RING
//  -------------------------------------------------------------------------

FPR.D.1 {@ Rule FPR.D.1: Metal of protection ring Distance to FW (laser fuse window): 1.000
    EXT FW R_M1 < 1.000 ABUT <90
    EXT FW R_M2 < 1.000 ABUT <90
    EXT FW R_M3 < 1.000 ABUT <90
    EXT FW R_M4 < 1.000 ABUT <90
    EXT FW R_M5 < 1.000 ABUT <90
    EXT FW R_M6 < 1.000 ABUT <90
    EXT FW R_MT < 1.000 ABUT <90
}

FPR.R.1 {@ Rule FPR.R.1: VIA rings are continuous. Width of the rings follow rule VIAx.W.1 for VIAx, and FPR.W.1 for VIAn
    NOT DONUT R_V1
    NOT DONUT R_V2
    NOT DONUT R_V3
    NOT DONUT R_V4
    NOT DONUT R_V5
    NOT DONUT R_V6
    WITH WIDTH R_V1 < 0.129
    WITH WIDTH R_V1 > 0.131
    WITH WIDTH R_V2 < 0.129
    WITH WIDTH R_V2 > 0.131
    WITH WIDTH R_V3 < 0.129
    WITH WIDTH R_V3 > 0.131
    WITH WIDTH R_V4 < 0.129
    WITH WIDTH R_V4 > 0.131
}

FPR.R.2 {@ Rule FPR.R.2: PMDMY must be drawn line-on-line with the outer metal edge of the protection ring
    A = PMDMY AND M7
    (M7 CUT PMDMY) NOT A
    
    HOLES_M7 = HOLES M7
    B = (PMDMY AND M7) NOT HOLES_M7
    X = PMDMY NOT HOLES_M7
    X XOR B
}

FPR.R.3 {@ Rule FPR.R.3: MKR;sealring must cover the protection ring and must be identical to Mtop of the protection ring 
    RNGX NOT SEALRING_FPR
    SEALRING_FPR NOT M7
}

FPR.W.1 {@ Rule FPR.W.1: Width of VIAn rings (VIAx uses regular width): 0.280
    WITH WIDTH R_V5 <  0.279 
    WITH WIDTH R_V5 >  0.281 
    
    WITH WIDTH R_V6 <  0.279 
    WITH WIDTH R_V6 >  0.281 
    
}

FPR.EN.1 {@ Rule FPR.EN.1: Metal enclosure of VIAx : 0.600
    ENC R_V1 R_M1 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V1 R_M2 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V2 R_M2 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V2 R_M3 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V3 R_M3 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V3 R_M4 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V4 R_M4 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_V4 R_M5 < 0.600 ABUT <90 SINGULAR REGION INSIDE ALSO
}

FPR.EN.2 {@ Rule FPR.EN.2: Metal enclosure of VIAn: 0.520
    ENC R_V5 R_M6 < 0.520 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC R_VT R_MT < 0.520 ABUT SINGULAR REGION
}

GROUP FPR FPR.?

//  -------------------------------------------------------------------------
//      LASER FUSE ALIGNMENT TARGETS
//  -------------------------------------------------------------------------

TARGET = HOLES (LMARK AND M7 )
TARGET_EDGE = TARGET INSIDE EDGE LMARK 
TARGET_SIDE_IN = CONVEX EDGE TARGET == 1
TARGET_SIDE_EXT = CONVEX EDGE TARGET == 2

LM.W.1 {@ Rule LM.W.1: Alignment target width (i.e. Mtop space): 6.000
    INT TARGET < 6.000 ABUT <90 SINGULAR REGION
}

LM.L.1 {@ Rule LM.L.1: Alignment target length (length of external edge of L-shape): 30.000
    NOT RECTANGLE (EXTENTS TARGET) >=30.000 BY >=30.000
}

LM.W.2 {@ Rule LM.W.2: Mtop width at end of alignment target L-shape (LMARK enclosure of L-shape): 5.000
    ENC (LENGTH TARGET_SIDE_EXT == 6.000) LMARK < 5.000 ABUT REGION
}

LM.W.3 {@ Rule LM.W.3: Mtop width parallel to alignment target L-shape (LMARK extension on L-shape parallel to leg). Mtop forming alignment target is excluded from regular maximum metal width rule Mn.W.2 and local density rule Mn.R.4: 27.000
    ENC (LENGTH TARGET_SIDE_EXT == 30.000) LMARK < 27.000 ABUT REGION
}

LM.D.1 {@ Rule LM.D.1: LMARK Distance to MKR;sealring (they must not interact) : 13.000
    EXT LMARK SEALRING_TC < 13.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

LM.D.2 {@ Rule LM.D.2: LMARK Distance to unrelated Mtop: 3.000
    EXT LMARK M7 < 3.000
}

LM.R.1 {@ Rule LM.R.1: LMARK must be drawn line-on-line with outer bound of Mtop of alignment target
    A = LMARK AND M7
    (M7 CUT LMARK) NOT A
    
    HOLES_M7 = HOLES M7
    B = (LMARK AND M7) NOT HOLES_M7
    X = LMARK NOT HOLES_M7
    X XOR B
}

LM.R.2 {@ Rule LM.R.2: No OD, PO or metal drawing shapes nor dummies are allowed under L-shape opening of alignment target. No AP or AP;dummy allowed above LMARK.
    XALLACT AND TARGET
    POLY_DENS AND TARGET    
    M1_DENS AND TARGET
    M2_DENS AND TARGET
    M3_DENS AND TARGET
    M4_DENS AND TARGET
    M5_DENS AND TARGET
    M6_DENS AND TARGET
    M7_DENS AND TARGET
    ALUCAP AND LMARK
    ALUCAP_dy AND LMARK
}

GROUP LM LM.?

//  -------------------------------------------------------------------------
//      POLY FUSE
//  -------------------------------------------------------------------------


POLY_FUSE = POLY AND POFUSE
POLY_FUSE_BODY = POLY_FUSE AND MKR_fuselink
POLY_FUSE_HEAD = EXPAND EDGE (COINCIDENT EDGE (POLY_FUSE NOT MKR_fuselink) GOOD_MKR_fuselink) INSIDE BY 1.01 

BAD_MKR_fuselink3 = MKR_fuselink INTERACT (EXPAND EDGE (COINCIDENT INSIDE EDGE MKR_fuselink POLY) INSIDE BY 0.001)
BAD_MKR_fuselink = COPY BAD_MKR_fuselink3
GOOD_MKR_fuselink = MKR_fuselink NOT INTERACT BAD_MKR_fuselink

PF.MRC.1 {@ Rule PF.MRC.1: Fuse heads are required at both extremities of fuse body and are aligned on MKR;fuselink.
      @ Rule PF.MRC.1: POFUSE must enclose at least 1 MKR;fuselink.
      @ Rule PF.MRC.1: MKR;fuselink must be covered by POFUSE.        
    COPY BAD_MKR_fuselink
    POFUSE NOT ENCLOSE MKR_fuselink
    MKR_fuselink NOT POFUSE
}

PF.W.1 {@ Rule PF.W.1: POFUSE Width within NP: 0.240
    INT (POFUSE AND NP) < 0.240 ABUT <90 SINGULAR REGION
}

PF.S.1 {@ Rule PF.S.1: POFUSE Space within NP: 0.240
    EXT (POFUSE AND NP) < 0.240 ABUT <90 SINGULAR REGION 
}


PF.W.2 {@ Rule PF.W.2: PO Width within MKR;fuselink (fuse body width, min=max): 0.130
    LENGTH (TOUCH EDGE (COINCIDENT EDGE POLY_FUSE_BODY MKR_fuselink) POLY_FUSE_HEAD)!= 0.130
}

PF.W.3 {@ Rule PF.W.3: PO Width of fuse head (MKR;fuselink Width): 1.360
    LENGTH (COINCIDENT OUTSIDE EDGE POLY_FUSE_HEAD GOOD_MKR_fuselink) != 1.360
    POLY_FUSE_HEAD NOT POLY
}

PF.L.1 {@ Rule PF.L.1: PO Length within MKR;fuselink (fuse body length = MKR;fuselink Length) (min=max): 1.040
    LENGTH (NOT INSIDE EDGE (POLY_FUSE_BODY INSIDE GOOD_MKR_fuselink) POLY) != 1.040
}

PF.EN.1 {@ Rule PF.EN.1: POFUSE Enclosure of PO (PO of poly fuse must be covered by POFUSE): 0.320
    ENC POLY_FUSE POFUSE < 0.320 ABUT <90 SINGULAR REGION OUTSIDE ALSO
}

PF.EN.2 {@ Rule PF.EN.2: PO Enclosure of CO within POFUSE: 0.200
    ENC (CO AND POFUSE) POLY_FUSE < 0.200 ABUT <90 SINGULAR REGION
}
  
PF.EN.3 {@ Rule PF.EN.3: M1 Enclosure of CO within POFUSE: 0.100
    ENC (CO AND POFUSE) M1 < 0.100 ABUT <90 SINGULAR REGION
}

PF.D.1 {@ Rule PF.D.1: MKR;fuselink Distance to CO (PO Enclosure of CO in direction towards fuse body): 0.430
    EXT (CO AND POFUSE) (EXPAND EDGE (COINCIDENT EDGE MKR_fuselink POLY_FUSE_HEAD) INSIDE BY 0.005) < 0.430 ABUT <90 SINGULAR REGION
}

PF.D.2 {@ Rule PF.D.2: MKR;fuselink Distance to M1 (M1 must not interact with MKR;fuselink): 0.230
    EXT M1 MKR_fuselink < 0.230 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

PF.D.3 {@ Rule PF.D.3: POFUSE Distance to OD, NW, unrelated PO (POFUSE must not interact with OD, NW): 0.320
    EXT POFUSE OD < 0.320 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT POFUSE NWEL < 0.320 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT CP_POFUSE ILP1i < 0.320 ABUT ==0 SINGULAR REGION INSIDE ALSO NOT CONNECTED // between POFUSE and POLY not related to this POFUSE
}
    
PF.R.1 {@ Rule PF.R.1: Minimum Number of CO in fuse poly head: 8
    POLY_FUSE_HEAD INTERACT  CO < 8
    POLY_FUSE_HEAD NOT INTERACT CO
}

PF.R.2 {@ Rule PF.R.2: Number of PO fuse body under MKR;fuselink (Exactly one PO fuse body must be centered): 1
    MKR_fuselink INTERACT (POLY_FUSE_BODY AND (EXPAND EDGE (NOT TOUCH EDGE MKR_fuselink POLY) INSIDE BY 0.615))
}

PF.R.3 {@ Rule PF.R.3: NP must completely cover PO fuse body
    POFUSE NOT NPi
}

GROUP PF PF.?

//  -------------------------------------------------------------------------
//      VARACTORS
//  -------------------------------------------------------------------------

MVAR.R.1 {@ Rule MVAR.R.1: No 90 corner of OD under PO
   R1 =     EXPAND EDGE (CONVEX EDGE (GATE_Var NOT TOUCH INSIDE EDGE POLY) ANGLE1 == 90 ANGLE2 <180) INSIDE BY 0.001
   M = FDRC INSIDE CELL '*FR_MVAXRX1_*' '*FR_POXX3_POXRX4_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

MVAR.R.5 {@ Rule MVAR.R.5: NP/PP must fully cover {(((Gate of Varactor) sizing 0.19) and OD) sizing 0.13}
    (SIZE ((SIZE GATE_Var BY 0.190) AND OD) BY 0.130) NOT IMP
}

GROUP MVAR MVAR.?

//  -------------------------------------------------------------------------
//      LATCH-UP
//  -------------------------------------------------------------------------

LUP.D.1_LUP.D.2 {@ Rule LUP.D.1: Maximum distance from any point inside Source/Drain OD area to the nearest OD of a well tie within the same NW or PW (see LUP.D.2 for special treatment of SRAM): 30.000 um
                  @ Rule LUP.D.2: Maximum distance from any point inside Source/Drain OD area to the nearest OD of a well tie within the same NW or PW in SRAM region (marked with layer SRM). The distance is defined by the larger of the zones I, II: (I) OD of well tie sized by A inside the well (=LUP.D.1), (II) OD of well tie upsized by 1.5um in one direction and value B in the other direction.   : 40.000 um
// PSTRAP vs NMOS -> LUP.D.1N, LUP.D.2N
// create LUP.D.2 specific "cross" checking region
    PSTP_SRM = PSTP AND DMSRM
    PSTP_SRM_SZ15 = SIZE PSTP_SRM BY 1.5
    PSTP_SRM_SZ_EXP = EXPAND EDGE PSTP_SRM_SZ15 BY 38.5
    PSTP_SRM_SZ_EXP_PW = PSTP_SRM_SZ_EXP AND PWELi
    PSTP_LUP_SRM = SIZE PSTP_SRM BY 40 INSIDE OF PSTP_SRM_SZ_EXP_PW STEP 0.600
// create LUP.D.1 standard checking region
    PSTP_LUP = SIZE PSTP BY 30 INSIDE OF PWELi STEP 0.600
// to avoid outputing LUP.D.1 in LUP.D.2 specific region
    LUPD2N_NOT_LUPD1N = PSTP_SRM_SZ_EXP NOT PSTP_LUP
// to avoid outputing LUP.D.2 in LUP.D.1 region (could be avoided if the two checks are merged)
    PSTP_LUP1 = SIZE PSTP BY 30
// create checking region for LUP.D.1 and LUP.D.2
    LUPN_AREA = PSTP_LUP OR PSTP_LUP_SRM
// actual check
    LUPD1_N  = NASD NOT LUPN_AREA
    NASD_SRM = NASD AND DMSRM
    LUPD2_N  = NASD_SRM NOT LUPN_AREA
    LUPD1_N OR LUPD2_N
// NSTRAP vs PMOS -> LUP.D.1P, LUP.D.2P
// create LUP.D.2 specific "cross" checking region
    NSTP_SRM = NSTP AND DMSRM
    NSTP_SRM_SZ15 = SIZE NSTP_SRM BY 1.5
    NSTP_SRM_SZ_EXP = EXPAND EDGE NSTP_SRM_SZ15 BY 38.5
    NSTP_SRM_SZ_EXP_NW = NSTP_SRM_SZ_EXP AND NWELi
    NSTP_LUP_SRM = SIZE NSTP_SRM BY 40 INSIDE OF NSTP_SRM_SZ_EXP_NW STEP 0.600
// create LUP.D.1 standard checking region
    NSTP_LUP = SIZE NSTP BY 30 INSIDE OF NWELi STEP 0.600
// to avoid outputing LUP.D.1 in LUP.D.2 specific region
    LUPD2P_NOT_LUPD1P = NSTP_SRM_SZ_EXP NOT NSTP_LUP
// to avoid outputing LUP.D.2 in LUP.D.1 region (could be avoided if the two checks are merged)
    NSTP_LUP1 = SIZE NSTP BY 30
// create checking region for LUP.D.1 and LUP.D.2
    LUPP_AREA = NSTP_LUP OR NSTP_LUP_SRM
// actual check
    LUPD1_P  = PASD NOT LUPP_AREA
    PASD_SRM = PASD AND DMSRM
    LUPD2_P  = PASD_SRM NOT LUPP_AREA
    LUPD1_P OR LUPD2_P
}

GROUP LUP LUP.D.1_LUP.D.2

// //////////////////////////////////////////////////////////////////////////////
// /              DRAM  SPECIFIC  DESIGN  RULES                                 /
// //////////////////////////////////////////////////////////////////////////////

//------------------------------------------------------------------------------
// GENERAL  
//------------------------------------------------------------------------------

D_CO.W.1 {@ Rule D_CO.W.1: CO;dm and CO must not interact
   R1 =     CTELEC2 INTERACT CO_dm
   R2 =     CO_dm INTERACT (COi_dg OR CO_hd)
   R3 = R1 OR R2
   R4 =     CTELEC2 INTERACT (COi_dg OR CO_hd)
   R5 = R3 OR R4
   M = FDRC INSIDE CELL '*FR_D_COXWX1_*' '*FR_COXWX1_D_*'
   R5 NOT INTERACT M
   R6 = R5 INTERACT M
   R6 INTERACT (SIZE (R6 XOR M) BY -0.001)
     }

GATE_DM = POLYG_dm AND OD_dm           
COOD_DM = CO_dm AND OD_dm

D_CO.D.4 {@ Rule D_CO.D.4: Distance of CO;dm on OD;dm to PO (on OD25;dm or OD33;dm): 0.080 
   R1 =     EXT COOD_DM GATE_DM < 0.080 ABUT <90 INSIDE ALSO SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_COXDX4_*' '*FR_COXDX4_D_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_CO.EN.2_D_CO.EX.2 {@ Rule D_CO.EN.2: CO;dm enclosure by OD;dm: 0.020
                      @ Rule D_CO.EX.2: OD;dm Extension on CO;dm in line end direction: 0.030
                      @ Rule CO.R.6: CO must be fully covered by M1 and by {PO or OD}
    RECTANGLE ENCLOSURE CO_dm OD_dm ABUT <90 SINGULAR GOOD 0.020 0.030 OPPOSITE 0.020 0.030 OPPOSITE
}

GATE_L_DM       = GATE NOT COIN INSIDE EDGE POLYG_dm  
HV_GATE_L_DM    = GATE_L_DM INSIDE EDGE (OD2_33_dm OR OD2_25_dm)         
HV_NGATE_L_DM   = HV_GATE_L_DM INSIDE EDGE NP        

D_OD.W.2 {@ Rule D_OD.W.2: Minimum OD;dm width (gate width) of DRAM MOS (on OD25;dm or OD33;dm): 0.160 
    INT HV_NGATE_L_DM < 0.160 ABUT <90
}

GATE_W_DM = POLYG_dm COIN INSIDE EDGE GATE      
HV_GATE_W_DM    = GATE_W_DM INSIDE EDGE (OD2_33_dm OR OD2_25_dm)         
HV_NGATE_W_DM   = HV_GATE_W_DM INSIDE EDGE NP        

D_PO.W.2 {@ Rule D_PO.W.2: Minimum PO;dm width (gate length) of DRAM MOS (on OD25;dm or OD33;dm): 0.180 
   R1 =     INT HV_NGATE_W_DM < 0.180 ABUT <90 REGION
   M = FDRC INSIDE CELL '*FR_D_POXWX2_*' '*FR_POXWX2_D_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_PO.S.5 {@ Rule D_PO.S.5: Minimum Space of 45 PO;dm lines on field oxide: 0.140 
   R1 =     EXT POLYG_dm < 0.140 ABUT <90 ANGLED  REGION
   M = FDRC INSIDE CELL '*FR_D_POXSX5_*' '*FR_POXSX5_D_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

ODGO2_dm = OD_dm AND (OD2_25_dm OR OD2_33_dm)
D_OD.S.1 {@ Rule D_OD.S.1: OD;dm space inside OD25;dm or OD33;dm
   R1 =     EXT ODGO2_dm < 0.140 ABUT <90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_ODXSX1_*' '*FR_ODXSX1_D_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_PO.W.6 {@ Rule D_PO.W.6: Minimum PO;dm width for 45 lines (on field): 0.120 
   R1 =     INT POLYG_dm  < 0.120 ABUT <90 ANGLED REGION
   M = FDRC INSIDE CELL '*FR_D_POXWX6_*' '*FR_POXWX6_D_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_GEN.1 {@ Rule D_GEN.1: Minimum overlap of layer purpose dm with corresponding layer purpose drawing is minimum width of the drawing layer.
    INT OD_dg OD_dm < 0.110 ABUT <90
    INT OD2_33_dg OD2_33_dm < 0.620 ABUT <90
    INT OD2_25_dg OD2_25_dm < 0.620 ABUT <90
    INT POLYG_dg POLYG_dm < 0.100 ABUT <90
    INT NP_dg NP_dm < 0.240 ABUT <90
    INT M1_dg M1_dm < 0.120 ABUT <90 
}

D_OD.R.1 {@ Rule D_OD.R.1: OD;dm must be completely covered by CELLIMP;dm
    OD_dm NOT CELLIMP_dm
}

D_PO.R.5 {@ Rule D_PO.R.5: PO;dm must be completely covered by CELLIMP;dm
    POLYG_dm NOT CELLIMP_dm
}

D_CO.R.3 {@ Rule D_CO.R.3: CO;dm inside RPO not allowed
    CO_dm AND RPO
}

GATE_Nodm = POLYG_dg AND OD_dg
D_OD2.R.1 {@ Rule D_OD2.R.1: OD25;dm, OD33;dm, CELLIMP;dm must not intersect Gate except when Gate is formed by {PO;dm and OD;dm}
    ((OD2_25_dm OR OD2_33_dm) OR CELLIMP_dm) AND GATE_Nodm
}

GROUP D_OD D_OD.?
GROUP D_PO D_PO.?
GROUP D_CO D_CO.?

GROUP DRAM D_?

//------------------------------------------------------------------------------
// LIL  
//------------------------------------------------------------------------------
 
D_LIL.W.1 {@ Rule D_LIL.W.1: Width (width = length, min. = max.): 0.120
   R1 =     NOT RECTANGLE LIL_dm == 0.120 BY == 0.120 
   M = FDRC INSIDE CELL '*FR_D_LILXWX1_*' '*FR_D39X1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.S.1 {@ Rule D_LIL.S.1: Space: 0.140
   R1 =     EXT LIL_dm < 0.140 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_LILXSX1_*' '*FR_D39X2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.D.1 {@ Rule D_LIL.D.1: Distance to PO: 0.080
   R1 =     EXT LIL_dm POLY < 0.080  REGION
   M = FDRC INSIDE CELL '*FR_D_LILXDX1_*' '*FR_D39X3_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.D.2 {@ Rule D_LIL.D.2: Distance of LIL;dm on PO to OD: 0.100
   R1 =     EXT (LIL_dm AND POLY) OD < 0.100 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_LILXDX2_*' '*FR_D_LILXDX2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.EN.1 {@ Rule D_LIL.EN.1: Enclosure by OD: 0.020
   R1 =     ENC LIL_dm OD < 0.020 ABUT <90 SINGULAR INSIDE ALSO REGION
   M = FDRC INSIDE CELL '*FR_D_LILXENX1_*' '*FR_D39X4_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.EN.2 {@ Rule D_LIL.EN.2: Enclosure by PO: 0.020
   R1 =     ENC LIL_dm POLY < 0.020 ABUT SINGULAR INSIDE ALSO REGION
   M = FDRC INSIDE CELL '*FR_D_LILXENX2_*' '*FR_D_LILXENX2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.EX.1 {@ Rule D_LIL.EX.1: PO Extension on LIL;dm on at least 2 opposite sides: 0.050
   R1 =     RECTANGLE ENCLOSURE LIL_dm POLY ABUT <90 SINGULAR GOOD 0 0.050 OPPOSITE 0 0.050 OPPOSITE
   M = FDRC INSIDE CELL '*FR_D_LILXEXX1_*' '*FR_D_LIL_EXX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.R.1 {@ Rule D_LIL.R.1: LIL;dm on GATE not allowed
   R1 =     LIL_dm AND GATE
   M = FDRC INSIDE CELL '*FR_D_LILXX1_*' '*FR_D_LILXX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.R.2 {@ Rule D_LIL.R.2: LIL;dm on RPO not allowed
    LIL_dm AND RPO
}

D_LIL.R.3 {@ Rule D_LIL.R.3: LIL;dm must be fully covered by OD or PO
   R1 =     LIL_dm NOT (OD OR POLY)
   M = FDRC INSIDE CELL '*FR_D_LILXX3_*' '*FR_D_LILXX3_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_LIL.R.5 {@ Rule D_LIL.R.5: 45 rotated LIL;dm not allowed
    ANGLE LIL_dm == 45
}

D_LIL.R.6 {@ Rule D_LIL.R.6: LIL;dm on {NP or CELLIMP;dm}/PP boundary not allowed
    LIL_dm CUT (NPi OR CELLIMP_dm)
    LIL_dm CUT PPi
}

GROUP D_LIL D_LIL.?

//------------------------------------------------------------------------------
// ELEC1  
//------------------------------------------------------------------------------
 
D_ELEC1.W.1 {@ Rule D_ELEC1.W.1: Width: 0.180
   R1 =     INT ELEC1 < 0.180 ABUT >0<90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_ELEC1XWX1_*' '*FR_D_ELEC1XWX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC1.S.1 {@ Rule D_ELEC1.S.1: Space: 0.100
   R1 =     EXT ELEC1 < 0.100 ABUT >0<90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_ELEC1XSX1_*' '*FR_D_ELEC1XSX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC1.EN.1 {@ Rule D_ELEC1.EN.1: Enclosure of LIL;dm (LIL;dm must be fully covered by ELEC1;dm): 0.030
   R1 =     ENC LIL_dm ELEC1 < 0.030 ABUT <90 OUTSIDE ALSO SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_ELEC1XENX1_*' '*FR_D_ELEC1XENX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC1.R.1 {@ Rule D_ELEC1.R.1: ELEC1 must be covered fully by ELEC2
    ELEC1 NOT ELEC2 
}

GROUP D_ELEC1 D_ELEC1.?

//------------------------------------------------------------------------------
// ELEC2 
//------------------------------------------------------------------------------
 
D_ELEC2.W.1 {@ Rule D_ELEC2.W.1: Width: 0.220
   R1 =     INT ELEC2 < 0.220 ABUT >0<90 SINGULAR REGION
   M = FDRC INSIDE CELL '*FR_D_ELEC2XWX1_*' '*FR_D_ELEC2XWX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC2.S.1 {@ Rule D_ELEC2.S.1: Space: 0.300
    EXT ELEC2 < 0.300 ABUT >0<90 SINGULAR REGION
}

HOLE_ELEC2 = AREA (HOLES ELEC2) == 0.09
D_ELEC2.EN.1 {@ Rule D_ELEC2.EN.1: Enclosure of ELEC1;dm (for ELEC2;dm edge that forms hole of 0.3um x 0.3um): 0.060
    X = ENC ELEC1 ELEC2 < 0.060 ABUT <90 SINGULAR OUTSIDE ALSO REGION
   R1 =     X INTERACT HOLE_ELEC2
   M = FDRC INSIDE CELL '*FR_D_ELEC2XENX1_*' '*FR_D_ELEC2XENX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC2.EN.2 {@ Rule D_ELEC2.EN.2: Enclosure of ELEC1;dm (except for ELEC2;dm edge that forms hole of 0.3um x 0.3um): 0.130
    X = ENC ELEC1 ELEC2 < 0.130 ABUT <90 SINGULAR OUTSIDE ALSO REGION
   R1 =     X NOT INTERACT HOLE_ELEC2
   M = FDRC INSIDE CELL '*FR_D_ELEC2XENX2_*' '*FR_D_ELEC2XENX2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC2.D.1 {@ Rule D_ELEC2.D.1: Distance to CO;dm (for ELEC2;dm edge that forms hole of 0.3um x 0.3um): 0.090
    ENC CO_dm HOLE_ELEC2 < 0.090 ABUT <90 SINGULAR REGION 
    CO_dm CUT HOLE_ELEC2
}

D_ELEC2.D.2 {@ Rule D_ELEC2.D.2: Distance to CO or CO;dm (except for ELEC2;dm edge that forms hole of 0.3um x 0.3um): 0.130
    X = EXT ELEC2 CO < 0.130 ABUT <90 SINGULAR REGION
   R1 =     X OUTSIDE HOLE_ELEC2
   M = FDRC INSIDE CELL '*FR_D_ELEC2XDX2_*' '*FR_D_ELEC2XDX2_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

D_ELEC2.R.1 {@ Rule D_ELEC2.R.1: No CO or CO;dm allowed above ELEC2;dm
    CO AND ELEC2
}

GROUP D_ELEC2 D_ELEC2.?
    
//------------------------------------------------------------------------------
// CTELEC2  
//------------------------------------------------------------------------------
     
D_CO2.W.1 {@ Rule D_CO2.W.1: Width (width = length, min = max): 0.120
    NOT RECTANGLE CTELEC2 == 0.120 BY == 0.120
}

D_CO2.S.1 {@ Rule D_CO2.S.1: Space: 0.300
    EXT CTELEC2 < 0.300 ABUT >0<90 SINGULAR
}
           
D_CO2.EN.1 {@ Rule D_CO2.EN.1: Enclosure by ELEC2;dm (CO;CTELEC2 must be fully covered by ELEC2;dm): 0.130
   R1 =     ENC CTELEC2 ELEC2  < 0.130 ABUT <90 SINGULAR OUTSIDE ALSO REGION
   M = FDRC INSIDE CELL '*FR_D_CO2XENX1_*' '*FR_D_CO2XENX1_*'
   R1 NOT INTERACT M
   R2 = R1 INTERACT M
   R2 INTERACT (SIZE (R2 XOR M) BY -0.001)
     }

GROUP D_CO2 D_CO2.?

//------------------------------------------------------------------------------
// CELLIMP purpose DRAM
//------------------------------------------------------------------------------

D_CIMP.W.1 {@ Rule D_CIMP.W.1: CELLIMP;dm Width: 0.400
    INT CELLIMP_dm < 0.400 ABUT >0<90 SINGULAR REGION
}

D_CIMP.S.1 {@ Rule D_CIMP.S.1: CELLIMP;dm Space: 0.400
    EXT CELLIMP_dm < 0.400 ABUT >0<90 SINGULAR REGION
}

D_CIMP.A.1 {@ Rule D_CIMP.A.1: CELLIMP;dm Area: 1.550
    AREA CELLIMP_dm < 1.550
}

D_CIMP.A.2 {@ Rule D_CIMP.A.2: CELLIMP;dm Enclosed Area: 0.250
    HOLES CELLIMP_dm < 0.250
}

D_CIMP.EN.1 {@ Rule D_CIMP.EN.1: CELLIMP;dm Enclosure of OD: 0.150
    ENC OD CELLIMP_dm  < 0.150 ABUT <90 SINGULAR REGION
}

D_CIMP.EN.2 {@ Rule D_CIMP.EN.2: CELLIMP;dm Enclosure of Gate: 0.220
    ENC GATE CELLIMP_dm  < 0.220 ABUT <90 SINGULAR REGION
}

D_CIMP.D.1 {@ Rule D_CIMP.D.1: CELLIMP;dm Distance to OD: 0.020
    EXT CELLIMP_dm OD < 0.020 ABUT <90 SINGULAR
}

D_CIMP.D.2 {@ Rule D_CIMP.D.2: CELLIMP;dm Distance to Gate: 0.220
    EXT CELLIMP_dm GATE < 0.220 ABUT <90 SINGULAR
}

D_CIMP.R.1 {@ Rule D_CIMP.R.1: CELLIMP;dm Intersection with PP is not allowed 
    CELLIMP_dm AND PP
}

GROUP D_CIMP D_CIMP.?

//  -------------------------------------------------------------------------
//      Bond Pad Design Rules
//  -------------------------------------------------------------------------

// bonding area is MKR;wb or CB outside SR
BONDING_AREA = MKR_WB OR (CBi NOT SEALRING_TC)
DS_BONDING_AREA = SIZE BONDING_AREA BY Bond_area

// metal inside bonding area and outside bonding area
M4X_WB = DS_BONDING_AREA AND M4
M5X_WB = DS_BONDING_AREA AND M5
M6Z_WB = DS_BONDING_AREA AND M6
M7Z_WB = DS_BONDING_AREA AND M7

WB.W.1 {@ Rule WB.W.1: Bonding Area Width : 30.000
    INT BONDING_AREA < 30.000 ABUT >0<90 SINGULAR REGION
}

//connectivity between Mtop and CB/CB_via for rule WB.D.1:
MTOP_PADi = (M7 INTERACT BONDING_AREA) OR (HOLES (M7 INTERACT BONDING_AREA) INNER)
MTOP_PAD = (SIZE MTOP_PADi BY 15 UNDEROVER TRUNCATE 15) AND MTOP_PADi //to keep only pads Mtop
CBs_PAD = (CBi OR CB_via) INSIDE MTOP_PAD
M7_FORPAD = M7 OR EMPTY
CONNECT CBs_PAD M7_FORPAD

WB.D.1 {@ Rule WB.D.1: Mtop Distance to unrelated CB or CB;via (to limit distance for pads and distance between pad and wiring metal) : 3.000
    EXT M7_FORPAD CBs_PAD < 3.000 ABUT >0<90 SINGULAR REGION MEASURE ALL NOT CONNECTED
}
       
WB.S.2 {@ Rule WB.S.2: M4, M5, ..., Mtop Space (within downsized bonding area): 1.000
       EXT M4X_WB < 1.000 ABUT >0<90 SINGULAR REGION 
       EXT M5X_WB < 1.000 ABUT >0<90 SINGULAR REGION 
       EXT M6Z_WB < 1.000 ABUT >0<90 SINGULAR REGION 
       EXT M7Z_WB < 1.000 ABUT >0<90 SINGULAR REGION 
      
}
       
WB.R.2 {@ Rule WB.R.2: NITRIDE may extend on maximal one edge of MKR;wb
    MKR_WB INTERACT (EXPAND EDGE (INSIDE EDGE MKR_WB (NITRIDE_dg INTERACT MKR_WB)) OUTSIDE by 0.005) > 1
}

// bonding area density
WB_DENS = EXTENTS DS_BONDING_AREA
M1_WB_DENS = WB_DENS AND M1_DENS
M2_WB_DENS = WB_DENS AND M2_DENS
M3_WB_DENS = WB_DENS AND M3_DENS
M4_WB_DENS = WB_DENS AND M4_DENS
M5_WB_DENS = WB_DENS AND M5_DENS
M6_WB_DENS = WB_DENS AND M6_DENS
M7_WB_DENS = WB_DENS AND M7_DENS
WB.DEN.1_M1 {@ Rule WB.DEN.1_M1: M1, M2, M3 minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.2
    DENSITY M1_WB_DENS < 0.2 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1_M1.density 
}
WB.DEN.1_M2 {@ Rule WB.DEN.1_M2: M1, M2, M3 minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.2
    DENSITY M2_WB_DENS < 0.2 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1_M2.density 
}
WB.DEN.1_M3 {@ Rule WB.DEN.1_M3: M1, M2, M3 minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.2
    DENSITY M3_WB_DENS < 0.2 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1_M3.density 
}

WB.DEN.1.1_M4 {@ Rule WB.DEN.1.1_M4: M4, M5, ..., Mtop minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.3
    DENSITY M4_WB_DENS < 0.3 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1.1_M4.density 
}
WB.DEN.1.1_M5 {@ Rule WB.DEN.1.1_M5: M4, M5, ..., Mtop minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.3
    DENSITY M5_WB_DENS < 0.3 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1.1_M5.density 
}
WB.DEN.1.1_M6 {@ Rule WB.DEN.1.1_M6: M4, M5, ..., Mtop minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.3
    DENSITY M6_WB_DENS < 0.3 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1.1_M6.density 
}
WB.DEN.1.1_M7 {@ Rule WB.DEN.1.1_M7: M4, M5, ..., Mtop minimum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.3
    DENSITY M7_WB_DENS < 0.3 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.1.1_M7.density 
}

WB.DEN.2_M1 {@ Rule WB.DEN.2_M1: M1, M2, M3, ..., Mtop-1 maximum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.8
    DENSITY M1_WB_DENS > 0.8 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.2_M1.density 
}
WB.DEN.2_M2 {@ Rule WB.DEN.2_M2: M1, M2, M3, ..., Mtop-1 maximum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.8
    DENSITY M2_WB_DENS > 0.8 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.2_M2.density 
}
WB.DEN.2_M3 {@ Rule WB.DEN.2_M3: M1, M2, M3, ..., Mtop-1 maximum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.8
    DENSITY M3_WB_DENS > 0.8 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.2_M3.density 
}
WB.DEN.2_M4 {@ Rule WB.DEN.2_M4: M1, M2, M3, ..., Mtop-1 maximum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.8
    DENSITY M4_WB_DENS > 0.8 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.2_M4.density 
}
WB.DEN.2_M5 {@ Rule WB.DEN.2_M5: M1, M2, M3, ..., Mtop-1 maximum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.8
    DENSITY M5_WB_DENS > 0.8 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.2_M5.density 
}
WB.DEN.2_M6 {@ Rule WB.DEN.2_M6: M1, M2, M3, ..., Mtop-1 maximum density over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.8
    DENSITY M6_WB_DENS > 0.8 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.2_M6.density 
}

WB.DEN.3 {@ Rule WB.DEN.3: Maximum density of the layer combination {Mtop-1 .or. ... .or. M4} over local 20um x 20um areas stepped in 5um increments (if check window is within downsized bonding area): 0.85
    M1_DENS_PAD_WB = COPY M4_WB_DENS
    M2_DENS_PAD_WB = M1_DENS_PAD_WB OR M5_WB_DENS
    M3_DENS_PAD_WB = M2_DENS_PAD_WB OR M6_WB_DENS
    DENSITY M3_DENS_PAD_WB > 0.85 WINDOW 20/Win_dev STEP 5/Step_dev INSIDE OF LAYER WB_DENS BACKUP PRINT WB.DEN.3.density 
}

GROUP WB WB.?
GROUP WB_DEN WB.DEN.?

//  -------------------------------------------------------------------------
//      Standard Pad Construction Rules
//  -------------------------------------------------------------------------

CB_pop =  (NITRIDE_dg INSIDE ALUCAP_DENS) NOT (SEALRING_TC OR SEALRING_TC_MZ)
CB_probe = ((CB_via NOT INTERACT MKR_WB) AND MKR_TP) NOT (SEALRING_TC OR SEALRING_TC_MZ)
CB_pad = (((CBi NOT CB_probe) OR (((CB_via AND ALUCAP) AND NITRIDE_dg) AND MKR_WB)) AND M7i) NOT (SEALRING_TC OR SEALRING_TC_MZ)
CB_rf = (CB_pad INTERACT VIA6) NOT INTERACT VIA5
CB_boa = CB_pad NOT INTERACT VIA6
CB_STD = CB_pad NOT ((CB_boa OR CB_rf) OR CB_pop)

//---------------  Standard pad
CR_PAD:1 = M1 INTERACT CB_STD
CR_PAD:2 = CR_PAD:1 AND M2
CR_PAD:3 = CR_PAD:2 AND M3
CR_PAD:4 = CR_PAD:3 AND M4
CR_PAD:5 = CR_PAD:4 AND M5
CR_PAD:6 = CR_PAD:5 AND M6

HOLES_CR_PAD = HOLES CR_PAD:6                 //PAD ring
HOLES_CR_STD = HOLES_CR_PAD INTERACT VIA6  //STD PAD holes
CR_STD1 = (SIZE HOLES_CR_STD BY 30.000) NOT HOLES_CR_STD
CR_STD = CR_PAD:6 AND  CR_STD1              // STD PAD ring

M1_STD = HOLES_CR_STD AND M1
M1_STD_NOT_PAD = HOLES_CR_STD NOT M1
M2_STD = HOLES_CR_STD AND M2
M2_STD_NOT_PAD = HOLES_CR_STD NOT M2
M3_STD = HOLES_CR_STD AND M3
M3_STD_NOT_PAD = HOLES_CR_STD NOT M3
M4_STD = HOLES_CR_STD AND M4
M4_STD_NOT_PAD = HOLES_CR_STD NOT M4
M5_STD = HOLES_CR_STD AND M5
M5_STD_NOT_PAD = HOLES_CR_STD NOT M5
M6_STD = HOLES_CR_STD AND M6
M6_STD_NOT_PAD = HOLES_CR_STD NOT M6
M7_STD = HOLES_CR_STD AND M7
M7_STD_NOT_PAD = HOLES_CR_STD NOT M7
VIA1_STD = VIA1 INSIDE HOLES_CR_STD
VIA2_STD = VIA2 INSIDE HOLES_CR_STD
VIA3_STD = VIA3 INSIDE HOLES_CR_STD
VIA4_STD = VIA4 INSIDE HOLES_CR_STD
VIA5_STD = VIA5 INSIDE HOLES_CR_STD
VIA6_STD = VIA6 INSIDE HOLES_CR_STD
 
S_WB.W.1 {@ Rule S_WB.W.1: M1, Mx, Mn (up to Mtop-1) Width for connection ring (except: minimum 3.0 at 45deg corners): 5.000
    INT (M1 AND CR_STD) < 5.000 ABUT <90 OPPOSITE PARALLEL
    INT (M1 AND CR_STD) < 3.000 ABUT <90 ANGLED OPPOSITE PARALLEL
    INT (M2 AND CR_STD) < 5.000 ABUT <90 OPPOSITE PARALLEL
    INT (M2 AND CR_STD) < 3.000 ABUT <90 ANGLED OPPOSITE PARALLEL
    INT (M3 AND CR_STD) < 5.000 ABUT <90 OPPOSITE PARALLEL
    INT (M3 AND CR_STD) < 3.000 ABUT <90 ANGLED OPPOSITE PARALLEL
    INT (M4 AND CR_STD) < 5.000 ABUT <90 OPPOSITE PARALLEL
    INT (M4 AND CR_STD) < 3.000 ABUT <90 ANGLED OPPOSITE PARALLEL
    INT (M5 AND CR_STD) < 5.000 ABUT <90 OPPOSITE PARALLEL
    INT (M5 AND CR_STD) < 3.000 ABUT <90 ANGLED OPPOSITE PARALLEL
    INT (M6 AND CR_STD) < 5.000 ABUT <90 OPPOSITE PARALLEL
    INT (M6 AND CR_STD) < 3.000 ABUT <90 ANGLED OPPOSITE PARALLEL
}

S_WB.W.2 {@ Rule S_WB.W.2: M1, Mx, Mn Width in grid (min = max): 1.500
       SZPAD = SIZE (CB_pad INTERACT HOLES_CR_STD) BY -28
       Y1 = SZPAD AND M1
       Y1 WITH WIDTH < 1.500
       Y1 WITH WIDTH > 1.500
       Y2 = SZPAD AND M2
       Y2 WITH WIDTH < 1.500
       Y2 WITH WIDTH > 1.500
       Y3 = SZPAD AND M3
       Y3 WITH WIDTH < 1.500
       Y3 WITH WIDTH > 1.500
       Y4 = SZPAD AND M4
       Y4 WITH WIDTH < 1.500
       Y4 WITH WIDTH > 1.500
       Y5 = SZPAD AND M5
       Y5 WITH WIDTH < 1.500
       Y5 WITH WIDTH > 1.500
       Y6 = SZPAD AND M6
       Y6 WITH WIDTH < 1.500
       Y6 WITH WIDTH > 1.500
}

S_WB.S.2 {@ Rule S_WB.S.2: M1, Mx, Mn Space (use min = max inside grid): 1.000
       X_M1 = SIZE M1_STD BY 1.000/2
       Y_M1 = SIZE M1_STD BY 1.000/2 OVERLAP ONLY
       Y_M1 OR (HOLES_CR_STD INTERACT X_M1 > 1)
       X_M2 = SIZE M2_STD BY 1.000/2
       Y_M2 = SIZE M2_STD BY 1.000/2 OVERLAP ONLY
       Y_M2 OR (HOLES_CR_STD INTERACT X_M2 > 1)
       X_M3 = SIZE M3_STD BY 1.000/2
       Y_M3 = SIZE M3_STD BY 1.000/2 OVERLAP ONLY
       Y_M3 OR (HOLES_CR_STD INTERACT X_M3 > 1)
       X_M4 = SIZE M4_STD BY 1.000/2
       Y_M4 = SIZE M4_STD BY 1.000/2 OVERLAP ONLY
       Y_M4 OR (HOLES_CR_STD INTERACT X_M4 > 1)
       X_M5 = SIZE M5_STD BY 1.000/2
       Y_M5 = SIZE M5_STD BY 1.000/2 OVERLAP ONLY
       Y_M5 OR (HOLES_CR_STD INTERACT X_M5 > 1)
       X_M6 = SIZE M6_STD BY 1.000/2
       Y_M6 = SIZE M6_STD BY 1.000/2 OVERLAP ONLY
       Y_M6 OR (HOLES_CR_STD INTERACT X_M6 > 1)
}

S_WB.S.3 {@ Rule S_WB.S.3: Maximum M1, Mx, Mn Space of grids to metal connection ring: 3.500
       M1_STD_NOT_PAD WITH WIDTH > 3.500
       M2_STD_NOT_PAD WITH WIDTH > 3.500
       M3_STD_NOT_PAD WITH WIDTH > 3.500
       M4_STD_NOT_PAD WITH WIDTH > 3.500
       M5_STD_NOT_PAD WITH WIDTH > 3.500
       M6_STD_NOT_PAD WITH WIDTH > 3.500
     
}

S_WB.S.4 {@ Rule S_WB.S.4: VIAx Space in grid: 0.220
       EXT VIA1_STD < 0.220 ABUT >0< 90 SINGULAR REGION
       EXT VIA2_STD < 0.220 ABUT >0< 90 SINGULAR REGION
       EXT VIA3_STD < 0.220 ABUT >0< 90 SINGULAR REGION
       EXT VIA4_STD < 0.220 ABUT >0< 90 SINGULAR REGION
     
}

S_WB.S.5 {@ Rule S_WB.S.5: VIAn Space in grid (is same as array space VIAn.S.2): 0.540
    EXT VIA5_STD < 0.540 ABUT <90 SINGULAR
    EXT VIA6_STD < 0.540 ABUT <90 SINGULAR
    
}

S_WB.EN.2 {@ Rule S_WB.EN.2: M1, Mx, Mn Enclosure of CB for connection ring: 2.000
    ENC CB_STD M1 < 2.000 ABUT <90
    ENC CB_STD M2 < 2.000 ABUT <90
    ENC CB_STD M3 < 2.000 ABUT <90
    ENC CB_STD M4 < 2.000 ABUT <90
    ENC CB_STD M5 < 2.000 ABUT <90
    ENC CB_STD M6 < 2.000 ABUT <90
    
}

S_WB.EN.3 {@ Rule S_WB.EN.3: Metal (above and below) Enclosure of VIAx: 0.160
    ENC VIA1_STD M1 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA1_STD M2 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA2_STD M2 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA2_STD M3 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA3_STD M3 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA3_STD M4 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA4_STD M4 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA4_STD M5 < 0.160 ABUT <90 SINGULAR OUTSIDE ALSO
    
}

S_WB.EN.4 {@ Rule S_WB.EN.4: Metal (above and below) Enclosure of VIAn: 0.120
    ENC VIA5_STD M5 < 0.120 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA5_STD M6 < 0.120 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA6_STD M6 < 0.120 ABUT <90 SINGULAR OUTSIDE ALSO
    ENC VIA6_STD M7 < 0.120 ABUT <90 SINGULAR OUTSIDE ALSO
    
}

S_WB.L.1 {@ Rule S_WB.L.1: Metals must have 45deg beveled corners. Minimum M1, Mx, Mn Corner Length: 2.000
    
    V1 = M1 INTERACT CB_STD
    W1 = (HOLES V1) OR V1
    X1 = (SIZE W1 BY 6 UNDEROVER TRUNCATE 6) AND W1
    Y1 = V1 AND X1
    Z1 = ANGLE Y1 == 45
    LENGTH Z1 < 2.000 * COS45
    Y1 NOT WITH EDGE Z1
    V2 = M2 INTERACT CB_STD
    W2 = (HOLES V2) OR V2
    X2 = (SIZE W2 BY 6 UNDEROVER TRUNCATE 6) AND W2
    Y2 = V2 AND X2
    Z2 = ANGLE Y2 == 45
    LENGTH Z2 < 2.000 * COS45
    Y2 NOT WITH EDGE Z2
    V3 = M3 INTERACT CB_STD
    W3 = (HOLES V3) OR V3
    X3 = (SIZE W3 BY 6 UNDEROVER TRUNCATE 6) AND W3
    Y3 = V3 AND X3
    Z3 = ANGLE Y3 == 45
    LENGTH Z3 < 2.000 * COS45
    Y3 NOT WITH EDGE Z3
    V4 = M4 INTERACT CB_STD
    W4 = (HOLES V4) OR V4
    X4 = (SIZE W4 BY 6 UNDEROVER TRUNCATE 6) AND W4
    Y4 = V4 AND X4
    Z4 = ANGLE Y4 == 45
    LENGTH Z4 < 2.000 * COS45
    Y4 NOT WITH EDGE Z4
    V5 = M5 INTERACT CB_STD
    W5 = (HOLES V5) OR V5
    X5 = (SIZE W5 BY 6 UNDEROVER TRUNCATE 6) AND W5
    Y5 = V5 AND X5
    Z5 = ANGLE Y5 == 45
    LENGTH Z5 < 2.000 * COS45
    Y5 NOT WITH EDGE Z5
    V6 = M6 INTERACT CB_STD
    W6 = (HOLES V6) OR V6
    X6 = (SIZE W6 BY 6 UNDEROVER TRUNCATE 6) AND W6
    Y6 = V6 AND X6
    Z6 = ANGLE Y6 == 45
    LENGTH Z6 < 2.000 * COS45
    Y6 NOT WITH EDGE Z6
    V7 = M7 INTERACT CB_STD
    W7 = (HOLES V7) OR V7
    X7 = (SIZE W7 BY 6 UNDEROVER TRUNCATE 6) AND W7
    Y7 = V7 AND X7
    Z7 = ANGLE Y7 == 45
    LENGTH Z7 < 2.000 * COS45
    Y7 NOT WITH EDGE Z7
}

S_WB.R.3 {@ Rule S_WB.R.3: Standard pad consists of solid Mtop, and a fill pattern below. The fill pattern must consist of all metals (M1 to Mtop-1) and vias (VIA1 to VIAtop) levels. It must not contain any CO.
    CO AND HOLES_CR_STD
    HOLES_CR_STD NOT INTERACT VIA1
    HOLES_CR_STD NOT INTERACT M1
    HOLES_CR_STD NOT INTERACT VIA2
    HOLES_CR_STD NOT INTERACT M2
    HOLES_CR_STD NOT INTERACT VIA3
    HOLES_CR_STD NOT INTERACT M3
    HOLES_CR_STD NOT INTERACT VIA4
    HOLES_CR_STD NOT INTERACT M4
    HOLES_CR_STD NOT INTERACT VIA5
    HOLES_CR_STD NOT INTERACT M5
    HOLES_CR_STD NOT INTERACT VIA6
    HOLES_CR_STD NOT INTERACT M6
}

S_WB.R.4 {@ Rule S_WB.R.4: Number of VIAx in each metal intersection inside bonding area: 16
    X1 = M1_STD AND M2_STD
    X1 INTERACT VIA1_STD < 16
    X1 NOT INTERACT VIA1_STD
    X2 = M2_STD AND M3_STD
    X2 INTERACT VIA2_STD < 16
    X2 NOT INTERACT VIA2_STD
    X3 = M3_STD AND M4_STD
    X3 INTERACT VIA3_STD < 16
    X3 NOT INTERACT VIA3_STD
    X4 = M4_STD AND M5_STD
    X4 INTERACT VIA4_STD < 16
    X4 NOT INTERACT VIA4_STD
    
}

S_WB.R.5 {@ Rule S_WB.R.5: Number of VIAn in each metal intersection inside bonding area: 4
    X5 = SIZE VIA5_STD BY 0.540/2 OVERUNDER
    X5 INTERACT VIA5_STD < 4
    (M4_STD AND (M5_STD AND M6)) NOT INTERACT VIA5_STD
    
    X6 = SIZE VIA6_STD BY 0.540/2 OVERUNDER
    X6 INTERACT VIA6_STD < 4
    (M5_STD AND (M6_STD AND M7)) NOT INTERACT VIA6_STD
    
    
}

GROUP STD_PAD_CHECK S_WB.?

//------------------------------------------------------------------------------
// CB  
//------------------------------------------------------------------------------

CB.W.1 {@ Rule CB.W.1: {CB or CB;via} Width (except CB;via in MIM): 3.000
    INT CBi < 3.000 ABUT >0<90 SINGULAR REGION
    INT CB_VIA_METAL:1 < 3.000 ABUT >0<90 SINGULAR REGION  //CB_via on MIM not considered
}

CB.S.1 {@ Rule CB.S.1: CB Space: 6.000
    EXT CBi < 6.000 ABUT >0<90 SINGULAR REGION
}

CB.S.2 {@ Rule CB.S.2: CB;via Space (except CB;via in MIM): 2.000
    EXT CB_VIA_METAL:1 < 2.000 ABUT >0<90 SINGULAR REGION //CB_via on MIM not considered
}

CB.EN.1 {@ Rule CB.EN.1: {CB or CB;via} Enclosure by Mtop (Mtop must cover {CB or CB;via} except CB under MKR;sealring): 0.700
    ENC (CBi OR CB_VIA_NOT_MIM_NOT_SR) M7 < 0.700 ABUT <90 SINGULAR INSIDE ALSO REGION
    ((CBi NOT (SEALRING_TC OR SEALRING_TC_MZ)) OR CB_VIA_NOT_MIM_NOT_SR) NOT M7
}

CB.R.1 {@ Rule CB.R.1: CB must not interact with CB;via
    CB_via INTERACT CBi
}

GROUP CB CB?

//------------------------------------------------------------------------------
// AP  
//------------------------------------------------------------------------------

AP.W.1 {@ Rule AP.W.1: AP Width (except in MIM): 3.000 
    INT (ALUCAP NOT ALUCAP_MIM) < 3.000 ABUT >0<90 SINGULAR REGION
}

AP.W.2 {@ Rule AP.W.2: Maximum AP width (excluding AP under NITRIDE or NITRIDE;bump): 35.000 
    ((ALUCAP NOT (NITRIDE_dg or NIT_bp)) NOT FILTER_I.AP.W.1)  WITH WIDTH > 35.000
}

AP.S.1 {@ Rule AP.S.1: AP Space: 2.000 
    EXT ALUCAP < 2.000 ABUT >0<90 SINGULAR REGION
}

AP.EN.1 {@ Rule AP.EN.1: AP Enclosure of CB;via (AP must cover CB;via): 0.700 
    ENC CB_via ALUCAP < 0.700 ABUT <90 SINGULAR REGION OUTSIDE ALSO INSIDE ALSO
}

AP.D.1 {@ Rule AP.D.1: AP Distance to CB (AP must not interact with CB): 4.000 
    EXT ALUCAP CBi < 4.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}

AP.PIN.CAD.1 {@ Rule AP.PIN.CAD.1: AP purpose PIN without DRAWING
    AP_pin NOT ALUCAP
}

GROUP AP AP.?

//------------------------------------------------------------------------------
// NITRIDE  
//------------------------------------------------------------------------------

NIT.W.1 {@ Rule NIT.W.1: {NITRIDE or NITRIDE;bump} Width: 2.000
    INT (NITRIDE_dg or NIT_bp) < 2.000 ABUT >0<90 SINGULAR REGION
}

NIT.S.1 {@ Rule NIT.S.1: {NITRIDE or NITRIDE;bump} Space: 2.000
    EXT (NITRIDE_dg or NIT_bp) < 2.000 ABUT >0<90 SINGULAR REGION
}

NIT.EN.1 {@ Rule NIT.EN.1: {NITRIDE or NITRIDE;bump} Enclosure by AP (must be fully covered by AP): 1.000 
    ENC (NITRIDE_dg or NIT_bp) ALUCAP < 1.000 ABUT <90 SINGULAR REGION OUTSIDE ALSO INSIDE ALSO
}

NIT.D.1 {@ Rule NIT.D.1: {NITRIDE or NITRIDE;bump} Distance to CB (must not interact with CB): 4.000
    EXT (NITRIDE_dg or NIT_bp) CBi < 4.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
}
      
NIT.OL.1 {@ Rule NIT.OL.1: CB;via Overlap of NITRIDE (align if less): 2.000
    INT CB_via NITRIDE_dg < 2.000 ABUT >0<90 SINGULAR REGION    
}

NIT.EX.1 {@ Rule NIT.EX.1: CB;via Extension on NITRIDE (align if less): 2.000
    ENC NITRIDE_dg CB_via  < 2.000 ABUT >0<90 SINGULAR REGION
}

NIT.D.2 {@ Rule NIT.D.2: NITRIDE;bump Distance to CB;via (CB;via must not straddle NITRIDE;bump, it must be either completely inside or completely outside NITRIDE;bump): 2.000
    EXT NIT_bp CB_via < 2.000 ABUT <90 SINGULAR REGION
        CB_via CUT NIT_bp
}

NIT.R.2 {@ Rule NIT.R.2: NITRIDE must be fully covered by a marker layer {MKR;wb or MKR;tp}
    (NITRIDE_dg NOT (MKR_WB OR MKR_TP)) NOT INTERACT SEALRING_TC_MZ
}      

NIT.R.3 {@ Rule NIT.R.3: NITRIDE must not interact with NITRIDE;bump
    NITRIDE_dg INTERACT NIT_bp
}

GROUP NIT NIT.?

//------------------------------------------------------------------------------
// Logo
//------------------------------------------------------------------------------

LOGO.EN.1 {@ Rule LOGO.EN.1: MKR;logo Enclosure of OD, PO and metal shapes on datatype 31 (MKR;logo layer must cover the logo area): 3.000
    ENC ACTIVE_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC POLY_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME1_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME2_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME3_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME4_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME5_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME6_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
    ENC ME7_ng LOGO < 3.000 ABUT <90 SINGULAR REGION INSIDE ALSO
}

LOGO.D.1 {@ Rule LOGO.D.1: MKR;logo Distance to CB, CB;via, AP, FW, NITRIDE (MKR;logo must not interact with these shapes): 2.000
    EXT LOGO CB < 2.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT LOGO CB_via < 2.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT LOGO ALUCAP < 2.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT LOGO FW < 2.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
    EXT LOGO NITRIDE_dg < 2.000 ABUT ==0 SINGULAR REGION INSIDE ALSO
} 

GROUP LOGO LOGO.?


//------------------------------------------------------------------------------
// SENSE  
//------------------------------------------------------------------------------

ME1_sense_down = ME1_sense NOT WITH TEXT "upwards"
ME1_sense_up = ME1_sense WITH TEXT "upwards"
ME2_sense_down = ME2_sense NOT WITH TEXT "upwards"
ME2_sense_up = ME2_sense WITH TEXT "upwards"
ME3_sense_down = ME3_sense NOT WITH TEXT "upwards"
ME3_sense_up = ME3_sense WITH TEXT "upwards"
ME4_sense_down = ME4_sense NOT WITH TEXT "upwards"
ME4_sense_up = ME4_sense WITH TEXT "upwards"
ME5_sense_down = ME5_sense NOT WITH TEXT "upwards"
ME5_sense_up = ME5_sense WITH TEXT "upwards"
ME6_sense_down = ME6_sense NOT WITH TEXT "upwards"
ME6_sense_up = ME6_sense WITH TEXT "upwards"
ME7_sense_down = ME7_sense NOT WITH TEXT "upwards"
ME7_sense_up = ME7_sense WITH TEXT "upwards"

M1.Sense.down.CAD.1 {@ Rule M1.Sense.down.CAD.1: Metal1,..., Metal1 are forbidden under metal1 sense.
    ME1_sense_down AND M1
}

M1.Sense.up.CAD.1 {@ Rule M1.Sense.up.CAD.1: Metal1,..., Metal7 are forbidden on metal1 sense upward.
    ME1_sense_up AND M1
    ME1_sense_up AND M2
    ME1_sense_up AND M3
    ME1_sense_up AND M4
    ME1_sense_up AND M5
    ME1_sense_up AND M6
    ME1_sense_up AND M7
}

M2.Sense.down.CAD.1 {@ Rule M2.Sense.down.CAD.1: Metal1,..., Metal2 are forbidden under metal2 sense.
    ME2_sense_down AND M1
    ME2_sense_down AND M2
}

M2.Sense.up.CAD.1 {@ Rule M2.Sense.up.CAD.1: Metal2,..., Metal7 are forbidden on metal2 sense upward.
    ME2_sense_up AND M2
    ME2_sense_up AND M3
    ME2_sense_up AND M4
    ME2_sense_up AND M5
    ME2_sense_up AND M6
    ME2_sense_up AND M7
}

M3.Sense.down.CAD.1 {@ Rule M3.Sense.down.CAD.1: Metal1,..., Metal3 are forbidden under metal3 sense.
    ME3_sense_down AND M1
    ME3_sense_down AND M2
    ME3_sense_down AND M3
}

M3.Sense.up.CAD.1 {@ Rule M3.Sense.up.CAD.1: Metal3,..., Metal7 are forbidden on metal3 sense upward.
    ME3_sense_up AND M3
    ME3_sense_up AND M4
    ME3_sense_up AND M5
    ME3_sense_up AND M6
    ME3_sense_up AND M7
}

M4.Sense.down.CAD.1 {@ Rule M4.Sense.down.CAD.1: Metal1,..., Metal4 are forbidden under metal4 sense.
    ME4_sense_down AND M1
    ME4_sense_down AND M2
    ME4_sense_down AND M3
    ME4_sense_down AND M4
}

M4.Sense.up.CAD.1 {@ Rule M4.Sense.up.CAD.1: Metal4,..., Metal7 are forbidden on metal4 sense upward.
    ME4_sense_up AND M4
    ME4_sense_up AND M5
    ME4_sense_up AND M6
    ME4_sense_up AND M7
}

M5.Sense.down.CAD.1 {@ Rule M5.Sense.down.CAD.1: Metal1,..., Metal5 are forbidden under metal5 sense.
    ME5_sense_down AND M1
    ME5_sense_down AND M2
    ME5_sense_down AND M3
    ME5_sense_down AND M4
    ME5_sense_down AND M5
}

M5.Sense.up.CAD.1 {@ Rule M5.Sense.up.CAD.1: Metal5,..., Metal7 are forbidden on metal5 sense upward.
    ME5_sense_up AND M5
    ME5_sense_up AND M6
    ME5_sense_up AND M7
}

M6.Sense.down.CAD.1 {@ Rule M6.Sense.down.CAD.1: Metal1,..., Metal6 are forbidden under metal6 sense.
    ME6_sense_down AND M1
    ME6_sense_down AND M2
    ME6_sense_down AND M3
    ME6_sense_down AND M4
    ME6_sense_down AND M5
    ME6_sense_down AND M6
}

M6.Sense.up.CAD.1 {@ Rule M6.Sense.up.CAD.1: Metal6,..., Metal7 are forbidden on metal6 sense upward.
    ME6_sense_up AND M6
    ME6_sense_up AND M7
}

M7.Sense.down.CAD.1 {@ Rule M7.Sense.down.CAD.1: Metal1,..., Metal7 are forbidden under metal7 sense.
    ME7_sense_down AND M1
    ME7_sense_down AND M2
    ME7_sense_down AND M3
    ME7_sense_down AND M4
    ME7_sense_down AND M5
    ME7_sense_down AND M6
    ME7_sense_down AND M7
}

M7.Sense.up.CAD.1 {@ Rule M7.Sense.up.CAD.1: Metal7,..., Metal7 are forbidden on metal7 sense upward.
    ME7_sense_up AND M7
}

GROUP SENSE ?.Sense.up.CAD.1 ?.Sense.down.CAD.1

//-----------------------------------------------------------
//  SWITCH
//-----------------------------------------------------------

#IFNDEF DENSITY_CHECK
DRC UNSELECT CHECK DENSITY_CHECK
#ENDIF

#IFNDEF DENS_WIN_SIZE
VARIABLE    Win_edge    1
#ENDIF

#IFDEF DENS_WIN_SIZE
VARIABLE    Win_edge    2
#ENDIF

#IFNDEF STD_PAD_CHECK
DRC UNSELECT CHECK STD_PAD_CHECK
#ENDIF

#IFNDEF OD2_REC_RULES
DRC UNSELECT CHECK R_OD2
#ENDIF

#IFNDEF SHRINK
DRC UNSELECT CHECK SHRINK_CHECK
#ENDIF

#IFDEF SHRINK
DRC UNSELECT CHECK CO.D.5
#ENDIF

//  -------------------------------------------------------------------------
//        CornerL
//  -------------------------------------------------------------------------
CORL_large = ((((((((((((((((((((((((((((ACTIVE_ng AND DNW_ng) AND NWEL_ng) AND NW2V_gdr) AND PW_gdr) AND PW2V_gdr) AND ADHVTN_ng) AND ADHVTP_ng) AND VTNCELL_gdr) AND OD2_33_ng)
 AND OD2_25_ng) AND POLY_ng) AND N1V_gdr) AND P1V_gdr) AND N2V_gdr2) AND P2V_gdr) AND VTL_N_ng) AND VTL_P_ng) AND NP_ng) AND PP_ng) AND PP2V_gdr) AND RPOi_ng)
 AND STACK_M7_ng) AND CB_ng) AND AP_gdr) AND PRESIST_0_ng) AND CELLIMP_gdr) AND ELEC2_ng) AND BOTMIM_ng) AND MKTOPMIM_ng
CORL_small = ((CONTACT_ng AND STACK_V6_ng) AND ELEC1_ng) AND CTDRAM_gdr

CORL_SR = (CORL_large ENCLOSE CORL_small) AND (SEALRING_TC OR SEALRING_TC_MZ)
CORL_small_SR = CORL_small AND CORL_SR
CORL_large_SR = CORL_large AND CORL_SR

CORL.L.1 {@ Rule CORL.L.1: Corner L length. (min = max) : 6.500
    CORL_small_EXT    = EXTENTS CORL_small_SR
    CORL_small_COMP    = CORL_small_EXT NOT CORL_small
    NOT RECTANGLE CORL_small_COMP == 6.500 BY == 6.500
    
    CORL_large_EXT    = EXTENTS CORL_large_SR
    CORL_large_COMP    = CORL_large_EXT NOT CORL_large
    NOT RECTANGLE CORL_large_COMP == 6.500 BY == 6.500
}

CORL.W.1 {@ Rule CORL.W.1: Corner L width (min = max) for:OD, DNW, NW, NW2V, PW, PW2V, VTH_N, VTH_P, VTNCELL, OD33, OD25, PO, N1V, P1V, N2V, P2V, VTL_N, VTL_P, NP, PP, PP2V, RPO, M1, ..., Mtop, CB, AP, HRI, CELLIMP, ELEC2, BOTMIM, MKTOPMIM: 1.500
    CORL_large_SR WITH WIDTH != 1.500
}

CORL.W.2 {@ Rule CORL.W.2: Corner L width (min = max) for:CO, VIA1, ..., VIAtop, ELEC1, CTDRAM: 0.500
    CORL_small_SR WITH WIDTH != 0.500
}

CORL.MRC.1 {@ Rule CORL.MRC.1: Four Corner L defining a rectangle shall be drawn in the four corners of the die (minimum requirement is three).
    (BULK INTERACT (SEALRING_TC OR SEALRING_TC_MZ)) INTERACT CORL_SR < 3    // the rule is checked only if SR exists
    (BULK INTERACT (SEALRING_TC OR SEALRING_TC_MZ)) NOT INTERACT CORL_SR    
}

GROUP CORL CORL.?

//  -------------------------------------------------------------------------
//        PO Bias
//  -------------------------------------------------------------------------

POB.R.1     {@ Rule POB.R.1: PO Bias markers cannot intersect each others
        POBIASP_drawing2 AND ((((POBIASP_drawing4 OR POBIASP_drawing6) OR POBIASM_drawing2) OR POBIASM_drawing4) OR POBIASM_drawing6)
        POBIASP_drawing4 AND (((POBIASP_drawing6 OR POBIASM_drawing2) OR POBIASM_drawing4) OR POBIASM_drawing6)
        POBIASP_drawing6 AND ((POBIASM_drawing2 OR POBIASM_drawing4) OR POBIASM_drawing6)
        POBIASM_drawing2 AND (POBIASM_drawing4 OR POBIASM_drawing6)
        POBIASM_drawing4 AND POBIASM_drawing6
      }

POB.EN.1 {@ Rule POB.EN.1: PO Bias marker enclosure of gate : 0.010
        ENC ALLGATE POBIASP_drawing2 < 0.010 ABUT <90 SINGULAR INSIDE ALSO
        ENC ALLGATE POBIASP_drawing4 < 0.010 ABUT <90 SINGULAR INSIDE ALSO
        ENC ALLGATE POBIASP_drawing6 < 0.010 ABUT <90 SINGULAR INSIDE ALSO
        ENC ALLGATE POBIASM_drawing2 < 0.010 ABUT <90 SINGULAR INSIDE ALSO
        ENC ALLGATE POBIASM_drawing4 < 0.010 ABUT <90 SINGULAR INSIDE ALSO
        ENC ALLGATE POBIASM_drawing6 < 0.010 ABUT <90 SINGULAR INSIDE ALSO
      }

POB.D.1      {@ Rule POB.D.1: PO Bias marker distance to unrelated gate : 0.010
        EXT POBIASP_drawing2 ALLGATE < 0.010 ABUT<90 SINGULAR
        EXT POBIASP_drawing4 ALLGATE < 0.010 ABUT<90 SINGULAR
        EXT POBIASP_drawing6 ALLGATE < 0.010 ABUT<90 SINGULAR
        EXT POBIASM_drawing2 ALLGATE < 0.010 ABUT<90 SINGULAR
        EXT POBIASM_drawing4 ALLGATE < 0.010 ABUT<90 SINGULAR
        EXT POBIASM_drawing6 ALLGATE < 0.010 ABUT<90 SINGULAR
      }

POB.R.2.1 {@ Rule POB.R.2.1 POBIASM;drawing2 not allowed on gate with gate length < 0.105
        EDGEGATE = ALLGATE COINCIDENT EDGE POLY
        EDGEGATE105 = LENGTH EDGEGATE < 0.105
        ALLGATE105 = ALLGATE INTERACT (EXPAND EDGE EDGEGATE105 BY 0.01) == 2
        POBIASM_drawing2 AND ALLGATE105
      }

POB.R.2.2 {@ Rule POB.R.2.2 POBIASM;drawing4 not allowed on gate with gate length < 0.105
        EDGEGATE = ALLGATE COINCIDENT EDGE POLY
        EDGEGATE105 = LENGTH EDGEGATE < 0.105
        ALLGATE105 = ALLGATE INTERACT (EXPAND EDGE EDGEGATE105 BY 0.01) == 2
        POBIASM_drawing4 AND ALLGATE105
      }

POB.R.2.3 {@ Rule POB.R.2.3 POBIASM;drawing6 not allowed on gate with gate length < 0.110
        EDGEGATE = ALLGATE COINCIDENT EDGE POLY
        EDGEGATE110 = LENGTH EDGEGATE < 0.110
        ALLGATE110 = ALLGATE INTERACT (EXPAND EDGE EDGEGATE110 BY 0.01) == 2
        POBIASM_drawing6 AND ALLGATE110
      }

GROUP POB POB.?
