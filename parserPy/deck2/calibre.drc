// $Id: calibre.drc 1394 2020-06-25 07:27:37Z akononov $
// ----------------------------------------------------------------------
// COPYRIGHT_TEMPLATE
// ----------------------------------------------------------------------

TITLE "CALIBRE hcmos8d DRC RULES FILE"

//  ########################################################################
//  ######                                                             #####
//  ######           SWITCHES  USAGE                                   #####
//  ######                                                             #####
//  ########################################################################
//
//   SWI_drcANTENNA_MOS
//     The default is set to "YES"; THIS IS DRM MANDATORY FOR CIRCUIT FINISHING.
//     If set to "NO", the ANTENNA MOS Rules are not checked (case of circuit under
//       development)
//   DENSITY CHECKS MANAGEMENT
//     SWI_density_CHECKS
//     The default is set to "YES"; THIS IS DRM MANDATORY FOR CIRCUIT FINISHING.
//     The following layers are checked for a minimum density over the whole chip :
//       - POLY, ACTIVE, METAL6
//     The following layers are checked for a minimum & a maximum local density value
//     by a 2x2 mm sliding window
//       - ACTIVE, METAL1, METAL2, METAL3, METAL4, METAL5
//     As the CPU time may be huge, you can turn the switch to "NO" at the
//       customization stage for a quick results on the other checks.
//
//   SWI_PROTO_EBEAM
//     The micropads are only allowed on prototype circuits;
//     The default is set to "NO",
//       thus a detection and output of error is done if MICROPADS exist
//     If set to "YES" , it assumes this is a prototype, the MICROPADS are allowed and
//       some distance checks are performed.
//
//   DUMMIES  USAGE 
//    For DRC mask verification only :
//    DUMMIES CHECKS ARE DRM MANDATORY FOR CIRCUIT FINISHING
//    -the Design Kit DRC file includes dimentional checks on the dummies layers
//    which are already inserted in the design.
//    In case the designer does'nt want these checks to be run, please refer to the
//    "DUMMIES  MANAGEMENT" chapter in the drc.ctrl file.
//
//   BONDING PADS DESIGN RULES MANAGEMENT
//    1- Generalities
//       ------------
//    The bonding pads design rules checking provided within this DRC
//    file is aligned on :
//    * the document EWS AND ASSEMBLY DESIGN RULES 0018063 Revision V available in ADCS.
//    * the document Assembly and reliability design Rules Manual DCS 7114456- Revision C available in ADCS.
//  
//    In this document, the bonding pads design rules are divided in
//    distincts set of rules corresponding to the Device Classes
//    which are qualified for production.
//  
//    The Device Classes, which link a set of relevant device
//    characteristics (package type / bonding wire type and diameter
//    / wire bonding quality requirements / EWS probe card type)
//    and the wire bonding line capability (machine and accessories)
//    to a corresponding set of EWS and Assembly Design rules, are :
//     - Device Class A : standard device
//                        ( pitch > 150um , pad opening > 90um )
//     - Device Class B : wedge bond (aluminium wire) fine pitch
//     - Device Class C : ball bond (gold wire) fine pitch at 150um
//                        160um with a proper set of rules.
//              
//  
//     - Device Class E : ball bond (gold wire) fine pitch at 100um
//                        with a proper set of rules.
//       There are 2 sub-classes:
//              E1  for EWS Epoxy ring probe cards,
//                  with 75 percent of ball bond inside the pad
//              E2  for EWS Epoxy ring probe cards,
//                  with 100 percent of ball bond inside the pad
//  
//     - Device Class F : ball bond (gold wire) fine pitch at 80um
//                        with a proper set of rules.
//  
//     - Device Class G : ball bond (gold wire) fine pitch at 50um
//                        staggered with a proper set of rules.
//              qualified only for PBGA.
//  
//     - Device Class H3_F1s, I2_H1s, M2_J1s, J2_G1s are the shrink class to be used with
//       DK shrink such as H9s
//  
//    For more information on the Device Classes features,
//    refer to the document mentioned above.
//  
//    2 - Bonding pads design rules
//        -------------------------
//    The set of bonding pads design rules checked by this DRC file
//    is listed below. This set is part of the complete set of rules
//    required for designing bonding pads and includes only the rules
//    that can be implemented in the layout verification tools.
//  
//    For more information on the complete set of rules and design
//    rules values, refer to the document mentioned above.
//  
//     - Rule A: Minimum overlap of passivation on pad.
//     - Rule B: Bond pad distance to any external edge of sealring.
//     - Rule C : Pad to pad minimum distance (Metal to Metal).
//     - Rule G : Pad opening to any mask layer minimum distance.
//     - Rule 1 : minimum pad opening window.
//     - Rule 2 : minimum pad pitch.
//     - Rule 3 : maximum size of chamfer in the corner of pad
//  
//     For Device Class Staggered only:
//     - Rule R2b :  minimum pad pitch between two rows 
//  
//     For Device Class non-Staggered only:
//     - Rule RNr : number of row allowed
//  
//    3 - Switches for the bonding pads design rules verification
//        -------------------------------------------------------
//    Since only bonding pads belonging to the same Device Class
//    can be put in the same circuit (multi class chip is not an option supported yet)
//    the designer can specify by means of switches the set of rules he wants to check and which
//    corresponds to the Device Class he has choosen.
//  
//    The switches available in this DRC file are :
//    Switch CHECK_PAD_ASSEMBLY "Check PAD_ASSEMBLY rules" DRC
//    YES : this is the default case; mandatory for circuit "sign-off"
//    NO : to avoid the check of Pad Architecture
//     Equivalent to yes (architecture and assembly), but for stacked pads only.
//     NB: Flip-Chip are excluded from this possibility
//  
//    Switch CHECK_PAD_ARCHITECTURE "Check PAD_ARCHITECTURE rules"
//    YES : this is the default case; mandatory for circuit "sign-off"
//    NO : to avoid the check of the bonding pads design rules : none of the design
//     rules related to the bonding pads are checked. This allows the
//     designer to check the core of the circuit without checking the
//     bonding pads placed around, which is time consuming.
//    
//    Switch CLASSPAD:
//    ClassB1 ClassB2 ClassB3 ClassB4 ClassC1 ClassC2 ClassC3 ClassC4 ClassC5 ClassC6 ClassC7 ClassC8 
//    ClassE1 ClassE2 ClassF1 ClassF2 ClassF3 ClassF4 ClassF5 ClassF6 ClassF7 ClassG1 
//    ClassH1 ClassH2 ClassJ1    
//    
//    ClassPAD to be used with shrink DK
//    ClassH3_F1s ClassJ2_G1s ClassI2_H1s ClassM2_J1s
//    
//    ClassPAD in the Advanced DRM
//    ClassI1 ClassK1 ClassL1 ClassM1  ClassN1 ClassO1 ClassP1 
//    
//     The Device Classes A  are not supported at all.
//     By default, when any of these switches are activated, the
//     design rules related to the Device Class G are checked.
//  
//   BUMPING PADS DESIGN RULES MANAGEMENT
//    The bumping pads design rules checking provided within this DRC
//    file is aligned on :
//    * the document DESIGN GUIDE FOR SOLDER BUMPED WAFERS 7158281 Revision E available in ADCS.
//  
//    WARNING : Please contact your Back End engineering team in order to select the right bump pad.
//    There are restrictions depending final package, reliability and bumping process.
//    
//    ClassPAD FLIPCHIP
//    ClassFlipChip_P_ADV ClassFlipChip_P_SP3 ClassFlipChip_A_STD ClassFlipChip_A_ADV ClassFlipChip_A_SP1 ClassFlipChip_A_SP2 
//    ClassFlipChip_S_STD ClassFlipChip_S_ADV ClassFlipChip_S_SP3 ClassFlipChip_SA_STD ClassFlipChip_P_STD
//  
// Input GDS file and cell :

// Default required parameter :
DRC MAXIMUM RESULTS 1000
DRC EXCLUDE FALSE NOTCH YES
DRC CELL NAME YES CELL SPACE XFORM ALL

// Default required output :
DRC RESULTS DATABASE drc_results.db
DRC SUMMARY REPORT drc_summary HIER

// Virtual connections :
// According with the SWITCH usage (HELP section) you did the following selection:
VIRTUAL CONNECT COLON NO

#IFDEF TEXT_DEPTH PRIMARY
TEXT DEPTH PRIMARY
#ENDIF
#IFDEF TEXT_DEPTH 1
TEXT DEPTH 1
#ENDIF
#IFDEF TEXT_DEPTH 2
TEXT DEPTH 2
#ENDIF
#IFDEF TEXT_DEPTH 3
TEXT DEPTH 3
#ENDIF

#IFDEF PORT_DEPTH PRIMARY
PORT DEPTH PRIMARY
#ENDIF
#IFDEF PORT_DEPTH 1
PORT DEPTH 1
#ENDIF
#IFDEF PORT_DEPTH 2
PORT DEPTH 2
#ENDIF
#IFDEF PORT_DEPTH 3
PORT DEPTH 3
#ENDIF

// //////////////////////////////////////////////////////////////////////////////
// /              ANTENNA CHECKS                                                /
// //////////////////////////////////////////////////////////////////////////////
// According with the SWITCH usage (HELP section) you did the following selection:
#IFDEF drcANTENNA_MOS
// All the Antenna checks are activated, but you can choose those you don't
//   want to be checked by uncommenting the corresponding lines hereunder :
#ELSE
// No Antenna check will be performed
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_PO
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_LIL
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_M1
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_M2
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_M3
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_M4
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_M5
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_M6
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_MIM5
#ELSE
#ENDIF
#IFDEF drcANTENNA_MOS
//DRC UNSELECT CHECK ANTENNA_RUL_HKMIM5
#ELSE
#ENDIF

// //////////////////////////////////////////////////////////////////////////////
// /              DUMMIES  MANAGEMENT                                           /
// //////////////////////////////////////////////////////////////////////////////
//
#IFDEF DUMMIES
// Checks dummies on the whole circuit are performed
#ELSE
// Following checks on the whole circuit are NOT performed:
DRC UNSELECT CHECK DUMMIES_ACT
DRC UNSELECT CHECK DUMMIES_POL
DRC UNSELECT CHECK DUMMIES_METAL1
DRC UNSELECT CHECK DUMMIES_METAL2
DRC UNSELECT CHECK DUMMIES_METAL3
DRC UNSELECT CHECK DUMMIES_METAL4
DRC UNSELECT CHECK DUMMIES_METAL5
DRC UNSELECT CHECK DUMMIES_METAL6
#ENDIF
#IFDEF DUMMIES
#ELSE
DRC UNSELECT CHECK DUMMIES_MIM5
#ENDIF
#IFDEF DUMMIES
#ELSE
DRC UNSELECT CHECK DUMMIES_HKMIM5
#ENDIF

// //////////////////////////////////////////////////////////////////////////////
// /              DENSITY MANAGEMENT                                            /
// //////////////////////////////////////////////////////////////////////////////
// For both verification DRC mask, and DRC nomask:
// The Design Kit DRC deck includes checks to ensure a sufficient DENSITY value
//   of the ACTIVE, POLY and METAL1 to 6 on the circuit.
// According with the SWITCH usage (HELP section) you did the following selection:
// 
#IFDEF density_CHECKS
// Checks ACTIVE, POLY, ME6 densities on the whole circuit are performed
#ELSE
// Following checks on the whole circuit are NOT performed :
DRC UNSELECT CHECK DENSITY_ACT_TOT
DRC UNSELECT CHECK DENSITY_POL_TOT
// Following checks by windows are NOT performed :
DRC UNSELECT CHECK DENSITY_ACT_WIN
DRC UNSELECT CHECK DENSITY_HKMIM_WIN_MIN
DRC UNSELECT CHECK DENSITY_HKMIM_WIN_MAX
DRC UNSELECT CHECK DENSITY_MET1_WIN_MIN
DRC UNSELECT CHECK DENSITY_MET1_WIN_MAX
DRC UNSELECT CHECK DENSITY_MET2_WIN_MIN
DRC UNSELECT CHECK DENSITY_MET2_WIN_MAX
DRC UNSELECT CHECK DENSITY_MET3_WIN_MIN
DRC UNSELECT CHECK DENSITY_MET3_WIN_MAX
DRC UNSELECT CHECK DENSITY_MET4_WIN_MIN
DRC UNSELECT CHECK DENSITY_MET4_WIN_MAX
DRC UNSELECT CHECK DENSITY_MET5_WIN_MIN
DRC UNSELECT CHECK DENSITY_MET5_WIN_MAX
DRC UNSELECT CHECK DENSITY_ME6_TOT
DRC UNSELECT CHECK DENSITY_MIM_WIN_MIN
DRC UNSELECT CHECK DENSITY_MIM_WIN_MAX
#ENDIF
//
//  ##############################################################################
//  ######                                                                   #####
//  ######                 SETTING  EXECUTION  CONDITIONS                    #####
//  ######                                                                   #####
//  ##############################################################################
 
//  -------------------------------------------------------------------------
//     INPUT  DATA
//  -------------------------------------------------------------------------

//  -------------------------------------------------------------------------
//     EXECUTION  MODE
//  -------------------------------------------------------------------------

PRECISION 1000
UNIT LENGTH U
RESOLUTION 20

//  ##############################################################################
//  ######                                                                   #####
//  ######                    INPUT   LAYER   BLOCK                          #####
//  ######                                                                   #####
//  ##############################################################################

BULK_1 = EXTENT
BULK = SIZE BULK_1 BY 1.0

LAYER MKR_PAD_CUP 415
LAYER MAP 62  DATATYPE == 18 415

LAYER RNWELL_0 1170
LAYER MAP 112  DATATYPE == 0 1170
 
LAYER NWELL_0 101
LAYER MAP 1  DATATYPE == 0 101

LAYER NWELL_30 107
LAYER MAP 1  DATATYPE == 30 107

LAYER NWELL_nsz 102
LAYER MAP 1  DATATYPE == 31 102

LAYER NWELL_fsz 103
LAYER MAP 1  DATATYPE == 32 103

LAYER NWELL2_0 8901
LAYER MAP 89  DATATYPE == 0 8901

LAYER NWELL2_30 8907
LAYER MAP 89  DATATYPE == 30 8907

LAYER NWELL2_nsz 8902
LAYER MAP 89  DATATYPE == 31 8902

LAYER NWELL2_fsz 8903
LAYER MAP 89  DATATYPE == 32 8903

LAYER PWELL_0 805
LAYER MAP 8 DATATYPE == 0 805

LAYER PWELL_30 808
LAYER MAP 8 DATATYPE == 30 808

LAYER PWELL_nsz 806
LAYER MAP 8 DATATYPE == 31 806

LAYER PWELL_fsz 807
LAYER MAP 8 DATATYPE == 32 807

LAYER PWELL2_0 9005
LAYER MAP 90 DATATYPE == 0 9005

LAYER PWELL2_30 9008
LAYER MAP 90 DATATYPE == 30 9008

LAYER PWELL2_nsz 9006
LAYER MAP 90 DATATYPE == 31 9006

LAYER PWELL2_fsz 9007
LAYER MAP 90 DATATYPE == 32 9007

LAYER OTP_0 9105
LAYER MAP 91 DATATYPE == 0 9105

LAYER OTP_30 9108
LAYER MAP 91 DATATYPE == 30 9108

LAYER OTP_nsz 9106
LAYER MAP 91 DATATYPE == 31 9106

LAYER OTP_fsz 9107
LAYER MAP 91 DATATYPE == 32 9107

LAYER ACTIVE_0 201
LAYER MAP 2  DATATYPE == 0 201

LAYER ACTIVE_30 207
LAYER MAP 2  DATATYPE == 30 207

LAYER ACTIVE_nsz 202
LAYER MAP 2  DATATYPE == 31 202

LAYER ACTIVE_fsz 203
LAYER MAP 2  DATATYPE == 32 203

LAYER POLY_0 1301
LAYER MAP 13  DATATYPE == 0 1301

LAYER POLY_30 1312
LAYER MAP 13  DATATYPE == 30 1312

LAYER POLY_nsz 1302
LAYER MAP 13  DATATYPE == 31 1302

LAYER POLY_fsz 1303
LAYER MAP 13  DATATYPE == 32 1303

LAYER PPOLY 1308
LAYER MAP 13  DATATYPE == 10 1308

LAYER MRPO 1307
LAYER MAP 13  DATATYPE == 17 1307

LAYER SIPROT_0 1801
LAYER MAP 18  DATATYPE == 0 1801

LAYER SIPROT_30 1805
LAYER MAP 18  DATATYPE == 30 1805

LAYER SIPROT_nsz 1802
LAYER MAP 18  DATATYPE == 31 1802

LAYER SIPROT_fsz 1803
LAYER MAP 18  DATATYPE == 32 1803

LAYER NITRIDE_0 3101
LAYER MAP 31  DATATYPE == 0 3101
// See farther for NITRIDE SHRINK merging into NITRIDE_0

LAYER NITRIDE_33 3105
LAYER MAP 31  DATATYPE == 33 3105
 
LAYER NITRIDE_28 3106
LAYER MAP 31  DATATYPE == 28 3106

LAYER NITRIDE_bumping 3108
LAYER MAP 31  DATATYPE == 34 3108

LAYER NITRIDE_nsz 3131
LAYER MAP 31  DATATYPE == 31 3131

LAYER NITRIDE_fsz 3132
LAYER MAP 31  DATATYPE == 32 3132

LAYER FDRC 6239 
LAYER MAP 62  DATATYPE == 59 6239

LAYER MRES 6244
LAYER MAP 62  DATATYPE == 44 6244

LAYER MRES_50 6250
LAYER MAP 62  DATATYPE == 50 6250

LAYER MIO 6236
LAYER MAP 62  DATATYPE == 56 6236

LAYER MSUB 6225
LAYER MAP 62  DATATYPE == 45 6225

LAYER MSHORT 5601
LAYER MAP 56  DATATYPE == 0 5601

LAYER MDIODE 6219
LAYER MAP 62  DATATYPE == 41 6219

LAYER MPNP 6222
LAYER MAP 62  DATATYPE == 43 6222

LAYER NOGATE 6226
LAYER MAP 62  DATATYPE == 46  6226

TEXT  LAYER 1306
LAYER MAP 13  TEXTTYPE == 22 1306

TEXT  LAYER 1305
LAYER MAP 13  TEXTTYPE == 21 1305

LAYER NLDD_0 1401
LAYER MAP 14  DATATYPE == 0 1401

LAYER NLDD_30 1404
LAYER MAP 14  DATATYPE == 30 1404

LAYER NLDD_nsz 1402
LAYER MAP 14  DATATYPE == 31 1402

LAYER NLDD_fsz 1403
LAYER MAP 14  DATATYPE == 32 1403

LAYER PLDD_0 1503
LAYER MAP 15  DATATYPE == 0 1503

LAYER PLDD_30 1504
LAYER MAP 15  DATATYPE == 30 1504

LAYER PLDD_nsz 1501
LAYER MAP 15  DATATYPE == 31 1501

LAYER PLDD_fsz 1502
LAYER MAP 15  DATATYPE == 32 1502

LAYER NPLUS_0 1601
LAYER MAP 16  DATATYPE == 0 1601

LAYER NPLUS_30 1604
LAYER MAP 16  DATATYPE == 30 1604

LAYER NPLUS_nsz 1602
LAYER MAP 16  DATATYPE == 31 1602

LAYER NPLUS_fsz 1603
LAYER MAP 16  DATATYPE == 32 1603

LAYER PPLUS_0 1703
LAYER MAP 17  DATATYPE == 0 1703

LAYER PPLUS_30 1706
LAYER MAP 17  DATATYPE == 30 1706

LAYER PPLUS_nsz 1701
LAYER MAP 17  DATATYPE == 31 1701

LAYER PPLUS_fsz 1702
LAYER MAP 17  DATATYPE == 32 1702

LAYER MFGPP_0 4601
LAYER MAP 46  DATATYPE == 0 4601

LAYER MFGPP_nsz 4602
LAYER MAP 46  DATATYPE == 31 4602

LAYER INVACT_0 6100
LAYER MAP 61  DATATYPE == 0 6100

LAYER HC8REC 6252
LAYER MAP 62  DATATYPE == 57 6252

LAYER NOSIZE:0 NWELL_nsz NWELL2_nsz PWELL_nsz PWELL2_nsz ACTIVE_nsz POLY_nsz SIPROT_nsz NLDD_nsz PLDD_nsz NPLUS_nsz 
PPLUS_nsz ADHVTN_nsz ADHVTP_nsz CONTACT_nsz METAL1_nsz VI1_nsz METAL2_nsz VI2_nsz METAL3_nsz VI3_nsz 
METAL4_nsz VI4_nsz METAL5_nsz VI5_nsz METAL6_nsz VFB_nsz PRL_nsz LIL_nsz NEXT_nsz NEXT_5V_nsz PEXT_nsz PEXT_5V_nsz 
GO2_nsz GO2_5V_nsz MIM5_nsz HKMIM5_nsz PRESIST_nsz NISO_nsz OTP_nsz NITRIDE_nsz

LAYER FSIZE:0 NWELL_fsz NWELL2_fsz PWELL_fsz PWELL2_fsz ACTIVE_fsz POLY_fsz SIPROT_fsz NLDD_fsz PLDD_fsz NPLUS_fsz 
PPLUS_fsz ADHVTN_fsz ADHVTP_fsz CONTACT_fsz METAL1_fsz VI1_fsz METAL2_fsz VI2_fsz METAL3_fsz VI3_fsz 
METAL4_fsz VI4_fsz METAL5_fsz VI5_fsz METAL6_fsz VFB_fsz PRL_fsz LIL_fsz NEXT_fsz NEXT_5V_fsz PEXT_fsz PEXT_5V_fsz 
GO2_fsz GO2_5V_fsz MIM5_fsz HKMIM5_fsz PRESIST_fsz NISO_fsz OTP_fsz

LAYER NOSIZE:1 NOSIZE:0 MFGPP_nsz

LAYER FSIZE:1 FSIZE:0 NITRIDE_fsz

LAYER ADHVTN_0 151
LAYER MAP 82  DATATYPE == 0 151

LAYER ADHVTN_30 154
LAYER MAP 82  DATATYPE == 30 154

LAYER ADHVTN_nsz 152
LAYER MAP 82  DATATYPE == 31 152

LAYER ADHVTN_fsz 153
LAYER MAP 82  DATATYPE == 32 153

LAYER ADHVTP_0 161
LAYER MAP 83  DATATYPE == 0 161

LAYER ADHVTP_30 164
LAYER MAP 83  DATATYPE == 30 164

LAYER ADHVTP_nsz 162
LAYER MAP 83  DATATYPE == 31 162

LAYER ADHVTP_fsz 163
LAYER MAP 83  DATATYPE == 32 163

LAYER MCP1NW 6203
LAYER MAP 62  DATATYPE == 3 6203

LAYER CONTACT_0 1901
LAYER MAP 19  DATATYPE == 0 1901

LAYER CONTACT_30 1907
LAYER MAP 19  DATATYPE == 30 1907

LAYER CONTACT_nsz 1902
LAYER MAP 19  DATATYPE == 31 1902

LAYER CONTACT_fsz 1903
LAYER MAP 19  DATATYPE == 32 1903

LAYER ME1D 2301
LAYER MAP 23  DATATYPE == 0 2301

LAYER ME1C 2317
LAYER MAP 23  DATATYPE == 3 2317

LAYER M1SG ME1D ME1C

LAYER ME1P 2309
LAYER MAP 23  DATATYPE == 1 2309

LAYER ME1N 2310
LAYER MAP 23  DATATYPE == 2 2310

LAYER M1PW ME1P ME1N

LAYER ME1_0 ME1D ME1P ME1N ME1C

LAYER ME1_30 2316
LAYER MAP 23  DATATYPE == 30 2316

LAYER METAL1_nsz 2302
LAYER MAP 23  DATATYPE == 31 2302

LAYER METAL1_fsz 2303
LAYER MAP 23  DATATYPE == 32 2303

LAYER PMET1 2311
LAYER MAP 23  DATATYPE == 10 2311

LAYER MRM1 2307
LAYER MAP 23  DATATYPE == 17 2307

TEXT LAYER 2306
LAYER MAP 23  TEXTTYPE == 22 2306

TEXT LAYER 2305
LAYER MAP 23  TEXTTYPE == 21 2305

LAYOUT TOP LAYER ME1D ME1P ME1N ME1C ME1_30

LAYER VI1_0 2501
LAYER MAP 25  DATATYPE == 0 2501

LAYER VI1_30 2509
LAYER MAP 25  DATATYPE == 30 2509

LAYER VI1_nsz 2502
LAYER MAP 25  DATATYPE == 31 2502

LAYER VI1_fsz 2503
LAYER MAP 25  DATATYPE == 32 2503

LAYER ME2D 2701
LAYER MAP 27  DATATYPE == 0 2701

LAYER ME2C 2717
LAYER MAP 27  DATATYPE == 3 2717

LAYER M2SG ME2D ME2C

LAYER ME2P 2714
LAYER MAP 27  DATATYPE == 1 2714

LAYER ME2N 2715
LAYER MAP 27  DATATYPE == 2 2715

LAYER M2PW ME2P ME2N

LAYER ME2_0 ME2D ME2P ME2N ME2C

LAYER ME2_30 2716
LAYER MAP 27  DATATYPE == 30 2716

LAYER METAL2_nsz 2702
LAYER MAP 27  DATATYPE == 31 2702

LAYER METAL2_fsz 2703
LAYER MAP 27  DATATYPE == 32 2703

LAYER PMET2 2709
LAYER MAP 27  DATATYPE == 10 2709

LAYER MRM2 2707
LAYER MAP 27  DATATYPE == 17 2707

TEXT LAYER 2706
LAYER MAP 27  TEXTTYPE == 22 2706

TEXT LAYER 2705
LAYER MAP 27  TEXTTYPE == 21 2705

LAYOUT TOP LAYER VI1_0 VI1_30 ME2D ME2P ME2N ME2C ME2_30

LAYER MDRIFT 3379
LAYER MAP 62  DATATYPE == 60 3379

LAYER MRHBD1 6262
LAYER MAP 62  DATATYPE == 62 6262

LAYER VI2_0 3201
LAYER MAP 32  DATATYPE == 0 3201

LAYER VI2_30 3209
LAYER MAP 32  DATATYPE == 30 3209

LAYER VI2_nsz 3202
LAYER MAP 32  DATATYPE == 31 3202

LAYER VI2_fsz 3203
LAYER MAP 32  DATATYPE == 32 3203

LAYER ME3D 3401
LAYER MAP 34  DATATYPE == 0 3401

LAYER ME3C 3417
LAYER MAP 34  DATATYPE == 3 3417

LAYER M3SG ME3D ME3C

LAYER ME3P 3414
LAYER MAP 34  DATATYPE == 1 3414

LAYER ME3N 3415
LAYER MAP 34  DATATYPE == 2 3415

LAYER M3PW ME3P ME3N

LAYER ME3_0 ME3D ME3P ME3N ME3C

LAYER ME3_30 3416
LAYER MAP 34  DATATYPE == 30 3416

LAYER METAL3_nsz 3402
LAYER MAP 34  DATATYPE == 31 3402

LAYER METAL3_fsz 3403
LAYER MAP 34  DATATYPE == 32 3403

LAYER PMET3 3409
LAYER MAP 34  DATATYPE == 10 3409

LAYER MRM3 3407
LAYER MAP 34  DATATYPE == 17 3407

TEXT LAYER 3406
LAYER MAP 34  TEXTTYPE == 22 3406

TEXT LAYER 3405
LAYER MAP 34  TEXTTYPE == 21 3405

LAYOUT TOP LAYER VI2_0 VI2_30 ME3D ME3P ME3N ME3C ME3_30
 
LAYER VI3_0 3501
LAYER MAP 35  DATATYPE == 0 3501

LAYER VI3_30 3509
LAYER MAP 35  DATATYPE == 30 3509

LAYER VI3_nsz 3502
LAYER MAP 35  DATATYPE == 31 3502

LAYER VI3_fsz 3503
LAYER MAP 35  DATATYPE == 32 3503

LAYER ME4D 3601
LAYER MAP 36  DATATYPE == 0 3601

LAYER ME4C 3617
LAYER MAP 36  DATATYPE == 3 3617

LAYER M4SG ME4D ME4C

LAYER ME4P 3614
LAYER MAP 36  DATATYPE == 1 3614

LAYER ME4N 3615
LAYER MAP 36  DATATYPE == 2 3615

LAYER M4PW ME4P ME4N

LAYER ME4_0 ME4D ME4P ME4N ME4C

LAYER ME4_28 3619
LAYER MAP 36  DATATYPE == 28 3619

LAYER ME4_30 3616
LAYER MAP 36  DATATYPE == 30 3616

LAYER METAL4_nsz 3602
LAYER MAP 36  DATATYPE == 31 3602

LAYER METAL4_fsz 3603
LAYER MAP 36  DATATYPE == 32 3603

LAYER PMET4 3609
LAYER MAP 36  DATATYPE == 10 3609

LAYER MRM4 3607
LAYER MAP 36  DATATYPE == 17 3607

TEXT LAYER 3606
LAYER MAP 36  TEXTTYPE == 22 3606

TEXT LAYER 3605
LAYER MAP 36  TEXTTYPE == 21 3605

LAYOUT TOP LAYER VI3_0 VI3_30 ME4D ME4P ME4N ME4C ME4_30

LAYER VI4_0 5201
LAYER MAP 52  DATATYPE == 0 5201

LAYER VI4_30 5209
LAYER MAP 52  DATATYPE == 30 5209

LAYER VI4_nsz 5202
LAYER MAP 52  DATATYPE == 31 5202

LAYER VI4_fsz 5203
LAYER MAP 52  DATATYPE == 32 5203

LAYER ME5D 5301
LAYER MAP 53  DATATYPE == 0 5301

LAYER ME5C 5317
LAYER MAP 53  DATATYPE == 3 5317

LAYER M5SG ME5D ME5C

LAYER ME5P 5314
LAYER MAP 53  DATATYPE == 1 5314

LAYER ME5N 5315
LAYER MAP 53  DATATYPE == 2 5315

LAYER M5PW ME5P ME5N

LAYER ME5_0 ME5D ME5P ME5N ME5C

LAYER ME5_30 5316
LAYER MAP 53  DATATYPE == 30 5316

LAYER METAL5_nsz 5302
LAYER MAP 53  DATATYPE == 31 5302

LAYER METAL5_fsz 5303
LAYER MAP 53  DATATYPE == 32 5303

LAYER PMET5 5309
LAYER MAP 53  DATATYPE == 10 5309

LAYER MRM5 5307
LAYER MAP 53  DATATYPE == 17 5307

TEXT LAYER 5306
LAYER MAP 53  TEXTTYPE == 22 5306

TEXT LAYER 5305
LAYER MAP 53  TEXTTYPE == 21 5305

LAYOUT TOP LAYER VI4_0 VI4_30 ME5D ME5P ME5N ME5C ME5_30

LAYER VI5_0 5411
LAYER MAP 54  DATATYPE == 0 5411

LAYER VI5_30 5419
LAYER MAP 54  DATATYPE == 30 5419

LAYER VI5_nsz 5412
LAYER MAP 54  DATATYPE == 31 5412

LAYER VI5_fsz 5413
LAYER MAP 54  DATATYPE == 32 5413

LAYER ME6D 5501
LAYER MAP 55  DATATYPE == 0 5501

LAYER ME6C 5516
LAYER MAP 55  DATATYPE == 3 5516

LAYER M6SG ME6D ME6C

LAYER ME6P 5513
LAYER MAP 55  DATATYPE == 1 5513

LAYER ME6N 5514
LAYER MAP 55  DATATYPE == 2 5514

LAYER M6PW ME6P ME6N

LAYER ME6_0 ME6D ME6P ME6N ME6C

LAYER ME6_30 5515
LAYER MAP 55  DATATYPE == 30 5515

LAYER METAL6_nsz 5502
LAYER MAP 55  DATATYPE == 31 5502

LAYER METAL6_fsz 5503
LAYER MAP 55  DATATYPE == 32 5503

LAYER PMET6 5508
LAYER MAP 55  DATATYPE == 10 5508

LAYER MRM6 5507
LAYER MAP 55  DATATYPE == 17 5507

TEXT LAYER 5506
LAYER MAP 55  TEXTTYPE == 22 5506

TEXT LAYER 5505
LAYER MAP 55  TEXTTYPE == 21 5505

LAYOUT TOP LAYER VI5_0 VI5_30 ME6D ME6P ME6N ME6C ME6_30

LAYER VFB_0 3356
LAYER MAP 64  DATATYPE == 0 3356

LAYER VFB_30 3348
LAYER MAP 64  DATATYPE == 30 3348

LAYER VFB_nsz 3355
LAYER MAP 64  DATATYPE == 31 3355

LAYER VFB_fsz 3354
LAYER MAP 64  DATATYPE == 32 3354

LAYER PRLD 3347
LAYER MAP 66  DATATYPE == 0 3347

LAYER PRLSG PRLD

LAYER PRL_0 PRLD

LAYER PRL_30 3333
LAYER MAP 66  DATATYPE == 30 3333

LAYER PRL_nsz 3346
LAYER MAP 66  DATATYPE == 31 3346

LAYER PRL_fsz 3345
LAYER MAP 66  DATATYPE == 32 3345

LAYER PPRL 3340
LAYER MAP 66  DATATYPE == 10 3340

TEXT LAYER 3342
LAYER MAP 66  TEXTTYPE == 22 3342

TEXT LAYER 3343
LAYER MAP 66  TEXTTYPE == 21 3343

LAYOUT TOP LAYER VFB_0 VFB_30 PRLD PRL_30

LAYER LIL_0 3901
LAYER MAP 39  DATATYPE == 0 3901

LAYER LIL_30 3910
LAYER MAP 39  DATATYPE == 30 3910

LAYER LIL_nsz 3902
LAYER MAP 39  DATATYPE == 31 3902

LAYER LIL_fsz 3903
LAYER MAP 39  DATATYPE == 32 3903

TEXT LAYER 3906
LAYER MAP 39  TEXTTYPE == 22  3906

TEXT LAYER 3905
LAYER MAP 39  TEXTTYPE == 21  3905

LAYER ACTIVE_4 208
LAYER MAP 2  DATATYPE == 4 208

LAYER POLY_4 1311
LAYER MAP 13  DATATYPE == 4 1311

LAYER ME1_4 2314
LAYER MAP 23  DATATYPE == 4  2314

LAYER ME2_4 2712
LAYER MAP 27  DATATYPE == 4  2712

LAYER ME3_4 3412
LAYER MAP 34  DATATYPE == 4  3412

LAYER ME4_4 3612
LAYER MAP 36  DATATYPE == 4  3612

LAYER ME5_4 5312
LAYER MAP 53  DATATYPE == 4  5312

LAYER ME6_4 5511
LAYER MAP 55  DATATYPE == 4  5511

LAYER MEXCLUD 6204
LAYER MAP 62  DATATYPE == 4 6204

LAYER MEXCLUD_P 6205
LAYER MAP 62  DATATYPE == 5 6205

LAYER MEXCLUD_M1 6206
LAYER MAP 62  DATATYPE == 6 6206

LAYER MEXCLUD_M2 6207
LAYER MAP 62  DATATYPE == 7 6207

LAYER MEXCLUD_M3 6208
LAYER MAP 62  DATATYPE == 8 6208

LAYER MEXCLUD_M4 6209
LAYER MAP 62  DATATYPE == 9 6209

LAYER MEXCLUD_M5 6210
LAYER MAP 62  DATATYPE == 10 6210

LAYER MEXCLUD_M6 6211
LAYER MAP 62  DATATYPE == 11 6211

LAYER MEXCLUD_RF 6212
LAYER MAP 62  DATATYPE == 12 6212

LAYER MEXCLUD_AC 6213
LAYER MAP 62  DATATYPE == 13 6213

LAYER NATIVE_0 6920
LAYER MAP 70  DATATYPE == 0 6920

LAYER NEPI_0 6514
LAYER MAP 65  DATATYPE == 0 6514

LAYER NEXT_0 7601
LAYER MAP 76  DATATYPE == 0 7601
 
LAYER NEXT_30 7604
LAYER MAP 76  DATATYPE == 30 7604
 
LAYER NEXT_nsz 7602
LAYER MAP 76  DATATYPE == 31 7602
 
LAYER NEXT_fsz 7603
LAYER MAP 76  DATATYPE == 32 7603

LAYER NEXT_5V_0 7800
LAYER MAP 78  DATATYPE == 0 7800

LAYER NEXT_5V_30 7830
LAYER MAP 78  DATATYPE == 30 7830

LAYER NEXT_5V_nsz 7831
LAYER MAP 78  DATATYPE == 31 7831

LAYER NEXT_5V_fsz 7832
LAYER MAP 78  DATATYPE == 32 7832

LAYER PEXT_0 7701
LAYER MAP 77  DATATYPE == 0 7701

LAYER PEXT_30 7704
LAYER MAP 77  DATATYPE == 30 7704

LAYER PEXT_nsz 7702
LAYER MAP 77  DATATYPE == 31 7702

LAYER PEXT_fsz 7703
LAYER MAP 77  DATATYPE == 32 7703

LAYER PEXT_5V_0 7900
LAYER MAP 79  DATATYPE == 0 7900

LAYER PEXT_5V_30 7930
LAYER MAP 79  DATATYPE == 30 7930

LAYER PEXT_5V_nsz 7931
LAYER MAP 79  DATATYPE == 31 7931

LAYER PEXT_5V_fsz 7932
LAYER MAP 79  DATATYPE == 32 7932

LAYER GO2_0 608
LAYER MAP 6  DATATYPE == 0 608

LAYER GO2_30 618
LAYER MAP 6  DATATYPE == 30 618

LAYER GO2_nsz 609
LAYER MAP 6  DATATYPE == 31 609

LAYER GO2_fsz 610
LAYER MAP 6  DATATYPE == 32 610

LAYER GO2_5V_0 7000
LAYER MAP 7  DATATYPE == 0 7000

LAYER GO2_5V_30 7030
LAYER MAP 7  DATATYPE == 30 7030

LAYER GO2_5V_nsz 7031
LAYER MAP 7  DATATYPE == 31 7031

LAYER GO2_5V_fsz 7032
LAYER MAP 7  DATATYPE == 32 7032

LAYER MIM5_0 8001
LAYER MAP 80  DATATYPE == 0 8001

LAYER MIM5_nsz 8002
LAYER MAP 80  DATATYPE == 31 8002

LAYER MIM5_fsz 8003
LAYER MAP 80  DATATYPE == 32 8003

LAYER MIM5_4 8005
LAYER MAP 80  DATATYPE == 4 8005

LAYER HKMIM5_0 921
LAYER MAP 92  DATATYPE == 0 921

LAYER HKMIM5_nsz 922
LAYER MAP 92  DATATYPE == 31 922

LAYER HKMIM5_fsz 923
LAYER MAP 92  DATATYPE == 32 923

LAYER HKMIM5_4 925
LAYER MAP 92  DATATYPE == 4 925

LAYER PRESIST_0 260
LAYER MAP 26  DATATYPE == 0 260

LAYER PRESIST_nsz 288
LAYER MAP 26  DATATYPE == 31 288

LAYER PRESIST_fsz 289
LAYER MAP 26  DATATYPE == 32 289

LAYER CTELEC2 1908
LAYER MAP 19  DATATYPE == 19 1908

LAYER CELLVT 3727
LAYER MAP 51  DATATYPE == 0 3727

LAYER CELLIMP 4305
LAYER MAP 43  DATATYPE == 0 4305

LAYER NISO_0 2403
LAYER MAP 24  DATATYPE == 0 2403

LAYER NISO_nsz 2401
LAYER MAP 24  DATATYPE == 31 2401

LAYER NISO_fsz 2402
LAYER MAP 24  DATATYPE == 32 2402

//-------------------------------------------------------------------------
//        LAYERS TABLE FOR GDSII INPUT FOR HD SUPPORT
//-------------------------------------------------------------------------

LAYER HD 1000
LAYER MAP >=1 <=127 DATATYPE == 30 1000

//  ##############################################################################
//  ######                                                                   #####
//  ######                      OPERATION   BLOCK                            #####
//  ######                                                                   #####
//  ##############################################################################

// //////////////////////////////////////////////////////////////////////////////
// /                      LAYERS  DERIVATION  SECTION                           /
// //////////////////////////////////////////////////////////////////////////////

//------------------------------------------------------------------------------
//       MAPPING  INPUT  LAYERS
//------------------------------------------------------------------------------

ACTIVE = ACTIVE_0 OR ACTIVE_30
RNWELL = COPY RNWELL_0
NWELL = NWELL_0 OR NWELL_30

NWELL2 = NWELL2_0 OR NWELL2_30
PWELL2 = PWELL2_0 OR PWELL2_30
OTP = OTP_0 OR OTP_30

NITRIDE = COPY NITRIDE_0
INVACT = COPY INVACT_0

ADHVTN = ADHVTN_0 OR ADHVTN_30
ADHVTP = ADHVTP_0 OR ADHVTP_30

POLY = POLY_0 OR POLY_30
PPLUS = PPLUS_0 OR PPLUS_30
NLDD = NLDD_0 OR NLDD_30
NPLUS = NPLUS_0 OR NPLUS_30
PLDD = PLDD_0 OR PLDD_30

SIPROT:1 = SIPROT_0 OR SIPROT_30
SIPROT_RHBD:1 = SIPROT:1 AND MRHBD1
//SIPROT_RHBD:1 = COPY RNWELL
SIPROT =  SIPROT:1 NOT SIPROT_RHBD:1

LIL = LIL_0 OR LIL_30

CONTACT = CONTACT_0 OR CONTACT_30

ME1 = ME1_0 OR ME1_30

VI1 = VI1_0 OR VI1_30
ME2 = ME2_0 OR ME2_30

VI2 = VI2_0 OR VI2_30
ME3 = ME3_0 OR ME3_30

VI3 = VI3_0 OR VI3_30
ME4 = ME4_0 OR ME4_30

VI4 = VI4_0 OR VI4_30
ME5 = ME5_0 OR ME5_30

VI5 = VI5_0 OR VI5_30
ME6 = ME6_0 OR ME6_30

VFB = VFB_0 OR VFB_30
PRL = PRL_0 OR PRL_30

NATIVE = COPY NATIVE_0

NEPI = COPY NEPI_0

NEXT = NEXT_0 OR NEXT_30
NEXT_5V = NEXT_5V_0 OR NEXT_5V_30

PEXT = PEXT_0 OR PEXT_30
PEXT_5V = PEXT_5V_0 OR PEXT_5V_30

GO2 = GO2_0 OR GO2_30
GO2_5V = GO2_5V_0 OR GO2_5V_30

MIM5 = COPY MIM5_0

HKMIM5 = COPY HKMIM5_0

PRESIST = COPY PRESIST_0

NISO = COPY NISO_0

//------------------------------------------------------------------------------
//       BONDING  PAD_BUMPING  LAYERS  DERIVATION
//------------------------------------------------------------------------------

SEALRING = SIZE MFGPPNG BY 2.1
SEALRING_BUMP = COPY SEALRING
PAD_FC = COPY NITRIDE_bumping
#IFDEF BUMPING
UPMETALPAD_FC = PRL INTERACT PAD_FC
#ELSE
UPMETALPAD_FC = ME6 INTERACT PAD_FC
#ENDIF

#IFDEF ClassPAD ClassFlipChip
CENTER_OF_PADBUMP = EXTENTS PAD_FC CENTERS     
PADBUMP_OPEN_WINDOW = SIZE CENTER_OF_PADBUMP BY 39.5
#ENDIF

PAD = NOT DONUT NITRIDE
PADR = RECTANGLE PAD
PADP = NOT RECTANGLE PAD
PADSZ = (SIZE PAD BY SIZE_PAD) NOT INTERACT MKR_PAD_CUP

#IFDEF ClassPAD ClassWireBonding
VARIABLE SIZE_PAD 8.0
SZPAD45 = SIZE PAD BY 8.0
#ENDIF

#IFDEF ClassPAD ClassFlipChip
VARIABLE SIZE_PAD 8.0
SZPAD45 = SIZE PAD BY 25.0
#ENDIF

SZPAD = EXTENTS SZPAD45

BPAACT = PADSZ AND ACTIVE
BPDACT = BPAACT AND PAD
BPXACT = BPAACT NOT PAD

BPANWL = PADSZ AND NWELL
BPDNWL = BPANWL INTERACT PAD               //FIND NWELL UNDER PAD
BPXNWL = BPANWL NOT INTERACT PAD

BPARNWL = PADSZ AND RNWELL
BPDRNWL = BPARNWL INTERACT PAD             //FIND RNWELL UNDER PAD
BPXRNWL = BPARNWL NOT INTERACT PAD

BPAPO1 = PADSZ AND POLY
BPDPO1 = BPAPO1 AND PAD
BPXPO1 = BPAPO1 NOT PAD

BPANEPI = PADSZ AND NEPI
BPDNEPI = BPANEPI INTERACT PAD
BPXNEPI = BPANEPI NOT BPDNEPI

BPACON = PADSZ AND CONTACT
BPDCON = BPACON AND PAD
BPXCON = BPACON NOT PAD

BPAMT1 = SZPAD AND ME1

BPDMT1 = BPAMT1 INSIDE PAD
BPDMT1_ALL = BPAMT1 INTERACT PAD
BPXMT1 = BPAMT1 NOT BPDMT1_ALL
THICKMETAL:1 = COPY ME1

BPAVI1 = PADSZ AND VI1
BPDVI1 = BPAVI1 INSIDE PAD
BPDVI1_ALL = BPAVI1 AND BPDMT1_ALL
BPXVI1 = BPAVI1 NOT BPDVI1_ALL
NBPDV1 = VI1 NOT BPDVI1

BPAMT2 = SZPAD AND ME2

BPDMT2 = BPAMT2 INSIDE PAD
BPDMT2_ALL = BPAMT2 INTERACT PAD
BPXMT2 = BPAMT2 NOT BPDMT2_ALL
THICKMETAL:2 = COPY ME2

BPAVI2 = PADSZ AND VI2
BPDVI2 = BPAVI2 INSIDE PAD
BPDVI2_ALL = BPAVI2 AND BPDMT2_ALL
BPXVI2 = BPAVI2 NOT BPDVI2_ALL
NBPDV2 = VI2 NOT BPDVI2

BPAMT3 = SZPAD AND ME3

BPDMT3 = BPAMT3 INSIDE PAD
BPDMT3_ALL = BPAMT3 INTERACT PAD
BPXMT3 = BPAMT3 NOT BPDMT3_ALL
THICKMETAL:3 = COPY ME3

BPAVI3 = PADSZ AND VI3
BPDVI3 = BPAVI3 INSIDE PAD
BPDVI3_ALL = BPAVI3 AND BPDMT3_ALL
BPXVI3 = BPAVI3 NOT BPDVI3_ALL
NBPDV3 = VI3 NOT BPDVI3

BPAMT4 = SZPAD AND ME4

BPDMT4 = BPAMT4 INSIDE PAD
BPDMT4_ALL = BPAMT4 INTERACT PAD
BPXMT4 = BPAMT4 NOT BPDMT4_ALL
THICKMETAL:4 = COPY ME4

BPAVI4 = PADSZ AND VI4
BPDVI4 = BPAVI4 INSIDE PAD
BPDVI4_ALL = BPAVI4 AND BPDMT4_ALL
BPXVI4 = BPAVI4 NOT BPDVI4_ALL
NBPDV4 = VI4 NOT BPDVI4

BPAMT5 = SZPAD AND ME5

BPDMT5 = BPAMT5 INSIDE PAD
BPDMT5_ALL = BPAMT5 INTERACT PAD
BPXMT5 = BPAMT5 NOT BPDMT5_ALL
THICKMETAL:5 = COPY ME5

BPAVI5 = PADSZ AND VI5
BPDVI5 = BPAVI5 INSIDE PAD
BPDVI5_ALL = BPAVI5 AND BPDMT5_ALL
BPXVI5 = BPAVI5 NOT BPDVI5_ALL
NBPDV5 = VI5 NOT BPDVI5

BPAMT6 = SZPAD AND ME6
BPDMT6 = BPAMT6 AND BPDNWL
BPXMT6 = BPAMT6 NOT INTERACT BPDNWL

M6PAD = ME6 INTERACT PAD
BPDMTL:1 = SIZE M6PAD BY 20 UNDEROVER
THICKMETAL:6 = COPY ME6

BPAVFB = PADSZ AND VFB
BPDVFB = BPAVFB INSIDE PAD
BPXVFB = BPAVFB NOT BPDVFB
NBPDVFB = VFB NOT BPDVFB

BPAPRL = SZPAD AND PRL
BPXPRL = BPAPRL NOT INTERACT BPDNWL

//------------------------------------------------------------------------------
//    BASIC  LAYERS  DERIVATION
//------------------------------------------------------------------------------

//--------------------------------------------- substrate layer
SUBS_1 = SIZE MSUB BY 0.1
//SUBS = (BULK NOT SUBS_1) OR MSUB
SUBS_2 = SUBS_1 NOT MSUB
SUBS = BULK NOT SUBS_2
EMPTY = BULK_1 NOT BULK

//--------------------------------------------- nwell layer
NWRNW = NWELL OR RNWELL
NWELL_ALL = NWRNW OR NWELL2
WELL_ALL = NWELL_ALL OR PWELL2

NWELFT:1 = (NWELL INTERACT NITRIDE) OUTSIDE ACTIVE
NWEL2FT:1 = (NWELL2 INTERACT NITRIDE) OUTSIDE ACTIVE

//--------------------------------------------- pwell layer
PWELL:1 = SUBS NOT WELL_ALL

//--------------------------------------------- pactive layer
PACTIVE = ACTIVE AND PPLUS

//--------------------------------------------- nactive layer
NACTIVE = ACTIVE AND NPLUS

//--------------------------------------------- active LDD layer
PLDDACT = ((ACTIVE AND PLDD) NOT PPLUS) NOT NPLUS
NLDDACT = ((ACTIVE AND NLDD) NOT PPLUS) NOT NPLUS

// --------------------------------------------- bad active  layer
ACTNOPLUS =  (ACTIVE NOT PPLUS) NOT NPLUS
BADACTIVE:1 = (ACTNOPLUS NOT PLDDACT) NOT NLDDACT

//--------------------------------------------- pdiff0 layer
PDIFF0:1 = PACTIVE NOT POLY

//--------------------------------------------- ndiff0 layer
NDIFF0:1 = NACTIVE NOT POLY

//--------------------------------------------- pinnw layer
PINNW = PACTIVE AND NWELL
PINNW2 = PACTIVE AND NWELL2

//--------------------------------------------- pinrnw layer
PINRNW = PACTIVE AND RNWELL

//--------------------------------------------- pinnwpo layer
PINNWPO = PINNW INTERACT POLY

//--------------------------------------------- ninpw layer
NINPW = NACTIVE AND PWELL:1
NINPW2 = NACTIVE AND PWELL2

//--------------------------------------------- ninpwpo layer
NINPWPO = NINPW INTERACT POLY

//--------------------------------------------- pdifnw layer
PDIFNW = PDIFF0:1 AND NWELL

//--------------------------------------------- ndifpw layer
NDIFPW = NDIFF0:1 AND PWELL:1

//--------------------------------------------- ngate layer
NGATE:1 = NINPW AND POLY
NGATE:2 = NGATE:1 OUTSIDE NEXT
NGATE:3 = NGATE:2 OUTSIDE PEXT
NGATE:4 = (NGATE:3 OUTSIDE GO2) OUTSIDE GO2_5V

NGATE_5V:1 = (NINPW2 AND POLY) OUTSIDE OTP
NGATE_5V:2 = NGATE_5V:1 INSIDE GO2_5V
//NGATE_5V:3 = NGATE_5V:2 INTERACT NEXT_5V
NGATEH_5V = ACTPOL:1 INTERACT (NOT RECTANGLE NGATE_5V:2)
NGATE_5V = NGATE_5V:2 NOT NGATEH_5V

A_0 = ACTIVE COINCIDENT INSIDE EDGE NGATEH_5V
NGATEH_5V:0 = (INT A_0<100 OPPOSITE REGION) AND NGATEH_5V
NGATEH_5V:1 = NGATEH_5V NOT NGATEH_5V:0

POLY_OTP = POLY INSIDE OTP

//--------------------------------------------- pgate layer
PGATE:1 = PINNW AND POLY
PGATE:2 = PGATE:1 OUTSIDE NEXT
PGATE:3 = PGATE:2 OUTSIDE PEXT
PGATE:4 = (PGATE:3 OUTSIDE GO2) OUTSIDE GO2_5V

PGATE_5V:1 = PINNW2 AND POLY
PGATE_5V:2 = PGATE_5V:1 INSIDE GO2_5V
PGATE_5V:3 = PGATE_5V:2 INTERACT PEXT_5V
PGATEH_5V = ACTPOL:1 INTERACT (NOT RECTANGLE PGATE_5V:3)
PGATE_5V = PGATE_5V:3 NOT PGATEH_5V

A_1 = ACTIVE COINCIDENT INSIDE EDGE PGATEH_5V
PGATEH_5V:0 = (INT A_1<100 OPPOSITE REGION) AND PGATEH_5V
PGATEH_5V:1 = PGATEH_5V NOT PGATEH_5V:0

//--------------------------------------------- gate layer
GATE = NGATE:4 OR PGATE:4
GATE_5V = NGATE_5V OR PGATE_5V
GATEH_5V = NGATEH_5V OR PGATEH_5V
GATEANDH_5V = GATE_5V OR GATEH_5V

//--------------------------------------------- trprot layer
SIPA = SIPROT AND ACTIVE
SIPG1 = SIPA ENCLOSE ACTPOL:1
SIPO = SIPROT AND POLY
SIPO_RHBD:1 = SIPROT_RHBD:1 AND POLY
SIPG2 = SIPO ENCLOSE ACTPOL:1
TRPROT:1 = SIPG1 OR SIPG2

//--------------------------------------------- siprotx layer
SIPROTX = SIPROT NOT TRPROT:1
 
//--------------------------------------------- psrcdrn layer (pmos drain/source)
PSRCDRN = PDIFNW NOT SIPROTX

//--------------------------------------------- nsrcdrn layer (nmos drain/source)
NSRCDRN = NDIFPW NOT SIPROTX

//--------------------------------------------- pofield layer
POFIELD = POLY NOT ACTIVE

//--------------------------------------------- siprpo1 layer
SIPRPO1:1 = POFIELD AND SIPROTX

//--------------------------------------------- poly and ndiff/pdiff layer
N_POLY = POLY AND NPLUS
P_POLY = POLY AND PPLUS

//--------------------------------------------- actpol layer
ACTPOL:1 = ACTIVE AND POLY

//--------------------------------------------- general drift derivation
NDRACT0 = ( NACTIVE CUT PWELL:1 ) CUT NWELL
NDRACT1 = NDRACT0 INTERACT GO2
NDRACT = NDRACT1 INTERACT NEXT
NDRACPO = POLY AND NDRACT

//--------------------------------------------- ndracts layer
NDRACTS = (( NACTIVE CUT PWELL:1 ) CUT NWELL) AND MDRIFT

//--------------------------------------------- general drift derivation
PDRACT0 = ( PACTIVE CUT PWNISO ) CUT ( NWELL INTERACT PWNISO )
PDRACT1 = PDRACT0 INTERACT GO2
PDRACT  = PDRACT1 INTERACT PEXT
PDRACPO = POLY AND PDRACT

//--------------------------------------------- pdracts layer
PDRACTS = (( PACTIVE CUT PWNISO ) CUT NWNISO) AND MDRIFT

//--------------------------------------------- nwelliso layer

NWHOLE_1 = NWELL NOT INSIDE NISO
NWHOLE = (HOLES NWHOLE_1) NOT NWHOLE_1

NWNISO = NWHOLE INSIDE NISO

//--------------------------------------------- pwelliso layer
PWNISO = PWELL:1 AND NWNISO

//--------------------------------------------- mrhbd1 layer
MRHBD:1 = COPY MRHBD1

//--------------------------------------------- ngate/pgate npoly_field/ppoly_field layers
N_GATE = N_POLY AND ACTIVE
P_GATE = P_POLY AND ACTIVE
N_POLY_FIELD = N_POLY NOT ACTIVE
P_POLY_FIELD = P_POLY NOT ACTIVE

//------------------------------------------------------------------------------
//       DRAM  LAYERS  DERIVATION
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
//         CMOS  INTERCONNECT & CONTACT  LAYERS  DERIVATION
//------------------------------------------------------------------------------

//--------------------------------------------- nwellc layer
NWELLC = NWELL NOT NWELFT:1
NWELL2C = NWELL2 NOT NWEL2FT:1

//--------------------------------------------- pwellc layer
PWELLC = PWELL:1 OR (NWELFT:1 OR NWEL2FT:1)

//--------------------------------------------- pdifsi layer
PDIFSI = PDIFF0:1 NOT SIPROTX

//--------------------------------------------- ndifsi layer
NDIFSI:1 = NDIFF0:1 NOT SIPROTX

//--------------------------------------------- sali layer
SALI = PDIFSI OR NDIFSI:1

//--------------------------------------------- polconn layer
POLCONN:1 = POLY NOT SIPROTX

//--------------------------------------------- lilint layer
LILINT = LIL OR CONTACT

//--------------------------------------------- lilact layer
LILEXT:0 = LIL OR ( CONTACT INTERACT LIL )
LILEXT:1 = LILEXT:0 NOT ( CONTACT ENCLOSE LIL )
LILACT = ( LILEXT:1 AND ACTIVE ) NOT SIPROT

LILACT:0 = LIL AND ACTIVE

//--------------------------------------------- lil not act layer
LILNOTACT = LIL NOT ACTIVE

//--------------------------------------------- lilpol layer
LILPOL = (LILEXT:1 AND POLY) NOT SIPROT

//--------------------------------------------- nstrap layer
NSTRAP:1 = NACTIVE AND NWRNW
NSTRAP:1_5V = NACTIVE AND NWELL2
NSTRAP:2 = NSTRAP:1 NOT NDRACPO
NSTRTP = NSTRAP:2 TOUCH PINNW
NSTRTP_5V = NSTRAP:1_5V TOUCH PINNW2
NSTRAP:2_ALL = NSTRAP:2 OR NSTRAP:1_5V
NSTRTP_ALL = NSTRTP OR NSTRTP_5V
NSTRAP_ALL = NSTRAP:1 OR NSTRAP:1_5V

//--------------------------------------------- pstrap layer
PSTRAP = PACTIVE AND PWELL:1
PSTRAP_5V = PACTIVE AND PWELL2
PSTRTN = PSTRAP TOUCH NINPW
PSTRTN_5V = PSTRAP_5V TOUCH NINPW2
PSTRAP_ALL = PSTRAP OR PSTRAP_5V
PSTRTN_ALL = PSTRTN OR PSTRTN_5V

//--------------------------------------------- active no pstrap or nstrap layer
ACTNOPSTRAP = (ACTIVE NOT PSTRAP) NOT PSTRAP_5V
ACTNONSTRAP = (ACTIVE NOT NSTRAP:1) NOT NSTRAP:1_5V

//--------------------------------------------- active strap layer
STRAPNP = NSTRAP:2 OR PSTRAP
STRAPNP_5V = NSTRAP:1_5V OR PSTRAP_5V
ACTNOSTRAP = (ACTIVE NOT STRAPNP) NOT STRAPNP_5V

//--------------------------------------------- nactive no nstrap layer
PACTNOSTRP = PACTIVE NOT PSTRAP
PACTNOSTRP_5V = PACTIVE NOT PSTRAP_5V
NACTNOSTRN = (NACTIVE NOT ACTH_5V) NOT NSTRAP:2
NACTNOSTRN_5V = (NACTIVE NOT ACTH_5V) NOT NSTRAP:1_5V

//--------------------------------------------- subtie layer
SUBTIE:1 = PACTIVE AND PWELL:1
SUBTIE:2 = SUBTIE:1 NOT PWNISO

//--------------------------------------------- ctp layer
CTP:1 = (CONTACT AND POLY) NOT SIPROT
CTP:2 = CTP:1 NOT (CONTACT INTERACT (LIL CUT CONTACT))
CTP:3 = CTP:2 NOT (CONTACT TOUCH LIL)

//--------------------------------------------- cta layer
CTA:1 = CONTACT AND SALI
CTA:2 = CTA:1 OR ( CONTACT AND LDDSALI )
CTA:3 = CTA:2 NOT (CONTACT INTERACT (LIL CUT CONTACT))
CTA:4 = CTA:3 NOT (CONTACT TOUCH LIL)

//--------------------------------------------- lilct layer
LILCT:1 = (CONTACT AND LILINT) NOT SIPROT

//--------------------------------------------- lilsali layer
LILSALI:1 = LILINT AND SALI
 
//--------------------------------------------- m1c layer
M1C:1 = COPY ME1

//--------------------------------------------- vi1c & m2c layer
VI1C:1 = COPY VI1
M2C:1 = COPY ME2

//--------------------------------------------- vi2c & m3c layer
VI2C:1 = COPY VI2
M3C:1 = COPY ME3

//--------------------------------------------- vi3c & m4c layer
VI3C:1 = COPY VI3
M4C:1 = COPY ME4

//--------------------------------------------- vi4c & m5c layer
VI4C:1 = COPY VI4
M5C:1 = COPY ME5

//--------------------------------------------- vi5c & m6c layer
VI5C:1 = COPY VI5
M6C:1 = COPY ME6

//--------------------------------------------- vimim5c
VIMIM5C = VI5C:1 AND MIM5

//--------------------------------------------- vi5c & m6c layer
VI5C:2 = VI5C:1 NOT VIMIM5C

//--------------------------------------------- mim5c layer
MIM5C = COPY MIM5

//--------------------------------------------- vihkmim5c
VIHKMIM5C = VI5C:2 AND HKMIM5

//--------------------------------------------- vi5c & m6c layer
VI5C:3 = VI5C:2 NOT VIHKMIM5C

//--------------------------------------------- hkmim5c layer
HKMIM5C = COPY HKMIM5

//--------------------------------------------- vfbc & prlc layer
VFBC:1 = COPY VFB
PRLC:1 = COPY PRL

//--------------------------------------------- nlddif layer
NPLDIF = NACTIVE NOT POLY
NLDAC = NLDD AND ACTIVE
NLDDIF = ( NLDAC NOT POLY ) NOT PPLUS

NEXTAC = NEXT AND ACTIVE 
NEXDIF = NEXTAC NOT POLY

//--------------------------------------------- plddif layer
PLDAC = PLDD AND ACTIVE
PLDDIF = ( PLDAC NOT POLY ) NOT NPLUS
PEXTAC = PEXT AND ACTIVE

//--------------------------------------------- lddif layer
NLDDIFSI = NLDDIF NOT SIPROTX
PLDDIFSI = PLDDIF NOT SIPROTX
LDDSALI =  NLDDIFSI OR PLDDIFSI

//------------------------------------------------------------------------------
//         DEVICES  LAYERS  DERIVATION
//------------------------------------------------------------------------------

NGATE:5 = NGATE:4 NOT NDRACPO
PGATE:5 = PGATE:4 NOT PDRACPO

NGATE:6 = NGATE:5 OUTSIDE ADHVTP

PGATE:6 = PGATE:5 AND PLDD
PGATE:7 = PGATE:6 OUTSIDE ADHVTN

//----------------------- vertical p+/nwell/p-substrate bipolar transistor device
NSTAPNONLDD =  NSTRAP:2 NOT NLDD
PINRNWNOPLDD =  PINRNW NOT PLDD
NPHOLE = (HOLES NSTAPNONLDD) NOT NSTAPNONLDD
VPNP = (PINRNWNOPLDD INSIDE NPHOLE) INSIDE MPNP
VPNPM = AREA VPNP > 23.9 < 24.1
VPNPMSI = INTERACT VPNPM SIPROT
PACTNOEM = PACTIVE NOT VPNPMSI
ACTNOEM = ACTIVE NOT VPNPMSI

//----------------------- low leakage nmos transistor device
NGATELL:1 = NGATE:6 AND ADHVTN
NGATE:7 = NGATE:6 NOT NGATELL:1

//----------------------- low leakage pmos transistor device
PGATELL:1 = PGATE:7 AND ADHVTP
PGATE:8 = PGATE:7 NOT PGATELL:1

//--------------------------------------------- n-channel drift mos transistor device
NDGATE:1 = NDRACPO AND PWELL:1
NDGATE:2 = NDGATE:1 OUTSIDE SIPROT
NDGATE:3 = NDGATE:2 TOUCH NWELL

//--------------------------------------------- n-channel drift symmetrical mos transistor device
NDGATESYM = NDGATE:3 AND MDRIFT

//--------------------------------------------- p-channel drift mos transistor device
PDGATE:1 = PDRACPO AND NWELL
PDGATE:2 = PDGATE:1 OUTSIDE SIPROT
PDGATE:3 = PDGATE:2 TOUCH PWNISO

//--------------------------------------------- p-channel drift symmetrical mos transistor device
PDGATESYM = PDGATE:3 AND MDRIFT

//--------------------------------------------- double oxyde nmosfet transistor device
NGO2:0 = ( ACTPOL:1 INTERACT NINPWPO ) INSIDE GO2
NGO2:0_1 = NGO2:0 NOT (NGATE_5V:2 OR GATEH_5V)
BADNGO2:1 = ( NGO2:0_1 NOT NEXT) OR ( NGO2:0_1 AND NLDD )
NGO2:1 = ( NGO2:0_1 AND NEXT ) NOT NLDD
NGO2:2 = NGO2:1 NOT NDRACPO
NGO2IO = NGO2:2 AND SIPROT

//--------------------------------------------- double oxyde nmosfet ESD transistor device
NGO2ESD:0 = ( ACTPOL:1 INTERACT NINPWPO ) INSIDE GO2
NGO2ESD:1 = ( NGO2ESD:0 NOT NEXT ) NOT NLDD
NGO2ESD:2 = NGO2ESD:1 NOT NDRACPO
NGO2ESD:3 = NGO2ESD:2 AND SIPROT
BADNGO2:2 = BADNGO2:1 NOT NGO2ESD:3

//--------------------------------------------- double oxyde nmosfet dram transistor device
NGO2DRAM0 = ( ACTPOL:1 INTERACT NINPWPO ) INSIDE GO2
NGO2DRAM1 = ( NGO2DRAM0 NOT NEXT ) AND NLDD
NGO2DRAM = NGO2DRAM1 NOT SIPROT
BADNGO2:3 = BADNGO2:2 NOT NGO2DRAM

//--------------------------------------------- double oxyde pmosfet transistor device
PGO2:0 = ( ACTPOL:1 INTERACT PINNWPO ) INSIDE GO2
PGO2:0_1 = PGO2:0 NOT (PGATE_5V:3 OR GATEH_5V)
BADPGO2 = ( PGO2:0 NOT PEXT) OR ( PGO2:0 AND PLDD )
PGO2:1 = ( PGO2:0 AND PEXT ) NOT PLDD
PGO2IO = PGO2:1 AND SIPROT

//-------------------------------------------- Addition of all mos gate
ALLNGATE:1 = COPY NGATE:7
ALLPGATE:1 = COPY PGATE:8
ALLNGATE:2 = ALLNGATE:1 OR NDGATE:3
ALLPGATE:2 = ALLPGATE:1 OR PDGATE:3
ALLNGATE:3 = ALLNGATE:2 OR NGO2:2
ALLPGATE:3 = ALLPGATE:2 OR PGO2:1
ALLNGATE:4 = ALLNGATE:3 OR NGO2ESD:3
ALLNGATE:5 = ALLNGATE:4 OR NGATELL:1
ALLPGATE:4 = ALLPGATE:3 OR PGATELL:1
ALLGATE_1 = ALLPGATE:4 OR ALLNGATE:5
ALLGATE = ALLGATE_1 OR GATEANDH_5V

//-------------------------------------------- 5V transistors
NGATEH_5V_1 = NGATEH_5V AND NPLUS
PGATEH_5V_1 = PGATEH_5V AND PPLUS
NPGATEH_5V = NGATEH_5V_1 OR PGATEH_5V_1
GATEH_5V_EDG = NPGATEH_5V COINCIDENT INSIDE EDGE POLY
GATEH_5V_TR = INT GATEH_5V_EDG <= 30.0 OPPOSITE REGION

GATEH_5V_W = GATEH_5V_TR COINCIDENT INSIDE EDGE POLY
GATEH_5V_BEAM = GATEH_5V NOT GATEH_5V_TR
GATEH_5V_L = GATEH_5V_TR TOUCH EDGE GATEH_5V_BEAM

NWC_H_5V = NDIFF0:1 TOUCH PGATEH_5V
PWC_H_5V = PDIFF0:1 TOUCH NGATEH_5V
WC_H_5V = NWC_H_5V OR PWC_H_5V

POLYWC_H_5V = GATEH_5V NOT NPGATEH_5V

CONNECT WC_H_5V M1C:2 BY CONTACT

//--------------------------------------------- OTP cell transistor
ACTOTP = ACTIVE INTERACT OTP
GATEH_5V_TR_OTP = GATEH_5V_TR INTERACT ACTOTP
GATEH_5V_OTP = GATEH_5V INTERACT ACTOTP
GATEH_5V_W_OTP = GATEH_5V_TR_OTP COINCIDENT INSIDE EDGE POLY
GATEH_5V_BEAM_OTP = GATEH_5V_OTP NOT GATEH_5V_TR_OTP
GATEH_5V_L_OTP = GATEH_5V_TR_OTP TOUCH EDGE GATEH_5V_BEAM_OTP
POLY_PLATE_OTP = POLY INTERACT OTP
GATEH_5V_BEAM_OTP_N = GATEH_5V_BEAM_OTP AND NACTIVE
GATEH_5V_BEAM_OTP_P = GATEH_5V_BEAM_OTP AND PACTIVE
NPLUS_OTP = NPLUS INTERACT OTP
PPLUS_OTP = PPLUS INTERACT OTP
NPLUS_OTP_ACT = NPLUS_OTP AND ACTIVE
PPLUS_OTP_ACT = PPLUS_OTP AND ACTIVE
NEXT_5V_OTP = NEXT_5V INTERACT OTP
PEXT_5V_OTP = PEXT_5V INTERACT OTP

//--------------------------------------------- rnw device
NWELLR = RNWELL OUTSIDE PACTIVE
RNWELLT = NWELLR NOT MRES
RESNWT = NSTRAP:2 INSIDE NWELLR
RESNW_1 = (NWELLR AND MRES) TOUCH RNWELLT == 2
RESNW = RESNW_1 TOUCH RESNWT == 2

//--------------------------------------------- n+ active resistor device
TMP:1 = NDIFPW CUT MDIODE
ACTRESN = ( NDIFPW OUTSIDE MDIODE ) OR TMP:1
SPRNDIF = ACTRESN AND SIPROTX
DEVRESN = SPRNDIF TOUCH NDIFSI:1 >= 2
RESN = DEVRESN OUTSIDE MRES
MRESN = DEVRESN AND MRES
RNDIFF0 = RESN OR MRESN

//--------------------------------------------- p+ active resistor device
TMP:2 = PDIFNW CUT MDIODE
ACTRESP = ( PDIFNW OUTSIDE MDIODE ) OR TMP:2
SPRPDIF = ACTRESP AND SIPROTX
DEVRESP = SPRPDIF TOUCH PDIFSI >= 2
RESP = DEVRESP OUTSIDE MRES
MRESP = DEVRESP AND MRES
RPDIFF0 = RESP OR MRESP

ACTIVERES = RPDIFF0 OR RNDIFF0

//--------------------------------------------- poly resistor devices
RESPO1 = SIPRPO1:1 OUTSIDE MRES
MRESPO1    = SIPRPO1:1 AND MRES
IPOLY = POLY NOT ( RESPO1 OR MRESPO1 )
RPOLY = ( RESPO1 OR MRESPO1 ) TOUCH IPOLY >= 2

//--------------------------------------------- salicided n+ poly resistor device
SALIPO1    = POFIELD NOT SIPROT
RSPO1BD:1 = SALIPO1 AND MRES
RSPO1BD_1 = SALIPO1 NOT RSPO1BD:1
RSPO1BD:2 = RSPO1BD:1 TOUCH RSPO1BD_1 == 2
MRSPO1:1 = MRPO OUTSIDE (CONTACT CUT MRPO)
MRSPO1:2 = MRSPO1:1 ENCLOSE RSPO1BD:2 == 1
MRPO:1 = MRPO NOT MRSPO1:2
RSPO1BD:3 = RSPO1BD:2 INSIDE MRSPO1:2
RSPO1BD:4 = RSPO1BD:3 OUTSIDE PPLUS
RSPO1BD:5 = RSPO1BD:4 INSIDE NPLUS
RSPO1BD:6 = RSPO1BD:5 INSIDE NLDD
RSPO1BD:7 = RSPO1BD:6 OUTSIDE PRESIST
POLCONN:2 = POLCONN:1 NOT RSPO1BD:7
RSPO1HD:1 = ( SALIPO1 NOT RSPO1BD:7 ) AND MRSPO1:2

//--------------------------------------------- poly short device
SHPO1:1 = POLCONN:2 NOT ACTIVE
SHPO1:2 = MRPO:1 AND SHPO1:1
SHPO1:3 = SHPO1:2 OUTSIDE CTP:3
POLCONN:3 = POLCONN:2 NOT SHPO1:3

//--------------------------------------------- metal short device
SHMETAL:1 = CTA:4 OR CTP:3
SHMETAL:2 = VI1 OR SHMETAL:1
SHMETAL:3 = VI2 OR SHMETAL:2
SHMETAL:4 = VI3 OR SHMETAL:3
SHMETAL:5 = VI4 OR SHMETAL:4
SHMETAL:6 = VI5 OR SHMETAL:5

//--------------------------------------------- metal1 short device
SHME1 = (M1C:1 AND MRM1) OUTSIDE SHMETAL:6
M1C:2 = M1C:1 NOT SHME1

//--------------------------------------------- metal2 short device
SHME2 = (M2C:1 AND MRM2) OUTSIDE SHMETAL:6
M2C:2 = M2C:1 NOT SHME2

//--------------------------------------------- metal3 short device
SHME3 = (M3C:1 AND MRM3) OUTSIDE SHMETAL:6
M3C:2 = M3C:1 NOT SHME3

//--------------------------------------------- metal4 short device
SHME4 = (M4C:1 AND MRM4) OUTSIDE SHMETAL:6
M4C:2 = M4C:1 NOT SHME4

//--------------------------------------------- metal5 short device
SHME5 = (M5C:1 AND MRM5) OUTSIDE SHMETAL:6
M5C:2 = M5C:1 NOT SHME5

//--------------------------------------------- metal6 short device
SHME6 = (M6C:1 AND MRM6) OUTSIDE SHMETAL:6
M6C:2 = M6C:1 NOT SHME6

//--------------------------------------------- rhipo device
RHBODY = (PRESIST AND SIPRPO1:1) NOT PPLUS
RHPOLY = POLY ENCLOSE RHBODY
RHTERM = RHPOLY NOT RHBODY
RHHEAD = RHTERM AND PPLUS

//--------------------------------------------- poly/nwell capacitor devices 
CP1NWAC:1 = ( MCP1NW AND NACTIVE ) AND NWELL        // active area
CP1NWAC:1_5 = NACTIVE AND NWELL2
CP1NWAC:2 = CP1NWAC:1 NOT NLDD
CP1NWB = CP1NWAC:2 ENCLOSE ACTPOL:1                // bottom plate
CP1NWB_5 = CP1NWAC:1_5 ENCLOSE ACTPOL:1
CP1NWGO2 = (( CP1NWB AND ACTPOL:1 ) AND NEXT ) INSIDE GO2
CP1NWGO2_5 = (( CP1NWB_5 AND ACTPOL:1 ) AND NEXT_5V ) INSIDE GO2_5V
CP1NWNOTGO2 = (( CP1NWB AND ACTPOL:1 ) OUTSIDE NEXT ) OUTSIDE GO2
CP1NW = (CP1NWGO2 OR CP1NWNOTGO2) OR CP1NWGO2_5
CP1NWT = POLY INTERACT CP1NW

//--------------------------------------------- Thin oxide Metal/Metal M5 capacitor device
CAPMIM5 = ME5 AND MIM5C
MIM5BASEI = SIZE MIM5 BY 1.2
TMPPLATE1 = SIZE MIM5 BY 2
MIM5PLATE = (ME5 AND TMPPLATE1) ENCLOSE MIM5C

//--------------------------------------------- Thin oxide Metal/HKMetal M5 capacitor device
CAPHKMIM5 = ME5 AND HKMIM5C
HKMIM5BASEI = SIZE HKMIM5 BY 1.2
TMPHKPLATE1 = SIZE HKMIM5 BY 2
HKMIM5PLATE = (ME5 AND TMPHKPLATE1) ENCLOSE HKMIM5C

//--------------------------------------------- NWELL2 resistor
RNWELL2 = NWELL2 INTERACT MRES_50
NACTRNW2 = NACTIVE TOUCH MRES_50

// //////////////////////////////////////////////////////////////////////////////
// /                      CONNECTIVITY  DEFINITION                              /
// //////////////////////////////////////////////////////////////////////////////

ATTACH 1306 POLCONN:3
ATTACH 1305 POLCONN:3

ATTACH 3906 LILINT
ATTACH 3905 LILINT
PORT LAYER TEXT 3905

ATTACH 2306 M1C:2
ATTACH 2305 M1C:2

ATTACH 2706 M2C:2
ATTACH 2705 M2C:2

ATTACH 3406 M3C:2
ATTACH 3405 M3C:2

ATTACH 3606 M4C:2
ATTACH 3605 M4C:2

ATTACH 5306 M5C:2
ATTACH 5305 M5C:2

ATTACH 5506 M6C:2
ATTACH 5505 M6C:2

ATTACH 3342 PRLC:1
ATTACH 3343 PRLC:1
CONNECT PRLC:1 M6C:2 BY VFBC:1
CONNECT M6C:2 M5C:2 BY VI5C:3
CONNECT M6C:2 MIM5C BY VIMIM5C
CONNECT M6C:2 HKMIM5C BY VIHKMIM5C
CONNECT M5C:2 M4C:2 BY VI4C:1
CONNECT M4C:2 M3C:2 BY VI3C:1
CONNECT M3C:2 M2C:2 BY VI2C:1
CONNECT M2C:2 M1C:2 BY VI1C:1
CONNECT M1C:2 LILINT BY LILCT:1
CONNECT LILINT SALI BY LILSALI:1
CONNECT LILINT POLCONN:3
CONNECT LILINT LDDSALI
CONNECT LDDSALI SALI
CONNECT SALI PDIFSI NDIFSI:1

NSTRAP_1 = STAMP NSTRAP:2 BY SALI
NSTRAP_1_5V = STAMP NSTRAP:1_5V BY SALI
NWELLC:1 = STAMP NWELLC BY NSTRAP_1
NWELL2C:1 = STAMP NWELL2C BY NSTRAP_1_5V
NWELL2:1 = STAMP NWELL2 BY NSTRAP_1_5V
PSTRAP_1 = STAMP PSTRAP BY SALI
PWELLC:1 = STAMP PWELLC BY PSTRAP_1
PSTRAP_1_5V = STAMP PSTRAP_5V BY SALI
PWELL2:1 = STAMP PWELL2 BY PSTRAP_1_5V
SUBTIE_1 = STAMP SUBTIE:2 BY SALI
SUBS:1 = STAMP SUBS BY SUBTIE_1

// //////////////////////////////////////////////////////////////////////////////
// /                            DRC  SECTION                                    /
// //////////////////////////////////////////////////////////////////////////////

// //////////////////////////////////////////////////////////////////////////////
// /                         SEALRING_LAY  DERIVATION                           /
// //////////////////////////////////////////////////////////////////////////////

DACTIVE = DONUT ACTIVE
DPPLUS = DONUT PPLUS
DME1 = DONUT ME1
DME2 = DONUT ME2
DME3 = DONUT ME3
DME4 = DONUT ME4
DME5 = DONUT ME5
DME6 = DONUT ME6
DNITRIDE = DONUT NITRIDE
DINVACT = DONUT INVACT
DMFGPP_0 = DONUT MFGPP_0
DSR1 = ((DACTIVE AND DINVACT) AND DPPLUS) AND DNITRIDE
DMET = ((((DME1 AND DME2) AND DME3) AND DME4) AND DME5) AND DME6
SEALRING_LAY = (DMFGPP_0 INTERACT DSR1) INTERACT DMET

// //////////////////////////////////////////////////////////////////////////////
// /              NOMASK  LAYERS  SPECIFIC  DERIVATION FOR DUMMIES              /
// //////////////////////////////////////////////////////////////////////////////

FNOSIZE:42 = FSIZE:0 OR NOSIZE:0

Mask_Rule_1 { @ Mask Rule 1 : mask patterns must not overlap circuit.
                ADHVTN_0 INTERACT FNOSIZE:42
            }

Mask_Rule_2 { @ Mask Rule 2 : corners patterns distance to circuit >= 3.
                EXT MFGPP_0 ADHVTN_0 < 3 ABUT<90 SINGULAR
            }

Mask_Rule_3 { @ Mask Rule 3 : mask patterns except corners distance to circuit >= 3.
                EXT MFGPP_nsz ADHVTN_0 < 3 ABUT<90 SINGULAR
            }

Mask_Rule_4 { @ Mask Rule 4 : mask patterns must not overlap circuit.
                ADHVTP_0 INTERACT FNOSIZE:42
            }

Mask_Rule_5 { @ Mask Rule 5 : corners patterns distance to circuit >= 3.
                EXT MFGPP_0 ADHVTP_0 < 3 ABUT<90 SINGULAR
            }

Mask_Rule_6 { @ Mask Rule 6 : mask patterns except corners distance to circuit >= 3.
                EXT MFGPP_nsz ADHVTP_0 < 3 ABUT<90 SINGULAR
            }

//------------------------------------------------------------------------------
//    CHECKS  ON  MASK  PATTERNS
//------------------------------------------------------------------------------

MFGPPDG = FNOSIZE:42 AND MFGPP_0
MFGPPNG = FNOSIZE:42 AND MFGPP_nsz
MASKPAT = MFGPPDG OR MFGPPNG

//------------------------------------------------------------------------------
//      Auxiliary layers
//------------------------------------------------------------------------------

FNOSIZE:1 = NOSIZE:1 OR FSIZE:1

Rany.imp1 { @ Rule any.imp1 : All auxiliary layers with purposes fsizing and nosizing must be
            @ inside of MFGPP_0 layer.
              FNOSIZE:1 NOT MFGPP_0
      }

Rany.imp2 { @ Rule any.imp2 : Layer with purposes fsizing and nosizing mustn't interact
            @ with proper layer with purpose drawing.
              (NWELL_nsz OR NWELL_fsz) INTERACT NWELL SINGULAR ALSO
          (ACTIVE_nsz OR ACTIVE_fsz) INTERACT ACTIVE SINGULAR ALSO
          (POLY_nsz OR POLY_fsz) INTERACT POLY SINGULAR ALSO
          (PRESIST_nsz OR PRESIST_fsz) INTERACT PRESIST SINGULAR ALSO
          (SIPROT_nsz OR SIPROT_fsz) INTERACT SIPROT SINGULAR ALSO
          NITRIDE_nsz INTERACT NITRIDE SINGULAR ALSO
          (NLDD_nsz OR NLDD_fsz) INTERACT NLDD SINGULAR ALSO
          (PLDD_nsz OR PLDD_fsz) INTERACT PLDD SINGULAR ALSO
          (NPLUS_nsz OR NPLUS_fsz) INTERACT NPLUS SINGULAR ALSO
          (PPLUS_nsz OR PPLUS_fsz) INTERACT PPLUS SINGULAR ALSO
          (ADHVTN_nsz OR ADHVTN_fsz) INTERACT ADHVTN SINGULAR ALSO
          (ADHVTP_nsz OR ADHVTP_fsz) INTERACT ADHVTP SINGULAR ALSO
          (CONTACT_nsz OR CONTACT_fsz) INTERACT CONTACT SINGULAR ALSO
          (METAL1_nsz OR METAL1_fsz) INTERACT ME1 SINGULAR ALSO
          (VI1_nsz OR VI1_fsz) INTERACT VI1 SINGULAR ALSO
          (METAL2_nsz OR METAL2_fsz) INTERACT ME2 SINGULAR ALSO
          (VI2_nsz OR VI2_fsz) INTERACT VI2 SINGULAR ALSO
          (METAL3_nsz OR METAL3_fsz) INTERACT ME3 SINGULAR ALSO
          (VI3_nsz OR VI3_fsz) INTERACT VI3 SINGULAR ALSO
          (METAL4_nsz OR METAL4_fsz) INTERACT ME4 SINGULAR ALSO
          (VI4_nsz OR VI4_fsz) INTERACT VI4 SINGULAR ALSO
          (METAL5_nsz OR METAL5_fsz) INTERACT ME5 SINGULAR ALSO
          (MIM5_nsz OR MIM5_fsz) INTERACT MIM5 SINGULAR ALSO
          (HKMIM5_nsz OR HKMIM5_fsz) INTERACT HKMIM5 SINGULAR ALSO
          (VI5_nsz OR VI5_fsz) INTERACT VI5 SINGULAR ALSO
          (METAL6_nsz OR METAL6_fsz) INTERACT ME6 SINGULAR ALSO
          (LIL_nsz OR LIL_fsz) INTERACT LIL SINGULAR ALSO
          (NWELL2_nsz OR NWELL2_fsz) INTERACT NWELL2 SINGULAR ALSO
          (PWELL2_nsz OR PWELL2_fsz) INTERACT PWELL2 SINGULAR ALSO
          (OTP_nsz OR OTP_fsz) INTERACT OTP SINGULAR ALSO
          (VFB_nsz OR VFB_fsz) INTERACT VFB SINGULAR ALSO
          (PRL_nsz OR PRL_fsz) INTERACT PRL SINGULAR ALSO
          (NEXT_nsz OR NEXT_fsz) INTERACT NEXT SINGULAR ALSO
          (PEXT_nsz OR PEXT_fsz) INTERACT PEXT SINGULAR ALSO
          (NEXT_5V_nsz OR NEXT_5V_fsz) INTERACT NEXT_5V SINGULAR ALSO
          (PEXT_5V_nsz OR PEXT_5V_fsz) INTERACT PEXT_5V SINGULAR ALSO
          (GO2_nsz OR GO2_fsz) INTERACT GO2 SINGULAR ALSO
          (GO2_5V_nsz OR GO2_5V_fsz) INTERACT GO2_5V SINGULAR ALSO
          (NISO_nsz OR NISO_fsz) INTERACT NISO SINGULAR ALSO
      }

MFGPP_0M1 = MFGPP_0 COIN IN EDGE ME1
MFGPP_1M1 = MFGPP_0 WITH EDGE MFGPP_0M1
MFGPP_2M1 = MFGPP_1M1 NOT CUT ME1
MFGPP_1 = MFGPP_0 NOT MFGPP_2M1

MFGPP_0M2 = MFGPP_0 COIN IN EDGE ME2
MFGPP_1M2 = MFGPP_0 WITH EDGE MFGPP_0M2
MFGPP_2M2 = MFGPP_1M2 NOT CUT ME2
MFGPP_2 = MFGPP_0 NOT MFGPP_2M2

MFGPP_0M3 = MFGPP_0 COIN IN EDGE ME3
MFGPP_1M3 = MFGPP_0 WITH EDGE MFGPP_0M3
MFGPP_2M3 = MFGPP_1M3 NOT CUT ME3
MFGPP_3 = MFGPP_0 NOT MFGPP_2M3

MFGPP_0M4 = MFGPP_0 COIN IN EDGE ME4
MFGPP_1M4 = MFGPP_0 WITH EDGE MFGPP_0M4
MFGPP_2M4 = MFGPP_1M4 NOT CUT ME4
MFGPP_4 = MFGPP_0 NOT MFGPP_2M4

MFGPP_0M5 = MFGPP_0 COIN IN EDGE ME5
MFGPP_1M5 = MFGPP_0 WITH EDGE MFGPP_0M5
MFGPP_2M5 = MFGPP_1M5 NOT CUT ME5
MFGPP_5 = MFGPP_0 NOT MFGPP_2M5

MFGPP_0M6 = MFGPP_0 COIN IN EDGE ME6
MFGPP_1M6 = MFGPP_0 WITH EDGE MFGPP_0M6
MFGPP_2M6 = MFGPP_1M6 NOT CUT ME6
MFGPP_6 = MFGPP_0 NOT MFGPP_2M6

Rany.imp3 { @ Rule any.imp3 : MFGPP_0 layer mustn't overlap ACTIVE, POLY, metals.
              (MFGPP_0 AND ACTIVE) NOT SEALRING_LAY
              (MFGPP_0 AND POLY) NOT SEALRING_LAY
              (MFGPP_1 AND ME1) NOT SEALRING_LAY
              (MFGPP_2 AND ME2) NOT SEALRING_LAY
              (MFGPP_3 AND ME3) NOT SEALRING_LAY
              (MFGPP_4 AND ME4) NOT SEALRING_LAY
              (MFGPP_5 AND ME5) NOT SEALRING_LAY
              (MFGPP_6 AND ME6) NOT SEALRING_LAY
          }

Rany.imp4 { @ Rule any.imp4 : MFGPP_0 distance to external metals >= 3.0.
              EXT MFGPP_1 ME1 < 3.0 ABUT<90 SINGULAR REGION
              EXT MFGPP_2 ME2 < 3.0 ABUT<90 SINGULAR REGION
              EXT MFGPP_3 ME3 < 3.0 ABUT<90 SINGULAR REGION
              EXT MFGPP_4 ME4 < 3.0 ABUT<90 SINGULAR REGION
              EXT MFGPP_5 ME5 < 3.0 ABUT<90 SINGULAR REGION
              EXT MFGPP_6 ME6 < 3.0 ABUT<90 SINGULAR REGION
          }

// ;------------------------------------------------------------------------------
// ;       ACTIVE_4  [CAD layer]
// ;------------------------------------------------------------------------------

DUMINW = ACTIVE_4 AND NWELL
DUMONW = ACTIVE_4 NOT NWELL

DUMINW2 = ACTIVE_4 AND NWELL2
DUMONW2 = ACTIVE_4 NOT NWELL2

R2.du1 { @ Rule 2.du1 : dummy ACTIVE is not allowed on ACTIVE.
         @ Rule 2.du1 : dummy ACTIVE distance to ACTIVE >= 2.
           ACTIVE_4 AND ACTIVE
           EXT ACTIVE_4 ACTIVE < 2 ABUT<90 SINGULAR
       }

R2.du2 { @ Rule 2.du2 : dummy ACTIVE is not allowed under POLY.
         @ Rule 2.du2 : dummy ACTIVE distance to poly >= 2.
           ACTIVE_4 AND POLY
           EXT ACTIVE_4 POLY < 2 ABUT<90 SINGULAR
       }

R2.du3_R2.du3a { @ Rule 2.du3 - 2.du3a : dummy ACTIVE crossing NWELL/PWELL or NWELL/PWELL2 boundary is not allowed.
                 @ Rule 2.du3 - 2.du3a : dummy ACTIVE distance to NWELL >= 2.
                 @ Rule 2.du3 - 2.du3a : dummy ACTIVE enclosure by NWELL >= 2.
                   EXT DUMINW DUMONW < 0.025 ABUT<90 SINGULAR
                   EXT ACTIVE_4 NWELL < 2 ABUT<90 SINGULAR
                   ENC ACTIVE_4 NWELL < 2 ABUT<90 SINGULAR
               }

R2.du3a { @ Rule 2.du3a : dummy ACTIVE crossing NWELL2/PWELL and NWELL2/PWELL2 boundary is not allowed.
          @ Rule 2.du3a : dummy ACTIVE distance to NWELL2 >= 2.
          @ Rule 2.du3a : dummy ACTIVE enclosure by NWELL2 >= 2.
            EXT DUMINW2 DUMONW2 < 0.025 ABUT<90 SINGULAR
            EXT ACTIVE_4 NWELL2 < 2 ABUT<90 SINGULAR
            ENC ACTIVE_4 NWELL2 < 2 ABUT<90 SINGULAR
        }

R2.du4 { @ Rule 2.du4 : dummy ACTIVE is not allowed on RNWELL.
         @ Rule 2.du4 : dummy ACTIVE distance to RNWELL >= 2.
           ACTIVE_4 AND RNWELL_0
           EXT ACTIVE_4 RNWELL_0 < 2 ABUT<90 SINGULAR
       }

R2.du5 { @ Rule 2.du5 : dummy ACTIVE is not allowed under LIL 
         @ Rule 2.du5 : dummy ACTIVE distance to LIL >= 2
           ACTIVE_4 AND LIL
           EXT ACTIVE_4 LIL < 2 ABUT<90 SINGULAR
       }

R2.du6 { @ Rule 2.du6 : dummy ACTIVE is not allowed under pad.
         @ Rule 2.du6 : dummy ACTIVE distance to pad >= 5.
           ACTIVE_4 AND PAD
           EXT ACTIVE_4 PAD < 5 ABUT<90 SINGULAR
       }

R2.du7a { @ Rule 2.du7a : dummy ACTIVE is not allowed under masks patterns.
            ACTIVE_4 AND MASKPAT
        }

R2.du7b { @ Rule 2.du7b : dummy ACTIVE distance to Corner L >= 3.
            EXT ACTIVE_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
        }

R2.du7c { @ Rule 2.du7c : dummy ACTIVE distance to others masks patterns >= 3.
            EXT ACTIVE_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
        }

R2.du8 { @ Rule 2.du8 : dummy ACTIVE width = 4 x 4.
           NOT RECTANGLE ACTIVE_4 == 4 BY == 4
       }

R2.du9 {@ Rule 2.du9 : dummy ACTIVE space = 2.
          EXT ACTIVE_4 < 2 SPACE ABUT>0<90 SINGULAR
       }

// The following check has been removed because of uncompatibility with R2.du.14
//R2.du.10_11_12_13 {@ Rule 2.du.10_11_12_13 : maximum width in both direction of areas without dummy active = 10.0
//  COPY EPTYDAC:1
//}

// The rule R2.du.13 is mandatory and works in partnership with the density rules
// NB. ACTIVE stand for ACTIVE_0 + ACTIVE_30

TMPACT:1 = ACTIVE OR ACTIVE_4
TMPACT:2 = ACTIVE_nsz OR TMPACT:1
TMPACT:3 = ACTIVE_fsz OR TMPACT:2

TMPACT_4 = FLATTEN TMPACT:3
BULK_3 = EXTENT TMPACT_4
SZBULK_3 = SIZE BULK_3 BY -100
OPBULK_3 = ENC SZBULK_3 BULK_3 < 101 OPPOSITE REGION
CORBULK_3 = BULK_3 NOT (SZBULK_3 OR OPBULK_3)

R2.du14 { @ Rule 2.du14 : maximum area width without active < 200.
          @ The check works for chips with length of sides > 200u.
            ACTSIZED = SIZE TMPACT_4 BY 100
            VOID = (BULK_3 NOT ACTSIZED) NOT CORBULK_3
        (SIZE VOID BY 100) AND BULK_3
    }  

// R2.du15 & R2.du16 are performed in the chapter "DENSITY RULES"

// ;------------------------------------------------------------------------------
// ;       POLY/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

R13.du1 { @ Rule 13.du1 : dummy POLY is not allowed on ACTIVE.
          @ Rule 13.du1 : dummy POLY distance to ACTIVE >= 2.
            POLY_4 AND ACTIVE
            EXT POLY_4 ACTIVE < 2 ABUT<90 SINGULAR
        }

R13.du2 { @ Rule 13.du2 : dummy POLY is not allowed under POLY.
          @ Rule 13.du2 : dummy POLY distance to POLY >= 2.
            POLY_4 AND POLY
            EXT POLY_4 POLY < 2 ABUT<90 SINGULAR
        }

R13.du6 {@ Rule 13.du6 : dummy POLY is not allowed under pad.
         @ Rule 13.du6 : dummy POLY distance to pad >= 5.
           POLY_4 AND PAD
           EXT POLY_4 PAD < 5 ABUT<90 SINGULAR
        }

R13.du7a { @ Rule 13.du.7a : dummy POLY is not allowed under masks patterns.
             POLY_4 AND MASKPAT
         }

R13.du7b { @ Rule 13.du.7b : dummy POLY distance to Corner L >= 3.
             EXT POLY_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R13.du7c { @ Rule 13.du.7c : dummy POLY distance to others masks patterns >= 3.
             EXT POLY_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

R13.du8 { @ Rule 13.du8 : dummy POLY width = 3 x 3.
            NOT RECTANGLE POLY_4 == 3 BY == 3
        }

R13.du9 { @ Rule 13.du9 : dummy poly space = 3.
            EXT POLY_4 < 3 SPACE ABUT>0<90 SINGULAR
        }

// ;------------------------------------------------------------------------------
// ;       METAL1/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

R23.du1 { @ Rule 23.du1 : dummy metal1 is not allowed on metal1.
          @ Rule 23.du1 : dummy metal1 distance to metal1 >= 1.5.
            ME1_4 AND ME1
            EXT ME1_4 ME1 < 1.5 ABUT<90 SINGULAR
        }

R23.du2a { @ Rule 23.du2a : dummy metal1 is not allowed under masks patterns.
             ME1_4 AND MASKPAT
         }

R23.du2b { @ Rule 23.du2b : dummy metal1 distance to Corner L >= 3.
             EXT ME1_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R23.du2c { @ Rule 23.du2c : dummy metal1 distance to others masks patterns >= 3.
             EXT ME1_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }
//min size 0.32 x 0.96 = min area 0,3072
R23.du3 { @ Rule 23.du3 : min dummy metal1 size 0.32 x 0.96.
            NOT RECTANGLE ME1_4 >= 0.32 BY >= 0.96
        }

R23.du4 { @ Rule 23.du4 : dummy metal1 space = 0.32.
            EXT ME1_4 < 0.32 SPACE ABUT>0<90 SINGULAR
        }

R23.du6 { @ Rule 23.du6 : dummy metal1 is not allowed under pad.
          @ Rule 23.du6 : dummy metal1 distance to pad >= ^SIZE_PAD.
            ME1_4 AND PAD
            EXT ME1_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

// The following check has been removed because "metal filling" is warranted by 
// checks performed in the chapter "DENSITY RULES"
//R23.du5 { @ Rule 23.du5 : maximum width in both direction of areas without dummy metal1 = 30.0.
//            COPY EPTYDM1:1
//        } 

// ;------------------------------------------------------------------------------
// ;       METAL2/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------

R27.du1 { @ Rule 27.du1 : dummy metal2 is not allowed on metal2.
          @ Rule 27.du1 : dummy metal2 distance to metal2 >= 1.5.
            ME2_4 AND ME2
            EXT ME2_4 ME2 < 1.5 ABUT<90 SINGULAR
        }

R27.du2a { @ Rule 27.du2a : dummy metal2 is not allowed under masks patterns.
             ME2_4 AND MASKPAT
         }

R27.du2b { @ Rule 27.du2b : dummy metal2 distance to Corner L >= 3.
             EXT ME2_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R27.du2c { @ Rule 27.du2c : dummy metal2 distance to others masks patterns >= 3.
             EXT ME2_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

//min size 0.32 x 0.96 = min area 0,3072
R27.du3 { @ Rule 27.du3 : min dummy metal2 size 0.32 x 0.96.
            NOT RECTANGLE ME2_4 >= 0.96 BY >= 0.32
        }

R27.du4 { @ Rule 27.du4 : dummy metal2 space = 0.32.
            EXT ME2_4 < 0.32 SPACE ABUT>0<90 SINGULAR
        }
 
R27.du6 { @ Rule 27.du6 : dummy metal2 is not allowed under pad.
          @ Rule 27.du6 : dummy metal2 distance to pad >= ^SIZE_PAD.
            ME2_4 AND PAD
            EXT ME2_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

// The following check has been removed because "metal filling" is warranted by 
// checks performed in the chapter "DENSITY RULES"
//R27.du5 { @ Rule 27.du5 : maximum width in both direction of areas without dummy metal2 = 30.0.
//            COPY EPTYDM2:1
//        }

// ;------------------------------------------------------------------------------ 
// ;       METAL3/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

R34.du1 { @ Rule 34.du1 : dummy metal3 is not allowed on metal3.
          @ Rule 34.du1 : dummy metal3 distance to metal3 >= 1.5.
            ME3_4 AND ME3
            EXT ME3_4 ME3 < 1.5 ABUT<90 SINGULAR
        }

R34.du2a { @ Rule 34.du2a : dummy metal3 is not allowed under masks patterns.
             ME3_4 AND MASKPAT
         }

R34.du2b { @ Rule 34.du2b : dummy metal3 distance to Corner L >= 3.
            EXT ME3_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
        }

R34.du2c { @ Rule 34.du2c : dummy metal3 distance to others masks patterns >= 3.
            EXT ME3_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
        }

//min size 0.32 x 0.96 = min area 0,3072
R34.du3 { @ Rule 34.du3 : min dummy metal3 size 0.32 x 0.96.
            NOT RECTANGLE ME3_4 >= 0.32 BY >= 0.96
        }

R34.du4 { @ Rule 34.du4 : dummy metal3 space = 0.32.
            EXT ME3_4 < 0.32 SPACE ABUT>0<90 SINGULAR
        }

R34.du6 { @ Rule 34.du6 : dummy metal3 is not allowed under pad.
          @ Rule 34.du.6 : dummy metal3 distance to pad >= ^SIZE_PAD.
            ME3_4 AND PAD
            EXT ME3_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

// The following check has been removed because "metal filling" is warranted by 
// checks performed in the chapter "DENSITY RULES"
//R34.du5 {@ Rule 34.du5 : maximum width in both direction of areas without dummy metal3 = 30.0.
//           COPY EPTYDM3:1
//        }

// ;------------------------------------------------------------------------------ 
// ;       METAL4/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

R36.du1 { @ Rule 36.du1 : dummy metal4 is not allowed on metal4.
          @ Rule 36.du1 : dummy metal4 distance to metal4 >= 1.5.
            ME4_4 AND ME4
            EXT ME4_4 ME4 < 1.5 ABUT<90 SINGULAR
        }

R36.du2a { @ Rule 36.du2a : dummy metal4 is not allowed under masks patterns.
             ME4_4 AND MASKPAT
         }

R36.du2b { @ Rule 36.du2b : dummy metal4 distance to Corner L >= 3.
             EXT ME4_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R36.du2c { @ Rule 36.du2c : dummy metal4 distance to others masks patterns >= 3.
             EXT ME4_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

//min size 0.32 x 0.96 = min area 0,3072
R36.du3 { @ Rule 36.du3 : min dummy metal4 size 0.32 x 0.96.
            NOT RECTANGLE ME4_4 >= 0.96 BY >= 0.32
        }

R36.du4 { @ Rule 36.du4 : dummy metal4 space = 0.32.
            EXT ME4_4 < 0.32 SPACE ABUT>0<90 SINGULAR
        }

R36.du6 { @ Rule 36.du6 : dummy metal4 is not allowed under pad.
          @ Rule 36.du6 : dummy metal4 distance to pad >= ^SIZE_PAD.
            ME4_4 AND PAD
            EXT ME4_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

// The following check has been removed because "metal filling" is warranted by 
// checks performed in the chapter "DENSITY RULES"
//R36.du5 {@ Rule 36.du5 : maximum width in both direction of areas without dummy metal4 = 30.0.
//           COPY EPTYDM4:1
//        }

// ;------------------------------------------------------------------------------ 
// ;       METAL5/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

R53.du1 { @ Rule 53.du1 : dummy metal5 is not allowed on metal5.
          @ Rule 53.du1 : dummy metal5 distance to metal5 >= 2.
            ME5_4 AND ME5
            EXT ME5_4 ME5 < 2 ABUT<90 SINGULAR
        }

R53.du2a { @ Rule 53.du2a : dummy metal5 is not allowed under masks patterns.
             ME5_4 AND MASKPAT
         }

R53.du2b { @ Rule 53.du.2b : dummy metal5 distance to Corner L >= 3.
             EXT ME5_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R53.du2c { @ Rule 53.du.2c : dummy metal5 distance to others masks patterns >= 3.
             EXT ME5_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

R53.du3 {@ Rule 53.du3 : min dummy metal5 width >= 2.
           INT ME5_4 < 2 ABUT>0<90 REGION
        }

R53.du4 {@ Rule 53.du4 : dummy metal5 space = 1.4.
           EXT ME5_4 < 1.4 SPACE ABUT>0<90 SINGULAR
        }

R53.du6 { @ Rule 53.du6 : dummy metal5 is not allowed under pad.
          @ Rule 53.du6 : dummy metal5 distance to pad >= ^SIZE_PAD.
            ME5_4 AND PAD
            EXT ME5_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

// The following check has been removed because "metal filling" is warranted by 
// checks performed in the chapter "DENSITY RULES"
//R53.du5 {@ Rule 53.du5 : maximum width in both direction of areas without dummy metal5 = 30.0.
//           COPY EPTYDM5:1
//        }

// ;------------------------------------------------------------------------------ 
// ;       METAL6/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 

R55.du1 { @ Rule 55.du1 : dummy metal6 is not allowed on metal6.
          @ Rule 55.du1 : dummy metal6 distance to metal6 >= 2.
            ME6_4 AND ME6
            EXT ME6_4 ME6 < 2 ABUT<90 SINGULAR
        }

R55.du2a { @ Rule 55.du2a : dummy metal6 is not allowed under masks patterns.
             ME6_4 AND MASKPAT
         }

R55.du2b { @ Rule 55.du2b : dummy metal6 distance to Corner L >= 3.
             EXT ME6_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R55.du2c { @ Rule 55.du2c : dummy metal6 distance to others masks patterns >= 3.
             EXT ME6_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

R55.du3 { @ Rule 55.du3 : min dummy metal6 width >= 2.
            INT ME6_4 < 2 ABUT>0<90 REGION
        }

R55.du4 { @ Rule 55.du4 : dummy metal6 space = 1.4.
            EXT ME6_4 < 1.4 SPACE ABUT>0<90 SINGULAR
        }

R55.du6 { @ Rule 55.du6 : dummy metal6 is not allowed under pad.
          @ Rule 55.du6 : dummy metal6 distance to pad >= ^SIZE_PAD.
            ME6_4 AND PAD
            EXT ME6_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

// The following check has been removed because "metal filling" is warranted by 
// checks performed in the chapter "DENSITY RULES"
//R55.du5 { @ Rule 55.du5 : maximum width in both direction of areas without dummy metal6 = 30.0.
//            COPY EPTYDM6:1
//        }

// ;------------------------------------------------------------------------------ 
// ;       MIM5/DUMMY  [CAD layer] 
// ;------------------------------------------------------------------------------ 
  
R80.du1 { @ Rule 80.du1 : dummy MIM5 is not allowed on MIM5.
          @ Rule 80.du1 : dummy MIM5 distance to mim5 >= 2.
            MIM5_4 AND MIM5
            EXT MIM5_4 MIM5 < 2 ABUT<90 SINGULAR
        }

R80.du2a { @ Rule 80.du2a : dummy MIM5 is not allowed under masks patterns.
             MIM5_4 AND MASKPAT
         }

R80.du2b { @ Rule 80.du2b : dummy MIM5 distance to Corner L >= 3.
             EXT MIM5_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R80.du2c { @ Rule 80.du2c : dummy MIM5 distance to others masks patterns >= 3.
             EXT MIM5_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

R80.du3 { @ Rule 80.du3 : dummy MIM5 is not allowed under pad.
          @ Rule 80.du3 : dummy MIM5 distance to pad >= ^SIZE_PAD.
            MIM5_4 AND PAD
            EXT MIM5_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

R80.du4 {@ Rule 80.du4 : dummy metal5 is required under dummy MIM5.
           MIM5_4 NOT ME5_4
        }

R80.du5 { @ Rule 80.du5 : dummy MIM5 is not allowed on metal5.
            MIM5_4 AND ME5
        }

R80.du6 { @ Rule 80.du6 : dummy MIM5 is required over dummy metal5.
            (ME5_4 NOT INTERACT MIM5_4) NOT (BULK NOT INTERACT MIM5)
        }

// ;------------------------------------------------------------------------------ 
// ;       HKMIM5/DUMMY  [CAD layer]
// ;------------------------------------------------------------------------------ 

R92.du1 { @ Rule 92.du1 : dummy HKMIM5 is not allowed on HKMIM5.
          @ Rule 92.du1 : dummy HKMIM5 distance to hkmim5 >= 2.
            HKMIM5_4 AND HKMIM5
            EXT HKMIM5_4 HKMIM5 < 2 ABUT<90 SINGULAR
         }

R92.du2a { @ Rule 92.du2a : dummy HKMIM5 is not allowed under masks patterns.
             HKMIM5_4 AND MASKPAT
         }

R92.du2b { @ Rule 92.du2b : dummy HKMIM5 distance to Corner L >= 3.
             EXT HKMIM5_4 MFGPPDG < 3 ABUT<90 SINGULAR REGION
         }

R92.du2c { @ Rule 92.du2c : dummy HKMIM5 distance to others masks patterns >= 3.
             EXT HKMIM5_4 MFGPPNG < 3 ABUT<90 SINGULAR REGION
         }

R92.du3 { @ Rule 92.du3 : dummy HKMIM5 is not allowed under pad.
          @ Rule 92.du3 : dummy HKMIM5 distance to pad >= ^SIZE_PAD.
            HKMIM5_4 AND PAD
            EXT HKMIM5_4 PAD < SIZE_PAD ABUT<90 SINGULAR
        }

R92.du4 { @ Rule 92.du4 : dummy metal5 is required under dummy HKMIM5.
            HKMIM5_4 NOT ME5_4
        }

R92.du5 { @ Rule 92.du5 : dummy HKMIM5 is not allowed on metal5.
            HKMIM5_4 AND ME5
        }

R92.du6 { @ Rule 92.du6 : dummy HKMIM5 is required over dummy metal5.
            (ME5_4 NOT INTERACT HKMIM5_4) NOT (BULK NOT INTERACT HKMIM5)
        }

//////////////////////////////////////////////////////////////////////////////
//              DENSITY  CHECKS                                              /
//////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////
//              ACTIVE AND POLY  DENSITY  CHECKS                             /
//////////////////////////////////////////////////////////////////////////////

XALLACT = AND BULK ((( ACTIVE OR ACTIVE_nsz) OR ACTIVE_fsz ) OR ACTIVE_4 )
XALLPOL = AND BULK ((( POLY OR POLY_nsz) OR POLY_fsz ) OR POLY_4 )

R2.du15 { @ Rule 2.du15 : Min ACTIVE density by 1x1mm window >= 0.2.
            DENSITY XALLACT < 0.2 WINDOW 1000 1000 STEP 500 PRINT "./densWIN1_ACT" BACKUP
        }

R2.du16 { @ Rule 2.du16 : Min ACTIVE density across full chip >= 0.25.
            DENSITY XALLACT < 0.25  PRINT "./densTOT_ACT"
        }

R13.12 { @ Rule 13.12 : Minimum POLY total density >= 0.15.
           DENSITY XALLPOL < 0.15 PRINT "./densTOT_POLY" 
       }

//////////////////////////////////////////////////////////////////////////////
//              METAL1  DENSITY  CHECKS                                      /
//////////////////////////////////////////////////////////////////////////////

XALLM1 = AND BULK ((( ME1 OR METAL1_nsz) OR METAL1_fsz ) OR ME1_4 )

R23.6 { @ Rule 23.6 : Minimum metal1 density by 0.5x0.5mm window >= 0.2.
          DENSITY XALLM1 < 0.2 WINDOW 500 500 STEP 250 PRINT "./min_densWIN_M1" BACKUP
      }

R23.7 { @ Rule 23.7 : Maximum metal1 density by 0.5x0.5mm window =< 0.55.
          DENSITY XALLM1 > 0.55 WINDOW 500 500 STEP 250 PRINT "./max_densWIN_M1" BACKUP
      }    

//////////////////////////////////////////////////////////////////////////////
//             METAL2  DENSITY  CHECKS                                       /
//////////////////////////////////////////////////////////////////////////////

XALLM2 = AND BULK ((( ME2 OR METAL2_nsz) OR METAL2_fsz ) OR ME2_4 )

R27.6 { @ Rule 27.6 : Minimum metal2 density by 0.5x0.5mm window >= 0.2.
          DENSITY XALLM2 < 0.2 WINDOW 500 500 STEP 250 PRINT "./min_densWIN_M2" BACKUP
      }

R27.7 { @ Rule 27.7 : Maximum metal2 density by 0.5x0.5mm window =< 0.55.
          DENSITY XALLM2 > 0.55 WINDOW 500 500 STEP 250 PRINT "./max_densWIN_M2" BACKUP
      }

//////////////////////////////////////////////////////////////////////////////
//             METAL3  DENSITY  CHECKS                                       /
//////////////////////////////////////////////////////////////////////////////

XALLM3 = AND BULK ((( ME3 OR METAL3_nsz) OR METAL3_fsz ) OR ME3_4 )

R34.6 { @ Rule 34.6 : Minimum metal3 density by 0.5x0.5mm window >= 0.2.
          DENSITY XALLM3 < 0.2 WINDOW 500 500 STEP 250 PRINT "./min_densWIN_M3" BACKUP
      }

R34.7 { @ Rule 34.7 : Maximum metal3 density by 0.5x0.5mm window =< 0.55.
          DENSITY XALLM3 > 0.55 WINDOW 500 500 STEP 250 PRINT "./max_densWIN_M3" BACKUP
      }

//////////////////////////////////////////////////////////////////////////////
//             METAL4  DENSITY  CHECKS                                       /
//////////////////////////////////////////////////////////////////////////////

XALLM4 = AND BULK ((( ME4 OR METAL4_nsz) OR METAL4_fsz ) OR ME4_4 )

R36.6 { @ Rule 36.6 : Minimum metal4 density by 0.5x0.5mm window >= 0.2.
          DENSITY XALLM4 < 0.2 WINDOW 500 500 STEP 250 PRINT "./min_densWIN_M4" BACKUP
      }

R36.7 { @ Rule 36.7 : Maximum metal4 density by 0.5x0.5mm window =< 0.85.
          DENSITY XALLM4 > 0.85 WINDOW 500 500 STEP 250 PRINT "./max_densWIN_M4" BACKUP
      }

//////////////////////////////////////////////////////////////////////////////
//             METAL5  DENSITY  CHECKS                                       /
//////////////////////////////////////////////////////////////////////////////

XALLM5 = AND BULK ((( ME5 OR METAL5_nsz) OR METAL5_fsz ) OR ME5_4 )

R53.6 { @ Rule 53.6 : Minimum metal5 density by 0.5x0.5mm window >= 0.33.
          DENSITY XALLM5 < 0.33 WINDOW 500 500 STEP 250 PRINT "./min_densWIN_M5" BACKUP
      }

R53.7 { @ Rule 53.7 : Maximum metal5 density by 0.5x0.5mm window =< 0.85.
          DENSITY XALLM5 > 0.85 WINDOW 500 500 STEP 250 PRINT "./max_densWIN_M5" BACKUP
      }

//////////////////////////////////////////////////////////////////////////////
//             MIM5  DENSITY  CHECKS                                         /
//////////////////////////////////////////////////////////////////////////////

XALLMIM5 = AND BULK (((MIM5 OR MIM5_4) OR MIM5_nsz) OR MIM5_fsz)
XMIM5 = BULK AND MIM5
GC_MIM5 = EXTENTS XMIM5 CENTERS 0.020
WINDOWMIM5 = SIZE GC_MIM5 BY 499.99 INSIDE OF BULK

RMT80.8 { @ Rule MT80.8 : Minimum MIM5 density by 1x1mm window around MIM5 >= 0.05.
            DENSITY XALLMIM5 < 0.05 WINDOW 1000 1000 STEP 100 INSIDE OF LAYER WINDOWMIM5 PRINT "./min_densWIN_MIM5"
        }

RMT80.9 { @ Rule MT80.9 : Maximum MIM5 density by 1x1mm window around MIM5 =< 0.85.
            DENSITY XALLMIM5 > 0.85 WINDOW 1000 1000 STEP 100 INSIDE OF LAYER WINDOWMIM5 PRINT "./max_densWIN_MIM5"
        }

//////////////////////////////////////////////////////////////////////////////
//             HKMIM5  DENSITY  CHECKS                                         /
//////////////////////////////////////////////////////////////////////////////

XALLHKMIM5 = AND BULK (((HKMIM5 OR HKMIM5_4) or HKMIM5_nsz) OR HKMIM5_fsz)
XHKMIM5 = BULK AND HKMIM5
GC_HKMIM5 = EXTENTS XHKMIM5 CENTERS 0.020
WINDOWHKMIM5 = SIZE GC_HKMIM5 BY 499.99 INSIDE OF BULK

RM92.8 { @ Rule M92.8 : Minimum HKMIM5 density by 1x1mm window around HKMIM5 >= 0.05.
             DENSITY XALLHKMIM5 < 0.05 WINDOW 1000 1000 STEP 100 INSIDE OF LAYER WINDOWHKMIM5 PRINT "./min_densWIN_HKMIM5"  
         }

RM92.9{ @ Rule M92.9 : Maximum HKMIM5 density by 1x1mm window around HKMIM5 =< 0.85.
           DENSITY XALLHKMIM5 > 0.85 WINDOW 1000 1000 STEP 100 INSIDE OF LAYER WINDOWHKMIM5 PRINT "./max_densWIN_HKMIM5"  
        }

//////////////////////////////////////////////////////////////////////////////
//             METAL6  DENSITY  CHECKS                                       /
//////////////////////////////////////////////////////////////////////////////

XALLM6 = AND BULK ((( ME6 OR METAL6_nsz) OR METAL6_fsz ) OR ME6_4 )

R55.5 { @ Rule 55.5 : Minimum metal6 density across full chip >= 0.33.
          DENSITY XALLM6 < 0.33 PRINT "./densTOT_M6"
      }

//------------------------------------------------------------------------------
//      CHECKS  ON  FUSES - DEVICES PURPOSES
//------------------------------------------------------------------------------

FUSEMET4 = ME4_0 INTERACT MRM4 
FUSEMET3 = ME3_0 INTERACT FUSEMET4
FUSEOPEN = NITRIDE_28 INTERACT FUSEMET4
FUSEM3IN = FUSEMET3 AND FUSEOPEN
FUSEM4IN = FUSEMET4 AND FUSEOPEN
FUSEME4 = TOUCH INSIDE EDGE FUSEM4IN MRM4
TMPFUSE = INT FUSEME4 < 1.1 REGION

FUSHEAD = FUSEM4IN NOT TMPFUSE
MET3FUSE = FUSEMET3 INTERACT FUSHEAD

SZFUSE = SIZE NITRIDE_28 by 2.5
ACTIVE_RING = SALI INTERACT SZFUSE
MET1RING = NET AREA RATIO M1C:2 ACTIVE_RING > 0
MET2RING = NET AREA RATIO M2C:2 ACTIVE_RING > 0

ME1NOTFUSE = ME1 NOT MET1RING
ME2NOTFUSE = ME2 NOT MET2RING

ME4NOTFUSE = ME4 NOT FUSEM4IN
ME3NOTFUSE = ME3 NOT FUSEMET3

RNG1.fuse { @ Rule NG1.fuse : NITRIDE opening for laser fuse enclosure by ACTIVE of guard (fuse end) >= 1.5.
              OPENNG1 = TOUCH INSIDE EDGE FUSEOPEN FUSEM3IN 
              EXT OPENNG1 ACTIVE < 1.5 ABUT<90 REGION
          }

RNG2.fuse { @ Rule NG2.fuse : NITRIDE opening for laser fuse enclosure by ACTIVE of guard (fuse side) >= 2.0.
              OPENNG2 = NOT TOUCH INSIDE EDGE FUSEOPEN FUSEM3IN
              EXT OPENNG2 ACTIVE < 2.0 ABUT<90 REGION
          }

RNM1.fuse.a { @ Rule NM1.fuse : NITRIDE opening for laser fuse distance to ME4, ME3 (except fuse or fuse interconnect bridge). 
                EXT FUSEOPEN ME4NOTFUSE < 5.0 REGION INSIDE ALSO
                EXT FUSEOPEN ME3NOTFUSE < 5.0 REGION INSIDE ALSO
            }

RNM1.fuse.b { @ Rule NM1.fuse : NITRIDE opening for laser fuse distance to ME5 (except fuse or fuse interconnect bridge). 
                EXT FUSEOPEN ME5 < 5.0 REGION INSIDE ALSO
        }

RNM1.fuse.c { @ Rule NM1.fuse : NITRIDE opening for laser fuse distance to ME6 (except fuse or fuse interconnect bridge).
                EXT FUSEOPEN ME6 < 5.0 REGION INSIDE ALSO
        }

RNM2.fuse { @ Rule NM2.fuse : NITRIDE opening for laser fuse distance to ME2, ME1 (except plug on active of guard biasing).
              EXT FUSEOPEN ME2NOTFUSE < 2.5 REGION INSIDE ALSO
              EXT FUSEOPEN ME1NOTFUSE < 2.5 REGION INSIDE ALSO
          }

RNM3.fuse { @ Rule NM3.fuse : NITRIDE opening for laser fuse distance to ME2, ME1 ( only ME1, ME2 connected on guard ring).
              EXT FUSEOPEN MET1RING < 1.5 REGION INSIDE ALSO
              EXT FUSEOPEN MET2RING < 1.5 REGION INSIDE ALSO
          }

RNF2.fuse { @ Rule NF2.fuse : NITRIDE opening for laser fuse enclosure of last fuse (fuse side) >= 5.0.
              ENC TMPFUSE FUSEOPEN < 5.0 ABUT<90 PROJECTING > 7
          }

RNF1.fuse { @ Rule NF1.fuse : NITRIDE opening for laser fuse enclosure of fuse end (end of W wide metal) >= 2.5.
              INT FUSEOPEN MET3FUSE < 2.5 ABUT<90 REGION
          }

RNF3.fuse { @ Rule NF3.fuse : NITRIDE opening for laser fuse enclosure of fuse metal (fuse metal including vias covering) >= 1.0.
              ENC FUSHEAD FUSEOPEN  < 1.0 ABUT<90 PROJECTING <= 7
          }

RW.fuse { @ Rule W.fuse : Fuse width (metal side) min = max = 1.0.
            INT FUSEME4 < 1.0 REGION
            WITH EDGE FUSHEAD FUSEME4
        }

RL.fuse { @ Rule L.fuse : Fuse length (metal heads) >= 8.0.
            X = FUSEME4 LENGTH < 8.0
            Y = WITH EDGE FUSEM4IN X
        Y NOT FUSHEAD
        }

RS.fuse { @ Rule S.fuse : Fuse space (metal side) >= 4.0.
            EXT FUSEME4 < 4.0 REGION
        }

////do not delete. Used for modularity !!!
//------------------------------------------------------------------------------
//    Definition of all layer for laser alignment target
//------------------------------------------------------------------------------

ALL_LAYER:1 = COPY ACTIVE_4
ALL_LAYER:2 = ACTIVE OR ACTIVE_4
ALL_LAYER:3 = ALL_LAYER:2 OR NPLUS
ALL_LAYER:4 = ALL_LAYER:3 OR VI4
ALL_LAYER:5 = (ALL_LAYER:4 OR ME5) OR ME5_4
ALL_LAYER:6 = ALL_LAYER:5 OR VI5
ALL_LAYER:7 = (ALL_LAYER:6 OR ME6) OR ME6_4
ALL_LAYER:8 = ALL_LAYER:7 OR MFGPP_0
ALL_LAYER:9 = ALL_LAYER:8 OR MFGPP_nsz
ALL_LAYER:10 = ALL_LAYER:9 OR ADHVTN
ALL_LAYER:11 = ALL_LAYER:10 OR ADHVTP
ALL_LAYER:12 = ALL_LAYER:11 OR NEXT
ALL_LAYER:13 = ALL_LAYER:12 OR PEXT
ALL_LAYER:14 = ALL_LAYER:13 OR NWELL
ALL_LAYER:15 = ALL_LAYER:14 OR RNWELL_0
ALL_LAYER:16 = ALL_LAYER:15 OR NISO
ALL_LAYER:17 = ALL_LAYER:16 OR GO2
ALL_LAYER:18 = (ALL_LAYER:17 OR POLY) OR POLY_4
ALL_LAYER:19 = ALL_LAYER:18 OR NLDD
ALL_LAYER:20 = ALL_LAYER:19 OR PLDD
ALL_LAYER:21 = ALL_LAYER:20 OR PPLUS
ALL_LAYER:22 = ALL_LAYER:21 OR SIPROT
ALL_LAYER:23 = ALL_LAYER:22 OR LIL
ALL_LAYER:24 = ALL_LAYER:23 OR CONTACT
ALL_LAYER:25 = (ALL_LAYER:24 OR ME1) OR ME1_4
ALL_LAYER:26 = ALL_LAYER:25 OR VI1
ALL_LAYER:27 = (ALL_LAYER:26 OR ME2) OR ME2_4
ALL_LAYER:28 = ALL_LAYER:27 OR VI2
ALL_LAYER:29 = (ALL_LAYER:28 OR ME3) OR ME3_4
ALL_LAYER:30 = ALL_LAYER:29 OR VI3
ALL_LAYER:31 = (ALL_LAYER:30 OR ME4) OR ME4_4

//------------------------------------------------------------------------------
//      CHECKS  ON  FUSES - ALIGNMENT TARGET PURPOSES
//------------------------------------------------------------------------------

TARGET_SIDE_1 = INT [ME4_28] < 11 OPPOSITE PARALLEL
TARGET_SIDE = LENGTH TARGET_SIDE_1 > 10
TMPSZ = EXPAND EDGE TARGET_SIDE OUTSIDE BY 0.02
TMPSZSHFT_1 = SHIFT TMPSZ BY 0.01 0
TMPSZSHFT_2 = SHIFT TMPSZ BY (-0.01) 0
TMPSZSHFT_3 = SHIFT TMPSZ BY 0 0.01
TMPSZSHFT_4 = SHIFT TMPSZ BY 0 (-0.01)
HORIZON_TARG = TARGET_SIDE INSIDE EDGE (TMPSZSHFT_1 OR TMPSZSHFT_2) 
VERTICAL_TARG = TARGET_SIDE INSIDE EDGE (TMPSZSHFT_3 OR TMPSZSHFT_4) 

TARGET_SIDE_HOR = EXPAND EDGE HORIZON_TARG OUTSIDE BY 25
TARGET_SIDE_VER = EXPAND EDGE VERTICAL_TARG OUTSIDE BY 25

TARGET_SIDE:1 = TARGET_SIDE_HOR OR TARGET_SIDE_VER
SZTARGET = SIZE ME4_28 BY 5
TARGET_EXC = SZTARGET OR TARGET_SIDE:1

TARGET_EDGE_1 = ME4_28 INSIDE EDGE BULK
END_EDGE:1 = TARGET_EDGE_1 NOT COINCIDENT EDGE TARGET_SIDE

RE1.target { @ Rule E1.target : Alignment Target side dist to any level (Y) > 25.
           TARGET_SIDE_VER CUT ALL_LAYER:31
           TARGET_SIDE_VER INSIDE ALL_LAYER:31
           }

RE2.target { @ Rule E2.target : Alignment Target side dist to any level (X) > 25.
           TARGET_SIDE_HOR CUT ALL_LAYER:31
           TARGET_SIDE_HOR INSIDE ALL_LAYER:31
           }

RE3.target { @ Rule E3.target : Alignment Target end dist to any level > 3.
           EXT END_EDGE:1 ALL_LAYER:31 < 3
           }

RWmin.target { @ Rule Wmin.target : Alignment Target min Width >= 6.
             INT ME4_28 < 6 OPPOSITE PARALLEL REGION
             }

RWmax.target { @ Rule Wmax.target : Alignment Target max Width >= 10.
             SIZE ME4_28 BY 5 UNDEROVER
             }

RL.target { @ Rule L.target : Alignment Target min Length >= 27.
          LENGTH TARGET_SIDE < 27
          }

//------------------------------------------------------------------------------
//      CHECKS  ON  NITRIDE  FOR  EBEAM  PADS
//------------------------------------------------------------------------------
#IFDEF PROTO_EBEAM
R31.eb24 { @ Rule 31.eb24 : NITRIDE opening for micropad width >= 2.0.
             INT NITRIDE_33 < 2.0 ABUT>0<90 SINGULAR
         }

R31.ebI1_R31.ebI3 { @ Rule 31.ebI1 : NITRIDE opening for micropad enclosure by ME6 >= 1.0.
                    @ Rule 31.ebI3 : NITRIDE opening for micropad should be on ME6.
                      ENC NITRIDE_33 ME6 < 1.0 ABUT<90 SINGULAR OUTSIDE ALSO
                  }

R31.ebI4 { @ Rule 31.ebI4 : NITRIDE opening for micropad must not be on PAD.
             AND NITRIDE_33 NITRIDE_0
         }

R31.ebI5 { @ Rule 31.ebI5 : NITRIDE opening for micropad dist to PAD >= 50.
             EXT NITRIDE_33 NITRIDE_0 < 50 ABUT<90 SINGULAR
         }
#ELSE
R31.ebI6 { @ Rule 31.ebI6 : NITRID opening for micropad not allowed if the design isn't a prototype
           @ (the switch prototype for ebeam must then be set to yes).
             OR NITRIDE_33
         }
#ENDIF

// //////////////////////////////////////////////////////////////////////////////
// /              NOMASK  LAYERS  SPECIFIC  DESIGN  RULES                       /
// //////////////////////////////////////////////////////////////////////////////

R13.imp1{ @ Rule 13.imp1 : POLY purpose PIN without DRAWING.
            PPOLY NOT POLY
    }

R23.imp1{ @ Rule 23.imp1 : METAL1 purpose PIN without DRAWING.
            PMET1 NOT ME1
    }

SHM1GND = SIZE ME1N BY 0.1
M1PWRSZ = SIZE M1PW BY 0.1
M1SA = M1SG NOT MSHORT
X_M1 = M1SG COINCIDENT OUTSIDE EDGE M1PW
SHM1PWR = INT X_M1 M1PWRSZ <= 0.1 REGION OPPOSITE ABUT>0<90 MEASURE COINCIDENT

R23.imp2{ @ Rule 23.imp2 : ME1 positivePS short to ME1 negativePS (touching included).
            ME1P AND (ME1N OR SHM1GND)
    }

R23.imp3{ @ Rule 23.imp3 : ME1 signal short to ME1 power (touching included).
            M1SA AND (M1PW OR SHM1PWR)
    }

R25.imp3{ @ Rule 25.imp3 : ME1 INT connected to ME2 POWER.
            (NBPDV1 AND M2PW) AND M1SA
    }

R25.imp4{ @ Rule 25.imp4 : ME1 GND to ME2 VDD short.
            (NBPDV1 AND ME1N) AND ME2P
    }

R25.imp5{ @ Rule 25.imp5 : ME1 VDD to ME2 GND short.
            (NBPDV1 AND ME1P) AND ME2N
    }

R27.imp1{ @ Rule 27.imp1 : ME2 PURPOSE PIN WITHOUT DRAWING.
            PMET2 NOT ME2
    }

SHM2GND = SIZE ME2N BY 0.1
M2PWRSZ = SIZE M2PW BY 0.1
M2SA = M2SG NOT MSHORT
X_M2 = M2SG COINCIDENT OUTSIDE EDGE M2PW
SHM2PWR = INT X_M2 M2PWRSZ <= 0.1 REGION OPPOSITE ABUT>0<90 MEASURE COINCIDENT

R27.imp2{ @ Rule 27.imp2 : ME2 positivePS short to ME2 negativePS (touching included).
            ME2P AND (ME2N OR SHM2GND)
    }

R27.imp3{ @ Rule 27.imp3 : ME2 signal short to ME2 power (touching included).
            M2SA AND (M2PW OR SHM2PWR)
    }

R32.imp3{ @ Rule 32.imp3 : ME2 INT connected to ME3 POWER.
            (NBPDV2 AND M3PW) AND M2SA
    }

R32.imp4{ @ Rule 32.imp4 : ME2 GND to ME3 VDD short.
            (NBPDV2 AND ME2N) AND ME3P
    }

R32.imp5{ @ Rule 32.imp5 : ME2 VDD to ME3 GND short.
            (NBPDV2 AND ME2P) AND ME3N
    }

R34.imp1{ @ Rule 34.imp1 : METAL3 PURPOSE PIN WITHOUT DRAWING.
            PMET3 NOT ME3
    }

SHM3GND = SIZE ME3N BY 0.1
M3PWRSZ = SIZE M3PW BY 0.1
M3SA = M3SG NOT MSHORT
X_M3 = M3SG COINCIDENT OUTSIDE EDGE M3PW
SHM3PWR = INT X_M3 M3PWRSZ <= 0.1 REGION OPPOSITE ABUT>0<90 MEASURE COINCIDENT

R34.imp2{ @ Rule 34.imp2 : ME3 positivePS short to ME3 negativePS (touching included).
            ME3P AND (ME3N OR SHM3GND)
    }

R34.imp3{ @ Rule 34.imp3 : ME3 signal short to ME3 power (touching included).
            M3SA AND (M3PW OR SHM3PWR)
    }

R35.imp3{ @ Rule 35.imp3 : ME3 INT connected to ME4 POWER.
            (NBPDV3 AND M4PW) AND M3SA
    }

R35.imp4{ @ Rule 35.imp4 : ME3 GND to ME4 VDD short.
            (NBPDV3 AND ME3N) AND ME4P
    }

R35.imp5{ @ Rule 35.imp5 : ME3 VDD to ME4 GND short.
            (NBPDV3 AND ME3P) AND ME4N
    }

R36.imp1{ @ Rule 36.imp1 : ME4 PURPOSE PIN WITHOUT DRAWING.
            PMET4 NOT ME4
    }

SHM4GND = SIZE ME4N BY 0.1
M4PWRSZ = SIZE M4PW BY 0.1
M4SA = M4SG NOT MSHORT
X_M4 = M4SG COINCIDENT OUTSIDE EDGE M4PW
SHM4PWR = INT X_M4 M4PWRSZ <= 0.1 REGION OPPOSITE ABUT>0<90 MEASURE COINCIDENT

R36.imp2{ @ Rule 36.imp2 : Metal4 positivePS short to metal4 negativePS (touching included).
            ME4P AND (ME4N OR SHM4GND)
    }

R36.imp3{ @ Rule 36.imp3 : ME4 signal short to ME4 power (touching included).
            M4SA AND (M4PW OR SHM4PWR)
    }

R52.imp3{ @ Rule 52.imp3 : ME4 INT connected to ME5 POWER.
            (NBPDV4 AND M5PW) AND M4SA
    }

R52.imp4{ @ Rule 52.imp4 : ME4 GND to ME5 VDD short.
            (NBPDV4 AND ME4N) AND ME5P
    }

R52.imp5{ @ Rule 52.imp5 : ME4 VDD to ME5 GND short.
            (NBPDV4 AND ME4P) AND ME5N
    }

R53.imp1{ @ Rule 53.imp1 : ME5 PURPOSE PIN WITHOUT DRAWING.
            PMET5 NOT ME5
    }

SHM5GND = SIZE ME5N BY 0.1
M5PWRSZ = SIZE M5PW BY 0.1
M5SA = M5SG NOT MSHORT
X_M5 = M5SG COINCIDENT OUTSIDE EDGE M5PW
SHM5PWR = INT X_M5 M5PWRSZ <= 0.1 REGION OPPOSITE ABUT>0<90 MEASURE COINCIDENT

R53.imp2{ @ Rule 53.imp2 : ME5 positivePS short to ME5 negativePS (touching included).
            ME5P AND (ME5N OR SHM5GND)
    }

R53.imp3{ @ Rule 53.imp3 : ME5 signal short to ME5 power (touching included).
            M5SA AND (M5PW OR SHM5PWR)
    }

R54.imp3{ @ Rule 54.imp3 : ME5 INT connected to ME6 POWER.
            (NBPDV5 AND M6PW) AND M5SA
    }

R54.imp4{ @ Rule 54.imp4 : ME5 GND to ME6 VDD short.
            (NBPDV5 AND ME5N) AND ME6P
    }

R54.imp5{ @ Rule 54.imp5 : ME5 VDD to ME6 GND short.
            (NBPDV5 AND ME5P) AND ME6N
    }

R55.imp1{ @ Rule 55.imp1 : ME6 PURPOSE PIN WITHOUT DRAWING.
            PMET6 NOT ME6
    }

SHM6GND = SIZE ME6N BY 0.1
M6PWRSZ = SIZE M6PW BY 0.1
M6SA = M6SG NOT MSHORT
X_M6 = M6SG COINCIDENT OUTSIDE EDGE M6PW
SHM6PWR = INT X_M6 M6PWRSZ <= 0.1 REGION OPPOSITE ABUT>0<90 MEASURE COINCIDENT

R55.imp2{ @ Rule 55.imp2 : Metal6 positivePS short to metal6 negativePS (touching included).
            ME6P AND (ME6N OR SHM6GND)
    }

R55.imp3{ @ Rule 55.imp3 : ME6 signal short to ME6 power (touching included).
            M6SA AND (M6PW OR SHM6PWR)
    }

R66.imp2{ @ Rule 66.imp2 : PRL PURPOSE PIN WITHOUT DRAWING.
            PPRL NOT PRL
    }

FLAG SKEW YES
FLAG OFFGRID NO // Avoid to flag offgrid on un-merged polygons
FLAG NONSIMPLE YES
FLAG ACUTE NO

// //////////////////////////////////////////////////////////////////////////////
// /              OFF-GRID  CHECKS                                              /
// //////////////////////////////////////////////////////////////////////////////

OFFGRID_ADHVTN { @ Offgrid vertex on ADHVTN.
                   OFFGRID ADHVTN_0 20
                   OFFGRID ADHVTN_30 20
               }

OFFGRID_ADHVTP { @ Offgrid vertex on ADHVTP.
                   OFFGRID ADHVTP_0 20
                   OFFGRID ADHVTP_30 20
               }

OFFGRID_RNWELL { @ Offgrid vertex on RNWELL.
                   OFFGRID RNWELL_0 20
               }

OFFGRID_NWELL { @ Offgrid vertex on NWELL.
                  OFFGRID NWELL_0 20
                  OFFGRID NWELL_30 20
              }

OFFGRID_NWELL2 { @ Offgrid vertex on NWELL2.
                   OFFGRID NWELL2_0 20
                   OFFGRID NWELL2_30 20
               }

OFFGRID_PWELL2 { @ Offgrid vertex on PWELL2.
                   OFFGRID PWELL2_0 20
                   OFFGRID PWELL2_30 20
               }

OFFGRID_OTP { @ Offgrid vertex on OTP.
                OFFGRID OTP_0 20
                OFFGRID OTP_30 20
            }

OFFGRID_ACTIVE { @ Offgrid vertex on ACTIVE.
                   OFFGRID ACTIVE_0 20
                   OFFGRID ACTIVE_30 20
               }

OFFGRID_ACTIVE_4 { @ Offgrid vertex on DUMMY ACTIVE.
                     OFFGRID ACTIVE_4 20
                 }

OFFGRID_POLY { @ Offgrid vertex on POLY.
                 OFFGRID POLY_0 20
                 OFFGRID POLY_30 20
             }

OFFGRID_NPLUS { @ Offgrid vertex on NPLUS.
                  OFFGRID NPLUS_0 20
                  OFFGRID NPLUS_30 20
              }

OFFGRID_NLDD { @ Offgrid vertex on NLDD.
                 OFFGRID NLDD_0 20
                 OFFGRID NLDD_30 20
             }

OFFGRID_PLDD { @ Offgrid vertex on PLDD.
                 OFFGRID PLDD_0  20
                 OFFGRID PLDD_30 20
             }

OFFGRID_PPLUS { @ Offgrid vertex on PPLUS.
                  OFFGRID PPLUS_0 20
                  OFFGRID PPLUS_30 20
              }

OFFGRID_SIPROT { @ Offgrid vertex on SIPROT.
                   OFFGRID SIPROT_0 20
                   OFFGRID SIPROT_30 20
               }

OFFGRID_NITRIDE { @ Offgrid vertex on NITRIDE.
                    OFFGRID NITRIDE_0 20
                }

OFFGRID_NITRIDE_bg { @ Offgrid vertex on NITRIDE_bg.
                       OFFGRID NITRIDE_bumping 20
                   }

OFFGRID_LIL { @ Offgrid vertex on LIL.
                OFFGRID LIL_0 20
                OFFGRID LIL_30 20
            }

OFFGRID_CONTACT { @ Offgrid vertex on CONTACT.
                    OFFGRID CONTACT_0 20
                    OFFGRID CONTACT_30 20
                }

OFFGRID_ME1 { @ Offgrid vertex on ME1.
                OFFGRID ME1_0 20
                OFFGRID ME1_30 20
            }

OFFGRID_VI1 { @ Offgrid vertex on VI1.
                OFFGRID VI1_0 20
                OFFGRID VI1_30 20
            }

OFFGRID_ME2 { @ Offgrid vertex on ME2.
                OFFGRID ME2_0 20
                OFFGRID ME2_30 20
            }

OFFGRID_VI2 { @ Offgrid vertex on VI2.
                OFFGRID VI2_0 20
                OFFGRID VI2_30 20
            }

OFFGRID_ME3 { @ Offgrid vertex on ME3.
                OFFGRID ME3_0 20
                OFFGRID ME3_30 20
            }

OFFGRID_VI3 { @ Offgrid vertex on VI3.
                OFFGRID VI3_0 20
                OFFGRID VI3_30 20
            }

OFFGRID_ME4 { @ Offgrid vertex on ME4.
                OFFGRID ME4_0 20
                OFFGRID ME4_30 20
            }

OFFGRID_VI4 { @ Offgrid vertex on VI4.
                OFFGRID VI4_0 20
                OFFGRID VI4_30 20
            }

OFFGRID_ME5 { @ Offgrid vertex on ME5.
                OFFGRID ME5_0 20
                OFFGRID ME5_30 20
            }

OFFGRID_VI5 { @ Offgrid vertex on VI5.
                OFFGRID VI5_0 20
                OFFGRID VI5_30 20
            }

OFFGRID_ME6 { @ Offgrid vertex on ME6.
                OFFGRID ME6_0 20
                OFFGRID ME6_30 20
            }

OFFGRID_VFB { @ Offgrid vertex on VFB.
                OFFGRID VFB_0 20
                OFFGRID VFB_30 20
            }

OFFGRID_PRL { @ Offgrid vertex on PRL.
                OFFGRID PRL_0 20
                OFFGRID PRL_30 20
            }

OFFGRID_NATIVE { @ Offgrid vertex on NATIVE.
                   OFFGRID NATIVE_0 20
               }

OFFGRID_NEXT { @ Offgrid vertex on NEXT.
                 OFFGRID NEXT_0 20
             }

OFFGRID_NEXT_5V { @ Offgrid vertex on NEXT_5V.
                    OFFGRID NEXT_5V_0 20
                }

OFFGRID_PEXT { @ Offgrid vertex on PEXT.
                 OFFGRID PEXT_0 20
             }

OFFGRID_PEXT_5V { @ Offgrid vertex on PEXT_5V.
                    OFFGRID PEXT_5V_0 20
                }

OFFGRID_GO2 { @ Offgrid vertex on GO2.
                OFFGRID GO2_0 20
            }

OFFGRID_GO2_5V { @ Offgrid vertex on GO2_5V.
                   OFFGRID GO2_5V_0 20
               }

OFFGRID_MIM5 { @ Offgrid vertex on MIM5.
                 OFFGRID MIM5_0 20
             }
 
OFFGRID_HKMIM5 { @ Offgrid vertex on HKMIM5.
                   OFFGRID HKMIM5_0 20
               }

OFFGRID_PRESIST { @ Offgrid vertex on PRESIST.
                    OFFGRID PRESIST 20
                }

OFFGRID_CTELEC2 { @ Offgrid vertex on CTELEC2.
                    OFFGRID CTELEC2 20
                }

OFFGRID_CELLVT { @ Offgrid vertex on CELLVT.
                   OFFGRID CELLVT 20
               }

OFFGRID_CELLIMP { @ Offgrid vertex on CELLIMP.
                    OFFGRID CELLIMP 20
                }

OFFGRID_NEPI { @ Offgrid vertex on EPI.
                 OFFGRID NEPI_0 20
             }

OFFGRID_NISO { @ Offgrid vertex on NISO.
                 OFFGRID NISO_0 20
             }

// //////////////////////////////////////////////////////////////////////////////
// /              NON  45  DEGREE  CHECKS                                       /
// //////////////////////////////////////////////////////////////////////////////

NON_45_DEG_ADHVTN { @ Non 45 degree angle ADHVTN.
                      ANGLE ADHVTN_0 >0 <45
                      ANGLE ADHVTN_0 >45 <90
                      ANGLE ADHVTN_30 >0 <45
                      ANGLE ADHVTN_30 >45 <90
                  }

NON_45_DEG_ADHVTP { @ Non 45 degree angle ADHVTP.
                      ANGLE ADHVTP_0  >0 <45
                      ANGLE ADHVTP_0  >45 <90
                      ANGLE ADHVTP_30 >0 <45
                      ANGLE ADHVTP_30 >45 <90
                  }

NON_45_DEG_RNWELL { @ Non 45 degree angle RNWELL.
                      ANGLE RNWELL_0 >0 <45
                      ANGLE RNWELL_0 >45 <90
                  }

NON_45_DEG_NWELL { @ Non 45 degree angle NWELL.
                     ANGLE NWELL_0 >0 <45
                     ANGLE NWELL_0 >45 <90
                     ANGLE NWELL_30 >0 <45
                     ANGLE NWELL_30 >45 <90
                 }

NON_45_DEG_NWELL2 { @ Non 45 degree angle NWELL2.
                      ANGLE NWELL2_0 >0 <45
                      ANGLE NWELL2_0 >45 <90
                      ANGLE NWELL2_30 >0 <45
                      ANGLE NWELL2_30 >45 <90
                  }

NON_45_DEG_PWELL2 { @ Non 45 degree angle PWELL2.
                      ANGLE PWELL2_0 >0 <45
                      ANGLE PWELL2_0 >45 <90
                      ANGLE PWELL2_30 >0 <45
                      ANGLE PWELL2_30 >45 <90
                  }

NON_45_DEG_OTP { @ Non 45 degree angle OTP.
                   ANGLE OTP_0 >0 <45
                   ANGLE OTP_0 >45 <90
                   ANGLE OTP_30 >0 <45
                   ANGLE OTP_30 >45 <90
               }

NON_45_DEG_ACTIVE { @ Non 45 degree angle ACTIVE.
                      ANGLE ACTIVE_0 >0 <45
                      ANGLE ACTIVE_0 >45 <90
                      ANGLE ACTIVE_30 >0 <45
                      ANGLE ACTIVE_30 >45 <90
                  }

NON_45_DEG_POLY { @ Non 45 degree angle POLY.
                    ANGLE POLY_0 >0 <45
                    ANGLE POLY_0 >45 <90
                    ANGLE POLY_30 >0 <45
                    ANGLE POLY_30 >45 <90
                }

NON_45_DEG_NPLUS { @ Non 45 degree angle NPLUS.
                     ANGLE NPLUS_0 >0 <45
                     ANGLE NPLUS_0 >45 <90
                     ANGLE NPLUS_30 >0 <45
                     ANGLE NPLUS_30 >45 <90
                 }

NON_45_DEG_NLDD { @ Non 45 degree angle NLDD.
                    ANGLE NLDD_0 >0 <45
                    ANGLE NLDD_0 >45 <90
                    ANGLE NLDD_30 >0 <45
                    ANGLE NLDD_30 >45 <90
                }

NON_45_DEG_PLDD { @ Non 45 degree angle PLDD.
                    ANGLE PLDD_0 >0 <45
                    ANGLE PLDD_0 >45 <90
                    ANGLE PLDD_30 >0 <45
                    ANGLE PLDD_30 >45 <90
                }

NON_45_DEG_PPLUS { @ Non 45 degree angle PPLUS.
                     ANGLE PPLUS_0 >0 <45
                     ANGLE PPLUS_0 >45 <90
                     ANGLE PPLUS_30 >0 <45
                     ANGLE PPLUS_30 >45 <90
                 }

NON_45_DEG_SIPROT { @ Non 45 degree angle SIPROT.
                      ANGLE SIPROT_0 >0 <45
                      ANGLE SIPROT_0 >45 <90
                      ANGLE SIPROT_30 >0 <45
                      ANGLE SIPROT_30 >45 <90
                  }

NON_45_DEG_NITRIDE { @ Non 45 degree angle NITRIDE.
                       ANGLE NITRIDE >0 <45
                       ANGLE NITRIDE >45 <90
                   }

NON_90_DEG_LIL { @ Non 90 degree angle LIL.
                   ANGLE LIL_0 >0 <45
               ANGLE LIL_0 >45 <90
                   ANGLE LIL_30 >0 <45
               ANGLE LIL_30 >45 <90
               }

NON_45_DEG_CONTACT { @ Non 45 degree angle CONTACT.
                       ANGLE CONTACT_0 >0 <45
                       ANGLE CONTACT_0 >45 <90
                       ANGLE CONTACT_30 >0 <45
                       ANGLE CONTACT_30 >45 <90
                   }

NON_45_DEG_ME1 { @ Non 45 degree angle ME1.
                   ANGLE ME1_0 >0 <45
                   ANGLE ME1_0 >45 <90
                   ANGLE ME1_30 >0 <45
                   ANGLE ME1_30 >45 <90
               }

NON_45_DEG_VI1 { @ Non 45 degree angle VI1.
                   ANGLE VI1_0 >0 <45
                   ANGLE VI1_0 >45 <90
                   ANGLE VI1_30 >0 <45
                   ANGLE VI1_30 >45 <90
               }

NON_45_DEG_ME2 { @ Non 45 degree angle ME2.
                   ANGLE ME2_0 >0 <45
                   ANGLE ME2_0 >45 <90
                   ANGLE ME2_30 >0 <45
                   ANGLE ME2_30 >45 <90
               }

NON_45_DEG_VI2 { @ Non 45 degree angle VI2.
                   ANGLE VI2_0 >0 <45
                   ANGLE VI2_0 >45 <90
                   ANGLE VI2_30 >0 <45
                   ANGLE VI2_30 >45 <90
               }

NON_45_DEG_ME3 { @ Non 45 degree angle ME3.
                   ANGLE ME3_0 >0 <45
                   ANGLE ME3_0 >45 <90
                   ANGLE ME3_30 >0 <45
                   ANGLE ME3_30 >45 <90
               }

NON_45_DEG_VI3 { @ Non 45 degree angle VI3.
                   ANGLE VI3_0 >0 <45
                   ANGLE VI3_0 >45 <90
                   ANGLE VI3_30 >0 <45
                   ANGLE VI3_30 >45 <90
               }

NON_45_DEG_ME4 { @ Non 45 degree angle ME4.
                   ANGLE ME4_0 >0 <45
                   ANGLE ME4_0 >45 <90
                   ANGLE ME4_30 >0 <45
                   ANGLE ME4_30 >45 <90
               }

NON_45_DEG_VI4 { @ Non 45 degree angle VI4.
                   ANGLE VI4_0 >0 <45
                   ANGLE VI4_0 >45 <90
                   ANGLE VI4_30 >0 <45
                   ANGLE VI4_30 >45 <90
               }

NON_45_DEG_ME5 { @ Non 45 degree angle ME5.
                   ANGLE ME5_0 >0 <45
                   ANGLE ME5_0 >45 <90
                   ANGLE ME5_30 >0 <45
                   ANGLE ME5_30 >45 <90
               }

NON_45_DEG_VI5 { @ Non 45 degree angle VI5.
                   ANGLE VI5_0 >0 <45
                   ANGLE VI5_0 >45 <90
                   ANGLE VI5_30 >0 <45
                   ANGLE VI5_30 >45 <90
               }

NON_45_DEG_ME6 { @ Non 45 degree angle ME6.
                   ANGLE ME6_0 >0 <45
                   ANGLE ME6_0 >45 <90
                   ANGLE ME6_30 >0 <45
                   ANGLE ME6_30 >45 <90
               }

NON_45_DEG_VFB { @ Non 45 degree angle VFB.
                   ANGLE VFB_0 >0 <45
                   ANGLE VFB_0 >45 <90
                   ANGLE VFB_30 >0 <45
                   ANGLE VFB_30 >45 <90
               }

NON_45_DEG_PRL { @ Non 45 degree angle PRL.
                   ANGLE PRL_0 >0 <45
                   ANGLE PRL_0 >45 <90
                   ANGLE PRL_30 >0 <45
                   ANGLE PRL_30 >45 <90
               }

NON_45_DEG_NATIVE { @ Non 45 degree angle NATIVE.
                      ANGLE NATIVE_0 >0 <45
                      ANGLE NATIVE_0 >45 <90
                  }

NON_45_DEG_NEXT { @ Non 45 degree angle NEXT.
                    ANGLE NEXT_0 >0 <45
                    ANGLE NEXT_0 >45 <90
                }

NON_45_DEG_NEXT_5V { @ Non 45 degree angle NEXT_5V.
                    ANGLE NEXT_5V_0 >0 <45
                    ANGLE NEXT_5V_0 >45 <90
                }

NON_45_DEG_PEXT { @ Non 45 degree angle PEXT.
                    ANGLE PEXT_0 >0 <45
                    ANGLE PEXT_0 >45 <90
                }

NON_45_DEG_PEXT_5V { @ Non 45 degree angle PEXT_5V.
                    ANGLE PEXT_5V_0 >0 <45
                    ANGLE PEXT_5V_0 >45 <90
                }

NON_45_DEG_GO2 { @ Non 45 degree angle GO2.
                   ANGLE GO2_0 >0 <45
                   ANGLE GO2_0 >45 <90
               }

NON_45_DEG_GO2_5V { @ Non 45 degree angle GO2_5V.
                      ANGLE GO2_5V_0 >0 <45
                      ANGLE GO2_5V_0 >45 <90
                  }

NON_45_DEG_MIM5 { @ Non 45 degree angle MIM5.
                    ANGLE MIM5_0 >0 <45
                    ANGLE MIM5_0 >45 <90
                }
 
NON_45_DEG_HKMIM5 { @ Non 45 degree angle HKMIM5.
                      ANGLE HKMIM5_0 >0 <45
                      ANGLE HKMIM5_0 >45 <90
                  }

NON_45_DEG_PRESIST { @ Non 45 degree angle PRESIST.
                       ANGLE PRESIST >0 <45
                       ANGLE PRESIST >45 <90
                   }

NON_45_DEG_NEPI { @ Non 45 degree angle EPI.
                    ANGLE NEPI_0 >0 <45
                ANGLE NEPI_0 >45 <90
                }

NON_45_DEG_CTELEC2 { @ Non 45 degree angle CTELEC2.
                       ANGLE CTELEC2 >0 <45
                       ANGLE CTELEC2 >45 <90
                   }

NON_45_DEG_CELLVT { @ Non 45 degree angle CELLVT.
                      ANGLE CELLVT >0 <45
                      ANGLE CELLVT >45 <90
                  }

NON_45_DEG_CELLIMP { @ Non 45 degree angle CELLIMP.
                       ANGLE CELLIMP >0 <45
                       ANGLE CELLIMP >45 <90
                   }    

NON_45_DEG_NISO { @ Non 45 degree angle NISO.
                    ANGLE NISO_0 >0 <45
                    ANGLE NISO_0 >45 <90
                }

// //////////////////////////////////////////////////////////////////////////////
// /              CMOS  DESIGN  RULES                                           /
// //////////////////////////////////////////////////////////////////////////////

//  -------------------------------------------------------------------------
//      HC8REC  [CAD layer]
//  -------------------------------------------------------------------------

HC8REC:1 = SIZE HC8REC BY -0.48
HC8REC:2 = SIZE HC8REC BY 0.48
HC8REC:3 = HC8REC:2 NOT HC8REC:1

RHC8REC.1_2_3 { @ Rule HC8REC.1 : Only metals crossing HC8REC are allowed.
        @ Rule HC8REC.2 : HC8REC enclosure of all layers (except metal) >= 0.5.
        @ Rule HC8REC.3 : HC8REC distance to all layers (except metal) >= 0.5.
          ACTIVE INTERACT HC8REC:3
          POLY INTERACT HC8REC:3
          NLDD INTERACT HC8REC:3 
          PLDD INTERACT HC8REC:3
          NPLUS INTERACT HC8REC:3
          PPLUS INTERACT HC8REC:3
          ADHVTN INTERACT HC8REC:3
          ADHVTP INTERACT HC8REC:3
          NWELL INTERACT HC8REC:3
          RNWELL INTERACT HC8REC:3
          SIPROT INTERACT HC8REC:3
          CONTACT INTERACT HC8REC:3
          LIL INTERACT HC8REC:3
          GO2 INTERACT HC8REC:3 
          NEXT INTERACT HC8REC:3
          PEXT INTERACT HC8REC:3
          NISO INTERACT HC8REC:3
          NATIVE INTERACT HC8REC:3 
          }

RHC8REC.4 { @ Rule HC8REC.4 : ADHVTN and/or ADHVTP not allowed on HC8REC.
          ADHVTN AND HC8REC
          ADHVTP AND HC8REC
      }

//  -------------------------------------------------------------------------
//      ACTIVE  [Mask level 2]
//  -------------------------------------------------------------------------

GATEND = GATE COINCIDENT INSIDE EDGE ACTIVE
GATEND_5V = GATE_5V COINCIDENT INSIDE EDGE ACTIVE

R2X1Xa { @ Rule 2.1a : MOS transistor width >= 0.28.
           R1 = INT GATEND < 0.28 ABUT>0<90 REGION
           M = FDRC INSIDE CELL '*FR_2X1Xa_*'
           R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
       }

NGO2D = NGO2:2 COINCIDENT INSIDE EDGE ACTIVE
PGO2D = PGO2:1 COINCIDENT INSIDE EDGE ACTIVE

R2.1b { @ Rule 2.1b : MOS transistor width for thick gate oxide >= 0.5.
          INT NGO2D < 0.5 ABUT>0<90 OPPOSITE
      INT PGO2D < 0.5 ABUT>0<90 OPPOSITE
      }

R2.1c { @ Rule 2.1c : Channel width for 5V transistors >= 0.28.
          INT GATEND_5V < 0.28 ABUT>0<90 REGION
      }

R2Ximp1 { @ Rule 2.imp1 ACTIVE without implant is not allowed.
            R1 = COPY BADACTIVE:1
            M = FDRC INSIDE CELL '*FR_2Ximp1_*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

R2.imp2 { @ Rule 2.imp2 ACTIVE with PLDD or NLDD without NPLUS or PPLUS is not allowed.
            PLDDACT AND NLDDACT
    }

R2X2 { @ Rule 2.2 : N+ active width > 0.28.
         R1 = INT NACTIVE < 0.28 ABUT>0<90 SINGULAR REGION
         M = FDRC INSIDE CELL '*FR_2X2_*'
         R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
     }

R2X3 { @ Rule 2.3 : P+ active  width > 0.28.
         R1 = INT PACTIVE < 0.28 ABUT>0<90 SINGULAR REGION
         M = FDRC INSIDE CELL '*FR_2X3_*'
         R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
     }

R2X5 { @ Rule 2.5 : ACTIVE space > 0.32.
         R1 = EXT ACTIVE < 0.32 ABUT>0<90 SINGULAR REGION
         M = FDRC INSIDE CELL '*FR_2X5_*'
         R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
     }

R2.6 { @ Rule 2.6 : NWELL strap distance to PWELL strap > 0.36.
         EXT NSTRAP:2 PSTRAP < 0.36 ABUT>0<90 SINGULAR
     }

R2.7 { @ Rule 2.7 : ACTIVE minimum area 0.1.
         R = NOT AREA ACTIVE >= 0.1
     R OUTSIDE HC8REC
     }

ACTIVEH = (HOLES ACTIVE) NOT ACTIVE

R2.8 { @ Rule 2.8 : ACTIVE minimum enclosed area 0.32.
         AREA ACTIVEH < 0.32
     }

//  -------------------------------------------------------------------------
//      NWELL  [Mask level 1]
//  -------------------------------------------------------------------------

NCRSNW = (NACTIVE CUT NWELL) CUT PWELL:1
NINPWON = NINPW NOT NCRSNW
BAD_NWELL = NWELLC NOT NWELLC:1
NWELLC_GND = NET NWELLC:1 GND GNDS gnd gnds "gnd;" "gnd!" "gnds;" "gnds!"
NWELLC_NOT = NWELLC:1 NOT NWELLC_GND

R1X1 { @ Rule 1.1 : NWELL width >= 1.0.
         R1 = INT NWELL < 1.0 ABUT>0<90 SINGULAR REGION
         M = FDRC INSIDE CELL '*FR_1X1_*'
         R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
     }

R1.2a { @ Rule 1.2a : NWELL space >= 1.0.
          EXT NWELL < 1.0 ABUT>=0<90 SINGULAR REGION
      }
 
//R1.3 { @ Rule 1.3 : nwell space for different nets > 1.0.
//         EXT NWELLC:1 < 1.0 NOT CONNECTED ABUT>0<90 SINGULAR
//         X = BAD_NWELL OR NWELFT:1
//         EXT X < 1.0 SPACE ABUT>=0<90 SINGULAR
//         EXT X NWELLC:1 < 1.0 ABUT>=0<90 SINGULAR
//     }

// Rule 1.5b : nwell strap across Nwell boundary is allowed.

R1.2b { @ Rule 1.2b : NWELL space if one NWELL is at ground > 1.4.
          EXT NWELLC_NOT NWELLC_GND < 1.4 ABUT>=0<90 SINGULAR REGION
      }

R1.5c { @ Rule 1.5c : NWELL intersection with NWELL strap > 0.4.
          INT NCRSNW NWELL < 0.4 ABUT>0<90 MEASURE COINCIDENT
      }

R1.7 { @ Rule 1.7 : NWELL distance to PWELL strap except pdrift >= 0.18.
         EXT ( NWELL NOT INTERACT PDRACPO ) PSTRAP < 0.18 ABUT<90 SINGULAR REGION
     }

//Already checked by rules 1.4 + 1.6
// Rule 1.8  P+ to N+ across well > 0.8
 
NWELLSZ = SIZE NWELL BY 0.24

R1.9 { @ Rule 1.9 : NWELL space after +0.24um sizing >= 0.52.
         EXT NWELLSZ < 0.52 ABUT>=0<90 SINGULAR REGION
     }

R1X4 { @ Rule 1.4 : NWELL enclosure of P+ active except pdrift >= 0.4.
         R1 = ENC PINNW ( NWELL NOT INTERACT PDRACPO ) < 0.4 ABUT<90 SINGULAR REGION
         M = FDRC INSIDE CELL '*FR_1X4_*'
         R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
     }

NPLNW = NACTIVE INSIDE NWELL

R1.5a { @ Rule 1.5a : NWELL enclosure of NWELL strap,
        @ if NWELL boundary does not cross NWELL strap > 0.18.
          R1 = ENC NSTRAP:2 NWELL < 0.18 ABUT>0<45 SINGULAR REGION
      R2 = ENC NSTRAP:2 NWELL < 0.18 ABUT>45<90 SINGULAR REGION
      R1 OR R2
      }

R1X6 { @ Rule 1.6 : NWELL distance to N+ active >= 0.4.
          R1 = EXT NWELL NINPWON < 0.4 ABUT<90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_1X6_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R1.11 { @ Rule 1.11 : NWELL enclosure of P+ active with PEXT >= 0.8.
          X = PACTIVE ENCLOSE PGO2IO
          ENC X NWELL  < 0.8 ABUT<90
      }

R1.12 { @ Rule 1.12 : NWELL distance to N+ active with NEXT >= 0.8.
      Y = NACTIVE ENCLOSE NGO2IO
          EXT Y NWELL < 0.8 ABUT<90
      }

R1.imp1 { @ Rule 1.imp1 : Floating NWELL is not allowed.
        NWELLC OUTSIDE ACTIVE
    }

R2.imp1 { @ Rule 2.imp1 : Floating NWELL2 is not allowed.
        NWELL2C OUTSIDE ACTIVE
    }

R8.imp1 { @ Rule 8.imp1 : Floating PWELL is not allowed.
            NWNISO OUTSIDE ACTIVE
    }

//  -------------------------------------------------------------------------
//      NWELL2  [Mask level 89]
//  -------------------------------------------------------------------------

NCRSNW2 = (NACTIVE CUT NWELL2) CUT PWELL:1
BAD_NWELL2 = NWELL2 NOT NWELL2:1

R89.1 { @ Rule 89.1 : NWELL2 width >= 1.0.
          INT NWELL2 < 1.0 ABUT>0<90 SINGULAR REGION
      }

//89.2a - for all net, not only same net. For different nets more strong.
R89.2a { @ Rule R89.2a : NWELL2 space >= 1.0
           EXT NWELL2 < 1.0 ABUT>0<90 SINGULAR REGION
}

R89.2b { @ Rule 89.2b : NWELL2 space for different nets > 2.0.
           EXT NWELL2:1 < 2.0 NOT CONNECTED ABUT>0<90 SINGULAR REGION
       EXT BAD_NWELL2 < 2.0 SPACE ABUT>0<90 SINGULAR REGION
       EXT BAD_NWELL2 NWELL2:1 < 2.0 ABUT>0<90 SINGULAR REGION
       }

R89.3 { @ Rule 89.3 : NWELL2 enclosure of P+ active >= 0.4.
          ENC PACTIVE NWELL2 < 0.4 ABUT>=0<90 SINGULAR REGION
      }
      
NW2_NOT_RNW2 = NWELL2 NOT RNW2_REG

R89.4 { @ Rule 89.4 : NWELL2 distance to P+ active, except for NWELL2 resistor >= 0.2.
          EXT NW2_NOT_RNW2 PACTIVE < 0.2 ABUT>=0<90 SINGULAR REGION
      }

NACTIVENW2 = NACTIVE NOT NACTRNW2

R89.5a { @ Rule 89.5a : NWELL2 enclosure of N+ active >= 0.2.
           ENC NACTIVENW2 NWELL2 < 0.2 ABUT>=0<90 SINGULAR REGION
       }

R89.5c { @ Rule 89.5c : NWELL2 intersection with N+ active >= 0.4.
           INT NCRSNW2 NWELL2 < 0.4 ABUT>0<90 MEASURE COINCIDENT
       }

R89.6 { @ Rule 89.6 : NWELL2 distance to N+ active, except for NWELL2 resistor >= 0.4.
          EXT NW2_NOT_RNW2 NACTIVE < 0.4 ABUT>=0<90 SINGULAR REGION
      }

PACT_PEXT_5V = PACTIVE AND PEXT_5V

R89.7 { @ Rule 89.7 : NWELL2 enclosure of P+ active with PEXT_5V >= 0.8.
          ENC PACT_PEXT_5V NWELL2 < 0.8 ABUT>=0<90 SINGULAR REGION
      }

NACT_NEXT_5V = NACTIVE AND NEXT_5V

R89.8 { @ Rule 89.8 : NWELL2 distance to N+ active with NEXT_5V >= 0.8.
          EXT NACT_NEXT_5V NWELL2 < 0.8 ABUT>=0<90 SINGULAR REGION
      }

R89.9a { @ Rule 89.9a : NWELL2 space to NWELL >= 1.2.
     @ Rule 89.14 : Allowed the formation of NWELL and NWELL2 butt
       EXT NWELL2 NWELL < 1.2 ABUT>0<90 SINGULAR REGION
       }

R89.9b { @ Rule 89.9b : NWELL2 space to NWELL of different net >= 2.0.
      @ Rule 89.14 : Allowed the formation of NWELL and NWELL2 butt
           EXT NWELL2:1 NWELLC:1 < 2.0 NOT CONNECTED ABUT>0<90 SINGULAR REGION
       EXT BAD_NWELL2 NWELLC:1 < 2.0 ABUT>0<90 SINGULAR REGION
       EXT NWELL2:1 BAD_NWELL < 2.0 ABUT>0<90 SINGULAR REGION
       EXT BAD_NWELL2 BAD_NWELL < 2.0 ABUT>0<90 SINGULAR REGION
       }

R89.12 { @ Rule 89.12 : NLDD or PLDD on NWELL2 are not allowed.
           NLDD AND NWELL2
           PLDD AND NWELL2
       }

R89.13_R89.11 { @ Rule 89.13 : NWELL2 space to PWELL2 >= 1.0.
                @ Rule 89.11 : NWELL2/PWELL2 abutting cointact is allowed.
                  EXT NWELL2 PWELL2 < 1.0 ABUT>0<90 SINGULAR REGION
              }

R89.15 { @ Rule 89.15 : Intersection NWELL/NWELL2 not allowed     
        NWELL AND NWELL2
    }


//  -------------------------------------------------------------------------
//      PWELL2  [Mask level 90]
//  -------------------------------------------------------------------------

PCRSPW2 = (PACTIVE CUT PWELL2) CUT PWELL:1
R90.1 { @ Rule 90.1 : PWELL2 width >= 1.0.
          INT PWELL2 < 1.0 ABUT>0<90 SINGULAR REGION
      }

R90.2 { @ Rule 90.2 : PWELL2 space >= 1.0.
          EXT PWELL2 < 1.0 ABUT>0<90 SINGULAR REGION
      }

R90.3 { @ Rule 90.3 : PWELL2 enclosure of N+ active >= 0.4.
          ENC NACTIVE PWELL2 < 0.4 ABUT>=0<90 SINGULAR REGION
      }

NACTNONSTRAP = ACTNONSTRAP AND NPLUS
R90.4 { @ Rule 90.4 : PWELL2 distance to N+ active other than NWELL/NWELL2 strap >= 0.4.
          EXT PWELL2 NACTNONSTRAP < 0.4 ABUT>=0<90 SINGULAR REGION
      }

R90.4a { @ Rule 90.4a : PWELL2 distance to NWELL/NWELL2 strap >= 0.2.
           EXT PWELL2 NSTRAP_ALL < 0.2 ABUT>=0<90 SINGULAR REGION
       }

R90.5a { @ Rule 90.5a : PWELL2 enclosure of P+ active >= 0.2.
           ENC PACTIVE PWELL2 < 0.2 ABUT>=0<90 SINGULAR REGION
       }

R90.5c { @ Rule 90.5c : PWELL2 intersection with P+ active >= 0.4.
           INT PCRSPW2 PWELL2 < 0.4 ABUT>0<90 MEASURE COINCIDENT
       }

PART_ESD = (POLY AND SIPROT) AND GO2_5V
NACT_IN_ESD = (NACTIVE OUTSIDE NEXT_5V) INTERACT PART_ESD

R90.6 { @ Rule 90.6 : PWELL2 enclosure of N+ active with NEXT_5V
        @ and in 5V ESD transistors >= 0.8.
      ENC NACT_NEXT_5V PWELL2 < 0.8 ABUT>=0<90 SINGULAR REGION
      ENC NACT_IN_ESD PWELL2 < 0.8 ABUT>=0<90 SINGULAR REGION
      }

R90.7 { @ Rule 90.7 : PWELL2 distance to P+ active with PEXT_5V >= 0.8.
          EXT PACT_PEXT_5V PWELL2 < 0.8 ABUT>=0<90 SINGULAR REGION
      }

R90.9_R90.11 { @ Rule 90.9 : PWELL2 space to NWELL >= 1.0.
               @ Rule 90.11 : PWELL2/NWELL abutting cointact is allowed.
                 EXT PWELL2 NWELL < 1.0 ABUT>0<90 SINGULAR REGION
             }

R90.10 { @ Rule 90.10 : NLDD and PLDD on PWELL2 is not allowed.
           NLDD AND PWELL2
           PLDD AND PWELL2
       }

R90.12 { @ Rule 90.12 : Intersection NWELL/PWELL2 or NWELL2/PWELL2 not allowed     
        NWELL AND PWELL2
        NWELL2 AND PWELL2
    }
    
//  -------------------------------------------------------------------------
//         RNWELL  [CAD layer]
//  -------------------------------------------------------------------------

NCRSRNW = (NACTIVE CUT RNWELL) CUT PWELL:1
RNWELSZ = SIZE RNWELL BY 0.24
NWELL2C_GND = NET NWELL2C:1 GND GNDS gnd gnds "gnd;" "gnd!" "gnds;" "gnds!"

R112.1 { @ Rule 112.1 : RNWELL width >= 1.0.
           INT RNWELL < 1.0 ABUT>0<90 SINGULAR
    }

R112.2 { @ Rule 112.2 : RNWELL space >= 1.0.
           EXT RNWELL < 1.0 ABUT>0<90 SINGULAR
    }

R112.3a { @ Rule 112.3a : RNWELL distance to NWELL >= 1.0.
            EXT RNWELL NWELL < 1.0 ABUT<90 SINGULAR REGION
    }

R112.3b { @ Rule 112.3.b : RNWELL distance to NWELL if NWELL is at ground >= 1.4.
            EXT RNWELL NWELLC_GND < 1.4 ABUT>0<90 SINGULAR REGION
    }

R112.3c { @ Rule 112.3c : RNWELL distance to NWELL2 >= 1.2.
            EXT RNWELL NWELL2 < 1.2 ABUT<90 SINGULAR REGION
    }

R112.3d { @ Rule 112.3.d : RNWELL distance to NWELL2 if NWELL2 is at ground >= 2.0.
            EXT RNWELL NWELL2C_GND < 2.0 ABUT>0<90 SINGULAR REGION
    }

// Rule 112.5.b : N+ active across RNWELL boundary is allowed.
 
R112.5c { @ Rule 112.5c : RNWELL intersection with N+ active >= 0.4.
            INT NCRSRNW RNWELL < 0.4 ABUT>0<90 MEASURE COINCIDENT
    }

R112.6 { @ Rule 112.6 : RNWELL distance to N+ active >= 0.64.
           X = NINPW NOT NCRSRNW
           EXT RNWELL X < 0.64 ABUT<90 SINGULAR
       }

R112.7 { @ Rule 112.7 : RNWELL distance to PWELL strap >= 0.32.
           EXT RNWELL PSTRAP < 0.32 ABUT<90 SINGULAR REGION
    }

R112.7a { @ Rule 112.7a : RNWELL distance to PWELL2 strap >= 0.32.
            EXT RNWELL PSTRAP_5V < 0.32 ABUT<90 SINGULAR REGION
    }

R112.8 { @ Rule 112.8 : RNWELL space after +0.24um sizing >= 0.52.
         EXT RNWELSZ < 0.52 ABUT>0<90 SINGULAR
    }

R112.9 { @ Rule 112.9 : RNWELL distance to NWELL or NEPI after +0.24um sizing >= 0.52.
         EXT RNWELSZ NWELLSZ < 0.52 ABUT<90 SINGULAR
     NEPISZ = SIZE NEPI BY 0.24
     EXT RNWELSZ NEPISZ < 0.52 ABUT<90 SINGULAR
    }

//R112.10 { @ Rule 112.10 : P+ active in RNWELL is not allowed.
//          RNWELL AND PACTIVE
//    }

R112.11 { @ Rule 112.11 : POLY in RNWELL is not allowed.
            RNWELL AND POLY
    }

R112.12 { @ Rule 112.12 : NWELL resistor width >= 0.7.
            X = RESNW COINCIDENT INSIDE EDGE RNWELL
            INT X < 0.7 ABUT>0<90
    }
 
R112.13 { @ Rule 112.13 : NWELL resistor length >= 1.4.
            X = RESNW COINCIDENT OUTSIDE EDGE RNWELLT
            INT X < 1.4 ABUT>0<90
    }

R112.imp1 { @ Rule 112.imp1 : floating RNWELL is not allowed under pads.
              (RNWELL INTERACT PAD) OUTSIDE ACTIVE
      }

R112.14 { @ Rule 112.14 : N+ active head enclosure by RNWELL >= 0.3.
          X = RESNWT NOT NCRSRNW
          ENC X RNWELL < 0.3 ABUT< 90 SINGULAR
    }

R112.10 { @ Rule 112.10 : P+ active in RNWELL is not allowed.
            (RNWELL_0 NOT INSIDE  CELL '*IOOTP_RNW*') AND PACTNOEM
    }

R112.15 { @ Rule 112.15 : NISO in RNWELL is not allowed.
          NISO AND RNWELL
        }

R112.17_112.18 { @ Rule 112.18 : RNWELL distance to PWELL2 >= 1.0
                 @ Rule 112.17 : Abutt formation of RNWELL and PWELL2 is allowed.
                   EXT RNWELL PWELL2 < 1.0 ABUT>0<90 SINGULAR REGION
           }

//------------------------------------------------------------------------------  
//       ADHVTN  [Mask level 82]
//------------------------------------------------------------------------------  

R82.1 { @ Rule 82.1 : ADHVTN width >= 0.48.
          INT ADHVTN < 0.48 ABUT>0<90 OPPOSITE SINGULAR
      }

R82.2 { @ Rule 82.2 : ADHVTN space >=0.48.
          EXT ADHVTN < 0.48 ABUT>0<90 SINGULAR
      }

R82X3 { @ Rule 82.3 : ADHVTN enclosure of N+ gate >= 0.36.
          R1 = ENC NGATELL:1 ADHVTN < 0.36 ABUT <90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_82X3_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

GATENOADHN = ALLGATE OUTSIDE ADHVTN

R82X4 { @ Rule 82.4 : ADHVTN distance to gate of mos without ADHVTN >= 0.26.
          R1 = EXT ADHVTN GATENOADHN < 0.26 ABUT <90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_82X4_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

ACTIVSD = (ACTNOSTRAP ENCLOSE ALLGATE) NOT ALLGATE
//ACTIVSD = ACTNOSTRAP NOT ALLGATE
ACTIVSDHVTN = ACTIVSD AND ADHVTN
ACTIVSDHVTP = ACTIVSD AND ADHVTP
ACTIVSDHVTNP = ACTIVSDHVTN OR ACTIVSDHVTP 
ACTIVSDHVT = ACTIVSD ENCLOSE ACTIVSDHVTNP
ACTIVSDLVT = ACTIVSD NOT ACTIVSDHVT

R82.5 { @ Rule 82.5 : ADHVTN distance to ACTIVE of mos without ADHVTN >= 0.08.
          EXT ADHVTN ACTIVSDLVT < 0.08 ABUT <90 SINGULAR REGION
      }

R82.6 { @ Rule 82.6 : ADHVTN minimum diagonal width for inner corners only > 0.22.
          INT ADHVTN < 0.22 ABUT>0<90 SINGULAR
      }

GATE_N = NINPW AND POLY
GATE_P = PINNW AND POLY

PGATESZ = (SIZE GATE_P BY 0.02) AND ACTIVE
PGATESZ:1 = SIZE PGATESZ BY 0.24

R82.imp1 { @ Rule 82.imp1 : ADHVTN not allowed on pgate sized by 0.26.
             PGATESZ:1 AND ADHVTN
     }

R82.imp2 { @ Rule 82.imp2 : ADHVTN mandatory on gate of low leakage nmos.
             (GATE_N INTERACT ADHVTN) NOT ADHVTN
     }

//------------------------------------------------------------------------------  
//       ADHVTP  [Mask level 82]
//------------------------------------------------------------------------------  

R83.1 { @ Rule 83.1 : ADHVTP width >= 0.48.
          INT ADHVTP < 0.48 ABUT>0<90 OPPOSITE SINGULAR
      }

R83.2 { @ Rule 83.2 : ADHVTP space >= 0.48.
         EXT ADHVTP < 0.48 ABUT>0<90 SINGULAR
      }

R83X3 { @ Rule 83.3 : ADHVTP enclosure of P+ gate >= 0.36.
          R1 = ENC PGATELL:1 ADHVTP < 0.36 ABUT <90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_83X3_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

GATENOADHP = ALLGATE OUTSIDE ADHVTP

R83X4 { @ Rule 83.4 : ADHVTP distance to gate of mos without ADHVTP >= 0.26.
          R1 = EXT ADHVTP GATENOADHP < 0.26 ABUT <90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_83X4_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R83.5 { @ Rule 83.5 : ADHVTP distance to ACTIVE of mos without ADHVTP >= 0.08.
          EXT ADHVTP ACTIVSDLVT < 0.08 ABUT <90 SINGULAR
      }            

R83.6 { @ Rule 83.6 : ADHVTP minimum diagonal width for inner corners only > 0.22.
          INT ADHVTP < 0.22 ABUT>0<90 SINGULAR
      }

NGATESZ = (SIZE GATE_N BY 0.02) AND ACTIVE
NGATESZ:1 = SIZE NGATESZ BY 0.24

R83.imp1 { @ Rule 83.imp1 : ADHVTP not allowed on ngate sized by 0.26.
             NGATESZ:1 AND ADHVTP
     }

R83.imp2 { @ Rule 83.imp2 : ADHVTP mandatory on pgate of low leakage pmos.
             (GATE_P INTERACT ADHVTP) NOT ADHVTP
     }

//  -------------------------------------------------------------------------
//      POLY  [Mask level 13]
//  -------------------------------------------------------------------------

ACTOVPO:1 = ACTIVE INSIDE EDGE POLY
ACTOVPO:2 = NOT TOUCH EDGE ACTOVPO:1 ( NDRACPO OR PDRACPO )
POLYEXT = ACTPOL:1 COINCIDENT INSIDE EDGE ACTIVE

ENDCAP = POFIELD TOUCH ACTPOL:1
ENDGATE = ENDCAP TOUCH GATE

HAMMERBODY:1 = POLYEXT COINCIDENT INSIDE EDGE GATE
HAMMERBODY = EXPAND EDGE HAMMERBODY:1 INSIDE BY 0.020 EXTEND BY 0.04

HAMMEREXT = (ENDGATE COINCIDENT INSIDE EDGE POLY) TOUCH EDGE HAMMERBODY

HAMMERHEAD:1 = RECTANGLE (ENDGATE NOT HAMMERBODY)
HAMMERHEAD:2 = (HAMMERHEAD:1 WITH EDGE HAMMEREXT ==2) TOUCH HAMMERBODY == 1
HAMMERHEAD = HAMMERHEAD:2 INSIDE HC8REC

R13X1Xa { @ Rule 13.1a : POLY width >= 0.18.
            R1 = INT POLY < 0.18 ABUT>0<90 SINGULAR REGION
            M = FDRC INSIDE CELL '*FR_13X1Xa_*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

GATENL = GATE COINCIDENT INSIDE EDGE POLY

R13.1b { @ Rule 13.1b : Min transistor length for thin gate oxide transistors >= 0.18.
           INT GATENL < 0.18 ABUT>0<90
       }

NGO2L = NGO2:2 COINCIDENT INSIDE EDGE POLY
PGO2L = PGO2:1 COINCIDENT INSIDE EDGE POLY
NGO2ESDL = NGO2ESD:3 COINCIDENT INSIDE EDGE POLY

R13.1c { @ Rule 13.1c : Min transistor length for thick gate oxide I/O's transistors >= 0.34.
           INT NGO2L < 0.34 ABUT>0<90
           INT NGO2ESDL < 0.34 ABUT>0<90
           INT PGO2L < 0.34 ABUT>0<90
       }

GATENL_5V = GATE_5V COINCIDENT INSIDE EDGE POLY

R13.1d { @ Rule 13.1d : Chanel length for 5V transistors >= 0.5.
           INT GATENL_5V < 0.5 ABUT>0<90
       }

R13X2Xa { @ Rule 13.2a : POLY space >= 0.28.
            R1 = EXT POLY < 0.28 ABUT>0<90 SINGULAR REGION
            M = FDRC INSIDE CELL '*FR_13X2*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

R13.2b { @ Rule 13.2b : POLY space on ACTIVE without CONTACT >= 0.28.
           X = ACTPOL:1 COINCIDENT INSIDE EDGE POLY
           EXT X < 0.28 ABUT>0<90
       }

DSC_1 = (ACTIVE ENCLOSE ALLGATE) NOT ALLGATE
CTORLIL = LILACT OR CONTACT
DSC_2 = DSC_1 ENCLOSE LILACT
DSC_3 = DSC_1 ENCLOSE CONTACT
DSC = DSC_2 OR DSC_3

R13.2c { @ Rule 13.2c : POLY space on ACTIVE when contacted.
     @ if L is lower than 5 um >= 0.36.
           X = ALLGATE COINCIDENT OUTSIDE EDGE DSC
           EXT X < 0.36 ABUT>0<90
       }

R13.2d { @ Rule 13.2d : POLY space on ACTIVE when contacted.
     @ if L is higher or equal to 5 um >= 0.44.
           X1 = ALLGATE COINCIDENT OUTSIDE EDGE DSC
       X2 = LENGTH X1 >= 5
           R = EXT X2 < 0.44 ABUT>0<90 PROJECTING OPPOSITE REGION
       R OUTSIDE HC8REC
       }

LPOLY_0 = POLY NOT POLY_30
GATENDANDH_5V = GATEANDH_5V COINCIDENT INSIDE EDGE ACTIVE

R_13X3 { @ Rule 13.3 : poly extension on active (Endcap) >= 0.2
           R0 = ENC GATENDANDH_5V LPOLY_0 < 0.2 ABUT< 90 REGION
           R1 = ENC GATEND LPOLY_0 < 0.2 ABUT< 90 REGION
           R2 = ENC NGO2D LPOLY_0 < 0.2 ABUT< 90 REGION
           R3 = (R0 OR R1) OR R2
           R4 = ENC PGO2D LPOLY_0 < 0.2 ABUT< 90 REGION
           R5 = R3 OR R4
           M = FDRC INSIDE CELL '*FR_13X3_*'
           R5 INTERACT (SIZE (R5 XOR M) BY -0.001)
       }

ACTINCORN = EXT NACTIVE < 0.020 ABUT == 90 INTERSECTING ONLY REGION
ACTINCORP = EXT PACTIVE < 0.020 ABUT == 90 INTERSECTING ONLY REGION
ACTINCORNEDG = NACTIVE COINCIDENT OUTSIDE EDGE ACTINCORN
ACTINCORPEDG = PACTIVE COINCIDENT OUTSIDE EDGE ACTINCORP
N_POLY_TR = N_POLY_FIELD TOUCH N_GATE
P_POLY_TR = P_POLY_FIELD TOUCH P_GATE

R13X4Xa { @ Rule 13.4a : POLY distance to ACTIVE corner >= 0.16.
            R1N = EXT N_POLY_TR ACTINCORNEDG < 0.16 ABUT< 90 REGION
        R1P = EXT P_POLY_TR ACTINCORPEDG < 0.16 ABUT< 90 REGION
            R1 = R1N OR R1P
            M = FDRC INSIDE CELL '*FR_13X4Xa_*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

POLYINCOR:1 = EXT POLYNOHAMM < 0.020 ABUT == 90 INTERSECTING ONLY REGION
//POLYINCOR:1 = EXT POLYNOHAMM < 0.020 ABUT <= 135 INTERSECTING ONLY REGION
POLYINCOR = POLY COINCIDENT OUTSIDE EDGE POLYINCOR:1
ACTIVEDRSRC = NINPWPO OR PINNWPO

R13X4Xb { @ Rule 13.4b : POLY corner distance to ACTIVE >= 0.16.
            R1 = EXT POLYINCOR ACTIVEDRSRC < 0.16 ABUT< 90 OPPOSITE REGION
//             R1 = EXT POLYINCOR ACTIVEDRSRC < 0.12 ABUT< 90 OPPOSITE REGION
            M = FDRC INSIDE CELL '*FR_13X4*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

POLYNOHAMM = NOT POLY HAMMERHEAD

R13X4Xc { @ Rule 13.4c : POLY distance to ACTIVE >= 0.12.
            R1 = EXT POLYNOHAMM ACTIVE < 0.12 ABUT< 90 SINGULAR REGION
            M = FDRC INSIDE CELL '*FR_13X4*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

R13X4i2 { @ Rule 13.4i2 : POLY space to ACTIVE when contacted by LIL >= 0.12.
            R1 = EXT LILPOL ACTIVE < 0.12 ABUT<90 OVERLAP SINGULAR REGION
            M = FDRC INSIDE CELL '*FR_13X4i2_*'
            R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
        }

NGATW = ALLNGATE:5 COINCIDENT INSIDE EDGE POLY
PGATW = ALLPGATE:4 COINCIDENT INSIDE EDGE POLY

R13X5Xa { @ Rule 13.5a : Minimum uncontacted source and drain width if L is <= 5um equals 0.36um
          @              "uncontacted" means - at distance more than 5um from contact window.
            R1 = ENC NGATW ACTIVE < 0.36 ABUT<90 OPPOSITE REGION
            R2 = ENC PGATW ACTIVE < 0.36 ABUT<90 OPPOSITE REGION
            R3 = R1 OR R2
            M = FDRC INSIDE CELL '*FR_13X5*'
            R3 INTERACT (SIZE (R3 XOR M) BY -0.001)
        }

SD1 = ALLGATE COINCIDENT INSIDE EDGE POLY
SD2 = LENGTH SD1 > 5    

CTORLIL:1 = CTORLIL AND (ACTIVE ENCLOSE ALLGATE)
LAYERG = EXT ALLGATE CTORLIL:1 >= 0.14 < 0.5 OPPOSITE PARALLEL REGION
//edge gate facing contact or lil 
LAYERB = LAYERG OUTSIDE EDGE ( CTORLIL OR ALLGATE )
LAYERZ = LAYERG OR (EXPAND EDGE LAYERB OUTSIDE BY 5)
AENLEV = ALLGATE COINCIDENT EDGE LAYERZ
AENLEV1 = ALLGATE INSIDE EDGE LAYERZ

LAYER6 = SD2 NOT COINCIDENT EDGE AENLEV    
LAYER7 = LAYER6 NOT COINCIDENT EDGE AENLEV1    

R13.5b { @ Rule 13.5b : Minimum uncontacted source and drain width if L is higher 5um equals 0.44
         @              "uncontacted" means - at distance more than 5um from contact window.
       R = ENC LAYER7 ACTIVE < 0.44 ABUT<90 OPPOSITE REGION
       R OUTSIDE HC8REC
       }    

R13.5_H8 { @ Rule 13.5_H8 : Minimum N & P Source/Drain Width limited by active = 0.36um.
       R = ENC LAYER7 ACTIVE < 0.36 ABUT<90 OPPOSITE REGION
       R INSIDE HC8REC
     }

R13.6 { @ Rule 13.6 : POLY over inward ACTIVE corner is not allowed.
          EXT ACTOVPO:2 < 0.1 ABUT >0 < 180 INTERSECTING ONLY
      }

R13.6. { @ Rule 13.6. : POLY over outward ACTIVE corner not allowed.
           INT ACTOVPO:2 < 0.1 ABUT >0 < 180 INTERSECTING ONLY
       }

PNOTMOS = ACTPOL:1 NOT ALLGATE
R13X7 { @ Rule 13.7 : POLY on ACTIVE distance to edge of non mos ACTIVE > 0.32.
          X = PNOTMOS COINCIDENT INSIDE EDGE POLY
          R1 = ENC X ACTIVE < 0.32 ABUT<90 REGION
          M = FDRC INSIDE CELL '*FR_13X7_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

POLYNOCPONW:1 = COPY POLY

POLYINCOR:2 = ((EXT POLYNOHAMM < 0.020 ABUT == 90 INTERSECTING ONLY REGION) NOT CP1NWT) NOT INTERACT GATEH_5V
POLYNOCPONW:2 = (POLYNOCPONW:1 NOT CP1NWT) NOT INTERACT GATEH_5V

R13.8 { @ Rule 13.8 : 90deg angles on ACTIVE are forbiden.
      POLYINCOR:2 AND ACTIVE
      POOVACT = POLYNOCPONW:2 INSIDE EDGE ACTIVE
      INT POOVACT < 0.02 ABUT >0 < 45 INTERSECTING ONLY
      INT POOVACT < 0.02 ABUT >45 < 135 INTERSECTING ONLY
      INT POOVACT < 0.02 ABUT >135 < 180 INTERSECTING ONLY
      }

R13.8_H8 { @ Rule 13.8_H8 : POLY space >= 0.36.
           X1 = ALLGATE COINCIDENT OUTSIDE EDGE DSC
       X2 = LENGTH X1 > 5
           R = EXT X2 < 0.36 ABUT>0<90 PROJECTING OPPOSITE REGION
       R INSIDE HC8REC
        }

R13.9 { @ Rule 13.9 : Min length of 45deg POLY line between two inside corners in the same direction = 0.3.
      POOVACT = POLY INSIDE EDGE ACTIVE
      POLYX5 = EXT POOVACT < 0.02 ABUT == 135 INTERSECTING ONLY REGION
      POOVACTSZ = RECTANGLE (EXPAND EDGE POOVACT INSIDE BY 0.02 )
      BADPOLY45 = NOT LENGTH ( POOVACTSZ TOUCH POLYX5 == 2 ) > 0.3
      R = BADPOLY45 COINCIDENT INSIDE EDGE POLY
      R OUTSIDE EDGE HC8REC
      }

R13.10 { @ Rule 13.10 : POLY distance to NWELL on ACTIVE in case this ACTIVE crosses NWELL boundary >= 0.56.
           X = NWELL INSIDE EDGE NCRSNW
           Y:1 = COPY ACTPOL:1  
           Y:2 = Y:1 NOT NDRACPO 
       Z = Y:2 COINCIDENT INSIDE EDGE POLY
       EXT Z X < 0.56  ABUT<90 INSIDE ALSO
           (Y:2 COINCIDENT INSIDE EDGE NCRSNW ) COINCIDENT INSIDE EDGE NWELL
}

R13.10a { @ Rule 13.10a : POLY distance to NWELL2 on ACTIVE in case this ACTIVE crosses NWELL2 boundary >= 0.56.
            X = NWELL2 INSIDE EDGE NCRSNW2
        Z = ACTPOL:1 COINCIDENT INSIDE EDGE POLY
        EXT Z X < 0.56  ABUT<90
    }

R13.11 { @ Rule 13.11 POLY distance to RNWELL on ACTIVE in case this ACTIVE crosses the RNWELL boundary >= 0.56.
           X = RNWELL INSIDE EDGE NCRSRNW
           Y:3 = COPY ACTPOL:1  
           Y:4 = Y:3 NOT NDRACPO 
           Z = ACTPOL:1 COINCIDENT INSIDE EDGE POLY
           EXT Z X < 0.56  ABUT<90 INSIDE ALSO
           (Y:4 COINCIDENT INSIDE EDGE NCRSRNW ) COINCIDENT INSIDE EDGE RNWELL
    }

ALLIMPLANT:1 = NPLUS OR PPLUS

R13.13 { @ Rule 13.13 : POLY without implant is not allowed except for RHIPO resistor.
           (( POLY NOT ALLIMPLANT:1 ) NOT HC8REC ) NOT PRESIST
       }

//  -------------------------------------------------------------------------
//      NLDD  [Mask level 14]
//  -------------------------------------------------------------------------

R14.imp1a { @ Rule 14.imp1 : NMOS gate must be inside NLDD.
              NGATE:7 CUT NLDD
          NGATELL:1 CUT NLDD
          }

R14.imp2a { @ Rule 14.imp2 : PMOS gate must not be inside NLDD.
              PGATE:8 AND NLDD
          PGATELL:1 AND NLDD
          }

R14.1 { @ Rule 14.1 : NLDD width >= 0.48.
          INT NLDD < 0.48 ABUT>0<90 SINGULAR
      }

R14.2 { @ Rule 14.2 : NLDD space >= 0.48.
          EXT NLDD < 0.48 ABUT>0<90 SINGULAR
      }

R14X3 { @ Rule 14.3 : NLDD enclosure of N+ gate >= 0.58.
          R1 = ENC NGATE:7 NLDD < 0.58 ABUT<90 SINGULAR REGION
          R2 = ENC NGATELL:1 NLDD < 0.58 ABUT<90 SINGULAR REGION
          R3 = R1 OR R2
          M = FDRC INSIDE CELL '*FR_14X3_*'
          R3 INTERACT (SIZE (R3 XOR M) BY -0.001)
      }

R14.4 { @ Rule 14.4 : NLDD distance to active resistors > 0.26.
      EXT ACTIVERES NLDD < 0.26 ABUT<90
      NLDD  INSIDE EDGE ACTIVERES
      }

R14.5 { @ Rule 14.5 : NLDD distance to poly resistors > 0.26.
      EXT RPOLY NLDD < 0.26 ABUT<90
      NLDD  INSIDE EDGE RPOLY
      }

R14X8 { @ Rule 14.8 : NLDD distance to P+ active other than PWELL strap > 0.22.
          R1 = EXT PACTNOSTRP NLDD < 0.22 ABUT<90 REGION
          R2 = EXPAND EDGE (NLDD INSIDE EDGE PACTNOSTRP) OUTSIDE BY 0.02
          R3 = R1 OR R2
          M = FDRC INSIDE CELL '*FR_14X8_*'
          R3 INTERACT (SIZE (R3 XOR M) BY -0.001)
      }

ACTIVEXT = NEXTAC OR PEXTAC

R14.6 { @ Rule 14.6 : NLDD distance to ACTIVE covered with NEXT or PEXT > 0.26.
      EXT ACTIVEXT NLDD < 0.26 ABUT<90
      NLDD  INSIDE EDGE ACTIVEXT
      }

NLDDSTRAP = NLDDACT AND NWELL

R14.imp3 { @ Rule 14.imp3 : ACTIVE strap with NLDD without nplus is not allowed.
             COPY NLDDSTRAP
     }

//  -------------------------------------------------------------------------
//      PLDD  [Mask level 15]
//  -------------------------------------------------------------------------

R15.imp1a { @ Rule 15.imp1 : PMOS gate must be inside PLDD.
              PGATE:8 CUT PLDD
          PGATELL:1 CUT PLDD
          }

R15.imp2a { @ Rule 15.imp2 : NMOS gate must not be inside PLDD.
              NGATE:7 AND PLDD
          NGATELL:1 AND PLDD
          }

R15.1 { @ Rule 15.1 : PLDD width >= 0.48.
          INT PLDD < 0.48 ABUT>0<90 SINGULAR
      }

R15.2 { @ Rule 15.2 : PLDD space >= 0.48.
          EXT PLDD < 0.48 ABUT>0<90 SINGULAR
      }

R15X3 { @ Rule 15.3 : PLDD enclosure of P+ gate >= 0.58.
          R1 = ENC PGATE:8 PLDD < 0.58 ABUT<90 SINGULAR REGION
          R2 = ENC PGATELL:1 PLDD < 0.58 ABUT<90 SINGULAR REGION
          R3 = R1 OR R2
          M = FDRC INSIDE CELL '*FR_15X3_*'
          R3 INTERACT (SIZE (R3 XOR M) BY -0.001)
      }

R15.4 { @ Rule 15.4 : PLDD distance to active resistors > 0.26.
      EXT ACTIVERES PLDD < 0.26 ABUT<90
      PLDD  INSIDE EDGE ACTIVERES
      }

R15.5 { @ Rule 15.5 : PLDD distance to poly resistors > 0.26.
      EXT RPOLY PLDD < 0.26 ABUT<90
      PLDD  INSIDE EDGE RPOLY
      }

R15X8 { @ Rule 15.8 : PLDD distance to  N active other than NWELL strap > 0.22.
          R1 = EXT NACTNOSTRN PLDD < 0.22 ABUT<90 REGION
          R2 = EXPAND EDGE (PLDD  INSIDE EDGE NACTNOSTRN) OUTSIDE BY 0.02
          R3 = R1 OR R2
          M = FDRC INSIDE CELL '*FR_15X8_*'
          R3 INTERACT (SIZE (R3 XOR M) BY -0.001)
      }

R15.6 { @ Rule 15.6 : PLDD distance to ACTIVE covered with NEXT or PEXT > 0.26.
      EXT ACTIVEXT PLDD < 0.26 ABUT<90
      PLDD  INSIDE EDGE ACTIVEXT
      }

PLDDSTRAP = PLDDACT AND PWELL:1

R15.imp3 { @ Rule 15.imp3 : ACTIVE strap with PLDD without pplus is not allowed.
             COPY PLDDSTRAP
     }

//  -------------------------------------------------------------------------
//      NPLUS  [Mask level 16]
//  -------------------------------------------------------------------------

R16.1 { @ Rule 16.1 : nplus width >= 0.48.
          INT NPLUS < 0.48 ABUT>0<90 SINGULAR
    }

R16.2 { @ Rule 16.2 : nplus space >= 0.48.
          EXT NPLUS < 0.48 ABUT>0<90 SINGULAR
    }

R16X3 { @ Rule 16.3 : nplus minimum area 0.36.
          R1 = NOT AREA NPLUS >= 0.36
          M = FDRC INSIDE CELL '*FR_16X3_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

ACTNONSTRAPEDGE = ACTNONSTRAP COINCIDENT INSIDE EDGE ACTIVE

R16X4_R16X4a { @ Rule 16.4_16.4a : NPLUS enclosure of N+ active other than NWELL/NWELL2 strap >= 0.26.
                 R2 = ENC ACTNONSTRAPEDGE NPLUS < 0.26 ABUT<90 REGION
         R3 = ENC ACTNONSTRAP NPLUS < 0.26 ABUT<90 SINGULAR REGION
         R4 = R3 NOT ACTIVE
         R = R2 OR R4
                 R1 = R OUTSIDE HC8REC
                 M = FDRC INSIDE CELL '*FR_16X4_*'
                 R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
             }

R16.3_H8a { @ Rule 16.3_H8 : nplus enclosure of N+ active >= 0.20.
              R = ENC ACTNONSTRAPEDGE NPLUS < 0.20 ABUT<90 REGION
          R INSIDE HC8REC
      }

R16.5_R16.5a { @ Rule 16.5_16.5a : NPLUS distance to ACTIVE other than PWELL/PWELL2 strap >= 0.26.
             R = EXT ACTNOPSTRAP NPLUS < 0.26 ABUT<90 SINGULAR REGION
             R OUTSIDE HC8REC
             }

R16.4_H8 { @ Rule 16.4_H8 : nplus dist to P+ active >0.20.
         R = EXT ACTNOSTRAP NPLUS < 0.20 ABUT>0<90 REGION
         R INSIDE HC8REC
     }

R16X6Xa_R16X6Xc { @ Rule 16.6a_16.6c: NPLUS enclosure of NWELL/NWELL2 strap >= 0.1.
                    NSTRAPEDGE = NSTRAP:2_ALL COINCIDENT INSIDE EDGE ACTIVE
            R2 = ENC NSTRAPEDGE NPLUS < 0.1 ABUT<90 REGION
            R3 = ENC NSTRAP:2_ALL NPLUS < 0.1 ABUT<90 SINGULAR REGION
            R4 = R3 NOT ACTIVE
            R1 = R2 OR R4
                    M = FDRC INSIDE CELL '*FR_16X6Xa_*'
                    R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
                }

R16.6b { @ Rule 16.6b: NPLUS enclosure of NWELL strap on that NWELL side,
         @ where distance from NWELL strap to NWELL boundary is <= 0.24, >= 0.18.
           X = ENC NSTRAP:2 NWELL <= 0.24 ABUT<90 REGION
       Y = NSTRAP:2 COINCIDENT EDGE X
       ENC Y NPLUS < 0.18 ABUT>=0<90 REGION
       }

R16.6d { @ Rule 16.6d: NPLUS enclosure of NWELL2 strap on that NWELL2 side,
         @ where distance from NWELL2 strap to NWELL2 boundary is <= 0.24, >= 0.18.
       X = ENC NSTRAP:1_5V NWELL2 <= 0.24 ABUT<90 REGION
       Y = NSTRAP:1_5V COINCIDENT EDGE X
       ENC Y NPLUS < 0.18 ABUT>=0<90 REGION
       }

R16.7a_R16.7c { @ Rule 16.7a_16.7c: NPLUS distance to PWELL/PWELL2 strap >= 0.1.
              R1 = EXT PSTRAP NPLUS < 0.1 ABUT<90 SINGULAR REGION
              R2 = EXT PSTRAP_5V NPLUS < 0.1 ABUT<90 SINGULAR REGION
          R3 = R1 OR R2
          R3 NOT ACTIVE
          }

R16.7b_R16.7d { @ Rule 16.7b_16.7d: NPLUS distance to PWELL/PWELL2 strap on NWELL/NWELL2 side,
                @ if distance from PWELL/PWELL2 strap to NWELL/NWELL2 is <= 0.24, >= 0.18.
              X1 = EXT PSTRAP NWELL <= 0.24 ABUT<90 REGION
              Y1 = PSTRAP COINCIDENT EDGE X1
              EXT Y1 NPLUS < 0.18 ABUT>0<90 REGION

              X2 = EXT PSTRAP NWELL2 <= 0.24 ABUT<90 REGION
              Y2 = PSTRAP COINCIDENT EDGE X2
              EXT Y2 NPLUS < 0.18 ABUT>0<90 REGION

              X3 = EXT PSTRAP_5V NWELL <= 0.24 ABUT<90 REGION
              Y3 = PSTRAP_5V COINCIDENT EDGE X3
              EXT Y3 NPLUS < 0.18 ABUT>0<90 REGION

              X4 = EXT PSTRAP_5V NWELL2 <= 0.24 ABUT<90 REGION
              Y4 = PSTRAP_5V COINCIDENT EDGE X4
              EXT Y4 NPLUS < 0.18 ABUT>0<90 REGION
          }

R16X8_R16X8a { @ Rule 16.8_16.8a : N+ active width of abutting NWELL/NWELL2 strap >= 0.28.
                 R1 = INT NPLUS NSTRTP_ALL < 0.28 ABUT>0<90 SINGULAR MEASURE COINCIDENT REGION
                 M = FDRC INSIDE CELL '*FR_16X8_*'
                 R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
             }

R16.9 { @ Rule 16.9 : POLY gate distance to N+ active of abutting NWELL strap >= 0.4.
          X = PINNW COINCIDENT OUTSIDE EDGE NSTRTP
          ENC PGATW X < 0.4 ABUT<90 PROJECTING
          ENC PGATW X < 0.4 CORNER TO CORNER
      }

R16.9a { @ Rule 16.9a : POLY gate distance to N+ active of abutting NWELL2 strap,
         @              except for H-type devices and OTP >= 0.4.
           X = PINNW2 COINCIDENT OUTSIDE EDGE NSTRTP_5V
           ENC PGATE_5V X < 0.4 ABUT<90 PROJECTING
           ENC PGATE_5V X < 0.4 CORNER TO CORNER
       }

R16.imp1 { @ Rule 16.imp1 : nplus crossing POLY gate not allowed.
            X = GATE NOT SIPROT:1
            NPLUS COINCIDENT INSIDE EDGE X
    }

R16X11 { @ Rule 16.11 : nplus distance to p+ implant in case of abutting strap = 0 (min=max).
           X1 = (ACTIVE NOT PPLUS) AND (ACTIVE NOT NPLUS)
           R1 = ( X1 TOUCH NSTRAP:2 ) OR ( X1 TOUCH PDIFF0:1 )
           M = FDRC INSIDE CELL '*FR_16X11_*'
           R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
       }

POLYR = POFIELD AND MRPO

R16.12 { @ Rule 16.12 : extension on POLY in case of N+ silicided poly resistor >= 0.26.
       R = ENC POLYR NPLUS < 0.26 ABUT <90 REGION
       R OUTSIDE HC8REC
       }

//  -------------------------------------------------------------------------
//      NATIVE  [CAD layer 70]
//  -------------------------------------------------------------------------

R70.1 { @ Rule 70.1 : NATIVE width >= 0.48.
          INT NATIVE < 0.48 ABUT>0<90 SINGULAR
      }

R70.2 { @ Rule 70.2 : NATIVE space >= 0.48.
          EXT NATIVE < 0.48 ABUT>0<90 SINGULAR
      }

R70.3 { @ Rule 70.3 : NATIVE enclosure of unsalicided poly >= 0.3.
          X = POLY AND SIPO
          ENC X NATIVE < 0.3 ABUT<90
      }

R70.4 { @ Rule 70.4 : All unsilicided N+ poly must be covered by NATIVE layer.
          X = ((POLY AND SIPO) AND NPLUS) INTERACT NATIVE
      X NOT NATIVE
      }

R70.5 { @ Rule 70.5 : All unsilicided P+ POLY must be covered by NATIVE.
          X = ((POLY AND SIPO) AND PPLUS) INTERACT NATIVE
      X NOT NATIVE
      }

#IFDEF RPOLYP_CHECK
R70.imp1 { @ Rule 70.imp1 : rpo1p are not recommended.
             (( RPOLY AND PPLUS ) NOT PRESIST) NOT MRHBD:1
     }
#ELSE
#ENDIF

//  -------------------------------------------------------------------------
//      PPLUS  [Mask level 17]
//  -------------------------------------------------------------------------

R17.1 { @ Rule 17.1 : pplus width >= 0.48.
          INT PPLUS < 0.48 ABUT>0<90 SINGULAR
      }

R17.2 { @ Rule 17.2 : pplus space >= 0.48.
          EXT PPLUS < 0.48 ABUT>0<90 SINGULAR
      }

R17.3 { @ Rule 17.3 : pplus minimum area 0.36.
          NOT AREA PPLUS >= 0.36
      }
    
R17.4_R17.4a { @ Rule 17.4_17.4a : PPLUS enclosure of P+ active other than PWELL/PWELL2 strap >= 0.26.
                 ACTNOPSTRAPEDGE = ACTNOPSTRAP COINCIDENT INSIDE EDGE ACTIVE
         R1 = ENC ACTNOPSTRAPEDGE PPLUS < 0.26 ABUT<90 REGION
         R2 = ENC ACTNOPSTRAP PPLUS < 0.26 ABUT<90 SINGULAR REGION
         R3 = R2 NOT ACTIVE
         R = R1 OR R3
             R OUTSIDE HC8REC
             }

ACTNOSTRAPEDGE = ACTNOSTRAP COINCIDENT INSIDE EDGE ACTIVE

R17.3_H8 { @ Rule 17.3_H8 : pplus enclosure of P+ active >= 0.20.
             R = ENC ACTNOSTRAPEDGE PPLUS < 0.20 ABUT<90 REGION
         R INSIDE HC8REC 
     }

R17X5_R17X5a { @ Rule 17.5_17.5a : PPLUS distance to ACTIVE other than NWELL/NWELL2 strap > 0.26.
             R = EXT ACTNONSTRAP PPLUS < 0.26 ABUT<90 SINGULAR REGION
                 R1 = R OUTSIDE HC8REC
                 M = FDRC INSIDE CELL '*FR_17X5_*'
                 R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
             }

R17.4_H8 { @ Rule 17.4_H8 : pplus distance to N+ active > 0.20.
         R = EXT ACTNOSTRAP PPLUS < 0.20 ABUT>0<90 REGION
         R INSIDE HC8REC
     }

R17X6Xa_R17X6Xc { @ Rule 17.6a_17.6c : PPLUS enclosure of PWELL/PWELL2 strap >= 0.1.
                    PSTRAPEDGE = PSTRAP_ALL COINCIDENT INSIDE EDGE ACTIVE
                    R2 = ENC PSTRAPEDGE PPLUS < 0.1 ABUT<90 REGION
            R3 = ENC PSTRAP_ALL PPLUS < 0.1 ABUT<90 SINGULAR REGION
            R4 = R3 NOT ACTIVE
            R1 = R2 OR R4
                    M = FDRC INSIDE CELL '*FR_17X6Xa_*'
                    R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
                }

R17.6b { @ Rule 17.6b: PPLUS enclosure of PWELL strap on that PWELL side,
         @ where distance from PWELL strap to PWELL boundary is <= 0.24, >= 0.18.
       X = EXT PSTRAP WELL_ALL <= 0.24 ABUT<90 PROJECTING REGION
       Y = PSTRAP COINCIDENT EDGE X
       ENC Y PPLUS < 0.18 ABUT>0<90
    }

R17.6d { @ Rule 17.6d : PPLUS enclosure of PWELL2 strap on that PWELL2 side,
         @ where distance from PWELL2 strap to PWELL2 boundary is <= 0.24, >= 0.18.
       X = ENC PSTRAP_5V PWELL2 <= 0.24 ABUT<90 PROJECTING REGION
       Y = PSTRAP_5V COINCIDENT EDGE X
       ENC Y PPLUS < 0.18 ABUT>0<90
    }

R17.7a_R17.7c { @ Rule 17.7a_17.7c : PPLUS distance to NWELL/NWELL2 strap >= 0.1.
              R = EXT NSTRAP:2_ALL PPLUS < 0.1 ABUT<90 SINGULAR REGION
          R NOT ACTIVE
          }

R17.7b_R17.7d { @ Rule 17.7b_17.7d : PPLUS distance to NWELL/NWELL2 strap on PWELL/PWELL2 side,
                  @ if distance from NWELL/NWELL2 strap to PWELL/PWELL2 is <= 0.24, >= 0.18.
                X1 = ENC NSTRAP:1 NWELL_ALL <= 0.24 ABUT<90 REGION
                Y1 = NSTRAP:1 COINCIDENT EDGE X1
                EXT Y1 PPLUS < 0.18 ABUT>0<90 REGION
        
                X2 = EXT NSTRAP:1 PWELL2 <= 0.24 ABUT<90 REGION
                Y2 = NSTRAP:1 COINCIDENT EDGE X2
                EXT Y2 PPLUS < 0.18 ABUT>0<90 REGION
        
                X3 = ENC NSTRAP:1_5V NWELL_ALL <= 0.24 ABUT<90 REGION
                Y3 = NSTRAP:1_5V COINCIDENT EDGE X3
                EXT Y3 PPLUS < 0.18 ABUT>0<90 REGION
        
                X4 = EXT NSTRAP:1_5V PWELL2 <= 0.24 ABUT<90 REGION
                Y4 = NSTRAP:1_5V COINCIDENT EDGE X4
                EXT Y4 PPLUS < 0.18 ABUT>0<90 REGION
            }

R17.8_R17.8a { @ Rule 17.8_17.8a : P+ active width of abutting PWELL/PWELL2 strap >= 0.28.
                 INT PPLUS PSTRTN_ALL < 0.28 ABUT>0<90 SINGULAR MEASURE COINCIDENT
         }

R17.9 { @ Rule 17.9 : POLY gate space to P+ active of abutting PWELL strap >= 0.4.
          X = NINPW COINCIDENT OUTSIDE EDGE PSTRTN
          ENC NGATW X < 0.4 ABUT<90 PROJECTING
          ENC NGATW X < 0.4 CORNER TO CORNER
      }

R17.9a { @ Rule 17.9a : POLY gate space to P+ active of abutting PWELL2 strap,
         @              except for H-type devices and OTP >= 0.4.
           X = NINPW2 COINCIDENT OUTSIDE EDGE PSTRTN_5V
           ENC NGATE_5V X < 0.4 ABUT<90 PROJECTING
           ENC NGATE_5V X < 0.4 CORNER TO CORNER
       }

R17.imp1 { @ Rule 17.imp1 : pplus crossing POLY gate is not allowed.
             X = GATE NOT SIPROT:1
             PPLUS COINCIDENT INSIDE EDGE X
    }

R17.11 { @ Rule 17.11 : pplus distance to n+ implant in case of abutting strap = 0 (min=max).
            X1 = (ACTIVE NOT PPLUS) AND (ACTIVE NOT NPLUS)
       (X1 TOUCH PSTRAP ) OR (X1 TOUCH NDIFF0:1 )
    }

R17.12 { @ Rule 17.12 : Superposition of N+ and P+ implant is not allowed.
      NPLUS AND PPLUS
       }

//  -------------------------------------------------------------------------
//      SIPROT  [Mask level 18]
//  -------------------------------------------------------------------------

POLYP = POLY AND PPLUS
POLYN = POLY AND NPLUS

R18.1 { @ Rule 18.1 : SIPROT width >= 0.48.
          INT SIPROT < 0.48 ABUT>0<90 SINGULAR
      }

R18.1.special_app { @ Rule 18.1 : SIPROT width >= 0.40 (special application).
                      INT SIPROT_RHBD:1 < 0.48 ABUT>0<90 SINGULAR
                  }

R18.2 { @ Rule 18.2 : SIPROT space >= 0.48.
          EXT SIPROT < 0.48 ABUT>0<90 SINGULAR
      }

R18.2.special_app { @ Rule 18.2 : SIPROT space >= 0.40 (special application).
                      EXT SIPROT_RHBD:1 < 0.40 ABUT>0<90 SINGULAR
              }

R18.3 { @ Rule 18.3 : SIPROT extension on ACTIVE for unsalicided S/D >= 0.3.
          ENC ACTIVE SIPROT < 0.3 ABUT<90 SINGULAR
      }

R18.3.special_app { @ Rule 18.3 (special application): SIPROT extension on ACTIVE for unsalicided S/D >= 0.26.
                      ENC ACTIVE SIPROT_RHBD:1 < 0.26 ABUT<90 SINGULAR
              }

R18.4 { @ Rule 18.4 : SIPROT intersection of ACTIVE for unsalicided S/D >= 0.24.
          INT SIPROT ACTIVE < 0.24 ABUT<90 SINGULAR MEASURE COINCIDENT
      }

R18.4.special_app { @ Rule 18.4 : SIPROT intersection of ACTIVE for unsalicided S/D >= 0.22 (special application).
                      INT SIPROT_RHBD:1 ACTIVE < 0.22 ABUT<90 SINGULAR MEASURE COINCIDENT
              }

R18.5 { @ Rule 18.5 : ACTIVE extension on salicide protection >= 0.32.
          ENC SIPROT ACTIVE < 0.32 ABUT<90 SINGULAR
      }

R18.5.special_app { @ Rule 18.5 : ACTIVE extension on salicide protection >= 0.28 (special application).
                      ENC SIPROT_RHBD:1 ACTIVE < 0.28 ABUT<90 SINGULAR
              }

R18.6 { @ Rule 18.6 : SIPROT extension on POLY on ACTIVE >= 0.56.
          ENC NGATW SIPAC < 0.56 ABUT<90
          ENC PGATW SIPAC < 0.56 ABUT<90
      }

R18.6.special_app { @ Rule 18.6 : SIPROT extension on POLY on ACTIVE >= 0.50 (special application).
                      ENC NGATW SIPAC_RHBD:1 < 0.50 ABUT<90
                      ENC PGATW SIPAC_RHBD:1 < 0.50 ABUT<90
              }

ACTSIP = SIPROT AND ACTIVE
SIPAC = SIPROT COINCIDENT INSIDE EDGE ACTSIP

ACTSIP_RHBD:1 = SIPROT_RHBD:1 AND ACTIVE
SIPAC_RHBD:1 = SIPROT_RHBD:1 COINCIDENT INSIDE EDGE ACTSIP_RHBD:1
 
R18.7 { @ Rule 18.7 : distance to CONTACT (on ACTIVE or on POLY) >= 0.2.
          EXT SIPROT CTA:4 < 0.2 ABUT<90 SINGULAR
          EXT SIPROT CTP:3 < 0.2 ABUT<90 SINGULAR
    }

R18.7.special_app { @ Rule 18.7 (special application): distance to CONTACT (on ACTIVE or on POLY) >= 0.18.
                      EXT SIPROT_RHBD:1 CTA:4 < 0.18 ABUT<90 SINGULAR
                      EXT SIPROT_RHBD:1 CTP:3 < 0.18 ABUT<90 SINGULAR
              }

R18.8 { @ Rule 18.8 : SIPROT space to ACTIVE on field >= 0.24.
          EXT SIPROT ACTIVE < 0.24 ABUT<90 SINGULAR
      }

R18.8.special_app { @ Rule 18.8 (special application): SIPROT space to ACTIVE on field >=0.22.
                      EXT SIPROT_RHBD:1 ACTIVE < 0.22 ABUT<90 SINGULAR
              }   

R18.9 { @ Rule 18.9 : SIPROT space to POLY on field >= 0.24.
          EXT SIPROT POFIELD < 0.24 ABUT<90 SINGULAR
      }

R18.9.special_app { @ Rule 18.9 (special application): SIPROT space to POLY on field >= 0.22.
                      EXT SIPROT_RHBD:1 POFIELD < 0.22 ABUT<90 SINGULAR
              }

R18.10 { @ Rule 18.10 : SIPROT distance to LIL >= 0.2.
           EXT LIL SIPROT < 0.2 ABUT<90 SINGULAR
       }

R18.10.special_app { @ Rule 18.10 (special application): SIPROT distance to LIL >= 0.18.
                       EXT LIL SIPROT_RHBD:1 < 0.18 ABUT<90 SINGULAR
               }

R18.11 { @ Rule 18.11 : SIPROT extension on POLY on field >= 0.3
           ENC POFIELD SIPROT < 0.3 ABUT<90 SINGULAR
       }

R18.11.special_app { @ Rule 18.11 (special application): SIPROT extension on POLY on field >= 0.26.
                       ENC POFIELD SIPROT_RHBD:1 < 0.26 ABUT<90 SINGULAR
               }

R18.12 { @ Rule 18.12 : salicide protection must overlap gate on both sides.
          ALLGATE CUT SIPROT
    }
 
R18.13 { @ Rule 18.13 : SIPROT on ACTIVE distance to POLY gate >= 0.4.
           EXT NGATW SIPAC < 0.4 ABUT<90
           EXT PGATW SIPAC < 0.4 ABUT<90
       }

R18.13.special_app { @ Rule 18.13 : SIPROT on ACTIVE distance to POLY gate >= 0.36.
                       EXT NGATW SIPAC_RHBD:1 < 0.36 ABUT<90
                       EXT PGATW SIPAC_RHBD:1 < 0.36 ABUT<90
               }

R18.14 { @ Rule 18.14 : pplus or nplus crossing unsalicided POLY not allowed except for RHIPO resistor.
        PPLUS INSIDE EDGE ( (POLY AND SIPROT) NOT PRESIST )
       NPLUS INSIDE EDGE ( (POLY AND SIPROT) NOT PRESIST )
       }

PPOLP = PPLUS COIN INSIDE EDGE POLYP
PPOLN = NPLUS COIN INSIDE EDGE POLYN

R18.15 { @ Rule 18.15 : N+ poly extension on SIPROT >= 0.48.
           ENC SIPROT PPOLN < 0.48 ABUT<90
       }

R18.15.special_app { @ Rule 18.15 (special application): N+ poly extension on SIPROT >= 0.44.
                       ENC SIPROT_RHBD:1 PPOLN < 0.44 ABUT<90
               } 

R18.16 { @ Rule 18.16 : P+ poly extension on SIPROT >= 0.48.
           ENC SIPROT PPOLP < 0.48 ABUT<90
       }

R18.16.special_app { @ Rule 18.16 (special application): P+ poly extension on SIPROT >= 0.44.
                       ENC SIPROT_RHBD:1 PPOLP < 0.44 ABUT<90
               }

STRT = NSTRTP OR PSTRTN
ACT_NOT_SIPROT = ACTIVE NOT SIPROT
 
R18.17 { @ Rule 18.17 : SIPROT must cross P+ implant boundary in case of abutting strap.
           ACT_NOT_SIPROT INSIDE STRT
       }

R18.18 { @ Rule 18.18 : N+ ACTIVE extention on SIPROT in case of abutting PWELL strap >= 0.48.
           X = PSTRTN COINCIDENT OUTSIDE EDGE NACTIVE
           EXT X SIPAC < 0.48 ABUT<90
       }

R18.18.special_app { @ Rule 18.18 (special application): N+ ACTIVE extention on SIPROT in case of abutting PWELL strap >= 0.44.
                       X = PSTRTN COINCIDENT OUTSIDE EDGE NACTIVE
                       EXT X SIPAC_RHBD:1 < 0.44 ABUT<90
               }

R18.18a { @ Rule 18.18a : N+ ACTIVE extention on SIPROT in case of abutting PWELL2 strap >= 0.48.
                          X = PSTRTN_5V COINCIDENT OUTSIDE EDGE NACTIVE
                          EXT X SIPAC < 0.48 ABUT<90
    }

R18.19 { @ Rule 18.19 : P+ ACTIVE extention on SIPROT in case of abutting NWELL strap >= 0.48.
           X = PPLUS COINCIDENT OUTSIDE EDGE NSTRTP
           ENC SIPAC X < 0.48 ABUT<90
       } 

R18.19.special_app { @ Rule 18.19 (special application): P+ ACTIVE extention on SIPROT in case of abutting NWELL strap >= 0.44.
                       X = PPLUS COINCIDENT OUTSIDE EDGE NSTRTP
                       ENC SIPAC_RHBD:1 X < 0.44 ABUT<90
               } 

R18.19a { @ Rule 18.19a : P+ ACTIVE extention on SIPROT in case of abutting NWELL2 strap >= 0.48.
            X = PPLUS COINCIDENT OUTSIDE EDGE NSTRTP_5V
            ENC SIPAC X < 0.48 ABUT<90
    } 

R18.20 { @ Rule 18.20 : POLY extension on SIPROT >= 0.32.
           ENC SIPROT POLY < 0.32 ABUT<90 SINGULAR
       }

R18.20.special_app { @ Rule 18.20 (special application): POLY extension on SIPROT >= 0.28.
                       ENC SIPROT_RHBD:1 POLY < 0.28 ABUT<90 SINGULAR
                   }

R18.21 { @ Rule 18.21 : SIPROT intersection of POLY for unsalicided POLY >= 0.24.
           INT SIPROT POLY < 0.24 ABUT<90 SINGULAR MEASURE COINCIDENT
       }

R18.21.special_app { @ Rule 18.21 (special application): SIPROT intersection of POLY for unsalicided POLY >= 0.22.
                       INT SIPROT_RHBD:1 POLY < 0.22 ABUT<90 SINGULAR MEASURE COINCIDENT
               }

R18.22 { @ Rule 18.22 : nplus enclosure of unsalicided POLY >= 0.3.
           X = SIPO COINCIDENT INSIDE EDGE POLY
           ENC X NPLUS < 0.3 ABUT<90
       }

R18.22.special_app { @ Rule 18.22 (special application): nplus enclosure of unsalicided POLY >= 0.26.
          X = SIPO_RHBD:1 COINCIDENT INSIDE EDGE POLY
          ENC X NPLUS < 0.26 ABUT<90
        }
                
R18.23 { @ Rule 18.23 : pplus enclosure of unsalicided POLY >= 0.3.
           X = SIPO COINCIDENT INSIDE EDGE POLY
           ENC X PPLUS < 0.3 ABUT<90
       }

R18.23.special_app { @ Rule 18.23 (special application): pplus enclosure of unsalicided POLY >= 0.26.
                       X = SIPO_RHBD:1 COINCIDENT INSIDE EDGE POLY
                       ENC X PPLUS < 0.26 ABUT<90
                   }

MRESACT = MRES AND ACTIVE
MRESPO = (MRES AND POLY) INTERACT SIPROT
MRESDEV = MRESACT OR MRESPO

R18.imp1 { @ Rule 18.imp1 : SIPROT over marker mres is required.
             MRESDEV NOT SIPROT
         }

R18.24 { @ Rule 18.24 : Unsalicided POLY distance to unsalicided ACTIVE >= 0.52.
           X = POLY AND SIPROT
       Y = ACTIVE AND SIPROT
       EXT X Y < 0.52 ABUT<90 SINGULAR
       }

R18.24.special_app { @ Rule 18.24 (special application): Unsalicided POLY distance to unsalicided ACTIVE >= 0.46.
                       X = POLY AND SIPROT_RHBD:1
                   Y = ACTIVE AND SIPROT_RHBD:1
                   EXT X Y < 0.46 ABUT<90 SINGULAR
               }

//  -------------------------------------------------------------------------
//      CONTACT  [Mask level 19]
//  -------------------------------------------------------------------------

BADCT:1 = (CONTACT NOT ACTIVE) NOT POLY
BADCT:2 = BADCT:1 NOT LILEXT:1

//  Rule 19.7 : Enclosure of P+ or N+ in abutting straps
//  Contact overlapping both PPLUS & NPLUS allowed in abutting
//  straps because of shorting by silicide.

R19.1 { @ Rule 19.1 : CONTACT width 0.24 X 0.24.
          NOT RECTANGLE CONTACT == 0.24 BY == 0.24
      }

R19.2 { @ Rule 19.2 : CONTACT space >= 0.32.
          EXT CONTACT < 0.32 ABUT>0<90 SINGULAR
      }

R19.3 { @ Rule 19.3 : CONTACT enclosure by POLY >= 0.02.
          X = CTP:3 NOT LILEXT:1
          ENC X POLY < 0.02 ABUT<90 SINGULAR OUTSIDE ALSO
      }

R19.4 { @ Rule 19.4 : CONTACT enclosure by ACTIVE  >= 0.02.
          X = CTA:4 NOT LILEXT:1
          ENC X ACTIVE < 0.02 ABUT<90 SINGULAR OUTSIDE ALSO
      }

R19.5 { @ Rule 19.5 : CONTACT on POLY distance to unrelated ACTIVE >= 0.14.
          EXT CTP:3 ACTIVE < 0.14 ABUT<90 SINGULAR
      }

R19.6 { @ Rule 19.6 : CONTACT on ACTIVE distance to unrelated POLY >= 0.14.
          X_0 = CTA:4 NOT CONTACT_30
          X_30 = CTA:4 AND CONTACT_30
          EXT X_0 LPOLY_0 < 0.14 ABUT<90 SINGULAR INSIDE ALSO
          EXT X_0 POLY_30 < 0.14 ABUT<90 SINGULAR INSIDE ALSO
          EXT X_30 LPOLY_0 < 0.14 ABUT<90 SINGULAR INSIDE ALSO
      }

R19.8 { @ Rule 19.8 : CONTACT to POLY over ACTIVE is forbidden.
          CTP:3 AND ACTIVE
      }

R19.9 { @ Rule 19.9 : CONTACT inside silicide protection is not allowed.
          CONTACT AND SIPROT
      }

R19Ximp1 { @ Rule 19.imp1 : CONTACT without ACTIVE nor POLY nor LIL.
             R1 = COPY BADCT:2
             M = FDRC INSIDE CELL '*FR_19Ximp1_*'
             R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
         }

//R19.imp2 { @ Rule 19.imp2 : CONTACT is not covered by ME1.
//         CONTACT NOT ME1
//    }
// Checked by OUTSIDE ALSO in R23.3

//  -------------------------------------------------------------------------
//      METAL1  [Mask level 23]
//  -------------------------------------------------------------------------
 
R23.1 { @ Rule 23.1 : ME1 minimum width >= 0.32.
          INT ME1 < 0.32 ABUT>0<90 SINGULAR
      }

R23X2 { @ Rule 23.2 : ME1 minimum space >= 0.32.
          R1 = EXT ME1 < 0.32 ABUT>0<90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_23X2_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R23X3_R19Ximp2 { @ Rule 23.3 : ME1 enclosure of CONTACT >= 0.04.
                 @ Rule 19.imp2 : CONTACT is not covered by ME1.
                   R1 = ENC CONTACT ME1 < 0.04 ABUT<90 SINGULAR OUTSIDE ALSO REGION
                   M = FDRC INSIDE CELL '*FR_23X3_R19Ximp2_*'
                   R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
               }

//M1 dummy datatype 4 minimum area rule 23.du3 = 0,3072
R23X5 { @ Rule 23.5 : ME1 minimum area 0.2 (except dummy datatype 4).
          R1 = NOT AREA ME1 >= 0.2
          M = FDRC INSIDE CELL '*FR_23X5_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

//  -------------------------------------------------------------------------
//      VIA1  [Mask level 25]
//  -------------------------------------------------------------------------

R25.1 { @ Rule 25.1 : VI1 size 0.32 X 0.32.
          NOT RECTANGLE NBPDV1 == 0.32 BY == 0.32
      }

R25.2 { @ Rule 25.2 : VI1 space >= 0.32.
          EXT NBPDV1 < 0.32 ABUT>0<90 SINGULAR
      }

R25.3_R25.imp1 { @ Rule 25.3 : VI1 enclosure by ME1 >= 0.0.
                 @ Rule 25.imp1 : VI1 without ME1.
                   NBPDV1 NOT ME1
           }

//Rule 25.imp2 : VI1 is not covered by ME2.
//Already checked by Rule 27.3.

//  -------------------------------------------------------------------------
//      METAL2  [Mask level 27]
//  -------------------------------------------------------------------------

R27.1 { @ Rule 27.1 : ME2 width >= 0.32.
          INT ME2 < 0.32 ABUT>0<90 SINGULAR
      }

R27X2 { @ Rule 27.2 : ME2 space >= 0.32.
          R1 = EXT ME2 < 0.32 ABUT>0<90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_27X2_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R27.3 { @ Rule 27.3 : ME2 enclosure of VI1 >= 0.00.
          NBPDV1 NOT ME2 
      }

//M2 dummy datatype 4 minimum area rule 27.du3 = 0,3072
R27X5 { @ Rule 27.5 : ME2 minimum area 0.2 (except dummy datatype 4).
          R1 = NOT AREA ME2 >= 0.2
          M = FDRC INSIDE CELL '*FR_27X5_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

//  -------------------------------------------------------------------------
//      VIA2  [Mask level 32]
//  -------------------------------------------------------------------------

R32.1 { @ Rule 32.1 : VI2 size 0.32 X 0.32.
          NOT RECTANGLE NBPDV2 == 0.32 BY == 0.32
      }

R32.2 { @ Rule 32.2 : VI2 space >= 0.32.
          EXT NBPDV2 < 0.32 ABUT>0<90 SINGULAR
      }

R32.3_R32.imp1 { @ Rule 32.3 : VI2 enclosure by ME2 >= 0.0.
                 @ Rule 32.imp1 : VI2 without ME2.
                   NBPDV2 NOT ME2
           }

//Rule 32.imp2 : VI2 is not covered by ME3.
//Already checked by Rule 34.3.

//  -------------------------------------------------------------------------
//      METAL3  [Mask level 34]
//  -------------------------------------------------------------------------

R34.1 { @ Rule 34.1 : ME3 width >= 0.32.
          INT ME3 < 0.32 ABUT>0<90 SINGULAR
      }

R34.2 { @ Rule 34.2 : ME3 space >= 0.32.
          EXT ME3 < 0.32 ABUT>0<90 SINGULAR
      }

R34.3 { @ Rule 34.3 : ME3 enclosure of VI2 >= 0.0.
          NBPDV2 NOT ME3
      }

//M3 dummy datatype 4 minimum area rule 34.du3 = 0,3072
R34X5 { @ Rule 34.5 : ME3 minimum area 0.2 (except dummy datatype 4).
          R1 = NOT AREA ME3 >= 0.2
          M = FDRC INSIDE CELL '*FR_34X5_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

//  -------------------------------------------------------------------------
//      VIA3  [Mask level 35]
//  -------------------------------------------------------------------------
 
R35.1 { @ Rule 35.1 : VI3 size 0.32 X 0.32.
          NOT RECTANGLE NBPDV3 == 0.32 BY == 0.32
      }

R35.2 { @ Rule 35.2 : VI3 space >= 0.32.
          EXT NBPDV3 < 0.32 ABUT>0<90 SINGULAR
      }

R35.3_R35.imp1 { @ Rule 35.3 : VI3 enclosure by ME3 >= 0.0.
                 @ Rule 35.imp1 : VI3 without ME3.
                   NBPDV3 NOT ME3
           }

//Rule 35.imp2 : VI3 is not covered by ME4.
//Already checked by Rule 36.3.

//  -------------------------------------------------------------------------
//      METAL4  [Mask level 36]
//  -------------------------------------------------------------------------

R36.1 { @ Rule 36.1 : ME4 width  >= 0.32.
          INT ME4 < 0.32 ABUT>0<90 SINGULAR
    }

R36.2 { @ Rule 36.2 : ME4 space >= 0.32.
          EXT ME4 < 0.32 ABUT>0<90 SINGULAR
      }

R36.3 { @ Rule 36.3 : ME4 enclosure of VI3 >= 0.0.
          NBPDV3 NOT ME4
      }

//M4 dummy datatype 4 minimum area rule 36.du3 = 0,3072
R36.5 { @ Rule 36.5 : ME4 minimum area 0.2 (except dummy datatype 4).
          NOT AREA ME4 >= 0.2
      }

//  -------------------------------------------------------------------------
//      VIA4  [Mask level 52]
//  -------------------------------------------------------------------------

R52.1 { @ Rule 52.1 : VI4 size 0.32 X 0.32.
          NOT RECTANGLE NBPDV4 == 0.32 BY == 0.32
      }

R52.2 { @ Rule 52.2 : VI4 minimum space >= 0.32.
          EXT NBPDV4 < 0.32 ABUT>0<90 SINGULAR
      }

R52.3_R52.imp1 { @ Rule 52.3 : VI4 enclosure by ME4 >= 0.0.
                 @ Rule 52.imp1 : VI4 without ME4.
                   NBPDV4 NOT ME4
           }

//Rule 52.imp2 : VI4 is not covered by ME5.
//Already checked by Rule 53.3.

//  -------------------------------------------------------------------------
//      METAL5  [Mask level 53]
//  -------------------------------------------------------------------------

R53.1 { @ Rule 53.1 : ME5 width >= 0.64.
          INT ME5 < 0.64 ABUT>0<90 SINGULAR
      }

R53.3 { @ Rule 53.3 : ME5 enclosure of VI4 >= 0.16.
          ENC NBPDV4 ME5 < 0.16 ABUT<90 SINGULAR OUTSIDE ALSO
      }

ME5NOMIM:1 = ME5 NOT MIM5PLATE

R53.2 { @ Rule 53.2 : ME5 space >= 0.64.
          EXT ME5NOMIM:1 < 0.64 ABUT>0<90 SINGULAR
      }

//  -------------------------------------------------------------------------
//      VIA5  [Mask level 54]
//  -------------------------------------------------------------------------

R54.1 { @ Rule 54.1 : VI5 size 0.6 X 0.6.
          NOT RECTANGLE NBPDV5 == 0.6 BY == 0.6
      }

R54.2 { @ Rule 54.2 : VI5 space >= 0.36.
          EXT NBPDV5 < 0.36 ABUT>0<90 SINGULAR
      }

R54.3_R54.imp1 { @ Rule 54.3 : VI5 enclosure by ME5 >= 0.02.
                 @ Rule 54.imp1 : VI5 without ME5.
                   ENC NBPDV5 ME5 < 0.02 ABUT<90 SINGULAR OUTSIDE ALSO
           }

//Rule 54.imp2 : VI5 is not covered by ME6.
//Already checked by Rule 55.3.

//  -------------------------------------------------------------------------
//      METAL6  [Mask level 55]
//  -------------------------------------------------------------------------

R55.1 { @ Rule 55.1 : ME6 width >= 0.64.
          INT ME6 < 0.64 ABUT>0<90 SINGULAR
      }

R55.2 { @ Rule 55.2 : ME6 space >= 0.64.
          EXT ME6 < 0.64 ABUT>0<90 SINGULAR
      }

R55.3 { @ Rule 55.3 : ME6 enclosure of VI5 >= 0.02.
          ENC NBPDV5 ME6 < 0.02 ABUT<90 SINGULAR OUTSIDE ALSO
      }

//  -------------------------------------------------------------------------
//      VFB  [Mask level 64]
//  -------------------------------------------------------------------------

#IFDEF BUMPING

R64.1 { @ Rule 64.1 : VFB size 0.6 X 0.6.
          NOT RECTANGLE NBPDVFB == 0.6 BY == 0.6
      }

R64.2 { @ Rule 64.2 : VFB space >= 0.36
         EXT NBPDVFB < 0.36 ABUT>0<90 SINGULAR
    }
 
R64.3_R64.imp1 { @ Rule 64.3 : VFB enclosure by ME6 >= 0.3.
                 @ Rule 64.imp1 : VFB without ME6.
                   ENC NBPDVFB ME6 < 0.3 ABUT<90 SINGULAR OUTSIDE ALSO
           }

#ELSE

R64.imp3{ @ Rule 64.imp3 : VFB is forbidden
        ( VFB OR VFB_nsz) OR VFB_fsz
        }

#ENDIF
 
//Rule 64.imp2 : VFB not covered by PRL.
//Already checked by Rule 66.3.
 
//  -------------------------------------------------------------------------
//      PRL  [Mask level 66]
//  -------------------------------------------------------------------------

#IFDEF BUMPING

R66.1 { @ Rule 66.1 : PRL width >= 10.0.
          INT PRL < 10.0 ABUT>0<90 SINGULAR
      }

R66.2 { @ Rule 66.2 : PRL space >= 4.0.
          EXT PRL < 4.0 ABUT>0<90 SINGULAR
      }

R66.3 { @ Rule 66.3 : PRL enclosure of VFB >= 1.0.
          ENC NBPDVFB PRL < 1.0 ABUT<90 SINGULAR OUTSIDE ALSO
      }

R66.4 { @ Rule 66.4 : PRL is not allowed for routing.
          PRL NOT INTERACT PAD_FC
      }
#ELSE

R66.imp1{ @ Rule 66.imp1 : PRL is forbidden.
        ( PRL OR PRL_nsz) OR PRL_fsz
        }
#ENDIF

//  -------------------------------------------------------------------------
//      LIL     [Mask level 39]
//  -------------------------------------------------------------------------

R39X1 { @ Rule 39.1 : LIL width = 0.24.
          R1 = INT LILEXT:1 < 0.24 ABUT>0<90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_39X1_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R39X1X { @ Rule 39.1.a : LIL maximum width = 0.24.
           LILS:1 = SIZE LILEXT:1  BY -0.12
           LILS:2 = SIZE LILS:1 BY 0.12
           R1 = LILEXT:1 AND LILS:2
           M = FDRC INSIDE CELL '*FR_39X1X_*'
           R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
       }

R39X2 { @ Rule 39.2 : LIL minimum space >= 0.32.
          R1 = EXT LILEXT:1 < 0.32 ABUT>0<90  SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_39X2_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R39X3 { @ Rule 39.3 : LIL minimum intersection with POLY >= 0.24.
          POLIBAD = INT LILPOL < 0.24 ABUT<90 OPPOSITE REGION
          POLILOK = AREA (LILPOL NOT POLIBAD) >= 0.0576 
          POLIBUT = POLIBAD TOUCH POLILOK
          R1 = ((LILPOL NOT POLILOK) NOT POLIBUT ) AND POLIBAD
          M = FDRC INSIDE CELL '*FR_39X3_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R39X4 { @ Rule 39.4 : LIL minimum intersection with ACTIVE >= 0.24.
          ACLIBAD = INT LILACT < 0.24 ABUT<90 OPPOSITE REGION
          ACLILOK = AREA (LILACT NOT ACLIBAD) >= 0.0576
          ACLIBUT = ACLIBAD TOUCH ACLILOK
          R1 = ((LILACT NOT ACLILOK) NOT ACLIBUT ) AND ACLIBAD
          M = FDRC INSIDE CELL '*FR_39X4_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R39X5 { @ Rule 39.5 : LIL distance to unrelated ACTIVE >= 0.14.
          R1 = EXT LILINT SALI < 0.14 NOT CONNECTED ABUT<90 SINGULAR REGION
          M = FDRC INSIDE CELL '*FR_39X5_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

//39.5 can works with 2.5 or 39.2 rules,maybe was problems with ABUT on earlier version of calibre - decided keep first version.
R39.5 { @ Rule 39.5 : LIL distance to unrelated ACTIVE >= 0.14.
      LILSZ = LIL SIZE BY -0.02
      ACTLIL = ACTIVE OR LILSZ 
      EXT ACTLIL < 0.04 SPACE ABUT<90 SINGULAR
      }

R39X5X { @ Rule 39.5 : LIL distance to unrelated ACTIVE >= 0.14.
           R1 = EXT LILINT LDDSALI < 0.14 NOT CONNECTED ABUT<90 SINGULAR REGION
           M = FDRC INSIDE CELL '*FR_39X5X_*'
           R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
       }

R39.6 { @ Rule 39.6 : LIL distance to unrelated POLY >= 0.14.
          EXT POLCONN:3 LILINT  < 0.14  NOT CONNECTED REGION
          EXT LILINT POLCONN:3 < 0.1  SINGULAR CORNER NOT CONNECTED
          Y = TOUCH POLCONN:3 LILINT
      X = COINCIDENT OUTSIDE EDGE Y LILINT
      COPY X
      }

R39X7 { @ Rule 39.7 LIL distance to CONTACT >= 0.32.
      TMPLIL = EXT LILINT CONTACT < 0.32 SINGULAR ABUT>=0<90 REGION
          R1 = TMPLIL OUTSIDE LILINT
          M = FDRC INSIDE CELL '*FR_39X7_*'
          R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
      }

R39.7 { @ Rule 39.7 LIL distance to CONTACT >= 0.32.
      X = COINCIDENT OUTSIDE EDGE LIL CONTACT
      LENGTH X < 0.24
      }

R39.8 { @ Rule 39.8 : LIL contact to POLY over ACTIVE not allowed.
          LILEXT:1 AND ACTPOL:1 
      }

LILENCPO1 = LILPOL INSIDE EDGE LILEXT:1
LILENCPO2 = EXPAND EDGE LILENCPO1 INSIDE BY 0.021
LILENCPO3 = LILPOL NOT LILENCPO2
LILENCPO4 = LENGTH LILENCPO3 != 0.24

R39X9 { @ Rule 39.9 : LIL enclosure by POLY >= 0.02.
          R1 = ENC LILENCPO4 POLY < 0.02 ABUT>45<90  REGION
          R2 = ENC LILENCPO4 POLY < 0.02 ABUT<45 REGION
          R3 = R1 OR R2
          R4 = EXPAND EDGE (LILEXT:1 COINCIDENT INSIDE EDGE POLY) OUTSIDE BY 0.02
          R5 = R3 OR R4
          M = FDRC INSIDE CELL '*FR_39X9_*'
          R5 INTERACT (SIZE (R5 XOR M) BY -0.001)
      }

LILCUTACT = LILEXT:1 NOT (LILEXT:1 INSIDE ACTIVE)
LILIN1  =  LILCUTACT AND ACTIVE
LILNOIN1=  LILCUTACT NOT ACTIVE

R39X10Xa { @ Rule 39.10a : LIL enclosure by ACTIVE if length of intersection with ACTIVE is < 0.48 >= 0.02.
         LILMIS  =  AREA LILIN1 < 0.1152
         LILCONF:0 =  (LILMIS AND ACTIVE ) NOT SIPROT 
         LILINACT = LILCONF:0 INSIDE EDGE ACTIVE
         LILINACT2 = INT LILINACT == 0.24 OPPOSITE REGION
         LILINACT3 = AREA LILINACT2 >= 0.0576
         LILCONF:1 = LILCONF:0 OUTSIDE LILINACT3    
         LILENC1 = COINCIDENT OUTSIDE EDGE LILCONF:1 LILNOIN1
         LILENC2 = LILCONF:1 INSIDE EDGE BULK
         LILENC30 =  LILENC2 NOT COINCIDENT EDGE LILENC1
         LILENC3 = LENGTH LILENC30 != 0.24
             R1 = ENC LILENC3 ACTIVE < 0.02 ABUT<90  OPPOSITE REGION
             M = FDRC INSIDE CELL '*FR_39X10Xa_*'
             R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
         }

R39.10a { @ Rule 39.10a : LIL enclosure by ACTIVE if length of intersection with ACTIVE is < 0.48 >= 0.02.
        LILSQ = AREA LILIN1 == 0.0576
        LIL24ENC1 = COINCIDENT OUTSIDE EDGE LILSQ LILNOIN1
        LIL24ENC2 = LILSQ INSIDE EDGE BULK
            LIL24ENC3 =  LIL24ENC2 NOT COINCIDENT EDGE LIL24ENC1
        LILCOINACT = LILEXT:1 INSIDE ACTIVE 
        LIL24BIS = AREA LILCOINACT == 0.0576
        LIL24ENC1BIS = COINCIDENT EDGE LIL24BIS ACTIVE
        LIL24ENC1BISEXP = EXPAND EDGE  LIL24ENC1BIS INSIDE BY 0.02
        LIL24ENC1BISSZ = EXPAND EDGE  LIL24ENC1BIS OUTSIDE BY 0.02
        LIL24COIN = LIL24ENC1BISSZ TOUCH  LIL24ENC1BISEXP >= 2
        ENC LIL24ENC3 ACTIVE < 0.02 ABUT<90 OPPOSITE
        ENC LIL24COIN ACTIVE < 0.02 ABUT<90 OPPOSITE
        }       

R39X11 { @ Rule 39.11 : LIL end of line with inward corner < 0.4 away, distance to POLY >= 0.24.
           LILINCOR:1 = EXT LILINT < 0.020 ABUT == 90 INTERSECTING ONLY REGION
       LILINCOR = LILINT COINCIDENT OUTSIDE EDGE LILINCOR:1
        LILINCORBAD = NOT LENGTH ( TOUCH EDGE LILINT LILINCOR ) >= 0.4
           X = EXPAND EDGE LILINCORBAD INSIDE BY 0.020
       LILENDINCORBAD:0 = NOT LENGTH ( TOUCH EDGE LILINT X ) >= 0.26
       LILENDINCORBAD = LILENDINCORBAD:0 NOT TOUCH EDGE  LILINCOR:1
           R1 = EXT POLY LILENDINCORBAD < 0.24  REGION
           M = FDRC INSIDE CELL '*FR_39X11_*'
           R1 INTERACT (SIZE (R1 XOR M) BY -0.001)
       }

R39.12 { @ Rule 39.12 : LIL with SIPROT is not allowed.
           LIL AND SIPROT
       }

R39.13 { @ Rule 39.13 : LIL 45 degre angles are forbidden.
           ANGLE LIL == 45
       }

R39.14  { @ Rule 39.14 : min LIL enclosed area.
             HOLES LIL < 0.36
    }

// //////////////////////////////////////////////////////////////////////////////
// /              DRAM  SPECIFIC  DESIGN  RULES                                 /
// //////////////////////////////////////////////////////////////////////////////

//------------------------------------------------------------------------------
// CTELEC2  [CAD layer]
//------------------------------------------------------------------------------

RD19.2 { @ Rule D19.2 : Contact_c2 minimum space >= 0.32.
           EXT CTELEC2 < 0.32 ABUT>0<90 SINGULAR
       }

RD19.1 { @ Rule D19.1 : Contact_c2 width = 0.24 X 0.24.
           NOT RECTANGLE CTELEC2 == 0.24 BY == 0.24
       }

//------------------------------------------------------------------------------
// CELLVT  [Mask level 51]
//------------------------------------------------------------------------------

RD51.1 { @ Rule D51.1 CELLVT width >= 0.48.
           INT CELLVT < 0.48 ABUT>0<90 SINGULAR
       }
     
RD51.2 { @ Rule D51.2 CELLVT space >= 0.48.
           EXT CELLVT < 0.48 ABUT>0<90 SINGULAR
       }
     
RD51.3 { @ Rule D51.3 CELLVT enclosure of Active >= 0.26.
           ENC ACTIVE CELLVT < 0.26 ABUT<90 SINGULAR
       }
        
RD51.4 { @ Rule D51.4 CELLVT distance to Active >= 0.26.
           EXT CELLVT ACTIVE < 0.26 ABUT<90 SINGULAR 
       }

//------------------------------------------------------------------------------
// CELLIMP  [Mask level 43]
//------------------------------------------------------------------------------
     
RD43.1 { @ Rule D43.1 CELLIMP width >= 0.48.
       INT CELLIMP < 0.48 ABUT>0<90 SINGULAR
       }

RD43.2 { @ Rule D43.2 CELLIMP space >= 0.48.
       EXT CELLIMP < 0.48 ABUT>0<90 SINGULAR
       }

RD43.3 { @ Rule D43.3 CELLIMP enclosure of ACTIVE >= 0.26.
       ENC ACTIVE CELLIMP < 0.26 ABUT<90 SINGULAR
       }
        
RD43.4 { @ Rule D43.4 CELLIMP distance to ACTIVE >= 0.26.
       EXT CELLIMP ACTIVE < 0.26 ABUT<90 SINGULAR 
       }

//------------------------------------------------------------------------------
//       EPI  [CAD layer]
//------------------------------------------------------------------------------

R65.1 { @ Rule 65.1 : EPI width >= 1.
          INT NEPI < 1 ABUT>0<90 SINGULAR
      }

R65.2 { @ Rule 65.2 : EPI space >= 1.
          EXT NEPI < 1 ABUT>0<90 SINGULAR
      }

R65.3 { @ Rule 65.3 : EPI with ACTIVE is forbidden, NEPI must be used as isolation wall.
          NEPI AND ACTIVE
      }

R65.4 { @ Rule 65.4 : EPI distance to ACTIVE >= 1.
          EXT NEPI ACTIVE < 1 ABUT<90 SINGULAR INSIDE ALSO 
      }

//65.5 conflict  65.8 : EPI abutting to NWELL or Niso allowed - decided keep first version
R65.5 { @ Rule 65.5 : EPI distance to NWELL >= 1.
          EXT NEPI NWELL < 1 ABUT<90 SINGULAR INSIDE ALSO 
      }

R65.6 { @ Rule 65.6 : EPI distance to RNWELL >= 1.
          EXT NEPI RNWELL < 1 ABUT<90 SINGULAR INSIDE ALSO
      }

R65.7_R65.8 { @ Rule 65.7 : EPI distance to NISO >= 1.
              @ Rule 65.8 : EPI abutting to Niso allowed
                EXT NEPI NISO < 1 ABUT>0<90 SINGULAR INSIDE ALSO 
            }

// //////////////////////////////////////////////////////////////////////////////
// /             CAPA MIM5  SPECIFIC  DESIGN  RULES                            /
// //////////////////////////////////////////////////////////////////////////////

//------------------------------------------------------------------------------
//       MIM5  [Mask level 80]
//------------------------------------------------------------------------------

RMT80.1 { @ Rule MT80.1 : MIM5 width >= 3.5.
            INT MIM5 < 3.5 ABUT>0<90 SINGULAR
        }

RMT80.2 { @ Rule MT80.2 : MIM5 space >= 3.5.
            EXT MIM5 < 3.5 ABUT>0<90 SINGULAR
        }

RMT80.3 { @ Rule MT80.3 : MIM5 maximum area = 20000.
            AREA MIM5 > 20000
        }

RMT80.5 { @ Rule MT80.5 : ME5 is required under MIM5
          @ or MIM5 enclosure by ME5 >= 1.2.
            ENC MIM5 ME5 < 1.2 ABUT<90 SINGULAR OUTSIDE ALSO
        }

RMT80.6 { @ Rule MT80.6 : MIM5 enclosure of VI5 >= 0.5.
            ENC VIMIM5C MIM5 < 0.5 ABUT<90 SINGULAR
        }

RMT80.7 { @ Rule MT80.7 : MIM5 distance to unrelated VI5 >= 0.5.
            EXT MIM5 VI5 < 0.5 ABUT<90 SINGULAR
        }

//------------------------------------------------------------------------------
//       METAL5  [Mask level 53]
//------------------------------------------------------------------------------

MIM5BASE = MIM5BASEI AND ME5

RMT_53.1 { @ Rule MT_53.1 : Width of a ME5 capacitor plate >= 5.9.
             INT MIM5BASE < 5.9 ABUT>0<90 SINGULAR
         }

RMT_53.2 { @ Rule MT_53.2 : Space of a ME5 capacitor plate >= 1.1.
             X = EXT MIM5PLATE < 1.1 ABUT>0<90 SINGULAR REGION
         X OUTSIDE ME5
         EXT MIM5PLATE ME5NOMIM:1 < 1.1 ABUT>0<90 SINGULAR
         }

VI4INSIDEMIM5P = VI4 INSIDE MIM5PLATE
VI4CUTMIM5P = VI4 CUT MIM5PLATE
TMP30MIM5 = SIZE VI4INSIDEMIM5P BY 0.3
TMP40MIM5 = SIZE VI4CUTMIM5P BY 0.3
TMP3MIM5 = TMP30MIM5 NOT ME5
TMP4MIM5 = TMP40MIM5 NOT ME5

RMT_53.3 { @ Rule MT_53.3 : Enclosure of VI4 by ME5 capacitor plate >= 0.3.
             EXT VI4INSIDEMIM5P TMP3MIM5 < 0.3 ABUT>0<90 SINGULAR
             EXT VI4CUTMIM5P TMP4MIM5 < 0.3 ABUT>0<90 SINGULAR
     }

VI5INSIDEMIM5P = VI5 INSIDE MIM5PLATE
VI5CUTMIM5P = VI5 CUT MIM5PLATE
TMP10MIM5 = SIZE VI5INSIDEMIM5P BY 0.3
TMP20MIM5 = SIZE VI5CUTMIM5P BY 0.3
TMP1MIM5 = TMP10MIM5 NOT ME5
TMP2MIM5 = TMP20MIM5 NOT ME5

RMT_53.4 { @ Rule MT_53.4 : Enclosure of VI5 by ME5 capacitor plate >= 0.3.
             EXT VI5INSIDEMIM5P TMP1MIM5 < 0.3 ABUT>0<90 SINGULAR
             EXT VI5CUTMIM5P TMP2MIM5    < 0.3 ABUT>0<90 SINGULAR
         }

//------------------------------------------------------------------------------
//       METAL6  [Mask level 55]
//------------------------------------------------------------------------------
 
RMT_55.1_MT_55.2 { @ Rule MT_55.1 : M6 not allowed over MIM5 if at different potential
                          @ Rule MT_55.2 : M6 dist to MIM5 if at different potential >=0.64
          EXT MIM5C M6C:2 < 0.64 OVERLAP NOT CONNECTED
        }

// //////////////////////////////////////////////////////////////////////////////
// /             CAPA HKMIM5  SPECIFIC  DESIGN  RULES                            /
// //////////////////////////////////////////////////////////////////////////////

//------------------------------------------------------------------------------
//       METAL5  [Mask level 53]
//------------------------------------------------------------------------------
 
HKMIM5BASE = HKMIM5BASEI AND ME5

RMT_53.1a { @ Rule MT_53.1 : Width of a ME5 capacitor plate >= 5.9.
              INT HKMIM5BASE < 5.9 ABUT>0<90 SINGULAR
          }

RMT_53.2a { @ Rule MT_53.2 : Space of a Metal5 capacitor plate >= 1.1.
              X = EXT HKMIM5PLATE < 1.1 ABUT>0<90 SINGULAR REGION
          X OUTSIDE ME5
          EXT HKMIM5PLATE ME5NOMIM:1 < 1.1 ABUT>0<90 SINGULAR
          }

VI4INSIDEHKMIM5P = VI4 INSIDE HKMIM5PLATE
VI4CUTHKMIM5P = VI4 CUT HKMIM5PLATE
TMP30HKMIM5 = SIZE VI4INSIDEHKMIM5P BY 0.3
TMP40HKMIM5 = SIZE VI4CUTHKMIM5P BY 0.3
TMP3HKMIM5 = TMP30HKMIM5 NOT ME5
TMP4HKMIM5 = TMP40HKMIM5 NOT ME5

RMT_53.3a { @ Rule MT_53.3 : Enclosure of VI4 by ME5 capacitor plate >= 0.3.
              EXT VI4INSIDEHKMIM5P TMP3HKMIM5 < 0.3 ABUT>0<90 SINGULAR
              EXT VI4CUTHKMIM5P TMP4HKMIM5  < 0.3 ABUT>0<90 SINGULAR
      }

VI5INSIDEHKMIM5P = VI5 INSIDE HKMIM5PLATE
VI5CUTHKMIM5P = VI5 CUT HKMIM5PLATE
TMP10HKMIM5 = SIZE VI5INSIDEHKMIM5P BY 0.3
TMP20HKMIM5 = SIZE VI5CUTHKMIM5P BY 0.3
TMP1HKMIM5 = TMP10HKMIM5 NOT ME5
TMP2HKMIM5 = TMP20HKMIM5 NOT ME5

RMT_53.4a { @ Rule MT_53.4 : Enclosure of VI5 by ME5 capacitor plate >= 0.3.
              EXT VI5INSIDEHKMIM5P TMP1HKMIM5 < 0.3 ABUT>0<90 SINGULAR
              EXT VI5CUTHKMIM5P TMP2HKMIM5 < 0.3 ABUT>0<90 SINGULAR
          }

//------------------------------------------------------------------------------
//       HKMIM5  [Mask level 92]
//------------------------------------------------------------------------------

RM92.1 { @ Rule M92.1 : HKMIM5 width >= 3.5.
           INT HKMIM5 < 3.5 ABUT>0<90 SINGULAR
       }

RM92.2 { @ Rule M92.2 : HKMIM5 space >= 3.5.
           EXT HKMIM5 < 3.5 ABUT>0<90 SINGULAR
       }

RM92.3 { @ Rule M92.3 : HKMIM5 maximum area = 20000.
           AREA HKMIM5 > 20000
       }

RM92.5 { @ Rule M92.5 : ME5 is required under HKMIM5
         @ or HKMIM5 enclosure by ME5 >= 1.2.
           ENC HKMIM5 ME5 < 1.2 ABUT<90 SINGULAR OUTSIDE ALSO
       }

RM92.6 { @ Rule M92.6 : HKMIM5 enclosure of VI5 >= 0.5.
           ENC VIHKMIM5C HKMIM5 < 0.5 ABUT<90 SINGULAR
       }

RM92.7 { @ Rule M92.7 : HKMIM5 distance to unrelated VI5 >= 0.5.
           EXT HKMIM5 VI5 < 0.5 ABUT<90 SINGULAR
       }    

RM92.imp1 { @ Rule M92.imp1 : MIM5 capacitors can not be used with HKMIM5 capacitors.
          ((BULK INTERACT HKMIM5) AND (BULK INTERACT MIM5)) AND (MIM5 OR HKMIM5)
          }

// //////////////////////////////////////////////////////////////////////////////
// /              HIPO  RESISTOR  OPTION  SPECIFIC  DESIGN  RULES               /
// //////////////////////////////////////////////////////////////////////////////
 
//------------------------------------------------------------------------------
//       ACTIVE  [Mask level 2]
//------------------------------------------------------------------------------
 
RF2.1 { @ Rule F2.1 : hipo resistor is not allowed on ACTIVE.
          PRESIST AND ACTIVE
      }

//------------------------------------------------------------------------------
//       POLY  [Mask level 13]
//------------------------------------------------------------------------------
 
RF13.1_RF13.2 { @ Rule F13.1 : hipo resistor POLY must be placed on NWELL.
                @ Rule F13.2 : hipo resistor POLY enclosure by NWELL >= 1.5.
                  ENC RHPOLY NWELL < 1.5 ABUT<90 SINGULAR OUTSIDE ALSO
          }

NORULECHECK_RPOLY_Rw:0 = COPY EMPTY
  
RF13.3 { @ Rule F13.3 : hipo resistor width >= 0.8.
           INT (RHBODY NOT INTERACT NORULECHECK_RPOLY_Rw:0) < 0.8 ABUT>0<90 SINGULAR
       }

RF13.4 { @ Rule F13.4 : hipo resistor space >= 0.54.
           EXT RHBODY < 0.54 SPACE ABUT>0<90
       }

//------------------------------------------------------------------------------
//       PRESIST  [Mask level 26]
//------------------------------------------------------------------------------
 
RF26.1 { @ Rule F26.1 : PRESIST width >= 0.64.
           INT PRESIST < 0.64 ABUT>0<90 SINGULAR
       }
 
RF26.2 { @ Rule F26.2 : PRESIST space >= 0.64.
           EXT PRESIST < 0.64 ABUT>0<90 SINGULAR
       }

RF26.3 { @ Rule F26.3 : PRESIST distance to ACTIVE >= 0.34.
           EXT PRESIST ACTIVE < 0.34 ABUT<90 SINGULAR INSIDE ALSO
       }

RF26.4 { @ Rule F26.4 : PRESIST distance to POLY >= 0.7.
           EXT PRESIST POLY < 0.7 ABUT<90 SINGULAR
           PRESIST AND (POLY NOT RHPOLY)
       }

RF26.5 { @ Rule F26.5 : PRESIST distance to pplus >= 0.54.
           EXT PRESIST PPLUS < 0.54 ABUT<90 SINGULAR
       PRESIST AND (PPLUS OUTSIDE RHHEAD)
       }

RF26.9_RF26.10 { @ Rule F26.9 : POLY of hipo resistor crossing PRESIST boundary is forbidden.
                 @ Rule F26.10 : presist enclosure of poly of hipo resistor >=1.1
               ENC RHPOLY PRESIST < 1.1 ABUT<90 SINGULAR OUTSIDE ALSO
           }

//------------------------------------------------------------------------------
//       PPLUS  [Mask level 17]
//------------------------------------------------------------------------------

RF17.1 { @ Rule F17.1 : pplus must be placed on heads of hipo resistor.
       RHTERM NOT PPLUS
       }

PPHEAD = RHHEAD COINCIDENT INSIDE EDGE PPLUS
RF17.2 { @ Rule F17.2 : pplus intersection with POLY of hipo resistor >= 1.14.
       INT PPHEAD RHPOLY < 1.14 ABUT<90 MEASURE COINCIDENT
       }

RF17.3 { @ Rule F17.3 : pplus extension on POLY of hipo resistor >= 0.34.
           ENC RHPOLY PPLUS < 0.34 ABUT<90 SINGULAR
       }

RF17.4 { @ Rule F17.4 : hipo resistor length >= 3.5.
           X = RHBODY COINCIDENT INSIDE EDGE POLY
           PATH LENGTH X < 3.5
       }

//------------------------------------------------------------------------------
//       SIPROT  [Mask level 18]
//------------------------------------------------------------------------------

RF18.1 { @ Rule F18.1 : SIPROT intersection with pplus on heads of hipo resistor >= 0.34.
       INT PPHEAD SIPROT < 0.34 ABUT<90 MEASURE COINCIDENT
       }

//------------------------------------------------------------------------------
//       CONTACT  [Mask level 19]
//------------------------------------------------------------------------------

RF19.1 { @ Rule F19.1 : HIPO resistor CONTACT distance to SIPROT = 0.28 (min=max).
       CTRH = CONTACT INTERACT RHHEAD
       SIPROTRH = SIPROT INTERACT RHBODY
       X = SIZE (SIPROTRH OR CTRH) BY 0.14
       SIPROTRH INTERACT (RHPOLY INTERACT X > 1)
       EXT SIPROTRH CTRH < 0.28
}

//------------------------------------------------------------------------------
//       NISO  [Mask level 24]
//------------------------------------------------------------------------------

NWHNISO = NWHOLE INTERACT NISO
NISOC = STAMP NISO BY NWELLC:1
NWENISO = NWELL INTERACT NISO
NWE2NISO = NWELL2 INTERACT NISO
SIZENISO = SIZE NISO BY 1.6

R24.1 { @ Rule 24.1 : NISO width > 2.0.
          INT NISO < 2.0 ABUT>0<90 SINGULAR
      }

R24.2 { @ Rule 24.2 : NISO space > 2.0.
          EXT NISO < 2.0 ABUT>0<90 SINGULAR
      }

R24.4 { @ Rule 24.4 : NISO intersection with NWELL guard-ring >= 0.4.
          INT NISO NWELL < 0.4 ABUT<90 SINGULAR MEASURE COINCIDENT
      }

R24.11 { @ Rule 24.11 : NISO crossing NWELL hole boundary is not allowed.
           NWHNISO NOT NISO
       }

NWHOLE2_1 = NWELL2 NOT INSIDE NISO
NWHOLE2 = (HOLES NWHOLE2_1) NOT NWHOLE2_1
NWH2NISO = NWHOLE2 INTERACT NISO

R24.4a { @ Rule 24.4a : NISO intersection with NWELL2 guard-ring >= 0.5.
          INT NISO NWELL2 < 0.5 ABUT<90 SINGULAR MEASURE COINCIDENT 
       } 

R24.11a { @ Rule 24.11a : NISO crossing NWELL2 hole boundary is not allowed.
            NWH2NISO NOT NISO
        } 

R24.3 { @ Rule 24.3 : NISO enclosure by NWELL >= 1.6.
          ENC NISO NWELL < 1.6 ABUT<90 SINGULAR
      }

R24.3a { @ Rule 24.3a : NISO enclosure by NWELL2 >= 1.6.
          ENC NISO NWELL2 < 1.6 ABUT<90 SINGULAR
       }

NWELL_ALL1 = NWELL OR NWELL2
NWELFT:3 = (NWELL_ALL1 INTERACT NITRIDE) OUTSIDE ACTIVE
NWELL_ALL2 = NWELL_ALL1 NOT NWELFT:3
NSTRAP:1_1 = NACTIVE AND NWELL_ALL2
NSTRAP:2_1 = NSTRAP:1_1 NOT NDRACPO
NSTRAP_1_1 = STAMP NSTRAP:2_1 BY SALI
NWELLC:1_1 = STAMP NWELL_ALL2 BY NSTRAP_1_1
NISOC_ALL = STAMP NISO BY NWELLC:1_1

R24.7 { @ Rule 24.7 : NWELLS (nwell and nwell2) layers overlapping NISO must be at the same potential.
          NWELL_ALL2 INTERACT (NISO NOT NISOC_ALL) 
          }

NW2HOLE_1 = NWELL2 NOT INSIDE NISO
NW2HOLE = (HOLES NW2HOLE_1) NOT NW2HOLE_1

RB24.imp1 { @ Rule B24.imp1 : NWELL/NWELL2 guard-ring is required.
	NISO OUTSIDE ( NWHOLE OR NW2HOLE )
	((NISO INTERACT ( NWHOLE OR NW2HOLE ) ) NOT NWELL) NOT ( NWHOLE OR NW2HOLE )
      }

#IFDEF RECOMMENDED_NISO
RB24.10 { @ Rule B24.10 : We recommend isolating the side walls of PWELL/PWELL2 with NWELL 
              NISO OUTSIDE NWHOLE
              ((NISO INTERACT NWHOLE) NOT NWELL) NOT NWHOLE
      }
#ENDIF

R24.5b { @ Rule 24.5b : NISO enclosure of NWELL strap >= 0.58.
        ENC NSTRAP:2 NISO < 0.58 ABUT<90 SINGULAR
       }

R24.5a { @ Rule 24.5a : NISO enclosure of PWELL strap >= 0.58.
        ENC PSTRAP NISO < 0.58 ABUT<90 SINGULAR
       }

R24.5d { @ Rule 24.5d : NISO enclosure of PWELL2 strap >= 0.6.
        ENC PSTRAP_5V NISO < 0.6 ABUT<90 SINGULAR
       }

R24.5e { @ Rule 24.5e : NISO enclosure of NWELL2 strap >= 0.6.
        ENC NSTRAP:1_5V NISO < 0.6 ABUT<90 SINGULAR
       }

R24.6.b { @ Rule 24.6.b : NISO enclosure of p+ active in NWELL  >=0.8                                  
         ENC PINNW NISO < 0.8 ABUT<90 SINGULAR
    }

R24.6a { @ Rule 24.6a : NISO enclosure of n+ active in PWELL >= 0.8.
        ENC NINPW NISO < 0.8 ABUT<90 SINGULAR
       }    

R24.6c { @ Rule 24.6c : NISO enclosure of n+ active in PWELL2 >= 1.
        ENC NINPW2 NISO < 1 ABUT<90 SINGULAR
       }    

R24.6.d { @ Rule 24.6.d : NISO enclosure of p+ active in NWELL  >=1                                  
         ENC PINNW2 NISO < 1 ABUT<90 SINGULAR
        }
    
R24.imp2 { @ Rule 24.imp2 : POLY/NWELL capacitor is not allowed on NOSO.
             CP1NW AND NISO
         }

// //////////////////////////////////////////////////////////////////////////////
// /              N-DRIFT MOS TRANSISTORS SPECIFIC DESIGN RULES                 /
// //////////////////////////////////////////////////////////////////////////////

//-------------------------------------------------------------------------------
//      POLY  SPECIFIC DESIGN  RULES [Mask level 13]
//-------------------------------------------------------------------------------

RNDR13.1 { @ Rule NDR13.1 : gate length on ndrift >= 1.0.
             INT NDGATESYM < 1.0 ABUT>0<90 SINGULAR
     }

NDRNW = NWELL CUT (NDRACPO AND MDRIFT)

RNDR13.2 { @ Rule NDR13.2 : POLY overlap NWELL ACTIVE on ndrift >= 1.5.
         INT ACTPOL:1 NDRNW < 1.5 ABUT>0<90 OPPOSITE PARALLEL SINGULAR
     }

//-------------------------------------------------------------------------------
//      ACTIVE  SPECIFIC DESIGN  RULES [Mask level 02]
//-------------------------------------------------------------------------------

NDRACTD = (ACTIVE INSIDE NWELL) AND MDRIFT

RNDR2.1 { @ Rule NDR2.1 : source drain space on ndrift >= 1.5
            EXT NDRACTD NDRACTS < 1.5 ABUT<90 OPPOSITE PARALLEL SINGULAR
        }

// //////////////////////////////////////////////////////////////////////////////
// /              P-DRIFT MOS TRANSISTORS SPECIFIC DESIGN RULES                 /
// //////////////////////////////////////////////////////////////////////////////
 
//-------------------------------------------------------------------------------
//      POLY  SPECIFIC DESIGN  RULES [Mask level 13]
//-------------------------------------------------------------------------------

RPDR13.1 { @ Rule PDR13.1 : gate length on pdrift >= 0.8.
             INT PDGATESYM < 0.8 ABUT>0<90 SINGULAR
     }

PDRPWNISO = PWNISO CUT (PDRACPO AND MDRIFT)

RPDR13.2 { @ Rule PDR13.2 : POLY overlap PWELL ACTIVE on pdrift >= 1.0.
         INT ACTPOL:1 PDRPWNISO < 1.0 ABUT>0<90 OPPOSITE PARALLEL SINGULAR
     }

//-------------------------------------------------------------------------------
//      ACTIVE  SPECIFIC DESIGN  RULES [Mask level 02]
//-------------------------------------------------------------------------------

PDRACTD = (ACTIVE INSIDE PWELL:1) AND MDRIFT

RPDR2.1 { @ Rule PDR2.1 : source drain space on pdrift >= 0.7.
            EXT PDRACTD PDRACTS < 0.7 ABUT<90 OPPOSITE PARALLEL SINGULAR
        }

//------------------------------------------------------------------------------
//         GO2
//------------------------------------------------------------------------------

R6.1  { @ Rule 6.1 GO2 width > 0.48.
          INT GO2 < 0.48 ABUT>0<90 SINGULAR     
      }

R6.2 { @ Rule 6.2 GO2 space > 0.48.
     EXT GO2 < 0.48 ABUT>0<90 SINGULAR
     }

ACTNOSTRAPBUTCPO1NW:1 = COPY ACTNOSTRAP
ACTNOSTRAPBUTCPO1NW:2 = ACTNOSTRAPBUTCPO1NW:1 OR CP1NWAC:2

R6.4 { @ Rule 6.4 : GO2 enclosure of active >= 0.5.
         ENC ACTNOSTRAPBUTCPO1NW:2 GO2 < 0.5 ABUT<90 SINGULAR
    }

R6.5 { @ Rule 6.5 : GO2 distance to source/drain active >= 0.5.
         EXT GO2 ACTNOSTRAP < 0.5 ABUT>=0<90 SINGULAR
     }

R6.imp2 { @ Rule 6.imp2 : Mos P double oxide without PEXT or with PLDD is not allowed.
            COPY BADPGO2
    }

R6.imp1 { @ Rule 6.imp1 : Mos N double oxide without NEXT or with NLDD is not allowed.
      COPY BADNGO2:3
    }

R6.6 { @ Rule 6.6 : GO2 accross mos diffusion is not allowed.
     GO2 INSIDE EDGE ACTNOSTRAP
     }

//------------------------------------------------------------------------------
//         GO2_5V
//------------------------------------------------------------------------------

R7.1 { @ Rule 7.1 : GO2_5V width > 0.84.
         INT GO2_5V < 0.84 ABUT>0<90 SINGULAR REGION
     }

R7.2 { @ Rule 7.2 : GO2_5V space > 0.84.
         EXT GO2_5V < 0.84 ABUT>0<90 SINGULAR REGION
     }

ACTCUTPOL = ACTIVE CUT POLY
ACTCUTPOL_OTP = ACTCUTPOL NOT INTERACT OTP

R7.4 { @ Rule 7.4 : GO2_5V enclosure of source/drain active > 0.50.
         ENC ACTCUTPOL GO2_5V < 0.50 ABUT>=0<90 SINGULAR REGION
     }

R7.5 { @ Rule 7.5 : GO2_5V distance to source/drain active > 0.50.
         EXT ACTCUTPOL GO2_5V < 0.50 ABUT>=0<90 SINGULAR REGION
     }

R7.6 { @ Rule 7.6 : GO2_5V across source/drain active is not allowed, except OTP cell.
         GO2_5V INSIDE EDGE ACTCUTPOL_OTP
     }

//------------------------------------------------------------------------------
//         OTP
//------------------------------------------------------------------------------

R91.1 { @ Rule 91.1 : OTP width >= 0.48.
         INT OTP < 0.48 ABUT>0<90 SINGULAR REGION
      }

R91.2 { @ Rule 91.2 : OTP space >= 0.48.
         EXT OTP < 0.48 ABUT>0<90 SINGULAR REGION
      }

R91.3 { @ Rule R91.3 : OTP area >= 0.36.
          NOT AREA OTP >= 0.36
      }

R91.4 { @ Rule 91.4 : OTP enclosure of ACTIVE >= 0.26.
          ENC ACTIVE OTP < 0.26 ABUT>=0<90 SINGULAR REGION
      }

//------------------------------------------------------------------------------
//         NEXT  [CAD layer]
//------------------------------------------------------------------------------
 
R76.1 { @ Rule 76.1 : NEXT width >= 0.48.
          INT NEXT < 0.48 ABUT>0<90 SINGULAR
      }
         
R76.2 { @ Rule 76.2 : NEXT space >= 0.48.
          EXT NEXT < 0.48 ABUT>0<90 SINGULAR
      }

R76.3 { @ Rule 76.3 : NEXT enclosure of ACTIVE >= 0.26.
          ENC ACTIVE NEXT < 0.26 ABUT<90 SINGULAR
      NEXT INSIDE EDGE (ACTIVE NOT ACTH_5V)
      }

R76.4 { @ Rule 76.4 : NEXT distance to active resistors >= 0.26.
      EXT ACTIVERES NEXT < 0.26 ABUT<90
      NEXT INSIDE EDGE ACTIVERES
      }

R76.5 { @ Rule 76.5 : NEXT distance to poly resistors >= 0.26.
      EXT RPOLY NEXT < 0.26 ABUT<90
      NEXT INSIDE EDGE RPOLY
      }

ACTIVLDD = NLDDACT OR PLDDACT

R76.6 { @ Rule 76.6 : NEXT distance to active covered with NLDD or PLDD >= 0.26.
      EXT ACTIVLDD NEXT < 0.26 SINGULAR ABUT<90
      NEXT INSIDE EDGE ACTIVLDD
      }

R76.8 { @ Rule 76.8 : NEXT distance to  P active other than Pwell strap >= 0.26.
      EXT PACTNOSTRP NEXT < 0.26 SINGULAR ABUT<90
      NEXT INSIDE EDGE PACTNOSTRP
      }

ACTH_5V = ACTIVE INTERACT GATEH_5V

R76.9 { @ Rule 76.9 : ACTIVE must not be crossed by NEXT boundary.
      (ACTIVE NOT ACTH_5V) CUT NEXT
      }

R76.imp { @ Rule R76.imp NEXT AND NLDD are alternative layers.
            NEXT AND NLDD
        }

//------------------------------------------------------------------------------
//         NEXT_5V  [CAD layer]
//------------------------------------------------------------------------------
 
R78.1 { @ Rule 78.1 : NEXT_5V width >= 0.48.
          INT NEXT_5V < 0.48 ABUT>0<90 SINGULAR REGION
      }
         
R78.2 { @ Rule 78.2 : NEXT_5V space >= 0.48.
          EXT NEXT_5V < 0.48 ABUT>0<90 SINGULAR REGION
      }

R78.3 { @ Rule 78.3 : NEXT_5V enclosure of ACTIVE >= 0.26.
          ENC ACTIVE NEXT_5V < 0.26 ABUT<90 SINGULAR REGION
      NEXT_5V INSIDE EDGE (ACTIVE NOT ACTH_5V)
      }

R78.4 { @ Rule 78.4 : NEXT_5V distance to active resistors >= 0.26.
      EXT ACTIVERES NEXT_5V < 0.26 ABUT<90 REGION
      NEXT_5V INSIDE EDGE ACTIVERES
      }

R78.5 { @ Rule 78.5 : NEXT_5V distance to poly resistors >= 0.26.
      EXT RPOLY NEXT_5V < 0.26 ABUT<90 REGION
      NEXT_5V INSIDE EDGE RPOLY
      }

R78.6 { @ Rule 78.6 : NEXT_5V without PWELL2 or NWELL2 is not allowed.
          (NEXT_5V NOT PWELL2) NOT NWELL2
      }

R78.7 { @ Rule 78.7 : NEXT_5V distance to P active other than PWELL2 straps >= 0.26.
      EXT PACTNOSTRP_5V NEXT_5V < 0.26 ABUT<90 SINGULAR REGION
      NEXT_5V INSIDE EDGE PACTNOSTRP_5V
      }

R78.8 { @ Rule 78.8 : ACTIVE must not be crossed by NEXT_5V boundary.
      (ACTIVE NOT ACTH_5V) CUT NEXT_5V
      }

R78.imp { @ Rule R78.imp : NEXT_5V AND NEXT are alternative layers,
          @                NEXT_5V AND NLDD are alternative layers.
            NEXT_5V AND NEXT
        NEXT_5V AND NLDD
        }

//------------------------------------------------------------------------------
//         PEXT  [CAD layer]
//------------------------------------------------------------------------------

R77.1 { @ Rule 77.1 : PEXT width >= 0.48.
          INT PEXT < 0.48 ABUT>0<90 SINGULAR
      }
 
R77.2 { @ Rule 77.2 : PEXT space >= 0.48.
          EXT PEXT < 0.48 ABUT>0<90 SINGULAR
      }

R77.3 { @ Rule 77.3 : PEXT enclosure of ACTIVE >= 0.26.
          ENC ACTIVE PEXT < 0.26 ABUT<90 SINGULAR
      PEXT INSIDE EDGE (ACTIVE NOT ACTH_5V)
      }

R77.4 { @ Rule 77.4 : PEXT distance to active resistors >= 0.26.
      EXT ACTIVERES PEXT < 0.26 ABUT<90
      PEXT  INSIDE EDGE ACTIVERES
      }

R77.5 { @ Rule 77.5 : PEXT distance to poly resistors >= 0.26.
      EXT RPOLY PEXT < 0.26 ABUT<90
      PEXT  INSIDE EDGE RPOLY
      }

R77.6 { @ Rule 77.6 : PEXT distance to ACTIVE covered with NLDD or PLDD >= 0.26.
      EXT ACTIVLDD PEXT < 0.26 SINGULAR ABUT<90
      PEXT  INSIDE EDGE ACTIVLDD
      }

R77.8 { @ Rule 77.8 : PEXT distance to N active other than NWELL strap >= 0.26.
      EXT NACTNOSTRN PEXT < 0.26 SINGULAR ABUT<90
      PEXT INSIDE EDGE NACTNOSTRN
      }

R77.9 { @ Rule 77.9 : Active must not be crossed by PEXT boundary.
      (ACTIVE NOT ACTH_5V) CUT PEXT
      }

R77.imp { @ Rule R77.imp PEXT AND PLDD are alternative layers.
            PEXT AND PLDD
        }

//------------------------------------------------------------------------------
//         PEXT_5V  [CAD layer]
//------------------------------------------------------------------------------

R79.1 { @ Rule 79.1 PEXT_5V width >= 0.48.
          INT PEXT_5V < 0.48 ABUT>0<90 SINGULAR REGION
      }
 
R79.2 { @ Rule 79.2 PEXT_5V space >= 0.48.
          EXT PEXT_5V < 0.48 ABUT>0<90 SINGULAR REGION
      }

R79.3 { @ Rule 79.3 : PEXT_5V enclosure of ACTIVE >= 0.26.
          ENC ACTIVE PEXT_5V < 0.26 ABUT<90 SINGULAR REGION
      PEXT_5V INSIDE EDGE (ACTIVE NOT ACTH_5V)
      }
 
R79.4 { @ Rule 79.4 : PEXT_5V distance to active resistors >= 0.26.
      EXT ACTIVERES PEXT_5V < 0.26 ABUT<90 REGION
      PEXT_5V INSIDE EDGE ACTIVERES
      }

R79.5 { @ Rule 79.5 : PEXT_5V distance to poly resistors >= 0.26.
      EXT RPOLY PEXT_5V < 0.26 ABUT<90 REGION
      PEXT_5V INSIDE EDGE RPOLY
      }

PEXT_5V_WO_OTP = PEXT_5V NOT INTERACT OTP

R79.6 { @ Rule 79.6 : PEXT_5V without NWELL2 or PWELL2 is not allowed.
          (PEXT_5V NOT PWELL2) NOT NWELL2
      }

R79.7 { @ Rule 79.7 : PEXT_5V distance to N active other than NWELL2 strap >= 0.26.
      EXT NACTNOSTRN_5V PEXT_5V < 0.26 ABUT<90 SINGULAR REGION
      PEXT_5V INSIDE EDGE NACTNOSTRN_5V
      }

R79.8 { @ Rule 79.8 : ACTIVE must not be crossed by PEXT_5V boundary.
      (ACTIVE NOT ACTH_5V) CUT PEXT_5V
      }

R79.imp { @ Rule R79.imp : PEXT_5V AND PEXT are alternative layers,
          @                PEXT_5V AND PLDD are alternative layers.
            PEXT_5V AND PEXT
        PEXT_5V AND PLDD
        }

//------------------------------------------------------------------------------
//         5V LAYERS ARE NOT COMPATITIVE WITH 3V LAYERS
//------------------------------------------------------------------------------

LAYERS_5V = NWELL2 OR (PWELL2 OR (OTP OR (NEXT_5V OR (PEXT_5V OR GO2_5V))))
LAYERS_3V = NEXT OR (PEXT OR GO2)

R5_3.imp { @ Rule 5_3.imp : 5V layers are not compatible with 3V layers.
             ((BULK INTERACT LAYERS_5V) AND (BULK INTERACT LAYERS_3V)) AND (LAYERS_5V OR LAYERS_3V)
         }

// //////////////////////////////////////////////////////////////////////////////
// /          HD  DESIGN  RULES                        /
// //////////////////////////////////////////////////////////////////////////////

RALLHD { @ Rule ALLHD : high density purpose present outside high density memories.
           R = OR HD
           M = FDRC INSIDE CELL 'FR_ALLHD_*'
           R INTERACT (SIZE (R XOR M) BY -0.001)
    }

#DEFINE FLIP_CHIP_USED
////do not delete. Used for modularity !!!

//  -------------------------------------------------------------------------
//      NITRIDE  [Mask level 31]
//  -------------------------------------------------------------------------

STDPAD:1 = COPY NITRIDE
RFPAD:1 = COPY STDPAD:1
NORFPAD:1 = BPDVI1 OR BPDMT2
RFPAD:2 = RFPAD:1 OUTSIDE NORFPAD:1
NORFPAD:2 = BPDVI2 OR BPDMT3
RFPAD:3 = RFPAD:2 OUTSIDE NORFPAD:2
NORFPAD:3 = BPDVI3 OR BPDMT4
RFPAD:4 = RFPAD:3 OUTSIDE NORFPAD:3
NORFPAD:4 = COPY BPDVI4
RFPAD:5 = RFPAD:4 OUTSIDE NORFPAD:4
STDPAD:2 = STDPAD:1 NOT RFPAD:5
CUPPAD = STDPAD:2 INTERACT MKR_PAD_CUP
STDPAD:3 = STDPAD:2 NOT CUPPAD

// Rule 31.0 : NITRIDE enclosure of pad = 0.0.
// no check, pad is defined from nitride.

R31.1 { @ Rule 31.1 : ME6 enclosure of pad opening >= 3.0.
          ENC PAD BPDMT6 < 3.0 ABUT<90 SINGULAR
      }

R31.2 { @ Rule 31.2 : NWELL enclosure of pad opening >= 3.0.
          ENC PAD BPDNWL < 3.0 ABUT<90 SINGULAR
      }

R31.2a { @ Rule 31.2 : RNWELL enclosure of pad opening >= 3.0.
           ENC PAD BPDRNWL < 3.0 ABUT<90 SINGULAR
       }

R31.3 { @ Rule 31.3 : ME1 enclosure of VI1 >= 0.34.
          ENC BPDVI1 BPDMT1 < 0.34 ABUT<90 SINGULAR
      }

R31.4 { @ Rule 31.4 : ME2 enclosure of VI2 >= 0.34.
          ENC BPDVI2 BPDMT2 < 0.34 ABUT<90 SINGULAR
      }

R31.5 { @ Rule 31.5 : ME3 enclosure of VI3 >= 0.34.
          ENC BPDVI3 BPDMT3 < 0.34 ABUT<90 SINGULAR
      }

R31.6 { @ Rule 31.6 : ME4 enclosure of VI4 >= 0.34.
          ENC BPDVI4 BPDMT4 < 0.34 ABUT<90 SINGULAR
      }

R31.7 { @ Rule 31.7 : ME5 enclosure of VI5 >= 0.2.
          ENC BPDVI5 BPDMT5 < 0.2 ABUT<90 SINGULAR
      }

R31.8 { @ Rule 31.8 : VI1 size in the pad = 0.32.
          INT BPDVI1 < 0.32 ABUT>0<90 SINGULAR
          NOT RECTANGLE BPDVI1 == 0.32 BY == 0.32
      }

R31.9 { @ Rule 31.9 : VI1 space in the pad = 1.68.
          EXT BPDVI1 < 1.68 ABUT>0<90 SINGULAR
          BPV1SZ_1 = SIZE BPDVI1 BY 0.84
          BPV1SZ = SIZE BPV1SZ_1 BY -0.84
          BPV1BS:1 = EXT BPV1SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
          BPV1BS:2 = BPV1BS:1 INSIDE PAD
          BPV1BS:3 = EXT BPV1SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
          BPV1BS:4 = BPV1BS:3 INSIDE PAD
          BPV1BS:2 OR BPV1BS:4
      }

R31.10 { @ Rule 31.10 : VI2 size in the pad = 0.32.
           INT BPDVI2 < 0.32 ABUT>0<90 SINGULAR
           NOT RECTANGLE BPDVI2 == 0.32 BY == 0.32
       }

R31.11 { @ Rule 31.11 : VI2 space in the pad = 1.68.
           EXT BPDVI2 < 1.68 ABUT>0<90 SINGULAR
           BPV2SZ_1 = SIZE BPDVI2 BY 0.84
           BPV2SZ = SIZE BPV2SZ_1 BY -0.84
           BPV2BS:1 = EXT BPV2SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPV2BS:2 = BPV2BS:1 INSIDE PAD
           BPV2BS:3 = EXT BPV2SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPV2BS:4 = BPV2BS:3 INSIDE PAD
           BPV2BS:2 OR BPV2BS:4
       }

R31.12 { @ Rule 31.12 : VI3 size in the pad = 0.32.
           INT BPDVI3 < 0.32 ABUT>0<90 SINGULAR
           NOT RECTANGLE BPDVI3 == 0.32 BY == 0.32
       }

R31.13 { @ Rule 31.13 : VI3 space in the pad = 1.68.
           EXT BPDVI3 < 1.68 ABUT>0<90 SINGULAR
           BPV3SZ_1 = SIZE BPDVI3 BY 0.84
           BPV3SZ = SIZE BPV3SZ_1 BY -0.84
           BPV3BS:1 = EXT BPV3SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPV3BS:2 = BPV3BS:1 INSIDE PAD
           BPV3BS:3 = EXT BPV3SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPV3BS:4 = BPV3BS:3 INSIDE PAD
           BPV3BS:2 OR BPV3BS:4
       }

R31.14 { @ Rule 31.14 : VI4 size in the pad = 0.32.
           INT BPDVI4 < 0.32 ABUT>0<90 SINGULAR
           NOT RECTANGLE BPDVI4 == 0.32 BY == 0.32
       }

R31.15 { @ Rule 31.15 : VI4 space in the pad = 1.68.
           EXT BPDVI4 < 1.68 ABUT>0<90 SINGULAR
           BPV4SZ_1 = SIZE BPDVI4 BY 0.84
           BPV4SZ = SIZE BPV4SZ_1 BY -0.84
           BPV4BS:1 = EXT BPV4SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPV4BS:2 = BPV4BS:1 INSIDE PAD
           BPV4BS:3 = EXT BPV4SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPV4BS:4 = BPV4BS:3 INSIDE PAD
           BPV4BS:2 OR BPV4BS:4
       }

R31.16 { @ Rule 31.16 : VI5 size in the pad = 0.6.
           INT BPDVI5 < 0.6 ABUT>0<90 SINGULAR
           NOT RECTANGLE BPDVI5 == 0.6 BY == 0.6
       }

R31.17 { @ Rule 31.17 : VI5 space in the pad = 1.4.
           EXT BPDVI5 < 1.4 ABUT>0<90 SINGULAR
           BPV5SZ_1 = SIZE BPDVI5 BY 0.7
           BPV5SZ = SIZE BPV5SZ_1 BY -0.7
           BPV5BS:1 = EXT BPV5SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPV5BS:2 = BPV5BS:1 INSIDE PAD
           BPV5BS:3 = EXT BPV5SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPV5BS:4 = BPV5BS:3 INSIDE PAD
           BPV5BS:2 OR BPV5BS:4
       }

R31.18 { @ Rule 31.18 : ME1 width in the matrix = 1.0.
           INT BPDMT1 < 1.0 ABUT>0<90 SINGULAR
           BPDMT1W =  SIZE BPDMT1 BY -0.5 
       BPDMT1W:1 = SIZE BPDMT1W BY 0.5
       COPY BPDMT1W:1
       }

R31.19 { @ Rule 31.19 : ME1 space in the matrix = 1.0.
           EXT BPDMT1 < 1.0 ABUT>0<90 SINGULAR
           BPMT1SZ_1 = SIZE BPDMT1 BY 0.5
           BPMT1SZ = SIZE BPMT1SZ_1 BY -0.5
           BPMT1SZ:1 = EXT BPMT1SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPMT1BS:2 = BPMT1SZ:1 INSIDE PAD
           BPMT1BS:3 = EXT BPMT1SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPMT1BS:4 = BPMT1BS:3 INSIDE PAD
           BPMT1BS:2 OR BPMT1BS:4
       }

R31.20 { @ Rule 31.20 : ME2 width in the matrix = 1.0.
           INT BPDMT2 < 1.0 ABUT>0<90 SINGULAR
           BPDMT2W =  SIZE BPDMT2 BY -0.5 
       BPDMT2W:1 = SIZE BPDMT2W BY 0.5
       COPY BPDMT2W:1
       }

R31.21 { @ Rule 31.21 : ME2 space in the matrix = 1.0.
           EXT BPDMT2 < 1.0 ABUT>0<90 SINGULAR
           BPMT2SZ_1 = SIZE BPDMT2 BY 0.5
           BPMT2SZ = SIZE BPMT2SZ_1 BY -0.5
           BPMT2SZ:1 = EXT BPMT2SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPMT2BS:2 = BPMT2SZ:1 INSIDE PAD
           BPMT2BS:3 = EXT BPMT2SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPMT2BS:4 = BPMT2BS:3 INSIDE PAD
           BPMT2BS:2 OR BPMT2BS:4
       }

R31.22 { @ Rule 31.22 :  ME3 width in the matrix = 1.0.
           INT BPDMT3 < 1.0 ABUT>0<90 SINGULAR
           BPDMT3W =  SIZE BPDMT3 BY -0.5 
       BPDMT3W:1 = SIZE BPDMT3W BY 0.5
       COPY BPDMT3W:1
       }

R31.23 { @ Rule 31.23 : ME3 space in the matrix = 1.0.
           EXT BPDMT3 < 1.0 ABUT>0<90 SINGULAR
           BPMT3SZ_1 = SIZE BPDMT3 BY 0.5
           BPMT3SZ = SIZE BPMT3SZ_1 BY -0.5
           BPMT3SZ:1 = EXT BPMT3SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPMT3BS:2 = BPMT3SZ:1 INSIDE PAD
           BPMT3BS:3 = EXT BPMT3SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPMT3BS:4 = BPMT3BS:3 INSIDE PAD
           BPMT3BS:2 OR BPMT3BS:4
       }

R31.24 { @ Rule 31.24 : ME4 width in the matrix = 1.0.
           INT BPDMT4 < 1.0 ABUT>0<90 SINGULAR
           BPDMT4W =  SIZE BPDMT4 BY -0.5 
       BPDMT4W:1 = SIZE BPDMT4W BY 0.5
       COPY BPDMT4W:1
       }

R31.25 { @ Rule 31.25 : ME4 space in the matrix = 1.0.
           EXT BPDMT4 < 1.0 ABUT>0<90 SINGULAR
           BPMT4SZ_1 = SIZE BPDMT4 BY 0.5
           BPMT4SZ = SIZE BPMT4SZ_1 BY -0.5
           BPMT4SZ:1 = EXT BPMT4SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPMT4BS:2 = BPMT4SZ:1 INSIDE PAD
           BPMT4BS:3 = EXT BPMT4SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPMT4BS:4 = BPMT4BS:3 INSIDE PAD
           BPMT4BS:2 OR BPMT4BS:4
       } 

R31.26 { @ Rule 31.26 :  ME5 width in the matrix = 1.0.
           INT BPDMT5 < 1.0 ABUT>0<90 SINGULAR
           BPDMT5W =  SIZE BPDMT5 BY -0.5 
       BPDMT5W:1 = SIZE BPDMT5W BY 0.5
       COPY BPDMT5W:1
       }

R31.27 { @ Rule 31.27 : ME5 space in the matrix = 1.0.
           EXT BPDMT5 < 1.0 ABUT>0<90 SINGULAR
           BPMT5SZ_1 = SIZE BPDMT5 BY 0.5
           BPMT5SZ = SIZE BPMT5SZ_1 BY -0.5
           BPMT5SZ:1 = EXT BPMT5SZ < 150 SPACE OPPOSITE REGION ABUT>0<90
           BPMT5BS:2 = BPMT5SZ:1 INSIDE PAD
           BPMT5BS:3 = EXT BPMT5SZ < 150 NOTCH OPPOSITE REGION ABUT>0<90
           BPMT5BS:4 = BPMT5BS:3 INSIDE PAD
           BPMT5BS:2 OR BPMT5BS:4
       }

ACTMFG = ACTIVE AND MFGPP_0
ACT_WO_ACTMFG = ACTIVE NOT ACTMFG

R31.28 { @ Rule 31.28 : ACTIVE is not allowed under pad.
           PAD AND ACT_WO_ACTMFG
       }

R31.29 { @ Rule 31.29 : POLY is not allowed under pad
           PAD AND POLY
       }

R31.imp1 { @ Rule 31.imp1 : ME1 max area on PAD =< 137.
             BPMT1 = ME1 AND STDPAD:3
         AREA BPMT1 > 137
     }

R31.imp2 { @ Rule 31.imp2 : ME2 max area on PAD =< 137.
             BPMT2 = ME2 AND PAD
         AREA BPMT2 > 137
     }

R31.imp3 { @ Rule 31.imp3 : ME3 max area on PAD =< 137.
             BPMT3 = ME3 AND PAD
         AREA BPMT3 > 137
     }

R31.imp4 { @ Rule 31.imp4 : ME4 max area on PAD =< 137.
             BPMT4 = ME4 AND PAD
         AREA BPMT4 > 137
     }

R31.imp5 { @ Rule 31.imp5 : ME5 max area on PAD =< 137.
             BPMT5 = ME5 AND PAD
         AREA BPMT5 > 137
     }

R31.imp6 { @ Rule 31.imp6 : ME1 is required under standard pad.
             STDPAD:3 OUTSIDE ME1
     }
      
R31.imp7 { @ Rule 31.imp7 : VI1 is required under standard pad.
             STDPAD:3 OUTSIDE VI1
     }

R31.imp8 { @ Rule 31.imp8 : ME2 is required under standard pad.
             STDPAD:3 OUTSIDE ME2
     }

R31.imp9 { @ Rule 31.imp9 : VI2 is required under standard pad.
             STDPAD:3 OUTSIDE VI2
     }

R31.imp10 { @ Rule 31.imp10 : ME3 is required under standard pad.
              STDPAD:3 OUTSIDE ME3
      }

R31.imp11 { @ Rule 31.imp11 : VI3 is required under standard pad.
              STDPAD:3 OUTSIDE VI3
      }

R31.imp12 { @ Rule 31.imp12 : ME4 is required under standard pad.
              STDPAD:3 OUTSIDE ME4
      }

R31.imp13 { @ Rule 31.imp13 : VI4 is required under standard pad.
              STDPAD:3 OUTSIDE VI4
      } 

R31.imp14 { @ Rule 31.imp14 : ME5 is required under pad.
              PAD OUTSIDE ME5
      }

R31.imp15 { @ Rule 31.imp15 : VI5 is required under pad.
              PAD OUTSIDE VI5
      }

R31.imp16 { @ Rule 31.imp16 : ME6 is required under pad.
              PAD NOT ME6
      }

//  -------------------------------------------------------------------------
//      NITRIDE/BUMPING [CAD layer]
//  -------------------------------------------------------------------------
#IFDEF BUMPING

RB31.1 { @ Rule B31.1 : NITRIDE drawing not allowed with PRL.
           NITRIDE AND PRL
       }

RB31.2 { @ Rule B31.2 : PRL is mandatory under NITRIDE bumping.
           PAD_FC NOT PRL
       }
#ELSE

RBU.1 { @ Rule BU.1 : ME6 enclosure of NITRIDE >= 5.0.
          ENC PAD_FC UPMETALPAD_FC < 5.0 ABUT<90 SINGULAR
      }
#ENDIF

#IFDEF ClassPAD ClassFlipChip

// ----------------------------------------------------------------------------
//        BUMPING  PADS  ASSEMBLY  RULES  for  DEVICE  CLASS  FlipChip
// ----------------------------------------------------------------------------

RBP1_FlipChip { @ Rule BP1 (Device Class FlipChip) : Minimum width of upper metal enclose nitride opening windows of pad flip_chip must be >= 115um
                @ and nitride bumping must be centered inside the upper metal pad.
              MIN_WIDTH_OF_UPMETAL = ( SIZE PAD_FC BY 17.5 ) AND UPMETALPAD_FC 
              INT MIN_WIDTH_OF_UPMETAL < 115 OPPOSITE PARALLEL 
              }

RBP3_FlipChip { @ Rule BP3 (Device Class FlipChip) : Upper metal enclosure of NITRIDE bumping must be >= 17um.
                  ENC PAD_FC UPMETALPAD_FC < 17
              }

RBP.imp1_FlipChip { @ Rule BP.imp1 (Device Class FlipChip) : pad opening window must be octagonal.
                      PAD_FC VERTEX >= 3 <=7
              }

RBP2_FlipChip { @ Rule BP2 (Device Class FlipChip) : pad opening window min=max == 80 um x 80 um.
                  PAD_FC INTERACT (PAD_FC NOT PADBUMP_OPEN_WINDOW)
                  INT PAD_FC < 80 ABUT>0<90 SINGULAR OPPOSITE PARALLEL
          }

RBP4_FlipChip { @ Rule BP4 (Device Class FlipChip) : minimum pad pitch >= 250um.
                  EXT PAD_FC  < 170
          }

RBP5_FlipChip { @ Rule BP5 (Device Class FlipChip) : Minimum distance from pad center to scribe line >= 92 um.
              NITRIDE_bumpingSZ = SIZE NITRIDE_bumping BY 39
              SEALRING_BUMP INSIDE EDGE NITRIDE_bumpingSZ
          }

#ENDIF
// this must must be keept for modularity !!!!!!

//------------------------------------------------------------------------------
//       ANTENNA  CHECK  for  POLY/NWELL  CAPACITOR
//------------------------------------------------------------------------------

CP1NWANOTGO2 = ( CP1NWAC:2 AND POLY ) OUTSIDE GO2
PO1CAPNWNOTGO2 = POLY INTERACT CP1NWANOTGO2
PO1CTCAPNWNOTGO2 = (CONTACT_0 NOT INSIDE CELL 'antifuseCapacitorCell6112000') AND PO1CAPNWNOTGO2

// PO1CTCAPNWNOTGO2 = CONTACT AND PO1CAPNWNOTGO2   no more used because of antifuse cell that contains 6 contact for one capacitor
// The error is filtered by the not inside cell command 

CP1NWA = ( CP1NWAC:2 AND POLY ) INSIDE GO2
CP1NWA_5 = ( CP1NWAC:1_5 AND POLY ) INSIDE GO2_5V
PO1CAPNW = POLY INTERACT CP1NWA
PO1CAPNW_5 = POLY INTERACT CP1NWA_5
PO1CTCAPNW = CONTACT AND PO1CAPNW
PO1CTCAPNW_5 = CONTACT AND PO1CAPNW_5
B = AREA BULK <  1e06
C = AREA BULK >= 1e06

RCAP01.1 { @ Rule CAP01.1 : NWELL enclosure of ACTIVE of capacitor POLY/NWELL >= 0.3.
         ENC CP1NWAC:2 NWELL < 0.3 ABUT<90
    }

RCAP19.1 { @ Rule CAP19.1 : maximum number of CONTACT on POLY = 4.
             X = PO1CAPNW ENCLOSE PO1CTCAPNW > 4
             Y = PO1CAPNWNOTGO2 ENCLOSE PO1CTCAPNWNOTGO2 > 4
             PO1CTCAPNW INTERACT X
             PO1CTCAPNWNOTGO2 INTERACT Y
         }

RCAP13.2 { @ Rule CAP13.2 : maximum POLY top plate area of POLY/NWELL double oxide capacitor = 1000 um2.
             AREA CP1NWA > 1000 
         }

RCAP13.3 { @ Rule CAP13.3 : maximum POLY top plate area of POLY/NWELL simple oxide capacitor = 100 um2.
             AREA CP1NWANOTGO2 > 100 
         }

RCAP13.4a { @ Rule CAP13.4a : maximum cumulated capacitor area (without GO2) if circuit >= 1mm2 <= 0.01.
          Y = C AND CP1NWNOTGO2
          DENSITY Y > 0.01
      }

RCAP13.4b { @ Rule CAP13.4b : maximum POLY area par capacitor (without GO2) if circuit < 1mm2 <= 10000
          X = B AND CP1NWNOTGO2
          AREA X > 10000
      }

//------------------------------------------------------------------------------
//       DESIGN RULES FOR H-TYPE TRANSISTORS
//------------------------------------------------------------------------------

RHTT.1 { @ Rule RHTT.1 : Chanel width for H-type 5V transistors >= 0.52.
           INT GATEH_5V_L < 0.52 ABUT>0<90 OPPOSITE
       }

RHTT.2 { @ Rule RHTT.2 : Chanel length for H-type 5V transistors >= 0.50.
           INT GATEH_5V_W < 0.50 ABUT>0<90 OPPOSITE
       }

GATEH_5V_BEAM_WO_OTP = GATEH_5V_BEAM NOT GATEH_5V_OTP

RHTT.3 { @ Rule RHTT.3 : Fixed width of gate finger of transistor, except for OTP cell == 0.24.
           INT GATEH_5V_BEAM_WO_OTP < 0.24 ABUT>0<90 OPPOSITE
       SIZE GATEH_5V_BEAM_WO_OTP BY 0.12 UNDEROVER
       }

WC_H_5V_WO_OTP = WC_H_5V NOT INTERACT GATEH_5V_OTP

RHTT.4 { @ Rule RHTT.4 : Width of ACTIVE for well contact in H-type transistor, except for OTP cell >= 0.40.
           INT WC_H_5V_WO_OTP < 0.40 ABUT>0<90 OPPOSITE
       }

SD_NEXT_5 = NEXT_5V INTERACT NGATEH_5V
SD_NPLUS = NPLUS INTERACT NGATEH_5V
SD_PEXT_5 = PEXT_5V INTERACT PGATEH_5V
SD_PPLUS = PPLUS INTERACT PGATEH_5V
ACT_H5N = (ACTIVE INTERACT NGATEH_5V) NOT INTERACT OTP
ACT_H5P = (ACTIVE INTERACT PGATEH_5V) NOT INTERACT OTP
ACT_H5_WCP = ACT_H5N NOT SD_NEXT_5
ACT_H5_WCN = ACT_H5P NOT SD_PEXT_5

RHTT.5 { @ Rule RHTT.5 : Drawing of N+/NEXT_5V and P+/PEXT_5V in S/D is the same.
           (SD_NEXT_5 XOR SD_NPLUS) AND ACTIVE  //ticket added active for sd only 
           (SD_PEXT_5 XOR SD_PPLUS) AND ACTIVE
           ACT_H5_WCP AND PEXT_5V
           ACT_H5_WCN AND NEXT_5V
       }

POLYWC_H_5V_WO_OTP = POLYWC_H_5V NOT GATEH_5V_OTP

RHTT.6 { @ Rule RHTT.6 : Fixed POLY intersection with Well contact implantation in H-type transistor == 0.12.
           INT POLYWC_H_5V_WO_OTP < 0.12 ABUT>0<90 OPPOSITE
       SIZE POLYWC_H_5V_WO_OTP BY 0.06 UNDEROVER
       }

RHTT.7 { @ Rule RHTT.7 : Well contact distance to Poly in H-type transistor >= 0.14.
           EXT CONTACT GATEH_5V < 0.14 ABUT<90 REGION
       }

RHTT.8 { @ Rule RHTT.8 : Well contact areas of H-type transistors must be shorted in metall.
           X1 = GATEH_5V TOUCH WC_H_5V > 1 BY NET
       WC_H_5V TOUCH X1
       }
       
RHTT.9 { @ Rule RHTT.9 : NPLUS is abutting to PPLUS over POLY.
           (GATEH_5V NOT NPLUS) NOT PPLUS
       (GATEH_5V AND NPLUS) AND PPLUS
       }

//------------------------------------------------------------------------------
//       DESIGN RULES FOR NWELL2 RESISTORS
//------------------------------------------------------------------------------

RNWELL2_W = MRES_50 COINCIDENT EDGE NWELL2

RNW2.1 { @ Rule RNW2.1 : Width of NWELL2 resistors >= 1.0.
           INT RNWELL2_W < 1.0 ABUT>0<90
       }

RNW2.3 { @ Rule RNW2.3 : Length of NWELL2 resistors >= 1.0.
           EXT NACTRNW2 < 1.0 ABUT>0<90
       }

#IFDEF RECOMMENDED_ANALOG_USE

RNW2.2 { @ Rule RNW2.2 : Recommended width of NWELL2 resistors for analog use >= 3.2.
           INT RNWELL2_W < 3.2 ABUT>0<90
       }

RNW2.4 { @ Rule RNW2.4 : Recommended length of NWELL2 resistors for analog use >= 1.4.
           EXT NACTRNW2 < 1.4 ABUT>0<90
       }

#ELSE
#ENDIF

RNW2.5 { @ Rule RNW2.5 : N+ active contact head enclosure by NWELL2 >= 0.3.
           ENC NACTRNW2 NWELL2 < 0.3 ABUT>=0<90 SINGULAR REGION
       }

RNW2_REG = NWELL2 ENCLOSE MRES_50

RNW2.6 { @ Rule RNW2.6 : Distance from resistor's area to NWELL or NWELL2
         @ if NWELL and NWELL2 are at ground >= 2.0.
           EXT RNW2_REG NWELLC_GND < 2.0 ABUT>0<90 SINGULAR REGION
       EXT RNW2_REG NWELL2C_GND < 2.0 ABUT>0<90 SINGULAR REGION
       }

RNW2.7 { @ Rule RNW2.7 : Distance from resistor's area to N+ active > 0.84.
           EXT RNW2_REG NACTIVE < 0.84 ABUT<90 SINGULAR REGION
       }

RNW2.8 { @ Rule RNW2.8 : Distance from resistor's area to P+ active > 0.6.
           EXT RNW2_REG PACTIVE < 0.6 ABUT<90 SINGULAR REGION
       }

RNW2.9 { @ Rule RNW2.9 : Poly on NWELL2 resistor is not allowed.
            RNWELL2 AND POLY
        }

RNW2.10 { @ Rule RNW2.10 : DAA in NWELL2 resistor is not allowed.
            RNWELL2 AND ACTIVE_4
        }

RNW2.11 { @ Rule RNW2.11 : P+ active on NWELL2 resistor is not allowed.
            RNWELL2 AND PACTIVE
        }

//------------------------------------------------------------------------------
//       Specific design rules for N+ POLY/NWELL2 capacitors (antenna rules)
//------------------------------------------------------------------------------

RCAPNNW2.1 { @ Rule RCAPNNW2.1 : MAX POLY area per capacitor with GO2_5V == 1000 um2.
               AREA CP1NWA_5 > 1000 
           }

RCAPNNW2.2 { @ Rule RCAPNNW2.2 : Maximum number of CONTACT on N+POLY == 4.
             X = PO1CAPNW_5 ENCLOSE PO1CTCAPNW_5 > 4
             PO1CTCAPNW_5 INTERACT X
           }

//------------------------------------------------------------------------------
//       Design rules for OTP memory cell
//------------------------------------------------------------------------------

R2.1.d { @ Rule R2.1.d : Chanel width for OTP cell transistor >= 1.0.
           INT GATEH_5V_L_OTP < 1.0 ABUT>0<90 OPPOSITE
       }

R13.1.e { @ Rule R13.1.e : Chanel length for OTP cell transistor >= 0.80.
            INT GATEH_5V_W_OTP < 0.80 ABUT>0<90 OPPOSITE
        }

R91.6 { @ Rule R91.6 : OTP enclosure of POLY >= 0.24.
          ENC POLY OTP < 0.24 ABUT<90 SINGULAR
      }

R7.9 { @ Rule R7.9 : GO2_5V enclosure of gate of cell transistor >= 0.26.
          ENC GATEH_5V_OTP GO2_5V < 0.26 ABUT<90 SINGULAR
     }

R7.10 { @ Rule R7.10 : GO2_5V distance to top plate of OTP capacitor >= 0.26.
          EXT POLY_PLATE_OTP GO2_5V < 0.26 ABUT<90 SINGULAR REGION
      }

R16.13 { @ Rule R16.13 : Intersection of sidewall of gate and N+ area >= 0.26.
           INT GATEH_5V_BEAM_OTP_N < 0.26 ABUT>0<90 REGION
       }

R17.13 { @ Rule R17.13 : Intersection of sidewall of gate and N+ area >= 0.26.
           INT GATEH_5V_BEAM_OTP_P < 0.26 ABUT>0<90 REGION
       }

R78.9 { @ Rule R78.9 : Layer NEXT_5V coincides with layer NPLUS in memory cell.
          NEXT_5V_OTP XOR NPLUS_OTP
       }

R79.9 { @ Rule R79.9 : Layer PEXT_5V coincides with layer PPLUS in memory cell.
          PEXT_5V_OTP XOR PPLUS_OTP
       }

// //////////////////////////////////////////////////////////////////////////////
// /              ANTENNA  DESIGN  RULES                                        /
// //////////////////////////////////////////////////////////////////////////////

// Define the Antenna check ratio:
VARIABLE ANT_RATPO  60
VARIABLE ANT_RATIO  60

CHANN = ACTIVE AND POLY
LILCT:2 = CONTACT AND LILINT
ACTCT:1 = CONTACT AND (ACTIVE NOT POLY)
ACTCT:2 = ACTCT:1 NOT (CONTACT INTERACT LIL)
POLCT:1 = CONTACT AND POLY
POLCT:2 = POLCT:1 NOT (CONTACT INTERACT LIL)
ACTDIF:1 = ACTIVE NOT POLY

// ------------------------------------------------------------------------------
//        POLY  ANTENNA  CHECK
// ------------------------------------------------------------------------------
 
POL_P = BULK AND POLY
GAT_P = COPY CHANN
CONNECT POL_P GAT_P

BAD_GAT0P = NET AREA RATIO POL_P GAT_P >= 60 ACCUMULATE
BAD_GATEP = STAMP BAD_GAT0P BY GAT_P

#IFDEF drcANTENNA_MOS
POLY_ANT { @ Rule POLY_ANT: Gates exceeding antenna ratio of 60 at the POLY stage.
             NET AREA RATIO POL_P GAT_P >= 60 ACCUMULATE
             NET AREA RATIO PRINT BAD_GAT0P "./gate.atPoly"
         }
    
POLY_XPO { @ Rule POLY_XPO : POLY parts causing ratio violation at the POLY stage.
             NET AREA RATIO POL_P BAD_GATEP > 0
         }

#ELSE
#ENDIF

POL_ACC = NET AREA RATIO POL_P GAT_P  >= 0 ACCUMULATE

// Memorizes the POLY charging share onto each gate connected to it.

// ------------------------------------------------------------------------------
//        LIL  ANTENNA  CHECK
// ------------------------------------------------------------------------------
 
ACTDIF_L = COPY ACTDIF:1
POL_L = COPY POL_P
LIL_L = BULK AND (CONTACT OR LIL)

CONNECT LIL_L ACTDIF_L
CONNECT LIL_L POL_L
GAT_L = STAMP CHANN BY POL_L

TMP:0 = NET AREA RATIO LIL_L ACTDIF_L == 0
// Selects LIL not connected to an ACTIVE area.

LIL_CK_L = COPY TMP:0

BAD_GAT0L = NET AREA RATIO LIL_CK_L GAT_L >= 60 ACCUMULATE POL_ACC
// Detects gates with ratio violation of 60 at LIL stage ( Poly cumulated also )
BAD_GATEL = STAMP BAD_GAT0L BY GAT_L

#IFDEF drcANTENNA_MOS
LIL_ANT { @ Rule LIL : Gates exceeding antenna ratio of 60 at the LIL stage.
            NET AREA RATIO LIL_CK_L GAT_L >= 60 ACCUMULATE POL_ACC
            NET AREA RATIO PRINT BAD_GAT0L "./gate.atLil"
        }

// Outputs - the gates in error at the LIL stage
//         - for the violations, lists the gates coords and ratio value attached in gate.atLil
 
LIL_XPOL { @ Rule LIL_XPOL : Poly parts involved in ratio violation at the LIL stage.
             NET AREA RATIO POL_L BAD_GATEL > 0
         }

LIL_XLIL { @ Rule LIL_XLIL : Lil parts involved in ratio violation at the LIL stage.
             NET AREA RATIO LIL_CK_L BAD_GATEL > 0
         }

#ELSE
#ENDIF

LIL_ACC = NET AREA RATIO LIL_CK_L GAT_L  >=0 ACCUMULATE POL_ACC
// Memorizes the LIL charging share onto each gate connected to it.

LIL_CX_L = NET AREA RATIO LIL_CK_L GAT_L > 0
// Selects LIL directly connected to a gate at the LIL stage.
 
// ------------------------------------------------------------------------------
//        METAL1  ANTENNA  CHECK
// ------------------------------------------------------------------------------
 
ACTCT_A = COPY ACTCT:2
POLCT_A = COPY POLCT:2
ACTDIF_A = COPY ACTDIF:1
POL_A = COPY POL_L
ME1_A = ME1 AND BULK
LILCT_A = COPY LILCT:2
LIL_A = COPY LIL_L

CONNECT ME1_A LIL_A BY LILCT_A
CONNECT LIL_A ACTDIF_A
CONNECT LIL_A POL_A
GAT_A = STAMP CHANN BY POL_A

TMP:5 = NET AREA RATIO ME1_A ACTDIF_A == 0
// Selects ME1 not connected to an ACTIVE area.

M1_CK_A = COPY TMP:5
// ME1 not connected to an ACTIVE area.

BAD_GATE01 = NET AREA RATIO M1_CK_A GAT_A >= 60 ACCUMULATE LIL_ACC
// Detects gates with ratio violation of 60 at the metal1 stage
BAD_GATE1 = STAMP BAD_GATE01 BY GAT_A

#IFDEF drcANTENNA_MOS
M1_XANT { @ Rule M1_XANT : Gates exceeding antenna ratio of 60 at the ME1 stage.
            NET AREA RATIO  M1_CK_A GAT_A  >= 60 ACCUMULATE LIL_ACC
            NET AREA RATIO PRINT BAD_GATE01 "./gate.atM1"
        }

// Outputs - the gates in error at the ME1 stage
//         - for the violations, lists the gates coords and ratio value attached in gate.atMx
#ELSE
#ENDIF

LIL_CX_A = COPY LIL_CX_L
LIL_CK_A = STAMP LIL_CX_A BY LIL_A
// Selects LIL directly connected to a gate at the LIL stage.

#IFDEF drcANTENNA_MOS
M1_XPOL { @ Rule M1_XPOL : POLY parts involved in ratio violation at ME1 stage.
            NET AREA RATIO POL_A BAD_GATE1 > 0
        }

M1_XLIL { @ Rule M1_XLIL : Lil parts involved in ratio violation at metal1 stage.
            NET AREA RATIO LIL_CK_A BAD_GATE1 > 0
        }

M1_XME1 { @ Rule M1_XME1 : Metal1 parts involved in ratio violation at metal1 stage.
            NET AREA RATIO M1_CK_A BAD_GATE1 > 0
        }

#ELSE
#ENDIF

M1_ACC = NET AREA RATIO M1_CK_A GAT_A >= 0 ACCUMULATE LIL_ACC
// Memorizes the ME1 charging share onto each gate connected to it.
 
M1_CX_A = NET AREA RATIO M1_CK_A GAT_A > 0
// Selects ME1 directly connected to a gate at the ME1 stage.

// ------------------------------------------------------------------------------
//        METAL2  ANTENNA  CHECK
// ------------------------------------------------------------------------------

ACTCT_B = COPY ACTCT_A
POLCT_B = COPY POLCT_A
ACTDIF_B = COPY ACTDIF_A
POL_B = COPY POL_A
ME1_B = COPY ME1_A
VI1_B = VI1 AND BULK
ME2_B = ME2 AND BULK
LILCT_B = COPY LILCT_A
LIL_B = COPY LIL_A

CONNECT ME2_B ME1_B BY VI1_B
CONNECT ME1_B LIL_B BY LILCT_B
CONNECT LIL_B ACTDIF_B
CONNECT LIL_B POL_B
GAT_B = STAMP CHANN BY POL_B

TMP:6 = NET AREA RATIO ME2_B ACTDIF_B == 0
// Selects metal2 not connected to an active area

M2_CK_B = COPY TMP:6
// Metal2 not connected to an active area

BAD_GATE02 = NET AREA RATIO M2_CK_B GAT_B >= 60 ACCUMULATE M1_ACC
// Detects gates with ratio violation of 60 at the ME2 stage.
BAD_GATE2 = STAMP BAD_GATE02 BY GAT_B

#IFDEF drcANTENNA_MOS
M2_XANT { @ Rule M2_ANT: Gates exceeding antenna ratio of 60 at the ME2 stage.
            NET AREA RATIO  M2_CK_B GAT_B >= 60 ACCUMULATE M1_ACC
            NET AREA RATIO PRINT BAD_GATE02 "./gate.atM2"
        }

// Outputs - the gates in error at the metal2 stage
//         - for the violations, lists the gates coords and ratio value attached in gate.atMx
#ELSE
#ENDIF

LIL_CX_B = COPY LIL_CX_A
LIL_CK_B = STAMP LIL_CX_B BY LIL_B
// Selects LIL directly connected to a gate at the LIL stage.

M1_CX_B = COPY M1_CX_A
M1_CK_B = STAMP M1_CX_B BY ME1_B
// Selects ME1 directly connected to a gate at the ME1 stage.

#IFDEF drcANTENNA_MOS
M2_XPOL { @ Rule M2_XPOL : Poly parts involved in ratio violation at ME2 stage.
            NET AREA RATIO POL_B BAD_GATE2 > 0
        }

M2_XLIL { @ Rule M2_XLIL : LIL parts involved in ratio violation at ME2 stage.
            NET AREA RATIO LIL_CK_B BAD_GATE2 > 0
        }

M2_XME1 { @ Rule M2_XME1 : ME1 parts involved in ratio violation at ME2 stage.
            NET AREA RATIO M1_CK_B BAD_GATE2 > 0
        }

M2_XME2 { @ Rule M2_XME2 : ME2 parts involved in ratio violation at ME2 stage.
            NET AREA RATIO M2_CK_B BAD_GATE2 >0
        }

#ELSE
#ENDIF

M2_ACC = NET AREA RATIO M2_CK_B GAT_B >= 0 ACCUMULATE M1_ACC
// Memorizes the ME2 charging share onto each gate connected to it.
 
M2_CX_B = NET AREA RATIO M2_CK_B GAT_B > 0
// Selects ME2 directly connected to a gate at the ME2 stage.

// ------------------------------------------------------------------------------
//        METAL3  ANTENNA  CHECK
// ------------------------------------------------------------------------------

ACTCT_C = COPY ACTCT_B
POLCT_C = COPY POLCT_B
ACTDIF_C = COPY ACTDIF_B
POL_C = COPY POL_B
ME1_C = COPY ME1_B
VI1_C = COPY VI1_B
ME2_C = COPY ME2_B
VI2_C = VI2 AND BULK
ME3_C = ME3 AND BULK
LILCT_C = COPY LILCT_B
LIL_C = COPY LIL_B

CONNECT ME3_C ME2_C BY VI2_C
CONNECT ME2_C ME1_C BY VI1_C 
CONNECT ME1_C LIL_C BY LILCT_C
CONNECT LIL_C ACTDIF_C
CONNECT LIL_C POL_C
GAT_C = STAMP CHANN BY POL_C

TMP:7 = NET AREA RATIO ME3_C ACTDIF_C == 0
// Selects ME3 not connected to an ACTIVE area.

M3_CK_C = COPY TMP:7
// ME3 not connected to an ACTIVE area.

BAD_GATE03 = NET AREA RATIO M3_CK_C GAT_C >= 60 ACCUMULATE M2_ACC
// Detects gates with ratio violation of 60 at the ME3 stage.
BAD_GATE3 = STAMP BAD_GATE03 BY GAT_C

#IFDEF drcANTENNA_MOS
M3_XANT { @ Rule M3_XANT : Gates exceeding antenna ratio of 60 at the ME3 stage.
            NET AREA RATIO M3_CK_C GAT_C >= 60 ACCUMULATE M2_ACC
            NET AREA RATIO PRINT BAD_GATE03 "./gate.atM3"
        }

// Outputs - the gates in error at the ME3 stage
//         - for the violations, lists the gates coords and ratio value attached in gate.atMx
#ELSE
#ENDIF

LIL_CX_C = COPY LIL_CX_B
LIL_CK_C = STAMP LIL_CX_C BY LIL_C
// Selects LIL directly connected to a gate at the LIL stage.

M1_CX_C = COPY M1_CX_B
M1_CK_C = STAMP M1_CX_C BY ME1_C
// Selects ME1 directly connected to a gate at the ME1 stage.
 
M2_CX_C = COPY M2_CX_B
M2_CK_C = STAMP M2_CX_C BY ME2_C
// Selects ME2 directly connected to a gate at the ME2 stage.
 
#IFDEF drcANTENNA_MOS
M3_XPOL { @ Rule M3_XPOL : POLY parts involved in ratio violation at ME3 stage.
            NET AREA RATIO POL_C BAD_GATE3 > 0
        }

M3_XLIL   { @Rule M3_XLIL : LIL parts involved in ratio violation at ME3 stage.
            NET AREA RATIO LIL_CK_C BAD_GATE3 > 0
          }

M3_XME1 { @ Rule M3_XME1 : ME1 parts involved in ratio violation at ME3 stage.
            NET AREA RATIO M1_CK_C BAD_GATE3 > 0
        }

M3_XME2 { @ Rule M3_XME2 : ME2 parts involved in ratio violation at ME3 stage.
            NET AREA RATIO M2_CK_C BAD_GATE3 > 0
        }

M3_XME3 { @ Rule M3_XME3 : ME3 parts involved in ratio violation at ME3 stage.
            NET AREA RATIO M3_CK_C BAD_GATE3 > 0
        }

#ELSE
#ENDIF

M3_ACC = NET AREA RATIO M3_CK_C GAT_C >=0 ACCUMULATE M2_ACC
// Memorizes the ME3 charging share onto each gate connected to it.

M3_CX_C = NET AREA RATIO M3_CK_C GAT_C > 0
// Selects ME3 directly connected to a gate at the ME3 stage.

// ------------------------------------------------------------------------------
//        METAL4  ANTENNA  CHECK
// ------------------------------------------------------------------------------

ACTCT_D = COPY ACTCT_C
POLCT_D = COPY POLCT_C
ACTDIF_D = COPY ACTDIF_C
POL_D = COPY POL_C
ME1_D = COPY ME1_C
VI1_D = COPY VI1_C
ME2_D = COPY ME2_C
VI2_D = COPY VI2_C
ME3_D = COPY ME3_C
VI3_D = VI3 AND BULK
ME4_D = ME4 AND BULK
LILCT_D = COPY LILCT_C
LIL_D = COPY LIL_C

CONNECT ME4_D ME3_D BY VI3_D
CONNECT ME3_D ME2_D BY VI2_D
CONNECT ME2_D ME1_D BY VI1_D 
CONNECT ME1_D LIL_D BY LILCT_D
CONNECT LIL_D ACTDIF_D
CONNECT LIL_D POL_D
GAT_D = STAMP CHANN BY POL_D

TMP:8 = NET AREA RATIO ME4_D ACTDIF_D == 0
// Selects ME4 not connected to an ACTIVE area.

M4_CK_D = COPY TMP:8
// ME4 not connected to an ACTIVE area.

BAD_GATE04 = NET AREA RATIO M4_CK_D GAT_D >= 60 ACCUMULATE M3_ACC
// Detects gates with ratio violation of 60 at the ME4 stage.
BAD_GATE4 = STAMP BAD_GATE04 BY GAT_D

#IFDEF drcANTENNA_MOS
M4_XANT { @ Rule M4_XANT: Gates exceeding antenna ratio of 60 at the ME4 stage.
            NET AREA RATIO  M4_CK_D GAT_D >= 60 ACCUMULATE M3_ACC
            NET AREA RATIO PRINT BAD_GATE04 "./gate.atM4"
        }

// Outputs - the gates in error at the ME4 stage
//         - for the violations, lists the gates coords and ratio value attached in gate.atMx
#ELSE
#ENDIF

LIL_CX_D = COPY LIL_CX_C
LIL_CK_D = STAMP LIL_CX_D BY LIL_D
// Selects LIL directly connected to a gate at the LIL stage.

M1_CX_D = COPY M1_CX_C
M1_CK_D = STAMP M1_CX_D BY ME1_D
// Selects ME1 directly connected to a gate at ME1 stage.

M2_CX_D = COPY M2_CX_C
M2_CK_D = STAMP M2_CX_D BY ME2_D
// Selects ME2 directly connected to a gate at ME2 stage.

M3_CX_D = COPY M3_CX_C
M3_CK_D = STAMP M3_CX_D BY ME3_D
// Selects ME3 directly connected to a gate at ME3 stage.

#IFDEF drcANTENNA_MOS
M4_XPOL { @ Rule M4_XPOL : POLY parts involved in ratio violation at ME4 stage.
            NET AREA RATIO POL_D BAD_GATE4 > 0
        }

M4_XLIL { @ Rule M4_XLIL : LIL parts involved in ratio violation at ME4 stage.
            NET AREA RATIO LIL_CK_D BAD_GATE4 > 0
        }

M4_XME1 { @ Rule M4_XME1 : ME1 parts involved in ratio violation at ME4 stage.
            NET AREA RATIO M1_CK_D BAD_GATE4 > 0
        }

M4_XME2    { @Rule M4_XME2 : ME2 parts involved in ratio violation at ME4 stage.
             NET AREA RATIO M2_CK_D BAD_GATE4 > 0
           }
      
M4_XME3    { @Rule M4_XME3 : ME3 parts involved in ratio violation at ME4 stage.
             NET AREA RATIO M3_CK_D BAD_GATE4 > 0
           }
      
M4_XME4    { @Rule M4_XME4 : ME4 parts involved in ratio violation at ME4 stage.
             NET AREA RATIO M4_CK_D BAD_GATE4 > 0
           }

#ELSE
#ENDIF

M4_ACC = NET AREA RATIO M4_CK_D GAT_D >= 0 ACCUMULATE M3_ACC
// Memorizes the ME4 charging share onto each gate connected to it.
 
M4_CX_D = NET AREA RATIO M4_CK_D GAT_D > 0
// Selects ME4 directly connected to a gate at the ME4 stage.

// ------------------------------------------------------------------------------
//        METAL5  ANTENNA  CHECK
// ------------------------------------------------------------------------------

ACTCT_E = COPY ACTCT_D
POLCT_E = COPY POLCT_D
ACTDIF_E = COPY ACTDIF_D
POL_E = COPY POL_D
ME1_E = COPY ME1_D
VI1_E = COPY VI1_D
ME2_E = COPY ME2_D
VI2_E = COPY VI2_D
ME3_E = COPY ME3_D
VI3_E = COPY VI3_D
ME4_E = COPY ME4_D
VI4_E = VI4 AND BULK
ME5_E = ME5 AND BULK
LILCT_E = COPY LILCT_D
LIL_E = COPY LIL_D

CONNECT ME5_E ME4_E BY VI4_E
CONNECT ME4_E ME3_E BY VI3_E
CONNECT ME3_E ME2_E BY VI2_E
CONNECT ME2_E ME1_E BY VI1_E 
CONNECT ME1_E LIL_E BY LILCT_E
CONNECT LIL_E ACTDIF_E
CONNECT LIL_E POL_E
GAT_E = STAMP CHANN BY POL_E

TMP:9 = NET AREA RATIO ME5_E ACTDIF_E == 0
// Selects ME5 not connected to an ACTIVE area.

M5_CK_E = COPY TMP:9
// ME5 not connected to an ACTIVE area.

BAD_GATE05 = NET AREA RATIO M5_CK_E GAT_E >= 60 ACCUMULATE M4_ACC
// Detects gates with ratio violation of 60 at the ME5 stage.
BAD_GATE5 = STAMP BAD_GATE05 BY GAT_E

#IFDEF drcANTENNA_MOS
M5_XANT { @ Rule M5_XANT: Gates exceeding antenna ratio of 60 at the ME5 stage
            NET AREA RATIO M5_CK_E GAT_E >= 60 ACCUMULATE M4_ACC
            NET AREA RATIO PRINT BAD_GATE05 "./gate.atM5"
        }

// Outputs - the gates in error at the metal5 stage
//         - for the violations, lists the gates coords and ratio value attached
#ELSE
#ENDIF

LIL_CX_E = COPY LIL_CX_D
LIL_CK_E = STAMP LIL_CX_E BY LIL_E
// Selects LIL directly connected to a gate at the LIL stage.

M1_CX_E = COPY M1_CX_D
M1_CK_E = STAMP M1_CX_E BY ME1_E
// Selects ME1 directly connected to a gate at ME1 stage.

M2_CX_E = COPY M2_CX_D
M2_CK_E = STAMP M2_CX_E BY ME2_E
// Selects ME2 directly connected to a gate at ME2 stage

M3_CX_E = COPY M3_CX_D
M3_CK_E = STAMP M3_CX_E BY ME3_E
// Selects ME3 directly connected to a gate at ME3 stage.

M4_CX_E = COPY M4_CX_D
M4_CK_E = STAMP M4_CX_E BY ME4_E
// Selects ME4 directly connected to a gate at ME4 stage.

#IFDEF drcANTENNA_MOS
M5_XPOL { @ Rule M5_XPOL : POLY parts involved in ratio violation at ME5 stage.
            NET AREA RATIO POL_E BAD_GATE5 > 0
        }

M5_XLIL { @ Rule M5_XLIL : LIL parts involved in ratio violation at ME5 stage.
            NET AREA RATIO LIL_CK_E BAD_GATE5 > 0
        }

M5_XME1    { @Rule M5_XME1 : ME1 parts involved in ratio violation at ME5 stage.
             NET AREA RATIO M1_CK_E BAD_GATE5 > 0
           }

M5_XME2    { @Rule M5_XME2 : ME2 parts involved in ratio violation at ME5 stage.
             NET AREA RATIO M2_CK_E BAD_GATE5 > 0
           }

M5_XME3    { @Rule M5_XME3 : ME3 parts involved in ratio violation at ME5 stage.
             NET AREA RATIO M3_CK_E BAD_GATE5 > 0
           }

M5_XME4    { @Rule M5_XME4 : ME4 parts involved in ratio violation at ME5 stage.
             NET AREA RATIO M4_CK_E BAD_GATE5 > 0
           }

M5_XME5    { @Rule M5_XME5 : ME5 parts involved in ratio violation at ME5 stage.
             NET AREA RATIO M5_CK_E BAD_GATE5 > 0
           }

#ELSE
#ENDIF

M5_ACC = NET AREA RATIO M5_CK_E GAT_E >= 0 ACCUMULATE M4_ACC
// Memorizes the ME5 charging share onto each gate connected to it.
 
M5_CX_E = NET AREA RATIO M5_CK_E GAT_E > 0
// Selects ME5 directly connected to a gate at ME5 stage.

// ------------------------------------------------------------------------------
//        METAL6  ANTENNA  CHECK
// ------------------------------------------------------------------------------

ACTCT_F = COPY ACTCT_E
POLCT_F = COPY POLCT_E
ACTDIF_F = COPY ACTDIF_E
POL_F = COPY POL_E
ME1_F = COPY ME1_E
VI1_F = COPY VI1_E
ME2_F = COPY ME2_E
VI2_F = COPY VI2_E
ME3_F = COPY ME3_E
VI3_F = COPY VI3_E
ME4_F = COPY ME4_E
VI4_F = COPY VI4_E
ME5_F = COPY ME5_E
VI5_F:1 = VI5 AND BULK
ME6_F = ME6 AND BULK
VI5_F:2 = VI5_F:1 NOT MIM5
VI5_F:3 = VI5_F:2 NOT HKMIM5
LILCT_F = COPY LILCT_E
LIL_F = COPY LIL_E

CONNECT ME6_F ME5_F BY VI5_F:3
CONNECT ME5_F ME4_F BY VI4_F
CONNECT ME4_F ME3_F BY VI3_F
CONNECT ME3_F ME2_F BY VI2_F
CONNECT ME2_F ME1_F BY VI1_F 
CONNECT ME1_F LIL_F BY LILCT_F
CONNECT LIL_F ACTDIF_F
CONNECT LIL_F POL_F
GAT_F = STAMP CHANN BY POL_F

TMP:10 = NET AREA RATIO ME6_F ACTDIF_F == 0
// Selects ME6 not connected to an ACTIVE area.

M6_CK_F = COPY TMP:10
// ME6 not connected to an ACTIVE area.

BAD_GATE06 = NET AREA RATIO M6_CK_F GAT_F >= 60 ACCUMULATE M5_ACC
// Detects gates with ratio violation of 60 at the ME6 stage.
BAD_GATE6 = STAMP BAD_GATE06 BY GAT_F

#IFDEF drcANTENNA_MOS
M6_XANT { @ Rule M6_XANT: Gates exceeding antenna ratio of 60 at the metal6 stage
            NET AREA RATIO  M6_CK_F GAT_F >= 60 ACCUMULATE M5_ACC
            NET AREA RATIO PRINT BAD_GATE06 "./gate.atM6"
        }

// Outputs - the gates in error at the metal6 stage
//         - for the violations, lists the gates coords and ratio value attached
#ELSE
#ENDIF

LIL_CX_F = COPY LIL_CX_E
LIL_CK_F = STAMP LIL_CX_F BY LIL_F
// Selects LIL directly connected to a gate at the LIL stage.
 
M1_CX_F = COPY M1_CX_E
M1_CK_F = STAMP M1_CX_F BY ME1_F
// Selects ME1 directly connected to a gate at the ME1 stage.

M2_CX_F = COPY M2_CX_E
M2_CK_F = STAMP M2_CX_F BY ME2_F
// Selects ME2 directly connected to a gate at the ME2 stage.

M3_CX_F = COPY M3_CX_E
M3_CK_F = STAMP M3_CX_F BY ME3_F
// Selects ME3 directly connected to a gate at the ME3 stage.
 
M4_CX_F = COPY M4_CX_E
M4_CK_F = STAMP M4_CX_F BY ME4_F
// Selects ME4 directly connected to a gate at the ME4 stage.

M5_CX_F = COPY M5_CX_E
M5_CK_F = STAMP M5_CX_F BY ME5_F
// Selects ME5 directly connected to a gate at the ME5 stage.

#IFDEF drcANTENNA_MOS
M6_XPOL { @ Rule M6_XPOL : POLY parts involved in ratio violation at ME6 stage.
            NET AREA RATIO POL_F BAD_GATE6 > 0
        }

M6_XLIL { @ Rule M6_XLIL : LIL parts involved in ratio violation at ME6 stage.
            NET AREA RATIO LIL_CK_F BAD_GATE6 > 0
        }

M6_XME1 { @ Rule M6_XME1 : ME1 parts involved in ratio violation at ME6 stage.
            NET AREA RATIO M1_CK_F BAD_GATE6 > 0
        }

M6_XME2 { @ Rule M6_XME2 : ME2 parts involved in ratio violation at ME6 stage.
            NET AREA RATIO M2_CK_F BAD_GATE6 > 0
        }

M6_XME3 { @ Rule M6_XME3 : ME3 parts involved in ratio violation at ME6 stage.
            NET AREA RATIO M3_CK_F BAD_GATE6 > 0
        }

M6_XME4 { @ Rule M6_XME4 : ME4 parts involved in ratio violation at ME6 stage.
            NET AREA RATIO M4_CK_F BAD_GATE6 > 0
        }

M6_XME5 { @ Rule M6_XME5 : ME5 parts involved in ratio violation at ME6 stage
            NET AREA RATIO M5_CK_F BAD_GATE6 > 0
        }

M6_XME6 { @ Rule M6_XME6 : ME6 parts involved in ratio violation at ME6 stage.
            NET AREA RATIO M6_CK_F BAD_GATE6 > 0
        }

#ELSE
#ENDIF

M6_ACC = NET AREA RATIO M6_CK_F GAT_F >= 0 ACCUMULATE M5_ACC
// Memorizes the ME6 charging share onto each gate connected to it.

M6_CX_F = NET AREA RATIO M6_CK_F GAT_F > 0
// Selects ME6 directly connected to a gate at the ME6 stage.

#IFDEF drcANTENNA_MOS

// //////////////////////////////////////////////////////////////////////////////
// /              ANTENNA CAPA DESIGN  RULES                                    /
// //////////////////////////////////////////////////////////////////////////////

LIL_M = COPY LIL_F
POL_M = COPY POL_F
ME1_M = COPY ME1_F
VI1_M = COPY VI1_F
ME2_M = COPY ME2_F
VI2_M = COPY VI2_F
ME3_M = COPY ME3_F
VI3_M = COPY VI3_F
ME4_M = COPY ME4_F
VI4_M = COPY VI4_F
ME5_M = COPY ME5_F

CONNECT ME5_M ME4_M BY VI4_M
CONNECT ME4_M ME3_M BY VI3_M
CONNECT ME3_M ME2_M BY VI2_M
CONNECT ME2_M ME1_M BY VI1_M 
CONNECT ME1_M LIL_M BY LILCT:2
CONNECT LIL_M ACTDIF:1
CONNECT LIL_M POL_M
 
TMP:3 = NET AREA RATIO ME5_M ACTDIF:1 == 0
// Selects ME5 not connected to an ACTIVE area.

// ------------------------------------------------------------------------------
//       ANTENNA  CHECK  for  MIM5  CAPACITOR 
// ------------------------------------------------------------------------------

RMT.ANT.1 { @ Rule MT.ANT.1: Capacitors in parallel must have separated ME5 plates.
              ME5 INTERACT MIM5 > 1
          }

RMT.ANT.3 { @ Rule MT.ANT.3: If ME5 of MIM capacitor is connected through ME4,
        @ this ME4 must be connected to other devices, ground or Vdd through
        @ a ME6 line.
              MIM5 NOT TMP:3
          }

BAD_ME5PLATE = (ME5_M INTERACT MIM5) NOT TMP:3

MT.XME5 { @ Rule MT.XME5 : ME5 parts involved in rule MT.ANT.3 violation.
            NET AREA RATIO ME5_M BAD_ME5PLATE > 0
    }
MT.XME4 { @ Rule MT.XME4 : ME4 parts involved in rule MT.ANT.3 violation.
            NET AREA RATIO ME4_M BAD_ME5PLATE > 0
    }
MT.XME3 { @ Rule MT.XME3 : ME3 parts involved in rule MT.ANT.3 violation.
            NET AREA RATIO ME3_M BAD_ME5PLATE > 0
    }
MT.XME2 { @ Rule MT.XME2 : ME2 parts involved in rule MT.ANT.3 violation.
            NET AREA RATIO ME2_M BAD_ME5PLATE > 0
    }
MT.XME1 { @ Rule MT.XME1 : ME1 parts involved in rule MT.ANT.3 violation.
            NET AREA RATIO ME1_M BAD_ME5PLATE > 0
        }
MT.XLIL { @ Rule MT.XLIL : LIL parts involved in rule MT.ANT.3 violation.
            NET AREA RATIO LIL_M BAD_ME5PLATE > 0
    }

MIM5AREA = AREA MIM5 < 1000

RMT.ANT.4 { @ Rule MT.ANT.4 : Maximum number of VI5 over MIM5
            @ of MIM5 capacitor plate if area < 1000 um2 = 4.
              X = (MIM5 INTERACT MIM5AREA) ENCLOSE VI5 > 4
              VI5 INTERACT X
          }

VI5MIM5 = VI5 AND MIM5
MIM5C2 = MIM5 NOT INTERACT MIM5AREA
CONNECT VI5MIM5 MIM5C2

RMT.ANT.5 { @ Rule MT.ANT.5 : Maximum number of VI5 over MIM5
            @ of MIM5 capacitor plate if area >= 1000 um2 = +2 via / 500 um2.
              NET AREA RATIO VI5MIM5 MIM5C2 > 1.44
          [(AREA(VI5MIM5) * 1000) / AREA(MIM5C2)]
          } 
    
VI5ME5 = VI5 AND (ME5 NOT MIM5)
VIMIM5 = COPY VI5MIM5
CONNECT VI5ME5  ME5_M
CONNECT VIMIM5  ME5_M

RMT.ANT.6 { @ Rule MT.ANT.6 : The number of VI5 connected to MIM5 plate
            @ should be identical to the number of VI5 over ME5 plate,
            @ including the VI5 connected through ME4.
              NET AREA RATIO VI5ME5 VIMIM5 != 1
              NET AREA RATIO VIMIM5 VI5ME5 != 1
              NET AREA RATIO VIMIM5 VI5ME5 == 0
          }

//The following rule is redundant after checking of MT.ANT.2 rule.
//RMT.ANT.7 { @ Rule MT.ANT.7: The standard pad including a great number of VI5 and VI4,
//            @ the direct connection to a ME5 capacitor plate through ME5 and ME4
//          @ is not allowed.
//        }

//The following rule is not intended for coding.
//RMT.ANT.8 { @ Rule MT.ANT.8: If ME6 connected to the plates of the capacitor, the length
//          @ of the two ME6 connections must be minimized if possible, identical.
//          }

RMT.ANT.9 { @ Rule MT.ANT.9 : Maximum length of ME6 connected to
        @ each plate of the MIM capacitor = 1000 um.
          X = ME6 INTERACT ((VI5 AND MIM5) OR (VI5 AND (ME5 INTERACT MIM5)))
          PERIMETER X > 2000
      }

RMT.ANT.10 { @ Rule MT.ANT.10 : Maximum ME6 antenna ratio = 400.
               NET AREA RATIO M6C:2 MIM5C > 400
           }

// ------------------------------------------------------------------------------
//       ANTENNA  CHECK  for  HKMIM5  CAPACITOR
// ------------------------------------------------------------------------------

RMT.ANT.1.HK { @ Rule MT.ANT.1.HK: Capacitors in parallel must have separated ME5 plates.
                 ME5 INTERACT HKMIM5 > 1
             }

RMT.ANT.3.HK { @ Rule MT.ANT.3.HK: If ME5 of HKMIM capacitor is connected through ME4,
           @ this ME4 must be connected to other devices, ground or Vdd through
           @ a ME6 line.
                 HKMIM5 NOT TMP:3
             }

BAD_ME5PLATE_HKMIM5 = (ME5_M INTERACT HKMIM5) NOT TMP:3

MT.XME5.HK { @ Rule MT.XME5.HK : ME5 parts involved in rule MT.ANT.3.HK violation 
               NET AREA RATIO ME5_M BAD_ME5PLATE_HKMIM5 > 0
       }
MT.XME4.HK { @ Rule MT.XME4.HK : ME4 parts involved in rule MT.ANT.3.HK violation 
               NET AREA RATIO ME4_M BAD_ME5PLATE_HKMIM5 > 0
       }
MT.XME3.HK { @ Rule MT.XME3.HK : ME3 parts involved in rule MT.ANT.3.HK violation 
               NET AREA RATIO ME3_M BAD_ME5PLATE_HKMIM5 > 0
       }
MT.XME2.HK { @ Rule MT.XME2.HK : ME2 parts involved in rule MT.ANT.3.HK violation 
               NET AREA RATIO ME2_M BAD_ME5PLATE_HKMIM5 > 0
       }
MT.XME1.HK { @ Rule MT.XME1.HK : ME1 parts involved in rule MT.ANT.3.HK violation 
               NET AREA RATIO ME1_M BAD_ME5PLATE_HKMIM5 > 0
       }
MT.XLIL.HK { @ Rule MT.XLIL.HK : LIL parts involved in rule MT.ANT.3.HK violation 
               NET AREA RATIO LIL_M BAD_ME5PLATE_HKMIM5 > 0
       }

HKMIM5AREA = AREA HKMIM5 < 1000

RMT.ANT.4.HK { @ MT.ANT.4.HK : Maximum number of VIA5 over HKMIM5 
               @ of HKMIM5 capacitor plate if area < 1000 um2 = 4.
                 X = (HKMIM5 INTERACT HKMIM5AREA) ENCLOSE VI5 > 4
                 VI5 INTERACT X 
             }

VI5HKMIM5 = VI5 AND HKMIM5
HKMIM5C2 = HKMIM5 NOT INTERACT HKMIM5AREA
CONNECT VI5HKMIM5 HKMIM5C2

RMT.ANT.5.HK { @ Rule MT.ANT.5.HK: Maximum number of VI5 over HKMIM5 
               @ of HKMIM5 capacitor plate if area > 1000 um2  = +2 via / 500 um2.
                 NET AREA RATIO VI5HKMIM5 HKMIM5C2 > 1.44
             [(AREA(VI5HKMIM5) * 1000) / AREA(HKMIM5C2)]
             } 
    
VI5ME5NOHKM = VI5 AND (ME5 NOT HKMIM5)
VIHKMIM5 = COPY VI5HKMIM5
CONNECT VI5ME5NOHKM  ME5_M
CONNECT VIHKMIM5  ME5_M

RMT.ANT.6.HK { @ Rule MT.ANT.6.HK: The number of VI5 connected to HKMIM5 plate
               @ should be identical to the number of VI5 connected ME5 plate,
               @ including the VI5 connected through ME4.
                 NET AREA RATIO VI5ME5NOHKM VIHKMIM5 != 1
                 NET AREA RATIO VIHKMIM5 VI5ME5NOHKM != 1
             NET AREA RATIO VIHKMIM5 VI5ME5NOHKM == 0
             }

//The following rule is redundant after checking of MT.ANT.2_HK rule.
//RMT.ANT.7.HK { @ Rule MT.ANT.7.HK: The standard pad including a great number of VI5 and VI4,
//               @ the direct connection to a ME5 capacitor plate through ME5 and ME4
//             @ is not allowed.
//             }

//The following rule is not intended for coding.
//RMT.ANT.8.HK { @ Rule MT.ANT.8.HK: If ME6 connected to the plates of the capacitor, the length
//             @ of the two ME6 connections must be minimized if possible, identical.
//             }

RMT.ANT.9.HK { @ Rule MT.ANT.9.HK: Maximum length of ME6 connected to
           @ each plate of the HKMIM capacitor = 1000 um.
             X = ME6 INTERACT ((VI5 AND HKMIM5) OR (VI5 AND (ME5 INTERACT HKMIM5)))
             PERIMETER X > 2000
      }

RMT.ANT.10.HK { @ Rule MT.ANT.10.HK: Maximum ME6 antenna ratio = 400.
                  NET AREA RATIO M6C:2 HKMIM5C > 400
              }

#ELSE
#ENDIF

//////////////////////////////////////////////////////////////////////////////
//             METAL SLOT CHECKS                                             /
//////////////////////////////////////////////////////////////////////////////

#IFDEF METAL_SLOT_CHECKS

M1 = ME1 NOT MFGPP_0
M2 = ME2 NOT MFGPP_0
M3 = ME3 NOT MFGPP_0
M4 = ME4 NOT MFGPP_0
M5 = ME5 NOT MFGPP_0
M6 = ME6 NOT MFGPP_0

BP1 = M6 ENCLOSE PAD
BP = MERGE (SIZE BP1 BY 29.99 UNDEROVER)

EPAD = EXTENTS PAD

ME1PADA = M1 NOT EPAD
ME2PADA = M2 NOT EPAD
ME3PADA = M3 NOT EPAD
ME4PADA = M4 NOT EPAD
ME5PADA = M5 NOT EPAD
ME6PADA = M6 NOT EPAD

ME1PADT = BP TOUCH EDGE ME1PADA
ME2PADT = BP TOUCH EDGE ME2PADA
ME3PADT = BP TOUCH EDGE ME3PADA
ME4PADT = BP TOUCH EDGE ME4PADA
ME5PADT = BP TOUCH EDGE ME5PADA
ME6PADT = BP TOUCH EDGE ME6PADA

ME1PADTE = EXPAND EDGE ME1PADT INSIDE BY 0.01
ME2PADTE = EXPAND EDGE ME2PADT INSIDE BY 0.01
ME3PADTE = EXPAND EDGE ME3PADT INSIDE BY 0.01
ME4PADTE = EXPAND EDGE ME4PADT INSIDE BY 0.01
ME5PADTE = EXPAND EDGE ME5PADT INSIDE BY 0.01
ME6PADTE = EXPAND EDGE ME6PADT INSIDE BY 0.01

ME1PADN = ME1PADA OR ME1PADTE
ME2PADN = ME2PADA OR ME2PADTE
ME3PADN = ME3PADA OR ME3PADTE
ME4PADN = ME4PADA OR ME4PADTE
ME5PADN = ME5PADA OR ME5PADTE
ME6PADN = ME6PADA OR ME6PADTE

ME1HOLG = (HOLES ME1PADN EMPTY) NOT EPAD
ME1HOL = RECTANGLE ME1HOLG >=7.0<=28.0 BY >=3.0<=28.0
ME1W = SIZE ME1PADN BY 5.99 UNDEROVER
ME1WL = LENGTH ME1W >= 30
ME1WI = ME1W WITH EDGE ME1WL
ME1WID = MERGE ME1WI

ME1H = ME1PADN OR ME1HOL
ME1HW = SIZE ME1H BY 5.99 UNDEROVER
ME1HWL = LENGTH ME1HW >= 30
ME1HWI = ME1HW WITH EDGE ME1HWL
ME1HWID = COPY ME1HWI

ME2HOLG = (HOLES ME2PADN EMPTY) NOT EPAD
ME2HOL = RECTANGLE ME2HOLG >=7.0<=28.0 BY >=3.0<=28.0
ME2W = SIZE ME2PADN BY 5.99 UNDEROVER
ME2WL = LENGTH ME2W >= 30
ME2WI = ME2W WITH EDGE ME2WL
ME2WID = MERGE ME2WI

ME2H = ME2PADN OR ME2HOL
ME2HW = SIZE ME2H BY 5.99 UNDEROVER
ME2HWL = LENGTH ME2HW >= 30
ME2HWI = ME2HW WITH EDGE ME2HWL
ME2HWID = COPY ME2HWI

ME3HOLG = (HOLES ME3PADN EMPTY) NOT EPAD
ME3HOL = RECTANGLE ME3HOLG >=7.0<=28.0 BY >=3.0<=28.0
ME3W = SIZE ME3PADN BY 5.99 UNDEROVER
ME3WL = LENGTH ME3W >= 30
ME3WI = ME3W WITH EDGE ME3WL
ME3WID = MERGE ME3WI

ME3H = ME3PADN OR ME3HOL
ME3HW = SIZE ME3H BY 5.99 UNDEROVER
ME3HWL = LENGTH ME3HW >= 30
ME3HWI = ME3HW WITH EDGE ME3HWL
ME3HWID = COPY ME3HWI

ME4HOLG = (HOLES ME4PADN EMPTY) NOT EPAD
ME4HOL = RECTANGLE ME4HOLG >=7.0<=28.0 BY >=3.0<=28.0
ME4W = SIZE ME4PADN BY 5.99 UNDEROVER
ME4WL = LENGTH ME4W >= 30
ME4WI = ME4W WITH EDGE ME4WL
ME4WID = MERGE ME4WI

ME4H = ME4PADN OR ME4HOL
ME4HW = SIZE ME4H BY 5.99 UNDEROVER
ME4HWL = LENGTH ME4HW >= 30
ME4HWI = ME4HW WITH EDGE ME4HWL
ME4HWID = COPY ME4HWI

ME5HOLG = (HOLES ME5PADN EMPTY) NOT EPAD
ME5HOL = RECTANGLE ME5HOLG >=7.0<=28.0 BY >=3.0<=28.0
ME5W = SIZE ME5PADN BY 5.99 UNDEROVER
ME5WL = LENGTH ME5W >= 30
ME5WI = ME5W WITH EDGE ME5WL
ME5WID = MERGE ((ME5WI OUTSIDE MIM5) OUTSIDE HKMIM5)

ME5H = ME5PADN OR ME5HOL
ME5HW = SIZE ME5H BY 5.99 UNDEROVER
ME5HWL = LENGTH ME5HW >= 30
ME5HWI = ME5HW WITH EDGE ME5HWL
ME5HWID = COPY ME5HWI

ME6HOLG = (HOLES ME6PADN EMPTY) NOT EPAD
ME6HOL = RECTANGLE ME6HOLG >=7.0<=28.0 BY >=3.0<=28.0
ME6W = SIZE ME6PADN BY 5.99 UNDEROVER
ME6WL = LENGTH ME6W >= 30
ME6WI = ME6W WITH EDGE ME6WL
ME6WID = MERGE ((ME6WI OUTSIDE MIM5) OUTSIDE HKMIM5)

ME6H = ME6PADN OR ME6HOL
ME6HW = SIZE ME6H BY 5.99 UNDEROVER
ME6HWL = LENGTH ME6HW >= 30
ME6HWI = ME6HW WITH EDGE ME6HWL
ME6HWID = COPY ME6HWI

RSL.1_M1 { @ Rule SL.1_M1 : Carving by slot is mandatory in wide ME1 lines.
         COPY ME1WID
         }

RSL.1_M2 { @ Rule SL.1_M2 : Carving by slot is mandatory in wide ME2 lines.
         COPY ME2WID
         }

RSL.1_M3 { @ Rule SL.1_M3 : Carving by slot is mandatory in wide ME3 lines.
         COPY ME3WID
         }

RSL.1_M4 { @ Rule SL.1_M4 : Carving by slot is mandatory in wide ME4 lines.
         COPY ME4WID
         }

RSL.1_M5 { @ Rule SL.1_M5 : Carving by slot is mandatory in wide ME5 lines.
         COPY ME5WID
         }

RSL.1_M6 { @ Rule SL.1_M6 : Carving by slot is mandatory in wide ME6 lines.
         COPY ME6WID
         }

ME1WIDH = ME1HWID ENCLOSE ME1HOL
ME1WIDHOL = ME1HOL INSIDE ME1WIDH
ME2WIDH = ME2HWID ENCLOSE ME2HOL
ME2WIDHOL = ME2HOL INSIDE ME2WIDH
ME3WIDH = ME3HWID ENCLOSE ME3HOL
ME3WIDHOL = ME3HOL INSIDE ME3WIDH
ME4WIDH = ME4HWID ENCLOSE ME4HOL
ME4WIDHOL = ME4HOL INSIDE ME4WIDH
ME5WIDH = ME5HWID ENCLOSE ME5HOL
ME5WIDHOL = ME5HOL INSIDE ME5WIDH
ME6WIDH = ME6HWID ENCLOSE ME6HOL
ME6WIDHOL = ME6HOL INSIDE ME6WIDH

RSL.2_M1 { @ Rule SL.2_M1 : Minimum slot density in wide ME1 lines = 9%.
             DENSITY ME1WIDHOL INSIDE OF LAYER ME1WIDH BY RECTANGLE RDB dens_M1.rdb < 0.09
         }

RSL.2_M2 { @ Rule SL.2_M2 : Minimum slot density in wide ME2 lines = 9%.
             DENSITY ME2WIDHOL INSIDE OF LAYER ME2WIDH BY RECTANGLE RDB dens_M2.rdb < 0.09
         }

RSL.2_M3 { @ Rule SL.2_M3 : Minimum slot density in wide ME3 lines = 9%.
             DENSITY ME3WIDHOL INSIDE OF LAYER ME3WIDH BY RECTANGLE RDB dens_M3.rdb < 0.09
         }

RSL.2_M4 { @ Rule SL.2_M4 : Minimum slot density in wide ME4 lines = 9%.
             DENSITY ME4WIDHOL INSIDE OF LAYER ME4WIDH BY RECTANGLE RDB dens_M4.rdb < 0.09
         }

RSL.2_M5 { @ Rule SL.2_M5 : Minimum slot density in wide ME5 lines = 9%.
             DENSITY ME5WIDHOL INSIDE OF LAYER ME5WIDH BY RECTANGLE RDB dens_M5.rdb < 0.09
         }

RSL.2_M6 { @ Rule SL.2_M6 : Minimum slot density in wide ME6 lines = 9%.
             DENSITY ME6WIDHOL INSIDE OF LAYER ME6WIDH BY RECTANGLE RDB dens_M6.rdb < 0.09
         }

RSL.3_M1 { @ Rule SL.3_M1 : Allowed no carving by ME1 slots in bond pads.
             HOLES (M1 AND PAD)
         }
RSL.3_M2 { @ Rule SL.3_M2 : Allowed no carving by ME2 slots in bond pads.
             HOLES (M2 AND PAD)
         }

RSL.3_M3 { @ Rule SL.3_M3 : Allowed no carving by ME3 slots in bond pads.
             HOLES (M3 AND PAD)
         }

RSL.3_M4 { @ Rule SL.3_M4 : Allowed no carving by ME4 slots in bond pads.
             HOLES (M4 AND PAD)
         }

RSL.3_M5 { @ Rule SL.3_M5 : Allowed no carving by ME5 slots in bond pads.
             HOLES (M5 AND PAD)
         }

RSL.3_M6 { @ Rule SL.3_M6 : Allowed no carving by ME6 slots in bond pads.
             HOLES (M6 AND PAD)
         }

ME1WID1 = INT ME1HWID >= 12 <= 30 ABUT<90 REGION
ME1WID2 = ME1HWID NOT ME1WID1
ME2WID1 = INT ME2HWID >= 12 <= 30 ABUT<90 REGION
ME2WID2 = ME2HWID NOT ME2WID1
ME3WID1 = INT ME3HWID >= 12 <= 30 ABUT<90 REGION
ME3WID2 = ME3HWID NOT ME3WID1
ME4WID1 = INT ME4HWID >= 12 <= 30 ABUT<90 REGION
ME4WID2 = ME4HWID NOT ME4WID1
ME5WID1 = INT ME5HWID >= 12 <= 30 ABUT<90 REGION
ME5WID2 = ME5HWID NOT ME5WID1
ME6WID1 = INT ME6HWID >= 12 <= 30 ABUT<90 REGION
ME6WID2 = ME6HWID NOT ME6WID1

ME1HOL1 = ME1HOL INSIDE ME1WID1
ME2HOL1 = ME2HOL INSIDE ME2WID1
ME3HOL1 = ME3HOL INSIDE ME3WID1
ME4HOL1 = ME4HOL INSIDE ME4WID1
ME5HOL1 = ME5HOL INSIDE ME5WID1
ME6HOL1 = ME6HOL INSIDE ME6WID1

RSLR.5a_M1 { @ Rule SLR.5a_M1 : Minimum slot space if ME1 width 12 <= W <= 30 equals 7.0.
           EXT ME1HOL1 < 7.0
           }

RSLR.5a_M2 { @ Rule SLR.5a_M2 : Minimum slot space if ME2 width 12 <= W <= 30 equals 7.0.
           EXT ME2HOL1 < 7.0
           }

RSLR.5a_M3 { @ Rule SLR.5a_M3 : Minimum slot space if ME3 width 12 <= W <= 30 equals 7.0.
           EXT ME3HOL1 < 7.0
           }

RSLR.5a_M4 { @ Rule SLR.5a_M4 : Minimum slot space if ME4 width 12 <= W <= 30 equals 7.0.
           EXT ME4HOL1 < 7.0
           }

RSLR.5a_M5 { @ Rule SLR.5a_M5 : Minimum slot space if ME5 width 12 <= W <= 30 equals 7.0.
           EXT ME5HOL1 < 7.0
           }

RSLR.5a_M6 { @ Rule SLR.5a_M6 : Minimum slot space if ME6 width 12 <= W <= 30 equals 7.0.
           EXT ME6HOL1 < 7.0
           }

ME1HOL2 = ME1HOL INSIDE ME1WID2
ME2HOL2 = ME2HOL INSIDE ME2WID2
ME3HOL2 = ME3HOL INSIDE ME3WID2
ME4HOL2 = ME4HOL INSIDE ME4WID2
ME5HOL2 = ME5HOL INSIDE ME5WID2
ME6HOL2 = ME6HOL INSIDE ME6WID2

RSLR.5b_M1 { @ Rule SLR.5b_M1 : Minimum slot space if ME1 width W > 30 equals 10.0.
           EXT ME1HOL2 < 10.0
           }

RSLR.5b_M2 { @ Rule SLR.5b_M2 : Minimum slot space if ME2 width W > 30 equals 10.0.
           EXT ME2HOL2 < 10.0
           }

RSLR.5b_M3 { @ Rule SLR.5b_M3 : Minimum slot space if ME3 width W > 30 equals 10.0.
           EXT ME3HOL2 < 10.0
           }

RSLR.5b_M4 { @ Rule SLR.5b_M4 : Minimum slot space if ME4 width W > 30 equals 10.0.
           EXT ME4HOL2 < 10.0
           }

RSLR.5b_M5 { @ Rule SLR.5b_M5 : Minimum slot space if ME5 width W > 30 equals 10.0.
           EXT ME5HOL2 < 10.0
           }

RSLR.5b_M6 { @ Rule SLR.5b_M6 : Minimum slot space if ME6 width W > 30 equals 10.0.
           EXT ME6HOL2 < 10.0
           }

RSLR.6b_M1 { @ Rule SLR.6b_M1 : Minimum slot length if ME1 width W > 30 equals 10.0.
               RECTANGLE ME1HOL2 >=3.0<10.0 BY >=3.0<10.0
           }

RSLR.6b_M2 { @ Rule SLR.6b_M2 : Minimum slot length if ME2 width W > 30 equals 10.0.
               RECTANGLE ME2HOL2 >=3.0<10.0 BY >=3.0<10.0
           }

RSLR.6b_M3 { @ Rule SLR.6b_M3 : Minimum slot length if ME3 width W > 30 equals 10.0.
               RECTANGLE ME3HOL2 >=3.0<10.0 BY >=3.0<10.0
           }

RSLR.6b_M4 { @ Rule SLR.6b_M4 : Minimum slot length if ME4 width W > 30 equals 10.0.
               RECTANGLE ME4HOL2 >=3.0<10.0 BY >=3.0<10.0
           }

RSLR.6b_M5 { @ Rule SLR.6b_M5 : Minimum slot length if ME5 width W > 30 equals 10.0.
               RECTANGLE ME5HOL2 >=3.0<10.0 BY >=3.0<10.0
           }

RSLR.6b_M6 { @ Rule SLR.6b_M6 : Minimum slot length if ME6 width W > 30 equals 10.0.
               RECTANGLE ME6HOL2 >=3.0<10.0 BY >=3.0<10.0
           }

RSLR.7a_M1 { @ Rule SLR.7a_M1 : Maximum slot length if ME1 width 12 <= W <= 30 equals 14.0.
               RECTANGLE ME1HOL1 > 14.0
           }

RSLR.7a_M2 { @ Rule SLR.7a_M2 : Maximum slot length if ME2 width 12 <= W <= 30 equals 14.0.
               RECTANGLE ME2HOL1 > 14.0
           }

RSLR.7a_M3 { @ Rule SLR.7a_M3 : Maximum slot length if ME3 width 12 <= W <= 30 equals 14.0.
               RECTANGLE ME3HOL1 > 14.0
           }

RSLR.7a_M4 { @ Rule SLR.7a_M4 : Maximum slot length if ME4 width 12 <= W <= 30 equals 14.0.
               RECTANGLE ME4HOL1 > 14.0
           }

RSLR.7a_M5 { @ Rule SLR.7a_M5 : Maximum slot length if ME5 width 12 <= W <= 30 equals 14.0.
               RECTANGLE ME5HOL1 > 14.0
           }

RSLR.7a_M6 { @ Rule SLR.7a_M6 : Maximum slot length if ME6 width 12 <= W <= 30 equals 14.0.
               RECTANGLE ME6HOL1 > 14.0
           }

ME1WID18 = ME1WID1 OR BP
ME2WID18 = ME2WID1 OR BP
ME3WID18 = ME3WID1 OR BP
ME4WID18 = ME4WID1 OR BP
ME5WID18 = ME5WID1 OR BP
ME6WID18 = ME6WID1 OR BP

ME1WID28 = ME1WID2 OR BP
ME2WID28 = ME2WID2 OR BP
ME3WID28 = ME3WID2 OR BP
ME4WID28 = ME4WID2 OR BP
ME5WID28 = ME5WID2 OR BP
ME6WID28 = ME6WID2 OR BP

RSLR.8a_M1 { @ Rule SLR.8a_M1 : Minimum slot enclosure by ME1 if ME1 width 12 <= W <= 30 equals 3.0.
           ENC ME1HOL1 ME1WID18 < 3.0
           }

RSLR.8a_M2 { @ Rule SLR.8a_M2 : Minimum slot enclosure by ME2 if ME2 width 12 <= W <= 30 equals 3.0.
           ENC ME2HOL1 ME2WID18 < 3.0
           }

RSLR.8a_M3 { @ Rule SLR.8a_M3 : Minimum slot enclosure by ME3 if ME3 width 12 <= W <= 30 equals 3.0.
           ENC ME3HOL1 ME3WID18 < 3.0
           }

RSLR.8a_M4 { @ Rule SLR.8a_M4 : Minimum slot enclosure by ME4 if ME4 width 12 <= W <= 30 equals 3.0.
           ENC ME4HOL1 ME4WID18 < 3.0
           }

RSLR.8a_M5 { @ Rule SLR.8a_M5 : Minimum slot enclosure by ME5 if ME5 width 12 <= W <= 30 equals 3.0.
           ENC ME5HOL1 ME5WID18 < 3.0
           }

RSLR.8a_M6 { @ Rule SLR.8a_M6 : Minimum slot enclosure by ME6 if ME6 width 12 <= W <= 30 equals 3.0.
           ENC ME6HOL1 ME6WID18 < 3.0
           }

RSLR.8b_M1 { @ Rule SLR.8b_M1 : Minimum slot enclosure by ME1 if ME1 width W > 30 equals 7.0.
           ENC ME1HOL2 ME1WID28 < 7.0
           }

RSLR.8b_M2 { @ Rule SLR.8b_M2 : Minimum slot enclosure by ME2 if ME2 width W > 30 equals 7.0.
           ENC ME2HOL2 ME2WID28 < 7.0
           }

RSLR.8b_M3 { @ Rule SLR.8b_M3 : Minimum slot enclosure by ME3 if ME3 width W > 30 equals 7.0.
           ENC ME3HOL2 ME3WID28 < 7.0
           }

RSLR.8b_M4 { @ Rule SLR.8b_M4 : Minimum slot enclosure by ME4 if ME4 width W > 30 equals 7.0.
           ENC ME4HOL2 ME4WID28 < 7.0
           }

RSLR.8b_M5 { @ Rule SLR.8b_M5 : Minimum slot enclosure by ME5 if ME5 width W > 30 equals 7.0.
           ENC ME5HOL2 ME5WID28 < 7.0
           }

RSLR.8b_M6 { @ Rule SLR.8b_M6 : Minimum slot enclosure by ME6 if ME6 width W > 30 equals 7.0.
           ENC ME6HOL2 ME6WID28 < 7.0
           }
    
#ELSE
#ENDIF

//////////////////////////////////////////////////////////////////////////////
//             PAD Nitride CHECK                                             /
//////////////////////////////////////////////////////////////////////////////

GROUP drcPAD_Nitride
R31.2
R31.2a
R31.28
R31.29
R31.18
R31.19
R31.imp6
R31.3
R31.8
R31.9
R31.20
R31.21
R31.imp1
R31.imp7
R31.imp8
R31.4
R31.10
R31.11
R31.22
R31.23
R31.imp2
R31.imp9
R31.imp10
R31.5
R31.12
R31.13
R31.imp3
R31.24
R31.25
R31.imp11
R31.imp12
R31.6
R31.14
R31.15
R31.26
R31.27
R31.imp4
R31.imp13
R31.imp14
R31.7
R31.1
R31.16
R31.17
R31.imp5
R31.imp15
R31.imp16

//////////////////////////////////////////////////////////////////////////////
//             DENSITY  CHECKS  GROUPING                                     /
//////////////////////////////////////////////////////////////////////////////
 
GROUP DENSITY_ACT_TOT R2.du14 R2.du16
GROUP DENSITY_POL_TOT R13.12
GROUP DENSITY_ACT_WIN R2.du15
GROUP DENSITY_MET1_WIN_MIN R23.6
GROUP DENSITY_MET2_WIN_MIN R27.6
GROUP DENSITY_MET3_WIN_MIN R34.6
GROUP DENSITY_MET4_WIN_MIN R36.6
GROUP DENSITY_MET5_WIN_MIN R53.6
GROUP DENSITY_MET1_WIN_MAX R23.7
GROUP DENSITY_MET2_WIN_MAX R27.7
GROUP DENSITY_MET3_WIN_MAX R34.7
GROUP DENSITY_MET4_WIN_MAX R36.7
GROUP DENSITY_MET5_WIN_MAX R53.7
GROUP DENSITY_ME6_TOT R55.5

//////////////////////////////////////////////////////////////////////////////
//             MIM5 DENSITY CHECKS GROUPING                                  /
//////////////////////////////////////////////////////////////////////////////
 
GROUP DENSITY_MIM_WIN_MIN RMT80.8
GROUP DENSITY_MIM_WIN_MAX RMT80.9

//////////////////////////////////////////////////////////////////////////////
//             HKMIM5 DENSITY CHECKS GROUPING                                  /
//////////////////////////////////////////////////////////////////////////////
 
GROUP DENSITY_HKMIM_WIN_MIN RM92.8
GROUP DENSITY_HKMIM_WIN_MAX RM92.9

//////////////////////////////////////////////////////////////////////////////
//             DUMMIES  CHECKS  GROUPING                                     /
//////////////////////////////////////////////////////////////////////////////
 
GROUP DUMMIES_ACT R2.du1 R2.du2 R2.du3_R2.du3a R2.du3a R2.du4 R2.du5 R2.du6 R2.du7a R2.du7b R2.du7c R2.du8 R2.du9
GROUP DUMMIES_POL R13.du1 R13.du2 R13.du6 R13.du7a R13.du7b R13.du7c R13.du8 R13.du9
GROUP DUMMIES_METAL1 R23.du1 R23.du2a R23.du2b R23.du2c R23.du3 R23.du4 R23.du6
GROUP DUMMIES_METAL2 R27.du1 R27.du2a R27.du2b R27.du2c R27.du3 R27.du4 R27.du6
GROUP DUMMIES_METAL3 R34.du1 R34.du2a R34.du2b R34.du2c R34.du3 R34.du4 R34.du6
GROUP DUMMIES_METAL4 R36.du1 R36.du2a R36.du2b R36.du2c R36.du3 R36.du4 R36.du6
GROUP DUMMIES_METAL5 R53.du1 R53.du2a R53.du2b R53.du2c R53.du3 R53.du4 R53.du6
GROUP DUMMIES_METAL6 R55.du1 R55.du2a R55.du2b R55.du2c R55.du3 R55.du4 R55.du6
GROUP DUMMIES_MIM5 R80.du1 R80.du2a R80.du2b R80.du2c R80.du3 R80.du4 R80.du5 R80.du6
GROUP DUMMIES_HKMIM5 R92.du1 R92.du2a R92.du2b R92.du2c R92.du3 R92.du4 R92.du5 R92.du6

GROUP DRC_rhipo RF2.1 RF13.3 RF13.4 RF26.1 RF26.2 RF26.3 RF26.4 RF26.5 RF26.9_RF26.10 RF17.1 RF17.2 RF17.3 RF17.4 RF18.1 

// ------------------------------------------------------------------------------
//        ANTENNA MOS CHECKS GROUPING
// ------------------------------------------------------------------------------
#IFDEF drcANTENNA_MOS
GROUP ANTENNA_RUL_PO POLY_ANT POLY_XPO
GROUP ANTENNA_RUL_LIL LIL_ANT LIL_XPOL LIL_XLIL
GROUP ANTENNA_RUL_M1 M1_XANT M1_XPOL M1_XLIL M1_XME1
GROUP ANTENNA_RUL_M2 M2_XANT M2_XPOL M2_XLIL M2_XME1 M2_XME2
GROUP ANTENNA_RUL_M3 M3_XANT M3_XPOL M3_XLIL M3_XME1 M3_XME2 M3_XME3
GROUP ANTENNA_RUL_M4 M4_XANT M4_XPOL M4_XLIL M4_XME1 M4_XME2 M4_XME3 M4_XME4
GROUP ANTENNA_RUL_M5 M5_XANT M5_XPOL M5_XLIL M5_XME1 M5_XME2 M5_XME3 M5_XME4 M5_XME5
GROUP ANTENNA_RUL_M6 M6_XANT M6_XPOL M6_XLIL M6_XME1 M6_XME2 M6_XME3 M6_XME4 M6_XME5 M6_XME6
GROUP ANTENNA_RUL_MIM5 RMT.ANT.1 RMT.ANT.3 MT.XME5 MT.XME4 MT.XME3 MT.XME2 MT.XME1 MT.XLIL
RMT.ANT.4 RMT.ANT.5 RMT.ANT.6 RMT.ANT.9 RMT.ANT.10
GROUP ANTENNA_RUL_HKMIM5 RMT.ANT.1.HK RMT.ANT.3.HK MT.XME5.HK MT.XME4.HK MT.XME3.HK MT.XME2.HK MT.XME1.HK MT.XLIL.HK
RMT.ANT.4.HK RMT.ANT.5.HK RMT.ANT.6.HK RMT.ANT.9.HK RMT.ANT.10.HK
#ELSE
#ENDIF

#IFDEF METAL_SLOT_CHECKS
GROUP METAL_SLOT RSL.1_M1 RSL.1_M2 RSL.1_M3 RSL.1_M4 RSL.1_M5 RSL.1_M6
RSL.2_M1 RSL.2_M2 RSL.2_M3 RSL.2_M4 RSL.2_M5 RSL.2_M6
RSLR.5a_M1 RSLR.5a_M2 RSLR.5a_M3 RSLR.5a_M4 RSLR.5a_M5 RSLR.5a_M6
RSLR.5b_M1 RSLR.5b_M2 RSLR.5b_M3 RSLR.5b_M4 RSLR.5b_M5 RSLR.5b_M6
RSLR.6b_M1 RSLR.6b_M2 RSLR.6b_M3 RSLR.6b_M4 RSLR.6b_M5 RSLR.6b_M6
RSLR.7a_M1 RSLR.7a_M2 RSLR.7a_M3 RSLR.7a_M4 RSLR.7a_M5 RSLR.7a_M6
RSLR.8a_M1 RSLR.8a_M2 RSLR.8a_M3 RSLR.8a_M4 RSLR.8a_M5 RSLR.8a_M6
RSLR.8b_M1 RSLR.8b_M2 RSLR.8b_M3 RSLR.8b_M4 RSLR.8b_M5 RSLR.8b_M6
#ELSE
#ENDIF

